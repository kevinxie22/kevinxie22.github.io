(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[,,,function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionUtils=t.Action=void 0,(o=r=t.Action||(t.Action={}))[o.TEST_ONLY_ClearStoreState=0]="TEST_ONLY_ClearStoreState",o[o.FailedAjaxConnection=1]="FailedAjaxConnection",o[o.GetAvatarFromEWS=2]="GetAvatarFromEWS",o[o.GetInternetMessageId=3]="GetInternetMessageId",o[o.GetLocalizationStrings=4]="GetLocalizationStrings",o[o.GetDefaultStrings=5]="GetDefaultStrings",o[o.GetUserSettings=6]="GetUserSettings",o[o.SetUserOptIn=7]="SetUserOptIn",o[o.UpdateOutlookNotificationsByUser=8]="UpdateOutlookNotificationsByUser",o[o.EnableOutlookNotificationsInDelayDelivery=9]="EnableOutlookNotificationsInDelayDelivery",o[o.OptOutAutoDelayDeliveryInOutlookNotifications=10]="OptOutAutoDelayDeliveryInOutlookNotifications",o[o.UpdateIsAutoDelayDeliveryOptedInByUser=11]="UpdateIsAutoDelayDeliveryOptedInByUser",o[o.UpdateIsProtectedTimeBookingOptedInByUser=12]="UpdateIsProtectedTimeBookingOptedInByUser",o[o.RefreshStateForItemChanged=13]="RefreshStateForItemChanged",o[o.InitializeRoamingSettings=14]="InitializeRoamingSettings",o[o.UpdateManagerInsightsOptedInByUser=15]="UpdateManagerInsightsOptedInByUser",o[o.FocusTimeSettings=16]="FocusTimeSettings",o[o.UpdateLunchTimeSettings=17]="UpdateLunchTimeSettings",o[o.EditLunchTime=18]="EditLunchTime",o[o.LunchTimeEditModeChanged=19]="LunchTimeEditModeChanged",o[o.EditLunchCheckbox=20]="EditLunchCheckbox",o[o.WaitingForResponse=21]="WaitingForResponse",o[o.ResponseReceived=22]="ResponseReceived",o[o.IgnorePeopleFirstRun=23]="IgnorePeopleFirstRun",o[o.Insights=24]="Insights",o[o.InsightActionLogItem=25]="InsightActionLogItem",o[o.HistoricalInsightActionLogItems=26]="HistoricalInsightActionLogItems",o[o.RESTCallbackTokenReady=27]="RESTCallbackTokenReady",o[o.GetSortedVIPs=28]="GetSortedVIPs",o[o.GetIRankerUnreadMail=29]="GetIRankerUnreadMail",o[o.GetUnreadMailFromIRankerSearchFolder=30]="GetUnreadMailFromIRankerSearchFolder",o[o.GetUnreadMailFromDirectReportSearchFolder=31]="GetUnreadMailFromDirectReportSearchFolder",o[o.MarkMailAsNotImportant=32]="MarkMailAsNotImportant",o[o.PeopleSuggestions=33]="PeopleSuggestions",o[o.PeoplePin=34]="PeoplePin",o[o.PeopleUnpin=35]="PeopleUnpin",o[o.MarkUserPinned=36]="MarkUserPinned",o[o.MarkUserUnpinned=37]="MarkUserUnpinned",o[o.SetConfirmation=38]="SetConfirmation",o[o.MarkEmailItemAsReadAction=39]="MarkEmailItemAsReadAction",o[o.GetWorkingHours=40]="GetWorkingHours",o[o.IsItemInSentItemsFolder=41]="IsItemInSentItemsFolder",o[o.SentMailStatistics=42]="SentMailStatistics",o[o.SentMailDocumentStatistics=43]="SentMailDocumentStatistics",o[o.SentMailInContextStatistics=44]="SentMailInContextStatistics",o[o.SentMailDocumentInContextStatistics=45]="SentMailDocumentInContextStatistics",o[o.GetToSentMailStatsInContextFromActionableMessage=46]="GetToSentMailStatsInContextFromActionableMessage",o[o.SentMailInContextStatus=47]="SentMailInContextStatus",o[o.GetUserAvailability=48]="GetUserAvailability",o[o.GetImportantPeopleAvailability=49]="GetImportantPeopleAvailability",o[o.UpsertExtractedFollowUpRequests=50]="UpsertExtractedFollowUpRequests",o[o.UpsertExtractedFollowUpRequestTasks=51]="UpsertExtractedFollowUpRequestTasks",o[o.UpsertFollowUpRequestIdsAsDone=52]="UpsertFollowUpRequestIdsAsDone",o[o.UpsertFollowUpRequestTaskIdsAsDone=53]="UpsertFollowUpRequestTaskIdsAsDone",o[o.OfficeJSReady=54]="OfficeJSReady",o[o.UpdateLoadedCache=55]="UpdateLoadedCache",o[o.LoadFromSessionData=56]="LoadFromSessionData",o[o.VisitDashboard=57]="VisitDashboard",o[o.GetDirectReports=58]="GetDirectReports",o[o.AddDirectReport=59]="AddDirectReport",o[o.RemoveDirectReport=60]="RemoveDirectReport",o[o.ChangeTheme=61]="ChangeTheme",o[o.UpdateDebugMessage=62]="UpdateDebugMessage",o[o.SetNewCardAnimationFinish=63]="SetNewCardAnimationFinish",o[o.AddAnimatingNewCard=64]="AddAnimatingNewCard",o[o.RemoveAnimatingNewCard=65]="RemoveAnimatingNewCard",o[o.SetExchangeRequestsDone=66]="SetExchangeRequestsDone",o[o.SetLoadingDone=67]="SetLoadingDone",o[o.AddUnfulfilledRequest=68]="AddUnfulfilledRequest",o[o.RemoveFulfilledRequest=69]="RemoveFulfilledRequest",o[o.GetMeetingOverloadFromActionableMessage=70]="GetMeetingOverloadFromActionableMessage",o[o.GetCalendarItems=71]="GetCalendarItems",o[o.GetScheduleItems=72]="GetScheduleItems",o[o.AddTaskCalendarItem=73]="AddTaskCalendarItem",o[o.AddDocumentCalendarItem=74]="AddDocumentCalendarItem",o[o.SetFreeBlockBookingStatus=75]="SetFreeBlockBookingStatus",o[o.BookFocusBlock=76]="BookFocusBlock",o[o.BookFocusBlocks=77]="BookFocusBlocks",o[o.DeleteFocusBlock=78]="DeleteFocusBlock",o[o.UpdateFocusTime=79]="UpdateFocusTime",o[o.UpdateSelectedMoveMeetingBlock=80]="UpdateSelectedMoveMeetingBlock",o[o.MoveFocusBlock=81]="MoveFocusBlock",o[o.SwitchToMovingFocusBlock=82]="SwitchToMovingFocusBlock",o[o.SwitchToMovingMeeting=83]="SwitchToMovingMeeting",o[o.ProtectedTimeMinLoadCompleted=84]="ProtectedTimeMinLoadCompleted",o[o.ProtectedTimeMaxLoadExceeded=85]="ProtectedTimeMaxLoadExceeded",o[o.BookingProtectedTimeSucceeded=86]="BookingProtectedTimeSucceeded",o[o.BookingProtectedTimeFailed=87]="BookingProtectedTimeFailed",o[o.ResetProtectedTimeBooking=88]="ResetProtectedTimeBooking",o[o.GetCalendarItemsForMeetingSuggestion=89]="GetCalendarItemsForMeetingSuggestion",o[o.UserActivityAction=90]="UserActivityAction",o[o.GetRecipientsWorkingHourConfig=91]="GetRecipientsWorkingHourConfig",o[o.GetWorkingHourConfig=92]="GetWorkingHourConfig",o[o.GetAutoDelayDeliveryInfobar=93]="GetAutoDelayDeliveryInfobar",o[o.GetSuggestedDelayDeliveryInfobar=94]="GetSuggestedDelayDeliveryInfobar",o[o.SetDelayDeliveryTime=95]="SetDelayDeliveryTime",o[o.GetDelayDeliveryProperties=96]="GetDelayDeliveryProperties",o[o.GetAutoDelayDeliveryAdvertisementCount=97]="GetAutoDelayDeliveryAdvertisementCount",o[o.UpdateAutoDelayDeliveryAdvertisementCount=98]="UpdateAutoDelayDeliveryAdvertisementCount",o[o.GetUserAddressToTimeZoneMap=99]="GetUserAddressToTimeZoneMap",o[o.GetPostDelayDeliveryFromActionableMessage=100]="GetPostDelayDeliveryFromActionableMessage",o[o.SetHasErrorHappenedInDelayDelivery=101]="SetHasErrorHappenedInDelayDelivery",o[o.DocumentsFromSentMail=102]="DocumentsFromSentMail",o[o.GetSuggestedTasksFromActionableMessage=103]="GetSuggestedTasksFromActionableMessage",o[o.GetToDoFromActionableMessage=104]="GetToDoFromActionableMessage",o[o.GetFocusTimeFromActionableMessage=105]="GetFocusTimeFromActionableMessage",o[o.GetFocusTimeConflictFromActionableMessage=106]="GetFocusTimeConflictFromActionableMessage",o[o.GetDaysToBookInsight=107]="GetDaysToBookInsight",o[o.GetInfobarContext=108]="GetInfobarContext",o[o.UpdateInfobar=109]="UpdateInfobar",o[o.GetAfterHoursMeetingAttendeeActionableMessage=110]="GetAfterHoursMeetingAttendeeActionableMessage",o[o.SelectAttendeeMeetingTimeSlot=111]="SelectAttendeeMeetingTimeSlot",o[o.CancelAttendeeMeetingTimeSlot=112]="CancelAttendeeMeetingTimeSlot",o[o.GetDetectOOFComposingInfobar=113]="GetDetectOOFComposingInfobar",o[o.NavigateBack=114]="NavigateBack",o[o.NavigateTo=115]="NavigateTo",o[o.HasLoadedFromExternalContext=116]="HasLoadedFromExternalContext",o[o.HasLoadedFromSettingsContext=117]="HasLoadedFromSettingsContext",o[o.TrackEmailInsightInfobar=118]="TrackEmailInsightInfobar",o[o.PeopleCatchUpItemsInsightInfobar=119]="PeopleCatchUpItemsInsightInfobar",o[o.GetComposeMeetingRequiredRecipients=120]="GetComposeMeetingRequiredRecipients",o[o.GetComposeMeetingOptionalRecipients=121]="GetComposeMeetingOptionalRecipients",o[o.GetComposeMeetingTime=122]="GetComposeMeetingTime",o[o.GetComposeMeetingRecurrence=123]="GetComposeMeetingRecurrence",o[o.GetComposeMessageToRecipients=124]="GetComposeMessageToRecipients",o[o.GetComposeMessageCcRecipients=125]="GetComposeMessageCcRecipients",o[o.GetComposeMessageBccRecipients=126]="GetComposeMessageBccRecipients",o[o.GetComposeMessageType=127]="GetComposeMessageType",o[o.GetComposeMeetingRequiredAndOptionalRecipients=128]="GetComposeMeetingRequiredAndOptionalRecipients",o[o.GetComposeItemAttachments=129]="GetComposeItemAttachments",o[o.UpdateEmailProperties=130]="UpdateEmailProperties",o[o.GetShortenMeetingFromActionableMessage=131]="GetShortenMeetingFromActionableMessage",o[o.GetIsNewComposeMeeting=132]="GetIsNewComposeMeeting",o[o.InitializeTeachingMoment=133]="InitializeTeachingMoment",o[o.CompleteTeachingMoment=134]="CompleteTeachingMoment",o[o.ResetTeachingMoment=135]="ResetTeachingMoment",o[o.UpsertLockedInsightNameAndType=136]="UpsertLockedInsightNameAndType",o[o.UpdateLastKnownEmailProperties=137]="UpdateLastKnownEmailProperties",o[o.UpdateLastKnownMeetingProperties=138]="UpdateLastKnownMeetingProperties",o[o.UpdateSearchContextInsightsRequestStatus=139]="UpdateSearchContextInsightsRequestStatus",o[o.CleanUpInfobarInsight=140]="CleanUpInfobarInsight",o[o.GetUnreadMailActionableMessage=141]="GetUnreadMailActionableMessage",o[o.DismissFocusTimeWorkingHourTip=142]="DismissFocusTimeWorkingHourTip",o[o.DismissAfterHoursWorkingHourTip=143]="DismissAfterHoursWorkingHourTip",o[o.DismissInfobarInsight=144]="DismissInfobarInsight",o[o.SetHasLoggedComposeMessageType=145]="SetHasLoggedComposeMessageType",o[o.ToggleJSONMode=146]="ToggleJSONMode",o[o.InComingWebhookUrl=147]="InComingWebhookUrl",o[o.InsightNameToLoad=148]="InsightNameToLoad",o[o.MockPanelError=149]="MockPanelError",o[o.MockSingleCards=150]="MockSingleCards",o[o.LocalizedStringsToLoad=151]="LocalizedStringsToLoad",o[o.UpdateThumbsState=152]="UpdateThumbsState",o[o.GetUserFlightsFromControlTower=153]="GetUserFlightsFromControlTower",o[o.GetUserFlightsFromExternalContext=154]="GetUserFlightsFromExternalContext",o[o.PreRollupInsights=155]="PreRollupInsights",o[o.NoApplicableInsights=156]="NoApplicableInsights",o[o.BroradcastInsights=157]="BroradcastInsights",o[o.NoBroadcastInsights=158]="NoBroadcastInsights",o[o.AdaptiveInsights=159]="AdaptiveInsights",o[o.NoAdaptiveInsights=160]="NoAdaptiveInsights",o[o.InContextInsights=161]="InContextInsights",o[o.NoInContextInsights=162]="NoInContextInsights",o[o.InfobarInsights=163]="InfobarInsights",o[o.NoInfobarInsights=164]="NoInfobarInsights",o[o.ActionableMessageInsights=165]="ActionableMessageInsights",o[o.NoActionableMessageInsights=166]="NoActionableMessageInsights",o[o.FilteredOutInsights=167]="FilteredOutInsights",o[o.HasNoFilteredOutInsights=168]="HasNoFilteredOutInsights",o[o.MeetingPreparationCardInsightAction=169]="MeetingPreparationCardInsightAction",o[o.MeetingDocumentStatsCardAction=170]="MeetingDocumentStatsCardAction",o[o.BookMeetingPreparationTimeAction=171]="BookMeetingPreparationTimeAction",o[o.CancelMeetingPreparationTimeAction=172]="CancelMeetingPreparationTimeAction",o[o.BookMeetingPreparationTimeInfobarAction=173]="BookMeetingPreparationTimeInfobarAction",o[o.CancelMeetingPreparationTimeInfobarAction=174]="CancelMeetingPreparationTimeInfobarAction",o[o.MeetingPreparationInfobar=175]="MeetingPreparationInfobar",o[o.MeetingRelatedDocumentsAction=176]="MeetingRelatedDocumentsAction",o[o.RespondToMeeting=177]="RespondToMeeting",o[o.BookOneOnOneInsight=178]="BookOneOnOneInsight",o[o.RescheduleOneOnOne=179]="RescheduleOneOnOne",o[o.ConflictingOneOnOneInsight=180]="ConflictingOneOnOneInsight",o[o.DraftInviteToBook=181]="DraftInviteToBook",o[o.GetUserOutcomesEnrollment=182]="GetUserOutcomesEnrollment",o[o.UpdateUserOutcomeEnrollment=183]="UpdateUserOutcomeEnrollment",o[o.DocumentsToCatchupInsightAction=184]="DocumentsToCatchupInsightAction",o[o.SmartRulesSuggestionInsightAction=185]="SmartRulesSuggestionInsightAction",o[o.GetMailFolders=186]="GetMailFolders",o[o.TeamsGroupSuggestion=187]="TeamsGroupSuggestion",o[o.TasksInsightAction=188]="TasksInsightAction",o[o.MarkTaskAsDoneAction=189]="MarkTaskAsDoneAction",o[o.MarkAsNotATaskAction=190]="MarkAsNotATaskAction",o[o.PromoteTaskAction=191]="PromoteTaskAction",o[o.FollowUpsInsight=192]="FollowUpsInsight",o[o.MarkFollowUpAsDone=193]="MarkFollowUpAsDone",o[o.MarkAsNotAFollowUp=194]="MarkAsNotAFollowUp",o[o.PromoteFollowUpAction=195]="PromoteFollowUpAction",o[o.GetTimeAwayRecord=196]="GetTimeAwayRecord",o[o.ForceSetNoTimeAway=197]="ForceSetNoTimeAway",o[o.SetNoTimeAway=198]="SetNoTimeAway",o[o.SetTimeAwayState=199]="SetTimeAwayState",o[o.SetAutoReplySetting=200]="SetAutoReplySetting",o[o.GetActiveContacts=201]="GetActiveContacts",o[o.UpdateGetActiveContactsStatus=202]="UpdateGetActiveContactsStatus",o[o.GetMeetingsDuringTimeAway1stBatch=203]="GetMeetingsDuringTimeAway1stBatch",o[o.GetMeetingsDuringTimeAway2ndBatch=204]="GetMeetingsDuringTimeAway2ndBatch",o[o.SetProtectedTimeAroundTimeAway=205]="SetProtectedTimeAroundTimeAway",o[o.UpdateProtectedTimeBeforeTimeAway=206]="UpdateProtectedTimeBeforeTimeAway",o[o.UpdateProtectedTimeAfterTimeAway=207]="UpdateProtectedTimeAfterTimeAway",o[o.DeleteMeetingsDuringTimeAway=208]="DeleteMeetingsDuringTimeAway",o[o.ClearDeletedMeetingsCount=209]="ClearDeletedMeetingsCount",o[o.DismissAllTimeAwayInstances=210]="DismissAllTimeAwayInstances",o[o.UpdateHolidayCardLoadHistory=211]="UpdateHolidayCardLoadHistory",o[o.DismissHoliday=212]="DismissHoliday",o[o.ChangeTimeAwayDropDown=213]="ChangeTimeAwayDropDown",o[o.ExpandNextPreparationTask=214]="ExpandNextPreparationTask",o[o.SelectMeeting=215]="SelectMeeting",o[o.SelectAllMeetings=216]="SelectAllMeetings",o[o.SetAutoReplyMessage=217]="SetAutoReplyMessage",o[o.SetDeclineOrCancelMeetingMessage=218]="SetDeclineOrCancelMeetingMessage",o[o.SetTimeAwayRange=219]="SetTimeAwayRange",o[o.UpdateScheduleTimeAwayCallout=220]="UpdateScheduleTimeAwayCallout",o[o.SetStartTimeRescheduleStatus=221]="SetStartTimeRescheduleStatus",o[o.SetEndTimeRescheduleStatus=222]="SetEndTimeRescheduleStatus",o[o.SetPullingMeetingsDuringTimeAway1stBatchStatus=223]="SetPullingMeetingsDuringTimeAway1stBatchStatus",o[o.SetPullingMeetingsDuringTimeAway1stBatchError=224]="SetPullingMeetingsDuringTimeAway1stBatchError",o[o.SetPullingMeetingsDuringTimeAway2ndBatchStatus=225]="SetPullingMeetingsDuringTimeAway2ndBatchStatus",o[o.SetPullingMeetingsDuringTimeAway2ndBatchError=226]="SetPullingMeetingsDuringTimeAway2ndBatchError",o[o.SetPullingProtectedTimeAroundTimeAwayStatus=227]="SetPullingProtectedTimeAroundTimeAwayStatus",o[o.SetPullingProtectedTimeAroundTimeAwayError=228]="SetPullingProtectedTimeAroundTimeAwayError",o[o.EditFocusTimeSubject=229]="EditFocusTimeSubject",o[o.UpdateFocusTimeSubject=230]="UpdateFocusTimeSubject",o[o.UpdateFeedbackThumbsState=231]="UpdateFeedbackThumbsState",o[o.UserSearchBackfill=232]="UserSearchBackfill",o[o.CurrentUserSearch=233]="CurrentUserSearch",o[o.UpdateUserSearchCalloutVisibility=234]="UpdateUserSearchCalloutVisibility",o[o.UserSearchCalloutStateChange=235]="UserSearchCalloutStateChange",o[o.ShowAllSearchResult=236]="ShowAllSearchResult",o[o.ClearUserSearchStore=237]="ClearUserSearchStore",t.default=r
var i=(a.getActionString=function(e){return r[e]},a)
function a(){}t.ActionUtils=i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LogRequestType=t.LogEventType=void 0
var p,r,o,s=n(0),u=s.__importStar(n(226)),i=n(144),a=n(266),l=n(275),c=s.__importDefault(n(6)),f=s.__importDefault(n(57)),d=s.__importDefault(n(25)),g=n(362),m=n(131),h=n(113);(r=p=t.LogEventType||(t.LogEventType={})).Load="Load",r.Click="Click",r.Hover="Hover",r.Get="GET",r.Set="SET",r.State="State",r.Assert="Assert",r.Warning="Warning",(o=t.LogRequestType||(t.LogRequestType={})).Init="Init",o.Interval="Interval",o.Action="Action",o.IndirectAction="IndirectAction",o.Test="Test"
var y=(_.setItemContext=function(e,t){_.currentItemType=e,_.currentMode=t},_.setIsItemInSentItemsFolder=function(e){_.isItemInSentItemsFolder=e},_.logUnhandledPromiseRejection=function(e,t,n){_.logAssert("Unhandled Rejected Promise"+JSON.stringify(e),t,n)},_.logOnSessionStart=function(){var e=d.default.IsAdvancedExperience||d.default.HasBackgroundAddinCapability?"bgEnabled":"bgDisabled"
_.logInformation("Boot Start, details: "+d.default.Environment+"_"+d.default.ExperienceType+"_"+d.default.Layout+"_"+e,"App",m.SourceName.OfficeInitialize)},_.logApiCallEvent=function(e,t,n){var r,o
_.areApiCallParametersValid(e,t,n)&&((r={}).Page=_.page(),r.Region=n.region||e,r.SourceName=n.source,r.Status=n.isSuccessful?"Success":"Fail",r.LT=String(n.duration),r.IsProxied=String(n.isProxied),r.RequestType=n.requestType,n.sourceValue&&(r.SourceValue=n.sourceValue),null!=n.isExpected&&(r.IsExpected=String(n.isExpected)),n.errorCode&&(r.ErrorCode=n.errorCode),n.errorMessage&&(r.ErrorMessage=n.errorMessage),null!=n.waitTime&&(r.WaitTime=String(n.waitTime)),n.requestId&&(r.RequestId=n.requestId),n.serverRequestId&&(r.ServerRequestId=n.serverRequestId),null!=n.batchSuccessCount&&(r.SuccessfulRequestCount=String(n.batchSuccessCount)),null!=n.batchFailCount&&(r.FailedRequestCount=String(n.batchFailCount)),o=_.getTableName(n.isExpected),_.logEvent(e,t,r,o))},_.logAssert=function(e,t,n){var r
_.areEventLogParametersValid(e,t,n)&&(r=_.buildEventProps(e,n),_.logEvent(t,p.Assert,r,u.TableNames.Error))},_.logWarning=function(e,t,n){var r
_.areEventLogParametersValid(e,t,n)&&(r=_.buildEventProps(e,n),_.logEvent(t,p.Warning,r,u.TableNames.Warning))},_.logInformation=function(e,t,n){var r,o
_.areEventLogParametersValid(e,t,n)&&(r=_.buildEventProps(e,n),o=_.getTableName(),_.logEvent(t,p.State,r,o))},_.logLoad=function(e,t,n,r){void 0===r&&(r=!0),t?_.logLoadHelper(u.TableNames.Information,e,t,n,r):_.logAssert("Null logProvider provided for: "+e+'"',"Logger","logLoadEvent")},_.logRoamingSettings=function(e,t){t?_.logLoadHelper(u.TableNames.RoamingSettings,e,t,void 0,!1):_.logAssert("Null logProvider provided for: "+e+'"',"Logger","LogRoamingSettingsLoadEvent")},_.logClick=function(e,t,n){var r,o,i
void 0===n&&(n=!0),t?(r=t.getFeatureNameForLogging(),o=_.buildUserActionEventProps(e,t),_.logEvent(r,p.Click,o,u.TableNames.Information),n&&_.areRequiredInteractionPropsValid()&&(i=_.buildInterestedUserInteractionEventProps(t,o),_.logInterestedUserInteraction(r,p.Click,i))):_.logAssert("Null logProvider provided for: "+e+'"',"Logger","logClickEvent")},_.logHover=function(i,a){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return s.__generator(this,function(e){switch(e.label){case 0:return a?(t=a.getFeatureNameForLogging(),n=a.getRegionNameForLogging(),r=t+"_"+n+"=="+i,[4,_.loggedInsightHovers.getItem(r)]):(_.logAssert("Null logProvider provided for: "+i+'"',"Logger","logHoverEvent"),[2])
case 1:return e.sent()?[2]:[3,2]
case 2:return[4,_.loggedInsightHovers.setItem(r,!0,{ttl:300})]
case 3:e.sent(),e.label=4
case 4:return o=_.buildUserActionEventProps(i,a),_.logEvent(t,p.Hover,o,u.TableNames.Information),[2]}})})},_.logLoadHelper=function(e,t,n,r,o){void 0===o&&(o=!0)
var i,a,s,u,l=n.getFeatureNameForLogging(),c=l+"_"+n.getRegionNameForLogging(),d=c+"=="+t
_.loggedInsightLoads[d]||(i=null!=r?r:Date.now()-f.default.sessionStartTime,a=n.getLoadEventLoggingProperties(),s={Page:_.page(),LT:String(i),Region:c,SourceName:c},a&&0!==Object.keys(a).length&&(s.SourceValue=JSON.stringify(a)),_.loggedInsightLoads[d]=!0,_.logEvent(l,p.Load,s,e),o&&_.areRequiredInteractionPropsValid()&&(u=_.buildInterestedUserInteractionEventProps(n,s),_.logInterestedUserInteraction(l,p.Load,u)))},_.logEvent=function(e,t,n,r){_.isLogToRightTable(r,t,e)||_.logAssert("Log with eventType "+t+" and featureName "+e+" shouldn't go to "+r+" table.",m.FeatureName.Log,m.SourceName.LogEvent)
var o=null==n.SourceName?"":n.SourceName
g.LogSampler.shouldSuppressLog(o,r)||(n.IsSampledSession=g.LogSampler.isSampledSession,u.default.logDiagnosticEvent({TableName:r,FeatureName:e,Event:t,Properties:n}))},_.logInterestedUserInteraction=function(e,t,n){u.default.logUserInteractionEvent({TableName:u.TableNames.UserInteractions,FeatureName:e,Event:t,Properties:n})},_.buildEventProps=function(e,t){var n={}
return n.Page=_.page(),n.SourceValue=e,n.SourceName=t,n},_.buildUserActionEventProps=function(e,t){var n=t.getFeatureNameForLogging(),r=t.getRegionNameForLogging(),o=t.getClickEventLoggingProperties(),i={Page:_.page(),Region:n+"_"+r,SourceName:n+"_"+e}
return o&&0!==Object.keys(o).length&&(i.SourceValue=JSON.stringify(o)),i},_.buildInterestedUserInteractionEventProps=function(e,t){var n={FeatureName:e.getFeatureNameForLogging(),Page:t.Page,Region:t.Region,PropertyBag:t.SourceValue?e.getClickEventLoggingProperties():void 0}
return{Source:"Agave",Version:_.USER_INTERACTION_EVENT_VERSION,ActionName:t.SourceName,LicenseType:d.default.ExperienceType,SessionId:f.default.sessionGuid,ActionProperties:n}},_.areRequiredInteractionPropsValid=function(){if(d.default.isLocalDebugging||c.default.isInMockMode)return!0
var e=f.default.ActorIdFromRESTToken,t=f.default.AadTenantIdFromRESTToken
return!!e&&!!t},_.page=function(){var e=h.Layout[d.default.Layout]+"_"+_.currentItemType+"_"+_.currentMode
return _.currentMode===i.Modes.Read&&(e+="_"+(_.isItemInSentItemsFolder?"Sender":"Receiver")),e},_.areApiCallParametersValid=function(e,t,n){var r=[]
return e||r.push("null feature"),null==t?r.push("null eventType"):t!==p.Get&&t!==p.Set&&r.push("unexpected eventType"),n?(n.source||r.push("null source"),null==n.isSuccessful&&r.push("null isSuccessful"),null==n.duration&&r.push("null duration")):r.push("null props"),!(0<r.length&&(_.logAssert("Incorrect params: "+r.join(", "),"Log","Logger.logApiCallEvent"),1))},_.areEventLogParametersValid=function(e,t,n){var r=[]
return e||r.push("null message"),t||r.push("null feature"),n||r.push("null source"),!(0<r.length&&(_.logAssert("Incorrect params: "+r.join(", "),"Log","Logger.LogMessage"),1))},_.isLogToRightTable=function(e,t,n){switch(e){case u.TableNames.Information:return t!==p.Warning&&t!==p.Assert
case u.TableNames.Error:return t===p.Assert||t===p.Set||t===p.Get
case u.TableNames.Warning:return t===p.Warning||t===p.Set||t===p.Get
case u.TableNames.BackgroundAddIn:return t===p.State||t===p.Set||t===p.Get
case u.TableNames.RoamingSettings:return n===m.FeatureName.RoamingSettings&&t===p.Load
case u.TableNames.UserInteractions:return!1
default:c.default.assertUnreachableError(e,u.TableNames)}},_.getTableName=function(e){return void 0!==e?e?u.TableNames.Warning:u.TableNames.Error:d.default.isInBackgroundMode?u.TableNames.BackgroundAddIn:u.TableNames.Information},_.loggedInsightLoads={},_.loggedInsightHovers=new a.ExpirationStrategy(new l.MemoryStorage),_.currentItemType=i.ItemTypes.Unknown,_.currentMode=i.Modes.Unknown,_.USER_INTERACTION_EVENT_VERSION=1,_)
function _(){}t.default=y},,function(e,d,p){"use strict";(function(t){Object.defineProperty(d,"__esModule",{value:!0}),d.OrderBy=void 0
var s,e,n=p(0),i=n.__importStar(p(455)),r=p(348),o=n.__importDefault(p(25)),a=p(7),u=p(456);(e=s=d.OrderBy||(d.OrderBy={})).Ascending="ascending",e.Descending="descending"
var l=(Object.defineProperty(c,"isInitializedByOnComposeEvent",{get:function(){return c.initializedEvent===r.AutoRunEventNames.OnMessageCompose||c.initializedEvent===r.AutoRunEventNames.OnAppointmentOrganizer},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMailboxReady",{get:function(){return c.officejsHasBeenInitialized&&!!Office&&!!Office.context&&!!Office.context.mailbox},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isCurrentItemAvailable",{get:function(){return c.isMailboxReady&&!!Office.context.mailbox.item},enumerable:!1,configurable:!0}),Object.defineProperty(c,"userEmail",{get:function(){return Office.context.mailbox.userProfile.emailAddress},enumerable:!1,configurable:!0}),Object.defineProperty(c,"userEmailLowerCase",{get:function(){return c.userEmail.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(c,"userDisplayName",{get:function(){return Office.context.mailbox.userProfile.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isChrome",{get:function(){return!o.default.isInAutoRunJSMode&&!!window.chrome&&!!window.chrome.webstore},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isIE",{get:function(){return!o.default.isInAutoRunJSMode&&!!document.documentMode},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isEdge",{get:function(){return!o.default.isInAutoRunJSMode&&0<=window.navigator.userAgent.indexOf("Edge/")},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isDisplayLanguageEnglish",{get:function(){return 0===c.LCID.indexOf("en-")},enumerable:!1,configurable:!0}),Object.defineProperty(c,"LCID",{get:function(){return Office.context.displayLanguage?Office.context.displayLanguage.toLowerCase():null},enumerable:!1,configurable:!0}),Object.defineProperty(c,"Timezone",{get:function(){var e=Office.context.mailbox.userProfile.timeZone
switch(e){case"Greenwich Mean Time":case"GMT":return"GMT Standard Time"
case"Western European Standard Time":return"W. Europe Standard Time"
case"West Africa Standard Time":return"W. Central Africa Standard Time"
case"Australian Eastern Standard Time":return"AUS Eastern Standard Time"
case"New Caledonia Standard Time":return"Central Pacific Standard Time"
case"Central Africa Time":return"South Africa Standard Time"
case"Moscow Standard Time":case"GMT+03:00":return"Russian Standard Time"
case"GMT-05:00":return"Eastern Standard Time"
case"Eastern European Standard Time":return"E. Europe Standard Time"
case"East Africa Time":return"E. Africa Standard Time"
case"Gulf Standard Time":return"Arabian Standard Time"
case"Maldives Time":return"West Asia Standard Time"
case"East Kazakhstan Time":return"N. Central Asia Standard Time"
case"Indochina Time":return"SE Asia Standard Time"
case"Novosibirsk Standard Time":return"North Asia Standard Time"
case"Malaysia Time":case"Philippine Standard Time":return"Singapore Standard Time"
case"Hong Kong Standard Time":return"China Standard Time"
case"Australian Western Standard Time":return"W. Australia Standard Time"
case"Central Indonesia Time":case"Brunei Darussalam Time":return"North Asia East Standard Time"
case"Japan Standard Time":return"Tokyo Standard Time"
case"Korean Standard Time":return"Korea Standard Time"
case"Australian Central Standard Time":return"AUS Central Standard Time"
case"Uruguay Standard Time":return"SA Eastern Standard Time"
case"Brasilia Standard Time":return"E. South America Standard Time"
case"Chile Standard Time":return"Pacific SA Standard Time"
case"Peru Standard Time":case"Colombia Standard Time":case"Ecuador Time":return"SA Pacific Standard Time"
case"Mexican Pacific Standard Time":return"Central Standard Time (Mexico)"
case"Hawaii-Aleutian Standard Time":return"Hawaiian Standard Time"
default:return e}},enumerable:!1,configurable:!0}),Object.defineProperty(c,"appGuidProd",{get:function(){return"fe93bfe1-7947-460a-a5e0-7a5906b51360"},enumerable:!1,configurable:!0}),c.getGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},c.showUrlFullScreen=function(e){window.open(e,"_blank","height="+(screen.availHeight-80)+",width="+(screen.availWidth-20)+",top=0,left=0,resizable=yes,scrollbars=yes,toolbar=yes,menubar=yes,location=yes")},c.getMillisecondsFromTicks=function(e){return Math.round((e-a.Constants.epochTicksDiff)/a.Constants.ticksPerMillisecond)},c.getTicksFromMilliseconds=function(e){return a.Constants.epochTicksDiff+e*a.Constants.ticksPerMillisecond},c.wordCount=function(e){return e?e.trim().split(/\s+/g).length:0},c.toUnicode=function(e){for(var t,n=0,r=e.length,o=new Uint8Array(2*r);n<r;n++)t=e.charCodeAt(n),o[2*n]=t,o[2*n+1]=0
return o},c.getGUID=function(e){for(var t="",n=0;n<16;n++){var r=e[n].toString(16)
1===r.length&&(r="0"+r),t+=n<4?r.split("").reverse().join(""):r}return t.substr(0,8).split("").reverse().join("")+"-"+t.substr(10,2)+t.substr(8,2)+"-"+t.substr(14,2)+t.substr(12,2)+"-"+t.substr(16,4)+"-"+t.substr(20,12)},c.getHashInternetMsgId=function(e){for(var t=this.toUnicode(e),n=i.hash(t),r=new Uint8Array(16),o=0;o<n.byteLength;o++)r[o%16]^=n[o]
return this.getGUID(r)},c.scrubXMLFromException=function(e){return e&&e.message?e.message.split("<")[0]:""},c.dedupObjectArrayByKey=function(e,t,n){var r=this,o=this.aggregateObjectArrayByKey(e,t),i=[]
return Object.keys(o).forEach(function(e){var t=o[e]
i.push(n.call(r,t))}),i},c.aggregateObjectArrayByKey=function(e,n){var r=this,o={}
return e.forEach(function(e){var t=n.call(r,e)
o[t]=(o[t]||[]).concat(e)}),o},c.getDistinctKeyCountInObjectArray=function(e,t){var n=this.aggregateObjectArrayByKey(e,t)
return Object.keys(n).length},c.shallowEquals=function(e,t){return u(e,t)},c.buildErrorMessage=function(e){return e&&e.name&&e.message?"["+e.name+"] : "+e.message:c.NO_ERROR_NAME_OR_MESSAGE_PROVIDED},c.atob=function(e){return null!==window&&void 0!==window&&window.atob?window.atob(e):new t(e,"base64").toString("binary")},c.parseJWTToken=function(e){var t=e.split(".")[1]
return JSON.parse(c.atob(t))},c.sortArrayOnKey=function(e,o,i){var a=this
return e.slice(0).sort(function(e,t){var n=o.call(a,e),r=o.call(a,t)
return i===s.Ascending?n-r:r-n})},c.sumElementsInArray=function(e,n){var r=this
return e.reduce(function(e,t){return e+n.call(r,t)},0)},c.initials=function(e){var t,n,r=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,o=/\s+/g
return e?(e=e.replace(r,"").replace(o," ").trim(),/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/.test(e)?"":(t="",2===(n=e.split(" ")).length?(t+=n[0].charAt(0).toUpperCase(),t+=n[1].charAt(0).toUpperCase()):3===n.length?(t+=n[0].charAt(0).toUpperCase(),t+=n[2].charAt(0).toUpperCase()):0!==n.length&&(t+=n[0].charAt(0).toUpperCase()),t)):""},c.fetchWithTimeout=function(e,i,a){return void 0===a&&(a=3e3),new Promise(function(t,n){var r=!1,o=setTimeout(function(){r=!0,n(new Error("Request timed out"))},a)
fetch(e,i).then(function(e){clearTimeout(o),r||t(e)}).catch(function(e){clearTimeout(o),r||n(e)})})},c.onDocumentReady=function(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)},c.firstOrDefault=function(e,t){return e&&0<e.length?e[0]:t},c.replaceFirstMatchingItem=function(e,t,n){var r=e.map(function(e,t){return[t,e]}).filter(function(e){return t(e[1])})
return 0!==r.length&&(e[r[0][0]]=n),e},c.dateReviver=function(e,t){if("string"==typeof t&&/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/.exec(t)){var n=new Date(t)
return isNaN(n.getTime())?t:n}return t},c.getHashValue=function(e){var t=0
if(0===e.length)return t
for(var n=0;n<e.length;n++)t=109*t+e.charCodeAt(n),t|=0
return Math.abs(t)/2147483648},c.assertUnreachableError=function(e,t){var n=Object.keys(t).filter(function(e){return isNaN(Number(e))})
throw new Error("Unexpected key: "+e+"; Please ensure all elements in {"+n+"} are specified in the switch-case and no extra element.")},c.NO_ERROR_NAME_OR_MESSAGE_PROVIDED="NO_ERROR_NAME_OR_MESSAGE_PROVIDED",c.officejsHasBeenInitialized=!1,c.isInMockMode=!1,c.isMockingSingleCards=!1,c)
function c(){}d.default=l}).call(this,p(454).Buffer)},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=t.FeatureArea=t.VivaInsightsUrls=t.DashboardUrls=t.AriaTokens=t.ApplicationInsightsIds=void 0
var r=function(){this.DEBUG="f4a09487-3294-417b-a634-22339736d55c",this.DEV="f4a09487-3294-417b-a634-22339736d55c",this.PPE="636bb1a2-b2a7-4120-9c4d-a12340a2354d",this.PROD="94fea24e-b912-4211-92ab-dcb69099256c"}
t.ApplicationInsightsIds=r
var o=function(){this.DEV="acfdd61dd00540b9a08edfa7c45a3984-a4128603-b4fd-4253-9c8a-5bd4913fec6d-7438",this.PPE="1b04ec8e1b4046a7b8d7a56836c424b6-affc257f-518d-4d5b-8677-42baee0b30b3-7696",this.PROD="b2bdaadcfc484ea3bbdf62c9835e3b33-32986ed2-a606-4425-b4bb-539adb1aa65f-7703"}
t.AriaTokens=o
var i=function(){this.HOME_PAGE="https://myanalytics.microsoft.com/?s=agave",this.FOCUS=this.HOME_PAGE+"&v=focus",this.IMPORTANT_PEOPLE=this.HOME_PAGE+"&v=network&w=importantpeople"}
t.DashboardUrls=i
var a=function(){this.HOME_PAGE_PROD="https://insights.viva.office.com/?s=agave"}
t.VivaInsightsUrls=a
var s=function(){this.DIGEST_EMAIL={featureName:"MyAnalytics Digest Email",surveyId:"90bdb7cc-fd60-4c67-bcd0-b9d641ea5d85"},this.ADD_IN={featureName:"MyAnalytics Outlook Add-in",surveyId:"3cc10864-1677-4808-beeb-31e4c302e629"}}
t.FeatureArea=s
var u=(Object.defineProperty(l,"PrivacyLink",{get:function(){return"https://go.microsoft.com/fwlink/?linkid=870408"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"WorkingHoursChangeLink",{get:function(){return"https://outlook.office.com/calendar/options/calendar/view/appearance"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"FocusTimeLearnMoreLink",{get:function(){return"https://docs.microsoft.com/en-us/workplace-analytics/myanalytics/use/dashboard#focus-hours​"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"AfterHoursLearnMoreLink",{get:function(){return"https://docs.microsoft.com/en-us/workplace-analytics/myanalytics/use/dashboard#after-hours​"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"HowReadStatsWorksLink",{get:function(){return"https://go.microsoft.com/fwlink/?linkid=2113323"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"ManageRulesLink",{get:function(){return"https://go.microsoft.com/fwlink/?linkid=2116531"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"EWSWeblinkBase",{get:function(){return"https://outlook.office365.com/owa/?"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"TeamsChatLink",{get:function(){return"https://teams.microsoft.com/l/chat/0/0?lm=deeplink&lmsrc=myainsights&cmpid=groupchatfrommya&users="},enumerable:!1,configurable:!0}),Object.defineProperty(l,"TeamsExploreLink",{get:function(){return"https://teams.microsoft.com/l/home/_#/?lm=deeplink&lmsrc=myainsights&cmpid=explorefrommya"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"WeeklyCalendarLink",{get:function(){return"https://outlook.office.com/calendar/view/week"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"UnreadFromVIPFolderName",{get:function(){return"MyAnalytics-UnreadFromVIPFolder"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"UnreadFromDirectReportFolderName",{get:function(){return"MyAnalytics-DirectReportsUnreadMailFolder"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"UnreadFromIRankerFolderName",{get:function(){return"MyAnalytics-UnreadFromIRankerFolder"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"RequestsFolderName",{get:function(){return"MyAnalytics-RequestsFolder"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"NRTDataLatencyInSeconds",{get:function(){return 1800},enumerable:!1,configurable:!0}),Object.defineProperty(l,"LowActivityThreshold",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(l,"HighActivityThreshold",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(l,"EWSTypesNamespace",{get:function(){return"http://schemas.microsoft.com/exchange/services/2006/types"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"EWSMessagesNamespace",{get:function(){return"http://schemas.microsoft.com/exchange/services/2006/messages"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"EWSErrorsNamespace",{get:function(){return"http://schemas.microsoft.com/exchange/services/2006/errors"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"EWSGetUserConfigWorkingHoursNS",{get:function(){return"WorkingHours.xsd"},enumerable:!1,configurable:!0}),Object.defineProperty(l,"FontFamilyFallbacks",{get:function(){return"-apple-system,Segoe UI,HelveticaNeue-Bold,Helvetica Neue Bold,Helvetica Neue,Helvetica,Arial"},enumerable:!1,configurable:!0}),l.epochTicksDiff=621355968e9,l.ticksPerMillisecond=1e4,l.oneSecondInMilliseconds=1e3,l.fiveMinutesInMilliSeconds=5*(l.oneMinuteInMilliSeconds=(l.oneMinuteInSeconds=60)*l.oneSecondInMilliseconds),l.fifteenMinutesInMilliSeconds=15*l.oneMinuteInMilliSeconds,l.halfHourInMilliSeconds=(l.halfHourInMinutes=30)*l.oneMinuteInMilliSeconds,l.halfHourInHours=.5,l.threeQuarterHourInHours=.75,l.oneHourInHours=1,l.twoHoursInMilliSeconds=2*(l.oneHourInMilliSeconds=(l.oneHourInSeconds=(l.oneHourInMinutes=60)*l.oneMinuteInSeconds)*l.oneSecondInMilliseconds),l.oneDayInHalfHours=(l.oneDayInHours=24)/l.halfHourInHours,l.oneDayInMinutes=l.oneDayInHours*l.oneHourInMinutes,l.oneDayInSeconds=l.oneDayInHours*l.oneHourInSeconds,l.oneDayInMilliSeconds=l.oneDayInHours*l.oneHourInMilliSeconds,l.oneDay=l.oneDayInHours*l.oneHourInMilliSeconds,l.oneWeekInDays=7,l.oneWeek=7*l.oneDay,l.fourteenDaysInSeconds=14*l.oneDayInSeconds,l.fourteenDays=14*l.oneDay,l.oneMonthInDays=30,l.oneMonth=30*l.oneDay,l.oneQuarterYear=91*l.oneDay,l.oneYear=365*l.oneDay,l.defaultLocation="en-us",l.actionQueueFastPollingInterval=6*l.oneSecondInMilliseconds,l.appInsightsIds=new r,l.ariaTokens=new o,l.dashboardUrls=new i,l.vivaInsightsUrls=new a,l.trackEmailHeaderKey="x-MyAnalyticsIsEmailTracked",l.featureArea=new s,l.emailContextTimeSpanThreshold=l.oneMinuteInSeconds/2,l.base10Radix=10,l.greyBackground="#666666",l.blackBackground="#262626",l.whiteBackground="#FFFFFF",l)
function l(){}t.Constants=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(54)),i=r.__importDefault(n(6)),a=n(13),s=r.__importDefault(n(25)),u=r.__importDefault(n(62)),l=(Object.defineProperty(c,"areDevelopersEnabled",{get:function(){return u.default.isFlightEnabled(u.default.DEVELOPER)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areFeedInsightsEnabled",{get:function(){return!s.default.isInBackgroundMode},enumerable:!1,configurable:!0}),Object.defineProperty(c,"canUseDeveloperTools",{get:function(){return(s.default.isLocalDebugging||s.default.IsDev||c.areDevelopersEnabled)&&c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isCleanupDataEnabled",{get:function(){return s.default.IsAdvancedExperience},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingSuggestionEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areFollowUpRequestTasksEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.FOLLOWUP_REQUEST_TASKS_INSIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isPinUserEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isSuggestedTimeForTasksEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.SUGGESTED_TIME_FOR_TASKS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areSentMailStatisticsEnabled",{get:function(){return c.areFeedInsightsEnabled&&(u.default.isFlightEnabled(u.default.ENABLE_READ_STATS_FOR_E1_E3)||s.default.IsAdvancedExperience)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isDashboardEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isOutcomeEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isFollowUpsTaskSuggestionMigrationEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.FOLLOWUP_TASK_SUGGESTION_MIGRATION_ENABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isSentMailStatsInfoTextEnabled",{get:function(){return u.default.isFlightEnabled(u.default.SENT_MAIL_STATS_INFO_TEXT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isServerSideDismissEnabled",{get:function(){return u.default.isFlightEnabled(u.default.SERVER_SIDE_DISMISS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isRecurrenceApiEnabled",{get:function(){return u.default.isFlightEnabled(u.default.RECURRENCE_API)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isToDoTaskPromotionEnabled",{get:function(){return u.default.isFlightEnabled(u.default.TASK_INSIGHT_TASK_PROMOTION)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isFollowUpTaskPromotionEnabled",{get:function(){return c.isFollowUpsTaskSuggestionMigrationEnabled&&u.default.isFlightEnabled(u.default.TASK_INSIGHT_TASK_PROMOTION)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTaskInsightsWithRankingScoreEnabled",{get:function(){return u.default.isFlightEnabled(u.default.TASK_INSIGHTS_WITH_RANKING_SCORE)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTeamsFocusPlanEnabled",{get:function(){return u.default.isFlightEnabled(u.default.TEAMS_FOCUS_PLAN)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isFocusReminderSettingEnabled",{get:function(){return c.isTeamsFocusPlanEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areInfobarComputesEnabled",{get:function(){return o.default.doesSupportNotificationMessage&&(s.default.IsAdvancedExperience||s.default.HasBackgroundAddinCapability)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"shouldRenderInfobars",{get:function(){return!!i.default.isInMockMode||c.areInfobarComputesEnabled&&(c.isBackgroundAddinEnabled||c.isInfobarUpdatableFromVertical)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isBackgroundAddinEnabled",{get:function(){return s.default.isInBackgroundMode},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areActionableMessagesEnabled",{get:function(){return o.default.doesSupportActionableMessage},enumerable:!1,configurable:!0}),c.isClientSideNudge=function(e){switch(e){case a.InsightName.ScheduledDelayDeliveryInfobar:case a.InsightName.ShortenMeeting:return!0
default:return!1}},Object.defineProperty(c,"areInfobarComputesEnabledForAdvanced",{get:function(){return o.default.doesSupportNotificationMessage&&s.default.IsAdvancedExperience},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isShortenMeetingInfobarEnabled",{get:function(){return!!c.areDevelopersEnabled||c.areInfobarComputesEnabledForAdvanced},enumerable:!1,configurable:!0}),Object.defineProperty(c,"hasDelayDeliveryPrerequisites",{get:function(){return o.default.doesSupportDelayDelivery&&o.default.doesSupportNotificationMessage},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isDelayDeliveryActionableMessageEnabled",{get:function(){return c.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isDetectOOFComposingInfobarEnabled",{get:function(){return!!c.areDevelopersEnabled||o.default.doesSupportNotificationMessage&&(s.default.IsAdvancedExperience||s.default.IsBasicExperience&&u.default.isFlightEnabled(u.default.EXPAND_OOF_NUDGE_TO_E1_E3))},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMultilingualOOFComposingInfobarEnabled",{get:function(){return!!c.areDevelopersEnabled||o.default.doesSupportNotificationMessage&&(s.default.IsAdvancedExperience||s.default.IsBasicExperience&&u.default.isFlightEnabled(u.default.EXPAND_OOF_NUDGE_TO_E1_E3))&&u.default.isFlightEnabled(u.default.MULTILINGUAL_OOF_INFOBAR)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isPeopleCatchUpItemsInfobarEnabled",{get:function(){return!!c.areDevelopersEnabled||c.areInfobarComputesEnabledForAdvanced&&u.default.isFlightEnabled(u.default.COMPOSE_PEOPLE_CATCH_UP_ITEMS_INFOBAR)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTrackEmailInfoBarEnabled",{get:function(){return c.areInfobarComputesEnabledForAdvanced},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isToDosActionableMessageEnabled",{get:function(){return c.areFeedInsightsEnabled&&c.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingPreparationCardEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingPreparationAgendaEnabled",{get:function(){return u.default.isFlightEnabled(u.default.MEETING_PREPARATION_CARD_AGENDA)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingPreparationOutOfRoutineEnabled",{get:function(){return u.default.isFlightEnabled(u.default.OUT_OF_ROUTINE_CARD)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingPreparationDocumentStatsEnabled",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isManagerEffectivenessEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.MANAGER_EFFECTIVENESS_EXPERIENCE_FLIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isBookOneOnOneEnabled",{get:function(){return c.isManagerEffectivenessEnabled&&o.default.doesSupportNewMessageForm},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isSmartRulesSuggestionEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.SMART_RULES_SUGGESTION_INSIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isDocumentsToCatchupEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isReadStatsPrematureTimeFifteenMinutes",{get:function(){return u.default.isFlightEnabled(u.default.READ_STATS_PREMATURE_TIME_FIFTEEN_MINUTES)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"hideReadStatsForCalendarItems",{get:function(){return c.areSentMailStatisticsEnabled&&u.default.isFlightEnabled(u.default.HIDE_READ_STATS_FOR_CALENDAR_ITEMS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isMeetingPreparationInfobarEnabled",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTeamsGroupSuggestionInsightEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.TEAMS_GROUP_SUGGESTION_INSIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isIRankerInOneEngineEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.CATCH_UP_UNREAD_IRANKER_FLIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isIRankerInAgaveEnabled",{get:function(){return c.areFeedInsightsEnabled&&!u.default.isFlightEnabled(u.default.CATCH_UP_UNREAD_IRANKER_FLIGHT)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTimeAwayPreparationEnabled",{get:function(){return c.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isImportantPeopleFollowUpsEnabled",{get:function(){return u.default.isFlightEnabled(u.default.IMPORTANT_PEOPLE_FOLLOW_UPS_NUDGE)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isTaskInsightEnabled",{get:function(){return c.areFeedInsightsEnabled&&u.default.isFlightEnabled(u.default.TASK_INSIGHT_IN_AGAVE)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isEstimateToRecipientsEnabled",{get:function(){return c.hasDelayDeliveryPrerequisites&&u.default.isFlightEnabled(u.default.ESTIMATE_TO_RECIPIENTS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"areMeetingInfobarsEnabledForEditMode",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isExtendedSentMailStatsEnabled",{get:function(){return u.default.isFlightEnabled(u.default.EXTENDED_SENT_MAIL_STATS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isStampCalendarEventClassificationsEnabled",{get:function(){return u.default.isFlightEnabled(u.default.STAMP_CALENDAR_EVENT_CLASSIFICATIONS)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isNoResponseRequestedEnabled",{get:function(){return u.default.isFlightEnabled(u.default.MEETING_PREP_NO_RESPONSE_REQUESTED)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isInfobarUpdatableFromVertical",{get:function(){return u.default.isFlightEnabled(u.default.REFRESH_INFOBAR_FROM_VERTICAL)&&c.doesSupportSessionData},enumerable:!1,configurable:!0}),Object.defineProperty(c,"doesSupportSessionData",{get:function(){var e,t
return o.default.doesSupportSessionData&&i.default.isMailboxReady&&!(null===(t=null===(e=Office.context.mailbox)||void 0===e?void 0:e.item)||void 0===t||!t.sessionData)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isNewDwellBucketSchemeEnabled",{get:function(){return this.isExtendedSentMailStatsEnabled&&u.default.isFlightEnabled(u.default.EXTENDED_SENT_MAIL_STATS_ENABLE_NEW_BUCKET_SCHEME)},enumerable:!1,configurable:!0}),Object.defineProperty(c,"isFallbackToConversationId",{get:function(){return u.default.isFlightEnabled(u.default.FALLBACK_TO_CONVERSATION_ID)},enumerable:!1,configurable:!0}),c)
function c(){}t.default=l},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.Dispatcher=void 0
var r,o=n(0),i=o.__importStar(n(453)),a=o.__importDefault(n(3)),s=o.__importDefault(n(4)),u=o.__importDefault(n(25)),l=(r=i.Dispatcher,o.__extends(c,r),c.prototype.dispatch=function(t){try{var e=o.__assign(o.__assign({},t),{timeDispatched:Date.now()})
r.prototype.dispatch.call(this,e)}catch(e){if(this.logDebuggingDetails(t,e),u.default.isLocalDebugging)throw e}},c.prototype.dispatchAsync=function(e,t){var n=this
void 0===t&&(t=1),setTimeout(function(){n.dispatch(e)},t)},c.prototype.logDebuggingDetails=function(e,t){var n="Error in dispatching "+a.default[e.actionType]+" \n"+JSON.stringify(t)+" \n",r=this.getPendingPayload()
r&&(n+="Another Action["+a.default[r.actionType]+"] was dispatched at "+r.timeDispatched+"\n\n                Pending callbacks: "+this.getPendingCallbacks()),s.default.logAssert(n,"Dispatcher","dispatch")},c.prototype.getPendingPayload=function(){return r.prototype.isDispatching.call(this)?this._pendingPayload:null},c.prototype.getPendingCallbacks=function(){var t=this
return Object.keys(this._callbacks).filter(function(e){return t._isPending[e]&&!t._isHandled[e]})},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.Dispatcher=l,t.default=new l},,function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeInsightNames=t.InsightName=void 0,(o=r=t.InsightName||(t.InsightName={})).FocusTimeBusyThisWeek="FocusTimeBusyThisWeek",o.FocusTimeBusyNextWeek="FocusTimeBusyNextWeek",o.FocusTimeNotBusyThisWeek="FocusTimeNotBusyThisWeek",o.FocusTimeNotBusyNextWeek="FocusTimeNotBusyNextWeek",o.PeopleFirstRun="PeopleFirstRun",o.PeopleAdd="PeopleAdd",o.PeopleFirstRunRollup="PeopleFirstRunRollup",o.PeopleRollup="PeopleRollup",o.ImportantUnreadMail="ImportantUnreadMail",o.ImportantUnreadMailRollup="ImportantUnreadMailRollup",o.MeetingSuggestion="MeetingSuggestion",o.MeetingSuggestionRollup="MeetingSuggestionRollup",o.SentMailStats="SentMailStats",o.SentMailStatsInContext="SentMailStatsInContext",o.SentMailStatsRollup="SentMailStatsRollup",o.DashboardTeaser="DashboardTeaser",o.UpcomingMeeting="UpcomingMeeting",o.ToDos="ToDos",o.ToDosRollup="ToDosRollup",o.MeetingOverload="MeetingOverload",o.AfterHoursMeetingAttendeeActionableMessage="AfterHoursMeetingAttendeeActionableMessage",o.AutoDelayDeliveryInfobar="AutoDelayDeliveryInfobar",o.SuggestedDelayDeliveryInfobar="SuggestedDelayDeliveryInfobar",o.ScheduledDelayDeliveryInfobar="ScheduledDelayDeliveryInfobar",o.PostDelayDeliveryActionableMessage="PostDelayDeliveryActionableMessage",o.AutoDelayDeliveryAdvertisement="AutoDelayDeliveryAdvertisement",o.DelayDeliveryAdvertFeed="DelayDeliveryAdvertFeed",o.MeetingPreparationCard="MeetingPreparationCard",o.MeetingPreparationInfobar="MeetingPreparationInfobar",o.MeetingPreparationCardRollup="MeetingPreparationCardRollup",o.MeetingRelatedDocuments="MeetingRelatedDocuments",o.SmartRulesSuggestion="SmartRulesSuggestion",o.SmartRulesSuggestionRollup="SmartRulesSuggestionRollup",o.SuggestedTasksActionableMessage="SuggestedTasksActionableMessage",o.BookFocusTimeActionableMessage="BookFocusTimeActionableMessage",o.FocusTimeConflictActionableMessage="FocusTimeConflictActionableMessage",o.DetectOOFComposingInfobar="DetectOOFComposingInfobar",o.MeetingOverloadActionableMessage="MeetingOverloadActionableMessage",o.ShortenMeetingActionableMessage="ShortenMeetingActionableMessage",o.SentMailStatsInContextActionableMessage="SentMailStatsInContextActionableMessage",o.ShortenMeeting="ShortenMeeting",o.TrackEmail="TrackEmail",o.PeopleCatchUpItems="PeopleCatchUpItems",o.LegacyInsightType="LegacyInsightType",o.ProtectedTimeBookingHeader="ProtectedTimeBookingHeader",o.Tasks="Tasks",o.TasksRollup="TasksRollup",o.FollowUpRequestTasks="FollowUpRequestTasks",o.FollowUpRequestTasksRollup="FollowUpRequestTasksRollup",o.CatchUpImportantMail="CatchUpImportantMail",o.CatchUpImportantMailRollup="CatchUpImportantMailRollup",o.FocusTime="FocusTime",o.SentMailRollup="SentMailRollup",o.DocumentsToCatchup="DocumentsToCatchup",o.DocumentsToCatchupRollup="DocumentsToCatchupRollup",o.SuggestedFreeBlocks="SuggestedFreeBlocks",o.FocusOutcome="FocusOutcome",o.DaysToBook="DaysToBook",o.DirectReportBookOneOnOne="DirectReportBookOneOnOne",o.DirectReportConflictingOneOnOne="DirectReportConflictingOneOnOne",o.LunchSettingsAdvert="LunchSettingsAdvert",o.DirectReportTasksRollup="DirectReportTasksRollup",o.DirectReportUnreadMail="DirectReportUnreadMail",o.DirectReportUnreadMailAndDocsPerPerson="DirectReportUnreadMailAndDocsPerPerson",o.DirectReportCatchupRollup="DirectReportCatchupRollup",o.TeamCatchupRollup="TeamCatchupRollup",o.TeamsGroupSuggestion="TeamsGroupSuggestion",o.TeamsGroupSuggestionRollup="TeamsGroupSuggestionRollup",o.TimeAway="TimeAway",o.TimeAwayRollup="TimeAwayRollup"
var i=(a.focusTimeInsightNames=function(){return[r.FocusTimeBusyThisWeek,r.FocusTimeNotBusyThisWeek,r.FocusTimeBusyNextWeek,r.FocusTimeNotBusyNextWeek]},a)
function a(){}t.FocusTimeInsightNames=i},,function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.WellKnownDataSources=void 0,(r=t.WellKnownDataSources||(t.WellKnownDataSources={}))[r.ActionLog=0]="ActionLog",r[r.CurrentItem=1]="CurrentItem",r[r.DelayDelivery=2]="DelayDelivery",r[r.PreRollupInsights=3]="PreRollupInsights",r[r.CalendarData=4]="CalendarData",r[r.PeopleSuggestions=5]="PeopleSuggestions",r[r.ImportantPeople=6]="ImportantPeople",r[r.UnreadMails=7]="UnreadMails",r[r.CatchUpImportantMails=8]="CatchUpImportantMails",r[r.SentMailStatisticsInContext=9]="SentMailStatisticsInContext",r[r.SentMailStats=10]="SentMailStats",r[r.FirstRun=11]="FirstRun",r[r.ExtractedEntities=12]="ExtractedEntities",r[r.TrackEmail=13]="TrackEmail",r[r.Loading=14]="Loading",r[r.Navigation=15]="Navigation",r[r.ActionableMessage=16]="ActionableMessage",r[r.Infobar=17]="Infobar",r[r.SearchContextInsights=18]="SearchContextInsights",r[r.FilteredOutInsights=19]="FilteredOutInsights",r[r.Avatar=20]="Avatar",r[r.UserSettings=21]="UserSettings",r[r.LunchTimeSettings=22]="LunchTimeSettings",r[r.FindRelevantInsights=23]="FindRelevantInsights",r[r.ActionableMessageInsights=24]="ActionableMessageInsights",r[r.InfobarInsights=25]="InfobarInsights",r[r.FeedInsights=26]="FeedInsights",r[r.InContextInsights=27]="InContextInsights",r[r.BroadcastInsights=28]="BroadcastInsights",r[r.AdaptiveInsights=29]="AdaptiveInsights",r[r.ProtectedTime=30]="ProtectedTime",r[r.MeetingPreparationInsights=31]="MeetingPreparationInsights",r[r.MeetingRelatedDocumentsInsights=32]="MeetingRelatedDocumentsInsights",r[r.TasksInsight=33]="TasksInsight",r[r.FollowUpInsights=34]="FollowUpInsights",r[r.Outcome=35]="Outcome",r[r.DocumentsToCatchupInsights=36]="DocumentsToCatchupInsights",r[r.DaysToBookInsights=37]="DaysToBookInsights",r[r.DirectReports=38]="DirectReports",r[r.DirectReportBookOneOnOneInsights=39]="DirectReportBookOneOnOneInsights",r[r.DirectReportConflictingOneOnOneInsights=40]="DirectReportConflictingOneOnOneInsights",r[r.UserSearch=41]="UserSearch",r[r.TimeAway=42]="TimeAway",r[r.SmartRulesSuggestionInsights=43]="SmartRulesSuggestionInsights",r[r.MailFolders=44]="MailFolders",r[r.TeamsGroupSuggestionInsight=45]="TeamsGroupSuggestionInsight",r[r.NetworkContacts=46]="NetworkContacts",r[r.WorkingHourConfigs=47]="WorkingHourConfigs",r[r.DirectReportsOneOnOneFreeSlots=48]="DirectReportsOneOnOneFreeSlots",r[r.FocusTimeSettings=49]="FocusTimeSettings"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MethodToLogTypeConverter=t.HTTPRequestMethod=void 0
var r,o,i=n(4);(o=r=t.HTTPRequestMethod||(t.HTTPRequestMethod={})).GET="GET",o.POST="POST",o.PATCH="PATCH",o.DELETE="DELETE",o.PUT="PUT"
var a=(s.getLogType=function(e){switch(e){case r.GET:return i.LogEventType.Get
case r.POST:case r.PATCH:case r.DELETE:case r.PUT:return i.LogEventType.Set
default:throw new Error("No mapping from HttpRequestMethod type "+e+" to log type")}},s)
function s(){}t.MethodToLogTypeConverter=a},,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LocaleTimeFormat=t.LocaleDateFormat=void 0
var r=n(0),a=r.__importDefault(n(2)),s=r.__importDefault(n(24)),u=r.__importDefault(n(6)),l=r.__importDefault(n(4)),o=n(7),c=(i.numericMonthAndDay={month:"numeric",day:"numeric"},i.shortMonthTwoDigitDay={month:"short",day:"2-digit"},i.shortWeekday={weekday:"short"},i.longWeekday={weekday:"long"},i.shortMonthWithYearDateFormat=r.__assign(r.__assign({},i.shortMonthTwoDigitDay),{year:"numeric"}),i)
function i(){}t.LocaleDateFormat=c
var d=(p.hourTwoDigitMinute={hour:"numeric",minute:"2-digit"},p.twoDigitHour24TwoDigitMinute={hour12:!1,hour:"2-digit",minute:"2-digit"},p)
function p(){}t.LocaleTimeFormat=d
var f=(g.toHourAndMinuteString=function(e){return g.toLocaleStringFixed(e,d.hourTwoDigitMinute)},g.getLocalizedDay=function(e,t,n){var r,o
return void 0===t&&(t=c.longWeekday),void 0===n&&(n=!1),o=n?(r=a.default.TODAY_CAPITAL(),a.default.TOMORROW_CAPITAL()):(r=a.default.TODAY(),a.default.TOMORROW()),s.default.isToday(e)?r:s.default.isTomorrow(e)?o:g.toLocaleStringFixed(e,t)},g.getLocalizedDaysAgo=function(e){if(s.default.isToday(e))return a.default.TODAY_CAPITAL()
var t=s.default.startOfDay(e),n=s.default.startOfDay(new Date),r=Math.round((n.getTime()-t.getTime())/o.Constants.oneDay)
return r<0?"":a.default.DAYS_AGO_CAPITAL(r,r)},g.getLocalizedDateRange=function(e,t){var n=(new Date).getFullYear()===e.getFullYear()&&e.getFullYear()===t.getFullYear()?c.shortMonthTwoDigitDay:c.shortMonthWithYearDateFormat,r=s.default.isSameDay(e,t),o=g.toLocaleStringFixed(e,n),i=g.toLocaleStringFixed(t,n)
return r?o:a.default.TIME_RANGE(o,i)},g.toLocaleStringFixed=function(e,t,n){void 0===n&&(n=u.default.LCID),n=n.toLowerCase(),t.hour12=void 0!==t.hour12?t.hour12:0===n.indexOf("en-us"),u.default.isIE&&0===n.indexOf("zh-")&&"short"===t.month&&(t.month="numeric"),t.weekday&&g.shouldHideWeekday(n)&&(t.weekday=void 0)
var r,o,i,a,s=g.toLocaleString(e,n,t)
return!u.default.isIE||"numeric"!==t.month&&"2-digit"!==t.month||"numeric"!==t.day&&"2-digit"!==t.day||(s=s.replace(/[\u200e\u200f]/g,""),r=e.getMonth()+1,o=e.getDate(),i=g.brokenNumericMonthDayString(n,r,o,t),a=g.fixedNumericMonthDayString(n,r,o,t),s=s.replace(i,a)),s},g.shouldHideWeekday=function(t){return u.default.isChrome&&["eu-","gl-","kk-","nn-"].some(function(e){return 0===t.indexOf(e)})},g.toLocaleString=function(e,t,n){var r=!!(n.year||n.month||n.day||n.weekday),o=!!(n.hour||n.minute||n.second||n.hour12)
if(r&&o)return e.toLocaleString(t,n)
if(r)return e.toLocaleDateString(t,n)
if(o)return e.toLocaleTimeString(t,n)
var i=Object.keys(n).map(function(e){return e+"-"+n[e]})
return l.default.logAssert("unexpected date options: "+i.join(", "),g.featureName,"toLocaleStringFixed"),""},g.brokenNumericMonthDayString=function(t,e,n,r){var o=String(e),i=g.unitNumberTo2Digit(n,t,["et-","he-","hi-","id-","ms-","vi-"],r.day)
return 0===t.indexOf("eu-")?o+"ren "+i+"a":"en-us"===t?o+" "+i:0===t.indexOf("hu-")?o+" "+i+".":0===t.indexOf("ja-")||0===t.indexOf("zh-")?o+"月"+i+"日":0===t.indexOf("ko-")?o+"월 "+i+"일":0===t.indexOf("lt-")?o+" "+i+" d.":0===t.indexOf("sv-")?"den "+i+" "+o:["cs-","da-","de-","et-","fi-","hr-","lv-","nb-","nn-","sk-","sl-","sr-"].some(function(e){return 0===t.indexOf(e)})?i+". "+o:["es-","gl-","pt-"].some(function(e){return 0===t.indexOf(e)})?i+" de "+o:i+" "+o},g.fixedNumericMonthDayString=function(t,e,n,r){var o=g.unitNumberTo2Digit(e,t,["bg-","en-gb","fr-","hr-","kk-","lt-","lv-","nn-","pt-pt","ro-","ru-","uk-"],r.month),i=g.unitNumberTo2Digit(n,t,["en-gb","fr-","hr-","kk-","lv-","nn-","pt-pt","ro-","ru-","uk-","vi-"],r.day)
return 0===t.indexOf("lt-")?o+"-"+i:0===t.indexOf("ms-")||0===t.indexOf("nl-")?i+"-"+o:0===t.indexOf("hu-")||0===t.indexOf("ko-")?o+"."+i+".":["bg-","et-","he-","kk-","pl-","ro-","ru-","uk-"].some(function(e){return 0===t.indexOf(e)})?i+"."+o:["cs-","de-","fi-","hr-","lv-","nb-","nn-","sk-","sl-","sr-"].some(function(e){return 0===t.indexOf(e)})?i+"."+o+".":["eu-","en-us","ja-","zh-"].some(function(e){return 0===t.indexOf(e)})?o+"/"+i:i+"/"+o},g.unitNumberTo2Digit=function(e,t,n,r){return"numeric"!==r&&"2-digit"!==r?(l.default.logAssert("Expected 'numeric' or '2-digit' option",g.featureName,"unitTo2Digit"),null):n.some(function(e){return 0===t.indexOf(e)})&&("2-digit"===r||e<10)?"0"+e:String(e)},g.featureName="DateLocalizer",g)
function g(){}t.default=f},,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DateFormat=void 0
var r,o,i=n(0),a=i.__importDefault(n(792)),s=i.__importDefault(n(4)),l=n(7);(o=r=t.DateFormat||(t.DateFormat={})).Default="YYYY-MM-DDTHH:mm:ss",o.DateOnly="YYYY-MM-DD"
var u=(c.toString=function(e,t){return void 0===t&&(t=r.Default),a.default(e).format(t)},c.toISOString=function(e){return e?e.toISOString():null},c.wrapString=function(e){return e?new Date(e):null},c.convertToDayOfWeek=function(e){switch(e.toLocaleLowerCase()){case"sunday":case"sun":return 0
case"monday":case"mon":return 1
case"tuesday":case"tue":return 2
case"wednesday":case"wed":return 3
case"thursday":case"thu":return 4
case"friday":case"fri":return 5
case"saturday":case"sat":return 6
default:return void s.default.logAssert("Unexpected weekday: "+e,this.featureName,"dayStrToNum")}},c.getTimeSpanStringFromMilliSeconds=function(e){var t=Math.floor(e/l.Constants.oneSecondInMilliseconds),n=t%l.Constants.oneMinuteInSeconds,r=Math.floor(t/l.Constants.oneMinuteInSeconds),o=r%l.Constants.oneHourInMinutes,i=Math.floor(r/l.Constants.oneHourInMinutes),a=i%l.Constants.oneDayInHours
return Math.floor(i/l.Constants.oneDayInHours)+"."+a+":"+o+":"+n},c.getDaysOfWeek=function(e,t){for(var n=[],r=e;r.getTime()<=t.getTime();)n.push(r.getDay()),r=c.addDays(r,1)
return n},c.getWeeksBetweenDates=function(e,t){var n=[]
e=c.startOfDay(e),t=c.startOfDay(t)
for(var r,o=e;o.getTime()<=t.getTime();)(r=c.addDays(o,6-o.getDay())).getTime()>t.getTime()&&(r=t),n.push(c.getDaysOfWeek(o,r)),o=c.addDays(r,1)
return n},c.getTotalDays=function(e,t){return a.default(t).diff(e,"d")+1},c.tomorrow=function(e){return a.default(e).add(1,"d").startOf("d").toDate()},c.yesterday=function(e){return a.default(e).subtract(1,"d").startOf("d").toDate()},c.startOfDay=function(e){return a.default(e).startOf("d").toDate()},c.startOfHour=function(e){return a.default(e).startOf("h").toDate()},c.endOfDay=function(e){return a.default(e).endOf("d").toDate()},c.addDays=function(e,t){return a.default(e).add(t,"d").toDate()},c.addHours=function(e,t){return a.default(e).add(t,"h").toDate()},c.addMinutes=function(e,t){return a.default(e).add(t,"m").toDate()},c.startOfNextWeek=function(e){return c.startOfDay(new Date(e.getTime()+(7-e.getDay())*l.Constants.oneDay))},c.getEndOfNextWeek=function(e){var t=c.startOfNextWeek(e)
return new Date(t.getTime()+7*l.Constants.oneDay)},c.getStartOfNWeeksAhead=function(e,t){var n=c.startOfCurrentWeek(e)
return c.addDays(n,7*t)},c.startOfCurrentWeek=function(e){return c.startOfDay(new Date(e.getTime()-e.getDay()*l.Constants.oneDay))},c.setTimeOnDate=function(e,t){var n=new Date(e.getTime()),r=t.trim().split(":")
return n.setHours(+r[0]),n.setMinutes(+r[1]),n.setSeconds(+r[2]),n},c.isSameDay=function(e,t){return a.default(e).isSame(t,"day")},c.isToday=function(e){return c.isSameDay(e,new Date)},c.isWithinCurrentWeek=function(e){var t=new Date,n=c.startOfCurrentWeek(t),r=c.startOfNextWeek(t)
return e.getTime()<r.getTime()&&e.getTime()>=n.getTime()},c.isTomorrow=function(e){var t=new Date
return c.isSameDay(e,a.default(t).add(1,"day").toDate())},c.parseDaylightTimeTransitionDate=function(e,t,n,r,o){if(0===e)return null
for(var i=c.convertToDayOfWeek(n),a=new Date((new Date).getFullYear(),e-1,1,1);a.getDay()!==i;)a=new Date(a.getTime()+l.Constants.oneDay)
var s=new Date(a.getTime()+(t-1)*l.Constants.oneWeekInDays*l.Constants.oneDay),u=(s=c.setTimeOnDate(s,r)).getTime()+o*l.Constants.oneMinuteInMilliSeconds-s.getTimezoneOffset()*l.Constants.oneMinuteInMilliSeconds
return new Date(u)},c.getCurrentTimeZoneOffsetInMinute=function(){return(new Date).getTimezoneOffset()},c.parseTimeZone=function(e){return e?parseInt(e,10):c.getCurrentTimeZoneOffsetInMinute()},c.generatePriorDate=function(e){return a.default().subtract(e,"day").toDate()},c.getTimeZoneWithDaylightTime=function(e,t,n){return t+(c.isDaylightTime(e,n)?n.biasInMinute:0)},c.isDaylightTime=function(e,t){if(!t)return!1
var n=new Date(e.getTime())
return n.setFullYear(t.daylightTimeStart.getFullYear()),t.daylightTimeStart<t.daylightTimeEnd?n>=t.daylightTimeStart&&n<=t.daylightTimeEnd:n>=t.daylightTimeStart||n<=t.daylightTimeEnd},c.getMinutesSinceStartOfDay=function(e){return(e.getTime()-c.startOfDay(e).getTime())/l.Constants.oneMinuteInMilliSeconds},c.setMinutesSinceStartOfDay=function(e,t){return a.default(e).startOf("d").add(t,"m").toDate()},c.toDate=function(e){return a.default().startOf("d").add(e,"m").toDate()},c.featureName="DateUtils",c)
function c(){}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=n(113),a=r.__importDefault(n(347)),s=(Object.defineProperty(u,"IsProd",{get:function(){return u.Environment===i.Environment.Prod},enumerable:!1,configurable:!0}),Object.defineProperty(u,"IsPPE",{get:function(){return u.Environment===i.Environment.PPE},enumerable:!1,configurable:!0}),Object.defineProperty(u,"IsDev",{get:function(){return u.Environment===i.Environment.Dev},enumerable:!1,configurable:!0}),Object.defineProperty(u,"isLocalDebugging",{get:function(){return u.Environment===i.Environment.Debug},enumerable:!1,configurable:!0}),Object.defineProperty(u,"AppInsightsId",{get:function(){switch(u.Environment){case i.Environment.Debug:return o.Constants.appInsightsIds.DEBUG
case i.Environment.Dev:return o.Constants.appInsightsIds.DEV
case i.Environment.PPE:return o.Constants.appInsightsIds.PPE
case i.Environment.Prod:case i.Environment.Unknown:return o.Constants.appInsightsIds.PROD
default:a.default.assertUnreachableError(u.Environment,i.Environment)}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"AriaToken",{get:function(){switch(u.Environment){case i.Environment.Debug:case i.Environment.Dev:return o.Constants.ariaTokens.DEV
case i.Environment.PPE:return o.Constants.ariaTokens.PPE
case i.Environment.Prod:case i.Environment.Unknown:return o.Constants.ariaTokens.PROD
default:a.default.assertUnreachableError(u.Environment,i.Environment)}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"Environment",{get:function(){return u.Config.environment},enumerable:!1,configurable:!0}),Object.defineProperty(u,"Layout",{get:function(){return u.Config.layout},enumerable:!1,configurable:!0}),Object.defineProperty(u,"BuildName",{get:function(){return u.Config.buildName},enumerable:!1,configurable:!0}),Object.defineProperty(u,"isInAutoRunJSMode",{get:function(){return u.Layout===i.Layout.AutoRunJS},enumerable:!1,configurable:!0}),Object.defineProperty(u,"isInBackgroundMode",{get:function(){return u.Layout===i.Layout.Background||u.Layout===i.Layout.AutoRunJS},enumerable:!1,configurable:!0}),Object.defineProperty(u,"IsAdvancedExperience",{get:function(){return u.ExperienceType===i.ExperienceType.Advanced},enumerable:!1,configurable:!0}),Object.defineProperty(u,"IsBasicExperience",{get:function(){return u.ExperienceType===i.ExperienceType.Basic},enumerable:!1,configurable:!0}),Object.defineProperty(u,"stopReloadInBackgroundMode",{get:function(){return u.Config.stopReloadInBackgroundMode},enumerable:!1,configurable:!0}),Object.defineProperty(u,"HasBackgroundAddinCapability",{get:function(){return u.Config.infobarEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(u,"ExperienceType",{get:function(){return u.Config.experienceType},enumerable:!1,configurable:!0}),Object.defineProperty(u,"OCVUrl",{get:function(){return u.Environment===i.Environment.Debug?"https://petrol-int.office.microsoft.com/v1/feedback":"https://petrol.office.microsoft.com/v1/feedback"},enumerable:!1,configurable:!0}),Object.defineProperty(u,"Config",{get:function(){return u._config||(u._config=a.default.createConfigurationContent()),u._config},enumerable:!1,configurable:!0}),u)
function u(){}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveInsightsDispatcher=t.InfobarInsightsDispatcher=t.ActionableMessageInsightsDispatcher=t.InContextInsightsDispatcher=t.BroadcastInsightsDispatcher=t.FeedInsightsDispatcher=t.FilteredOutInsightsDispatcher=t.InsightDomains=void 0
var r=n(0),o=r.__importDefault(n(3)),i=n(960),a=function(){this.Feed=new d,this.InContext=new y,this.ActionableMessage=new T,this.Infobar=new E,this.FilteredOut=new u,this.Adaptive=new D,this.Broadcast=new g}
t.InsightDomains=a
var s,u=(s=i.InsightDispatcher,r.__extends(l,s),l)
function l(){return s.call(this,o.default.FilteredOutInsights,o.default.HasNoFilteredOutInsights)||this}t.FilteredOutInsightsDispatcher=u
var c,d=(c=i.InsightDispatcher,r.__extends(p,c),p)
function p(){return c.call(this,o.default.PreRollupInsights,o.default.NoApplicableInsights)||this}t.FeedInsightsDispatcher=d
var f,g=(f=i.InsightDispatcher,r.__extends(m,f),m)
function m(){return f.call(this,o.default.BroradcastInsights,o.default.NoBroadcastInsights)||this}t.BroadcastInsightsDispatcher=g
var h,y=(h=i.InsightDispatcher,r.__extends(_,h),_)
function _(){return h.call(this,o.default.InContextInsights,o.default.NoInContextInsights)||this}t.InContextInsightsDispatcher=y
var S,T=(S=i.InsightDispatcher,r.__extends(I,S),I)
function I(){return S.call(this,o.default.ActionableMessageInsights,o.default.NoActionableMessageInsights)||this}t.ActionableMessageInsightsDispatcher=T
var b,E=(b=i.InsightDispatcher,r.__extends(v,b),v)
function v(){return b.call(this,o.default.InfobarInsights,o.default.NoInfobarInsights)||this}t.InfobarInsightsDispatcher=E
var A,D=(A=i.InsightDispatcher,r.__extends(O,A),O)
function O(){return A.call(this,o.default.AdaptiveInsights,o.default.NoAdaptiveInsights)||this}t.AdaptiveInsightsDispatcher=D,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RoutingDirector=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=n(107),s=(u.prototype.goBack=function(){i.default.dispatchAsync({actionType:o.default.NavigateBack})},u.prototype.goToInsightContainer=function(e){this.goToDetailsContainer({insightName:e.insightName,identifier:e.instanceData.identifier})},u.prototype.goToDetailsContainer=function(e){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.Details,context:e}})},u.prototype.goToSettingsContainer=function(){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.Settings}})},u.prototype.goToFeedbackContainer=function(e){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.Feedback,digestContext:e}})},u.prototype.goToNudgeFeedbackContainer=function(e){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.NudgeFeedback,context:e}})},u.prototype.goToCleanupPage=function(){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.CleanUp}})},u.prototype.goToMockPage=function(){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.Mock}})},u.prototype.goToInsightTransitionLeavePage=function(){i.default.dispatchAsync({actionType:o.default.NavigateTo,route:{routeName:a.Routes.InsightTransitionLeavePage}})},u.prototype.goToFeed=function(){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.Feed}})},u.prototype.goToOutcomeEnrollment=function(e){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.OutcomeEnrollment,outcomeContext:{outcomeName:e}}})},u.prototype.goToFocusPlanEnrollmentConfirmation=function(e,t){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.FocusPlanEnrollmentConfirmation,outcomeContext:{outcomeName:e,isEnrollmentSuccessful:t}}})},u.prototype.goToEditTeamContainer=function(){i.default.dispatch({actionType:o.default.NavigateTo,route:{routeName:a.Routes.EditTeam}})},u)
function u(){}t.RoutingDirector=s,t.default=new s},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.sortByStartTime=t.WorkingHours=t.CalendarTypeUtils=t.RecurrenceRangeType=t.RecurrencePatternType=t.BusyType=t.FocusConflict=t.BookFocusTimeActionableMessageTypes=t.ProtectedTimeErrorTypes=t.CalendarItemType=t.ResponseType=t.Sensitivity=t.DayInWeek=t.BusyStatus=void 0
var r,o,i,a,s,u,l,c,d,p,f,g,m,h,y,_,S,T,I=n(0),b=I.__importStar(n(24));(o=r=t.BusyStatus||(t.BusyStatus={}))[o.Free=0]="Free",o[o.Tentative=1]="Tentative",o[o.Busy=2]="Busy",o[o.Oof=3]="Oof",o[o.WorkingElsewhere=4]="WorkingElsewhere",o[o.NoData=5]="NoData",(a=i=t.DayInWeek||(t.DayInWeek={}))[a.Sunday=0]="Sunday",a[a.Monday=1]="Monday",a[a.Tuesday=2]="Tuesday",a[a.Wednesday=3]="Wednesday",a[a.Thursday=4]="Thursday",a[a.Friday=5]="Friday",a[a.Saturday=6]="Saturday",(u=s=t.Sensitivity||(t.Sensitivity={}))[u.Normal=0]="Normal",u[u.Personal=1]="Personal",u[u.Private=2]="Private",u[u.Confidential=3]="Confidential",(c=l=t.ResponseType||(t.ResponseType={}))[c.None=0]="None",c[c.Organizer=1]="Organizer",c[c.TentativelyAccepted=2]="TentativelyAccepted",c[c.Accepted=3]="Accepted",c[c.Declined=4]="Declined",c[c.NotResponded=5]="NotResponded",(p=d=t.CalendarItemType||(t.CalendarItemType={}))[p.FocusTime=0]="FocusTime",p[p.Meeting=1]="Meeting",p[p.Appointment=2]="Appointment",p[p.LunchTime=3]="LunchTime",p[p.OOFTime=4]="OOFTime",(f=t.ProtectedTimeErrorTypes||(t.ProtectedTimeErrorTypes={}))[f.None=0]="None",f[f.NoTimeZoneAndWorkingHours=1]="NoTimeZoneAndWorkingHours",f[f.OptInFail=2]="OptInFail",f[f.PartialBooked=3]="PartialBooked",f[f.NoneBooked=4]="NoneBooked",f[f.LoadTimeExceeded=5]="LoadTimeExceeded",f[f.Other=6]="Other",f[f.EnrollOutcomeFail=7]="EnrollOutcomeFail",(g=t.BookFocusTimeActionableMessageTypes||(t.BookFocusTimeActionableMessageTypes={}))[g.BusyDay=0]="BusyDay",g[g.ThisWeekBusy=1]="ThisWeekBusy",g[g.NextWeekBusy=2]="NextWeekBusy",g[g.NotFreeThisWeek=3]="NotFreeThisWeek",(m=t.FocusConflict||(t.FocusConflict={}))[m.MoveMeeting=0]="MoveMeeting",m[m.MoveFocusBlock=1]="MoveFocusBlock",(h=t.BusyType||(t.BusyType={}))[h.Busy=0]="Busy",h[h.NotBusy=1]="NotBusy",(_=y=t.RecurrencePatternType||(t.RecurrencePatternType={}))[_.Daily=0]="Daily",_[_.Weekly=1]="Weekly",_[_.AbsoluteMonthly=2]="AbsoluteMonthly",_[_.RelativeMonthly=3]="RelativeMonthly",_[_.AbsoluteYearly=4]="AbsoluteYearly",_[_.RelativeYearly=5]="RelativeYearly",(T=S=t.RecurrenceRangeType||(t.RecurrenceRangeType={}))[T.EndDate=0]="EndDate",T[T.NoEnd=1]="NoEnd",T[T.Numbered=2]="Numbered"
var E=(v.strToBusyStatus=function(e){switch(e.toLowerCase()){case"free":return r.Free
case"tentative":return r.Tentative
case"busy":return r.Busy
case"oof":return r.Oof
case"workingelsewhere":return r.WorkingElsewhere
case"nodata":default:return r.NoData}},v.numberToBusyStatus=function(e){switch(e){case 0:return r.Free
case 1:return r.Tentative
case 2:return r.Busy
case 3:return r.Oof
case 4:default:return r.NoData}},v.strToSensitivity=function(e){switch(e){case"Confidential":return s.Confidential
case"Private":return s.Private
case"Personal":return s.Personal
case"Normal":default:return s.Normal}},v.strToResponseType=function(e){switch(e){case"Organizer":return l.Organizer
case"TentativelyAccepted":case"Tentative":return l.TentativelyAccepted
case"Accepted":return l.Accepted
case"Declined":return l.Declined
case"NotResponded":return l.NotResponded
case"None":default:return l.None}},v.responseTypeToAttendeeStatus=function(e){switch(e){case l.TentativelyAccepted:return"Tentative"
case l.NotResponded:case l.None:return"No Response"
default:return l[e]}},v.isFocusTime=function(e){return e.calendarItemType===d.FocusTime},v.recurrencePatternTypeToString=function(e){return y[e]},v.recurrenceRangeTypeToString=function(e){return S[e]},v.recurrencePatternStringToType=function(e){switch(e){case"Daily":return y.Daily
case"Weekly":return y.Weekly
case"AbsoluteMonthly":return y.AbsoluteMonthly
case"RelativeMonthly":return y.RelativeMonthly
case"AbsoluteYearly":return y.AbsoluteYearly
case"RelativeYearly":return y.RelativeYearly
default:throw new Error("Unknown recurrence pattern type")}},v.recurrenceRangeStringToType=function(e){switch(e){case"EndDate":return S.EndDate
case"NoEnd":return S.NoEnd
case"Numbered":return S.Numbered
default:throw new Error("Unknown recurrence range type")}},v.recurrenceToJson=function(e){var t=e.pattern,n=e.range
return{Pattern:{Type:v.recurrencePatternTypeToString(t.patternType),Interval:t.interval,Month:t.month,DayOfMonth:t.dayOfMonth,DaysOfWeek:t.daysOfWeek,FirstDayOfWeek:t.firstDayOfWeek,Index:t.index},Range:{Type:v.recurrenceRangeTypeToString(n.rangeType),StartDate:b.default.toString(n.startDate,b.DateFormat.DateOnly),EndDate:n.endDate?b.default.toString(n.endDate,b.DateFormat.DateOnly):null,RecurrenceTimeZone:n.recurrenceTimeZone,NumberOfOccurrences:n.numberOfOccurrences}}},v.bookedAndFreeBlocksToEditedCalendarItems=function(e,t){return I.__spreadArrays(e.bookedBlocks.map(function(e){return I.__assign(I.__assign({},e),{isBooked:!0})}),e.freeBlocks.map(function(e){return I.__assign(I.__assign({},e),{subject:t,isBooked:!1})}))},v)
function v(){}t.CalendarTypeUtils=E
var A=(D.workingDaysAsString=function(n){return n.map(function(e,t){return i[t]}).filter(function(e,t){return 1===n[t]})},D.DEFAULT_WORKDAY_SCHEDULE=[0,1,1,1,1,1,0],D.DEFAULT_WORKHOUR_START=9,D.DEFAULT_WORKHOUR_END=17,D)
function D(){}t.WorkingHours=A,t.sortByStartTime=function(e,t){return e.startDate.getTime()-t.startDate.getTime()}},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.OneStageInsightComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(173)),a=o.__importDefault(n(958)),s=o.__importDefault(n(305)),u=o.__importDefault(n(959)),l=o.__importDefault(n(4)),c=(r=u.default,o.__extends(d,r),d.prototype.registerStoreObservers=function(){this.oneStageListener||(this.oneStageListener=new s.default(this.onStateChange.bind(this),this.onBeforeCalculateState.bind(this),this.storesToObserve.concat([i.default])))},d.prototype.disposeStoreObservers=function(){this.oneStageListener.dispose(),this.oneStageListener=null},d.prototype.safeCompute=function(e){try{return this.computeInsightInstances(e)}catch(e){return l.default.logAssert("Caught "+e.name+": "+e.message,this.insightName(),"Compute"),[]}},d.prototype.onBeforeCalculateState=function(e){var t=this.calculateState(e)
return this.actionLogFilter.extendStateWithActionLog(e,t)},d.prototype.onStateChange=function(e){var t=this.safeCompute(e),n=this.actionLogFilter.filterInstancesAgainstActionLog(t,e),r=t.filter(function(t){return!n.some(function(e){return e.identifier===t.identifier})}),o=this.getDataSources(this.storesToObserve)
this.filteredOutDomain.dispatchInsights(this.insightName(),this.wrapInstancesAsInsights(r,o)),this.insightDomain.dispatchInsights(this.insightName(),this.wrapInstancesAsInsights(n,o))},d)
function d(e){var t=r.call(this)||this
return(t.actionLogFilter=e)||(t.actionLogFilter=new a.default(t.insightName())),t}t.OneStageInsightComputeBase=c,t.default=c},,,function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.RequestPriority=void 0,(r=t.RequestPriority||(t.RequestPriority={}))[r.High=0]="High",r[r.Normal=1]="Normal",r[r.Low=2]="Low"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var d=n(0),p=d.__importStar(n(34)),o=d.__importDefault(n(808)),i=d.__importDefault(n(4)),u=d.__importDefault(n(199)),a=d.__importDefault(n(375)),l=d.__importDefault(n(497)),c=d.__importDefault(n(57)),f=d.__importDefault(n(6)),s=d.__importDefault(n(811)),g=n(16),r=d.__importDefault(n(25)),m=d.__importDefault(n(812)),h=d.__importDefault(n(814)),y=(_.convertToRestId=function(e){return e?e.replace(new RegExp("[/]","g"),"-").replace(new RegExp("[+]","g"),"_"):e},_.convertToEwsId=function(e){return e?e.replace(new RegExp("[-]","g"),"/").replace(new RegExp("[_]","g"),"+"):e},_.executeRequest=function(n,r){return void 0===r&&(r=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,a.default.executePromiseWithRetry(n,this.executeRequestPromise,r)]
case 1:return[2,e.sent()]
case 2:return t=e.sent(),i.default.logUnhandledPromiseRejection(t,_.LOG_FEATURE_NAME,"executeRequest"),[2,{status:Office.AsyncResultStatus.Failed,result:null,error:t,sourceRequest:n}]
case 3:return[2]}})})},_.executeBatchRequests=function(r,o){var i
return void 0===o&&(o=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return null===(i=c.default.RESTCallbackToken)||void 0===i?[3,1]:(n=i,[3,3])
case 1:return[4,l.default.RESTTokenString()]
case 2:n=e.sent(),e.label=3
case 3:return(t=n)?[2,_.internalExecuteBatchRequests(r,"Bearer "+t,_.buildBatchRequest,o)]:[2,r.map(function(e){return _.noTokenResult(e,"TokenService.getRESTCallbackToken")})]}})})},_.executeRequestWithPaging=function(r,o){return void 0===o&&(o=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),r.requiresCount()||(r=r.requiresCount(!0)),[4,this.getPromiseResultWithPaging(r,o)]
case 1:return(t=e.sent()).status!==Office.AsyncResultStatus.Succeeded&&r.logCreator().unexpectedFail(t.error),[2,t]
case 2:return n=e.sent(),i.default.logUnhandledPromiseRejection(n,_.LOG_FEATURE_NAME,"executeRequestWithPaging"),[2,{status:Office.AsyncResultStatus.Failed,result:null,error:n,sourceRequest:r}]
case 3:return[2]}})})},_.executeWESBatchRequests=function(o,i){var a
return void 0===i&&(i=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return null===(a=c.default.RESTCallbackToken)||void 0===a?[3,1]:(n=a,[3,3])
case 1:return[4,l.default.RESTTokenString()]
case 2:n=e.sent(),e.label=3
case 3:return r=function(e){return new s.default(_.LOG_FEATURE_NAME).requests(e)},(t=n)?[2,_.internalExecuteBatchRequests(o,"Bearer "+t,r,i)]:[2,o.map(function(e){return _.noTokenResult(e,"TokenService.getRESTCallbackToken")})]}})})},_.executeWESRequest=function(n,r){return void 0===r&&(r=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,a.default.executePromiseWithRetry(n,this.executeRequestPromise,r)]
case 1:return[2,e.sent()]
case 2:return t=e.sent(),i.default.logUnhandledPromiseRejection(t,_.LOG_FEATURE_NAME,"executeRequest"),[2,{status:Office.AsyncResultStatus.Failed,result:null,error:t,sourceRequest:n}]
case 3:return[2]}})})},_.processODataResultWithSafeCallback=function(t,e){var n={isSuccess:!1,result:null,error:null}
try{return n.result=e(t),n.isSuccess=!0,n}catch(e){n.isSuccess=!1
var r=e.message||""
return t.sourceRequest.logCreator().unexpectedFail("[JSON Parsing Error] "+r),n.error=r,n}},_.getPromiseResultWithPaging=function(o,i){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.executePromiseWithRetry(o,this.executeRequestPromise,i)]
case 1:return(t=e.sent()).status!==Office.AsyncResultStatus.Succeeded?(t.error="Paged request fails with raw error "+JSON.stringify(t.error),[2,t]):(n=t.result["@odata.count"],[4,Promise.all(this.getRequestsForSubsequentPages(o,n,i))])
case 2:return r=e.sent(),[2,this.concatPromiseResults(t,r)]}})})},_.getRequestsForSubsequentPages=function(e,t,n){for(var r=[],o=e.top(),i=o;i<t;i+=o)e=e.skip(i),r.push(a.default.executePromiseWithRetry(e,this.executeRequestPromise,n))
return r},_.concatPromiseResults=function(e,t){return t.reduce(function(e,t){return t.status!==Office.AsyncResultStatus.Succeeded?(e.status=Office.AsyncResultStatus.Failed,e.error="Fail to retrieve one or more pages."):e.result.value=e.result.value.concat(t.result.value),e},e)},_.buildBatchRequest=function(e){var t=new o.default(_.LOG_FEATURE_NAME),n=t.requestId(),r=e.map(function(e){var t=e.requestId(n)
return t.logCreator().updateRequestId(t.requestId()),t})
return t.requests(r)},_.internalExecuteBatchRequests=function(s,u,l,c){return void 0===c&&(c=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return d.__generator(this,function(e){switch(e.label){case 0:for(t=[],n=0;n<s.length;n+=_.MAX_BATCH_SIZE)r=s.slice(n,n+_.MAX_BATCH_SIZE),o=l(r),t.push(_.executeBatchRequestsWithoutPaging(o,u,c))
return[4,Promise.all(t)]
case 1:return i=e.sent(),a=[],i.forEach(function(e){a=a.concat(e)}),[2,Promise.resolve(a)]}})})},_.executeBatchRequestsWithoutPaging=function(o,i,a){return void 0===a&&(a=p.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:if(o.requests().length>_.MAX_BATCH_SIZE)throw new Error("over-length parameter batchRequests")
if(0===o.requests().length)throw new Error("No request entity in batchRequests")
return t={requestUri:o.requestUrl,method:o.method(),headers:d.__assign({Authorization:i,Prefer:"odata.continue-on-error","X-CorrelationId":o.requestId()},o.headers()),data:{__batchRequests:_.constructBatchRequests(o.requests())}},n=function(){return m.default.generateRequestPromise(o,t)},[4,u.default.execute(n,a)]
case 1:return r=e.sent(),[2,this.parseBatchResult(r,o)]}})})},_.parseBatchResult=function(t,e){if(t.status!==Office.AsyncResultStatus.Succeeded)return e.logCreator().unexpectedFail(t.error),e.requests().map(function(e){return{error:t.error,status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:e,responseStatusCode:t.responseStatusCode}})
for(var n=t.result.__batchResponses,r=[],o=0,i=0;i<n.length;i++){var a,s,u=n[i],l=Number(u.statusCode)
200<=l&&l<300?(o+=1,s={error:"",status:Office.AsyncResultStatus.Succeeded,result:u.data,sourceRequest:e.requests()[i],responseStatusCode:l},e.requests()[i].logCreator().success()):(s={error:(a=n[i]).response.body,status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:e.requests()[i],responseStatusCode:a.response.statusCode},e.requests()[i].logCreator().unexpectedFail(s.error)),r.push(s)}var c=n.length-o
return e.logCreator().batchCompleted(o,c),r},_.constructBatchRequests=function(e){var n=[]
return e.forEach(function(e){var t={requestUri:e.requestUrl,method:e.method(),headers:e.headers()}
_.needPostData(e.method())&&(t.data=e.postData()),n.push(t)}),n},_.noTokenResult=function(e,t){var n="Received null token from "+t
return e.logCreator().expectedFail(n),{status:Office.AsyncResultStatus.Failed,result:null,error:n,sourceRequest:e}},_.generateRequestInit=function(e,t){var n=d.__assign({Authorization:t,"Content-Type":"application/json;charset=utf-8","X-CorrelationId":c.default.sessionGuid},e.headers())
e.shouldIncludeMetadata()&&(n.Accept="application/json;odata.metadata=minimal")
var r={method:g.HTTPRequestMethod[e.method()],headers:n}
return _.needPostData(e.method())&&(r.body=JSON.stringify(e.postData())),r},_.needPostData=function(e){return e===g.HTTPRequestMethod.PATCH||e===g.HTTPRequestMethod.POST||e===g.HTTPRequestMethod.PUT},_.logWarningIfUserEmailIsNotMatchedToken=function(e,t){if((r.default.IsPPE||r.default.IsDev||r.default.isLocalDebugging)&&t)try{f.default.parseJWTToken(t).smtp.toLowerCase()!==e&&i.default.logWarning("Token claimed smtp is different from office.js provided userprofile smtp",_.LOG_FEATURE_NAME,"logWarningIfUserEmailIsNotMatchedToken")}catch(e){}},_.MAX_BATCH_SIZE=20,_.LOG_FEATURE_NAME="ODataService",_.executeRequestPromise=function(a,s){return void 0===s&&(s=p.RequestPriority.Normal),d.__awaiter(void 0,void 0,void 0,function(){var t,n,r,o,i
return d.__generator(this,function(e){switch(e.label){case 0:return null===(i=c.default.RESTCallbackToken)||void 0===i?[3,1]:(n=i,[3,3])
case 1:return[4,l.default.RESTTokenString()]
case 2:n=e.sent(),e.label=3
case 3:return(t=n)?(_.logWarningIfUserEmailIsNotMatchedToken(f.default.userEmailLowerCase,t),r=_.generateRequestInit(a,"Bearer "+t),o=function(){return h.default.generateRequestPromise(a,a.requestUrl,r,t)},[2,u.default.execute(o,s)]):[2,_.noTokenResult(a,"TokenService.getRESTCallbackToken")]}})})},_)
function _(){}t.default=y},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentItemStore=t.CurrentItemStoreState=void 0
var r,o=n(0),i=o.__importStar(n(144)),a=o.__importStar(n(15)),s=o.__importStar(n(115)),u=o.__importDefault(n(3)),l=o.__importDefault(n(743)),c=o.__importStar(n(83)),d=o.__importDefault(n(4)),p=o.__importDefault(n(6)),f=n(5),g=(r=c.DataStreamStoreStateBase,o.__extends(m,r),Object.defineProperty(m.prototype,"itemCreator",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"internetMessageId",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isAppointmentOrMeeting",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isMessage",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isCompose",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isReading",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isContextless",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isItemInSentItemsFolder",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"doesSenderApproximatelyMatchCurrentUser",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"currentItem",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"requiredAttendees",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"optionalAttendees",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"estimatedToRecipients",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"toRecipientsInUserType",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"toRecipients",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"ccRecipients",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"bccRecipients",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"messageComposeType",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"meetingStartTime",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"meetingEndTime",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"recurrence",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isInConversation",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"hasExternalRecipients",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isNewComposeMeeting",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"attachments",{get:function(){return f.doop()},enumerable:!1,configurable:!0}),o.__decorate([f.doop],m.prototype,"itemCreator",null),o.__decorate([f.doop],m.prototype,"internetMessageId",null),o.__decorate([f.doop],m.prototype,"isAppointmentOrMeeting",null),o.__decorate([f.doop],m.prototype,"isMessage",null),o.__decorate([f.doop],m.prototype,"isCompose",null),o.__decorate([f.doop],m.prototype,"isReading",null),o.__decorate([f.doop],m.prototype,"isContextless",null),o.__decorate([f.doop],m.prototype,"isItemInSentItemsFolder",null),o.__decorate([f.doop],m.prototype,"doesSenderApproximatelyMatchCurrentUser",null),o.__decorate([f.doop],m.prototype,"currentItem",null),o.__decorate([f.doop],m.prototype,"requiredAttendees",null),o.__decorate([f.doop],m.prototype,"optionalAttendees",null),o.__decorate([f.doop],m.prototype,"estimatedToRecipients",null),o.__decorate([f.doop],m.prototype,"toRecipientsInUserType",null),o.__decorate([f.doop],m.prototype,"toRecipients",null),o.__decorate([f.doop],m.prototype,"ccRecipients",null),o.__decorate([f.doop],m.prototype,"bccRecipients",null),o.__decorate([f.doop],m.prototype,"messageComposeType",null),o.__decorate([f.doop],m.prototype,"meetingStartTime",null),o.__decorate([f.doop],m.prototype,"meetingEndTime",null),o.__decorate([f.doop],m.prototype,"recurrence",null),o.__decorate([f.doop],m.prototype,"isInConversation",null),o.__decorate([f.doop],m.prototype,"hasExternalRecipients",null),o.__decorate([f.doop],m.prototype,"isNewComposeMeeting",null),o.__decorate([f.doop],m.prototype,"attachments",null),m=o.__decorate([f.doop],m))
function m(){var e=r.call(this)||this
return e.requiredAttendees([]),e.optionalAttendees([]),e.meetingStartTime(null),e.meetingEndTime(null),e.estimatedToRecipients([]),e.toRecipientsInUserType([]),e.toRecipients([]),e.ccRecipients([]),e.bccRecipients([]),e.isInConversation(null),e.isNewComposeMeeting(!0),e.attachments([]),e.hasExternalRecipients(!1),e}t.CurrentItemStoreState=g
var h,y=(h=c.default,o.__extends(_,h),_.prototype.currentItemId=function(){if(this.getState().currentItem())return this.getState().currentItem().itemId},_.prototype.asReadItem=function(){if(this.getState().currentItem()&&this.getState().isReading())return this.getState().currentItem().asReadItem()},_.prototype.asComposeItem=function(){if(this.getState().currentItem()&&this.getState().isCompose())return this.getState().currentItem().asComposeItem()},_.prototype.asComposeMessage=function(){if(this.getState().currentItem()&&this.getState().isMessage()&&this.getState().isCompose())return this.getState().currentItem().asComposeMessage()},_.prototype.asComposeAppointment=function(){if(this.getState().currentItem()&&this.getState().isAppointmentOrMeeting()&&this.getState().isCompose())return this.getState().currentItem().asComposeAppointment()},_.prototype.isMeetingRequestOrResponse=function(){return this.getState().currentItem()&&this.getState().currentItem().isMeetingRequestOrResponse},_.prototype.getInitialState=function(){return new g},_.prototype.getStoreLoggingName=function(){return"CurrentItemStore"},Object.defineProperty(_.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.CurrentItem},enumerable:!1,configurable:!0}),_.prototype.setStateForItemChangedEvent=function(e,t){return this.updateStateFromCurrentItem(e)},_.prototype.processGetInternetMessageIdAction=function(e,t){return this.updateStateFromCurrentItem(e).internetMessageId(t.internetMessageId)},_.prototype.processOfficeJSReady=function(e,t){return this.updateStateFromCurrentItem(e)},_.prototype.updateStateFromCurrentItem=function(e){if(!p.default.isCurrentItemAvailable)return d.default.setItemContext(i.ItemTypes.Contextless,i.Modes.Read),d.default.setIsItemInSentItemsFolder(!1),this.getInitialState().isContextless(!0)
var t=new l.default(Office.context.mailbox.item)
return d.default.setItemContext(t.itemType,t.mode),d.default.setIsItemInSentItemsFolder(t.doesSenderApproximatelyMatchCurrentUser),e.currentItem(t).doesSenderApproximatelyMatchCurrentUser(t.doesSenderApproximatelyMatchCurrentUser).isAppointmentOrMeeting(t.itemType===i.ItemTypes.Meeting).isCompose(t.isComposing).isMessage(t.itemType===i.ItemTypes.Message).itemCreator(t.getItemCreator()).isReading(t.isReading).isContextless(!1)},_.prototype.processGetComposeMeetingRequiredRecipients=function(e,t){return e.requiredAttendees(t.composingRecipients)},_.prototype.processGetComposeMeetingOptionalRecipients=function(e,t){return e.optionalAttendees(t.composingRecipients)},_.prototype.processGetComposeMeetingAttendees=function(e,t){return e.requiredAttendees(t.requiredAttendees).optionalAttendees(t.optionalAttendees)},_.prototype.processGetComposeMeetingRecurrence=function(e,t){return e.recurrence(t.recurrence)},_.prototype.processGetComposeMeetingTime=function(e,t){return e.meetingStartTime(t.meetingStartTime).meetingEndTime(t.meetingEndTime)},_.prototype.processGetComposeMessageType=function(e,t){return e.messageComposeType(t.composeType)},_.prototype.processGetComposeMessageToRecipients=function(e,t){var n=t.composingRecipients
return e.toRecipients(n).toRecipientsInUserType(n.filter(function(e){return e.recipientType===s.IRecipientType.User}))},_.prototype.processGetComposeMessageCcRecipients=function(e,t){return e.ccRecipients(t.composingRecipients)},_.prototype.processGetComposeMessageBccRecipients=function(e,t){return e.bccRecipients(t.composingRecipients)},_.prototype.processUpdateEmailProperties=function(e,t){return e.estimatedToRecipients(t.estimatedToRecipients).isInConversation(t.isInConversation).hasExternalRecipients(t.hasExternalRecipients)},_.prototype.processGetIsNewComposeMeeting=function(e,t){return e.isNewComposeMeeting(t.isNewComposeMeeting)},_.prototype.processIsItemInSentItemsFolder=function(e,t){return d.default.setIsItemInSentItemsFolder(t.isInSentItemsFolder),e.isItemInSentItemsFolder(t.isInSentItemsFolder)},_.prototype.processGetComposeItemAttachments=function(e,t){return e.attachments(t.attachments)},_)
function _(){var e=h.call(this)||this
return e.addActionCallback(u.default.GetInternetMessageId,e.processGetInternetMessageIdAction),e.addActionCallback(u.default.OfficeJSReady,e.processOfficeJSReady),e.addActionCallback(u.default.GetComposeMeetingRequiredRecipients,e.processGetComposeMeetingRequiredRecipients),e.addActionCallback(u.default.GetComposeMeetingOptionalRecipients,e.processGetComposeMeetingOptionalRecipients),e.addActionCallback(u.default.GetComposeMeetingRequiredAndOptionalRecipients,e.processGetComposeMeetingAttendees),e.addActionCallback(u.default.GetComposeMeetingTime,e.processGetComposeMeetingTime),e.addActionCallback(u.default.GetComposeMeetingRecurrence,e.processGetComposeMeetingRecurrence),e.addActionCallback(u.default.GetComposeMessageToRecipients,e.processGetComposeMessageToRecipients),e.addActionCallback(u.default.GetComposeMessageCcRecipients,e.processGetComposeMessageCcRecipients),e.addActionCallback(u.default.GetComposeMessageBccRecipients,e.processGetComposeMessageBccRecipients),e.addActionCallback(u.default.GetComposeMessageType,e.processGetComposeMessageType),e.addActionCallback(u.default.UpdateEmailProperties,e.processUpdateEmailProperties),e.addActionCallback(u.default.GetIsNewComposeMeeting,e.processGetIsNewComposeMeeting),e.addActionCallback(u.default.IsItemInSentItemsFolder,e.processIsItemInSentItemsFolder),e.addActionCallback(u.default.GetComposeItemAttachments,e.processGetComposeItemAttachments),e}t.CurrentItemStore=y,t.default=new y},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WESRequestBase=void 0
var a,r=n(0),o=n(5),i=n(63),s=r.__importDefault(n(378)),u=r.__importDefault(n(200)),l=(a=i.RESTRequestBase,r.__extends(c,a),Object.defineProperty(c.prototype,"version",{get:function(){return"v1.0"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"requestTimeInTicks",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),r.__decorate([o.doop],c.prototype,"requestTimeInTicks",null),c=r.__decorate([o.doop],c))
function c(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.headers(s.default.getInitialWESHeaders(i.headers())),i.baseUrl(u.default.wesBaseUrl),i.requestTimeInTicks((new Date).getTime()),i}t.WESRequestBase=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=(o.throwIfUndefinedOrNull=function(e,t){if(null==t)throw new Error("Argument ["+e+"] is null or undefined.")},o.throwIfUndefinedOrEmptyString=function(e,t){if(o.throwIfUndefinedOrNull(e,t),0===t.trim().length)throw new Error("Argument ["+e+"] is empty or whitespace.")},o.throwIfUndefinedOrInvalidDate=function(e,t){if(o.throwIfUndefinedOrNull(e,t),"string"==typeof t&&(t=new Date(t)),isNaN(t.getTime()))throw new Error("Argument ["+e+"] is an invalid date.")},o.throwIfNotExactlyOneElement=function(e,t){if(o.throwIfUndefinedOrNull(e,t),1!==t.length)throw new Error("Argument ["+e+"] has not exactly one element, but "+t.length+".")},o.throwIfNullOrEmptyArray=function(e,t){if(o.throwIfUndefinedOrNull(e,t),0===t.length)throw new Error("Argument ["+e+"] has zero element.")},o.throwIfUnknownEnumValue=function(e,t,n){if(o.throwIfUndefinedOrNull(e,t),n[t]!==t)throw new Error("Argument ["+e+'] is an unknown enum value "'+t+'"')},o)
function o(){}t.default=r},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CachedDataStreamStoreBase=t.CachedDataStreamStateBase=void 0
var r,o=n(0),i=n(3),a=o.__importDefault(n(25)),s=n(7),u=o.__importStar(n(114)),l=o.__importDefault(n(116)),c=o.__importDefault(n(6)),d=n(5),p=(r=u.LoadableDataStreamStateBase,o.__extends(f,r),f=o.__decorate([d.doop],f))
function f(){return null!==r&&r.apply(this,arguments)||this}t.CachedDataStreamStateBase=p
var g,m=(g=u.default,o.__extends(h,g),h.prototype.shouldLoadFromCache=function(){if(a.default.isInBackgroundMode&&!this.ENABLE_IN_BACKGROUND)return!1
var e=this.getState()
return!(e.hasCheckedInfobar()||e.hasCheckedCache())||c.default.isInMockMode},h.prototype.loadFromCache=function(){return l.default.tryLoadFromPersistedStorage(this.getStoreLoggingName())},h.prototype.saveToCache=function(e){l.default.trySaveToPersistedStorage(this.getStoreLoggingName(),this.saveStateToJSON(e),this.CACHE_LIFETIME)},h.prototype.saveStateToJSON=function(e){var t=e.toJSON()
return t.lastUpdatedTime=e.lastUpdatedTime(),t},h.prototype.onStateHasChanged=function(e,t,n){return t=g.prototype.onStateHasChanged.call(this,e,t,n),n.actionType!==i.Action.UpdateLoadedCache&&t.hasCheckedCache()&&this.saveToCache(t),t},h)
function h(){var e=null!==g&&g.apply(this,arguments)||this
return e.ENABLE_IN_BACKGROUND=!1,e.CACHE_LIFETIME=5*s.Constants.oneMinuteInSeconds,e}t.CachedDataStreamStoreBase=m,t.default=m},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a=n(0).__importDefault(n(4)),r=(c.isRtl=function(){return"rtl"===c.getLocalizationString("DIR_ATTRIBUTE").toLowerCase()},Object.defineProperty(c,"defaultStrings",{get:function(){return c._defaultStrings},set:function(e){c._defaultStrings=e},enumerable:!1,configurable:!0}),Object.defineProperty(c,"localizationStrings",{get:function(){return c._localizationStrings},set:function(e){c._localizationStrings=e},enumerable:!1,configurable:!0}),c.getLocalizationString=function(e){return c.localizationStrings&&c.localizationStrings[e]?c.localizationStrings[e]:c.defaultStrings&&c.defaultStrings[e]?c.defaultStrings[e]:""},c.getLocalizedStringWithArgs=function(e,t){var n=c.getLocalizationString(e)
return c.replace(n,t)},c.localizedCountString=function(e,t,n){var r=c.getLocalizationString(e),o=c.getLocalizationString(t)
if(!r||!o)return a.default.logWarning("Empty locText and/or intervals: locKey="+e+", intervalsKey="+t,"Localizer","localizedCountString"),""
var i=c.countString(r,o,n)
return i||a.default.logAssert("Empty result: "+e+", "+t+", "+n,"Localizer","localizedCountString"),i},c.getCountLocalizedStringWithArgs=function(e,t,n,r){var o=c.localizedCountString(e,t,n)
return c.replace(o,r)},c.countString=function(e,t,n){if(!e||!t||void 0===n)return""
var r=c.intervalIndexForNumber(t,n)
return c.locStringAtIndex(e,r)},c.intervalIndexForNumber=function(e,t){for(var n=-1,r=e.split("||"),o=0;o<r.length;o++){var i=r[o]
if(i){for(var a=i.split(","),s=0;s<a.length;s++){var u=a[s]
if(u)if(c.isStringNumber(u)){if(t===parseInt(u,10)){n=o
break}}else if(c.isStringNumberPattern(u)){var l=u.slice(1)
if(c.hasSuffix(t,l)){n=o
break}}else if(c.isNumberInRange(u,t)){n=o
break}}if(0<=n)break}}return n},c.replace=function(e,t){for(var n=0;n<t.length;n++)e=e.replace("{"+n+"}",String(t[n]))
return e},c.locStringAtIndex=function(e,t){var n,r=""
return e&&0<=t&&((n=e.split("||"))&&t>=n.length&&(t=n.length-1),n&&n[t]&&""!==n[t]&&(r=n[t])),r},c.isNumberInRange=function(e,t){var n,r=e.split("-")
if(!r||2!==r.length)return!1
if(""===r[0])n=0
else{if(!c.isStringNumber(r[0]))return!1
n=parseInt(r[0],10)}if(n<=t){if(""===r[1])return!0
if(!c.isStringNumber(r[1]))return!1
if(t<=parseInt(r[1],10))return!0}return!1},c.isStringNumber=function(e){return new RegExp("^\\d+$").test(e)},c.isStringNumberPattern=function(e){return new RegExp("^\\**\\d+$").test(e)},c.hasSuffix=function(e,t){var n=String(e)
if(n===t)return!0
var r=n.lastIndexOf(t)
return!(r<0)&&r===n.length-t.length&&c.isStringNumber(n.substring(0,r))},c._localizationStrings=null,c._defaultStrings=null,c)
function c(){}t.default=r},,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.expirable=t.ExpirableInBackground=t.RecurrenceTypes=t.ExpirationTypes=void 0
var o,r,s,i,a,u,l=n(0),c=l.__importDefault(n(64)),d=l.__importDefault(n(25)),p=l.__importDefault(n(6)),f=l.__importDefault(n(62)),g=n(7);(r=o=t.ExpirationTypes||(t.ExpirationTypes={}))[r.ByEvery_Minutes=0]="ByEvery_Minutes",r[r.BySpecificDateTime=1]="BySpecificDateTime",r[r.ByRecurrenceOnEvery_=2]="ByRecurrenceOnEvery_",r[r.ByItemChange=3]="ByItemChange",(i=s=t.RecurrenceTypes||(t.RecurrenceTypes={}))[i.Evening5pm=0]="Evening5pm",i[i.Morning10am=1]="Morning10am",i[i.MondayMorning9am=2]="MondayMorning9am",i[i.FridayAfternoon1pm=3]="FridayAfternoon1pm",i[i.NextDay10am=4]="NextDay10am",(u=a=t.ExpirableInBackground||(t.ExpirableInBackground={}))[u.Allowed=0]="Allowed",u[u.Suppressed=1]="Suppressed"
var m=(h.getInstance=function(){return h.instance||(h.instance=new h),h.instance},h.prototype.timedPolling=function(){if(p.default.isMailboxReady){if(c.default.getState().isMyAOptedOut()||c.default.getState().isAddInOptedOut())return clearInterval(this.timedPollingInterval),this.actionQueue=[],void(this.expirablesMonitoringArray=[])
this.timedQueuing(),this.timedExecution()}},h.prototype.timedQueuing=function(){var r=Date.now(),o=[]
this.expirablesMonitoringArray.map(function(e,t,n){e.exprationInUTC&&e.exprationInUTC<r?o.push(y.ExpireMeAndReschedule(e)):o.push(e)}),this.expirablesMonitoringArray=o},h.prototype.timedExecution=function(){this.shouldFlushActionQueue()&&this.tryExecuteQueuedActions()},h.prototype.shouldFlushActionQueue=function(){return Date.now()-this.lastFlushingTime>this.flushMinInterval},h.prototype.compareActions=function(e,t){var n=e.action,r=t.action
return String(n.actionCreatorFunction).length-String(r.actionCreatorFunction).length},h.prototype.addToExpirablesMonitoringArray=function(e){this.expirablesMonitoringArray.push(e)},h.prototype.enqueue=function(e){this.actionQueue.push(e)},h.prototype.tryExecuteQueuedActions=function(){var r=this
return this.actionQueue.sort(this.compareActions),this.actionQueue.filter(function(e,t,n){return t<1||0!==r.compareActions(e,n[t-1])}).forEach(function(e){e.action.actionCreatorFunction.apply(e.target,[])}),this.lastFlushingTime=Date.now(),this.actionQueue=[],!0},h)
function h(){var e=this
this.flushMinInterval=g.Constants.actionQueueFastPollingInterval,this.lastFlushingTime=Date.now(),this.actionQueue=[],this.expirablesMonitoringArray=[]
var t=setInterval(function(){p.default.isMailboxReady&&f.default.isFlightsDataReady()&&(e.timedPollingInterval=setInterval(e.timedPolling.bind(e),e.flushMinInterval),clearInterval(t))},this.flushMinInterval)}var y=(_.IsExpired=function(e){return Date.now()>e.exprationInUTC},_.setDay=function(e,t){return 0<=t&&t<=6&&(e=new Date(e.getTime())).setDate(e.getDate()+(t+7-e.getDay())%7),e},_.nextTimeToRecur=function(e){var t=0,n=new Date
switch(e){case s.NextDay10am:t=new Date(n.getTime()+g.Constants.oneDay).setHours(10,0,0,0)
break
case s.Morning10am:var r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),10,0,0,0)
r<n&&(r=new Date(r.getTime()+g.Constants.oneDay)),t=r.getTime()
break
case s.Evening5pm:var o=new Date(n.getFullYear(),n.getMonth(),n.getDate(),17,0,0,0)
o<n&&(o=new Date(o.getTime()+g.Constants.oneDay)),t=o.getTime()
break
case s.FridayAfternoon1pm:var i=_.setDay(n,5);(i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),13,0,0,0))<n&&(i=new Date(i.getTime()+g.Constants.oneWeek)),t=i.getTime()
break
case s.MondayMorning9am:var a=_.setDay(n,1);(a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),9,0,0,0))<n&&(a=new Date(a.getTime()+g.Constants.oneWeek)),t=a.getTime()}return t},_.QueueActions=function(e){return m.getInstance().enqueue(e),e},_.Schedule=function(e){var t=0,n=g.Constants.oneMinuteInMilliSeconds,r=Date.now()
switch(e.setting.expirationType){case o.ByEvery_Minutes:case o.ByItemChange:t=e.setting.value*n
break
case o.BySpecificDateTime:t=e.setting.value.getTime()-r
break
case o.ByRecurrenceOnEvery_:t=_.nextTimeToRecur(e.setting.value)-r}if(0<t){if(e.exprationInUTC=r+t,e.usedSetInterval)return e
e.setting.expirationType===o.ByEvery_Minutes||e.setting.expirationType===o.ByRecurrenceOnEvery_?e.usedSetInterval=!0:setTimeout(_.ExpireMeAndReschedule,t,e)}else e.setting.expirationType===o.ByItemChange&&_.registerWithItemChangedEvent(e)
return e},_.registerWithItemChangedEvent=function(e){var n=0,r=setInterval(function(t){p.default.isMailboxReady&&Office.context.mailbox.addHandlerAsync?Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,function(e){e.initialData&&f.default.isFlightsDataReady()&&t.action.actionCreatorFunction.apply(t.target,[])},function(e){clearInterval(r)}):n<=10?n++:clearInterval(r)},3e3,e)},_.ExpireMeAndReschedule=function(e){if(p.default.isMailboxReady&&(!d.default.isInBackgroundMode||e.setting.expirableInBackground===a.Allowed)&&!p.default.isInMockMode&&_.IsExpired(e))try{e=_.QueueActions(e)}catch(e){}return e=_.Schedule(e)},_)
function _(){}t.expirable=function(l,c,d){return void 0===d&&(d=a.Suppressed),c||l!==o.ByItemChange||(c=-1),function(i,e,t){if(!i)return null
if(!e){var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
if(i.apply(this,e),this.$__Expirables__$)for(var n=0,r=Object.keys(this.$__Expirables__$);n<r.length;n++){var o=r[n]
this.$__Expirables__$[o].target=this}return this},r=n.prototype=i.prototype
if(r.$__Expirables__$)for(var o=0,a=Object.keys(r.$__Expirables__$);o<a.length;o++){var s=a[o]
r.$__Expirables__$[s]=y.Schedule(r.$__Expirables__$[s]),m.getInstance().addToExpirablesMonitoringArray(r.$__Expirables__$[s])}return n}i.$__Expirables__$||(i.$__Expirables__$=[])
var u={action:{actionCreatorFunction:t.value},setting:{expirationType:l,value:c,expirableInBackground:d},exprationInUTC:0};(u.target=i).$__Expirables__$.push(u)}}},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CANCEL_DELAY_DELIVERY_AND_SEND_ACTION=t.CANCEL_DELAY_DELIVERY_AND_DELETE_ACTION=t.BOOK_REHEARSAL_TIME=t.RESCHEDULE_APPOINTMENT_ACTION=t.BOOK_ONE_ON_ONE_ACTION=t.PROMOTE_TASK_ACTION=t.MARK_MAIL_AS_NOT_IMPORTANT_ACTION=t.MARK_AS_NOT_A_TASK_ACTION=t.MARK_TASK_AS_DONE_ACTION=t.DISMISS_ACTION=t.DISLIKE_INSIGHT_ACTION=t.DECLINE_MEETING_ACTION=t.ACCEPT_MEETING_ACTION=t.CANCEL_BOOKED_TIME_ACTION=t.BOOK_PREPARATION_TIME_ACTION=t.TRACK_EMAIL_ACTION_NAME=t.SHORTEN_MEETING_REPLY_ACTION_NAME=t.BOOK_EMAIL_TIME_ACTION_NAME=t.DELEGATE_ATTENDEES_ACTION_NAME=t.MOVE_MEETING_ACTION_NAME=t.MOVE_FOCUS_BLOCK_ACTION_NAME=t.BOOK_FOCUS_BLOCK_ACTION_NAME=void 0
var r=n(0).__importDefault(n(39))
t.BOOK_FOCUS_BLOCK_ACTION_NAME="BookFocusBlock",t.MOVE_FOCUS_BLOCK_ACTION_NAME="MoveFocusBlock",t.MOVE_MEETING_ACTION_NAME="MoveMeeting",t.DELEGATE_ATTENDEES_ACTION_NAME="DelegateAttendeesSuggestions",t.BOOK_EMAIL_TIME_ACTION_NAME="BookEmailTime",t.SHORTEN_MEETING_REPLY_ACTION_NAME="ShortenMeetingReply",t.TRACK_EMAIL_ACTION_NAME="TrackEmail",t.BOOK_PREPARATION_TIME_ACTION="BookPreparationTime",t.CANCEL_BOOKED_TIME_ACTION="CancelBookedTime",t.ACCEPT_MEETING_ACTION="Accept",t.DECLINE_MEETING_ACTION="Decline",t.DISLIKE_INSIGHT_ACTION="DislikeInsightAction",t.DISMISS_ACTION="DismissAction",t.MARK_TASK_AS_DONE_ACTION="MarkTaskAsDone",t.MARK_AS_NOT_A_TASK_ACTION="MarkAsNotATask",t.MARK_MAIL_AS_NOT_IMPORTANT_ACTION="MarkMailAsNotImportant",t.PROMOTE_TASK_ACTION="PromoteTask",t.BOOK_ONE_ON_ONE_ACTION="BookOneOnOne",t.RESCHEDULE_APPOINTMENT_ACTION="RescheduleAppointment",t.BOOK_REHEARSAL_TIME="BookRehearsalTime",t.CANCEL_DELAY_DELIVERY_AND_DELETE_ACTION="CancelDelayDeliveryAndDeleteMessage",t.CANCEL_DELAY_DELIVERY_AND_SEND_ACTION="CancelDelayDeliveryAndSendMessage"
var o=(i.convertSuggestedActions=function(e,t){return r.default.throwIfUndefinedOrNull("suggestedActions",e),e.filter(function(e){return e.Name===t})},i.convertSuggestedAction=function(e,t){var n=i.convertSuggestedActions(e,t)
return r.default.throwIfNotExactlyOneElement("actions",n),n[0]},i.doesSupportNudgeFeedback=function(e){return i.doesSupportAction(e,t.DISLIKE_INSIGHT_ACTION)},i.doesSupportServerSideDislikeInsightAction=function(e){return i.doesSupportAction(e,t.DISLIKE_INSIGHT_ACTION)},i.doesSupportServerSideDismissAction=function(e){return i.doesSupportAction(e,t.DISMISS_ACTION)},i.doesSupportAction=function(e,t){return!!(e&&e.Suggestion&&e.Suggestion.SuggestedActions)&&1<=i.convertSuggestedActions(e.Suggestion.SuggestedActions,t).length},i)
function i(){}t.default=o},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=(Object.defineProperty(o,"hostName",{get:function(){return Office.context.mailbox.diagnostics?Office.context.mailbox.diagnostics.hostName:null},enumerable:!1,configurable:!0}),Object.defineProperty(o,"hostVersion",{get:function(){return Office.context.mailbox.diagnostics?Office.context.mailbox.diagnostics.hostVersion:null},enumerable:!1,configurable:!0}),Object.defineProperty(o,"hostPlatform",{get:function(){var e
return null!==(e=Office.context.diagnostics)&&void 0!==e&&e.platform?Office.PlatformType[Office.context.diagnostics.platform]:Office.context.platform?Office.PlatformType[Office.context.platform]:null},enumerable:!1,configurable:!0}),Object.defineProperty(o,"isOutlookDesktop",{get:function(){return"outlook"===Office.context.mailbox.diagnostics.hostName.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(o,"isOutlookWebApp",{get:function(){return"outlookwebapp"===Office.context.mailbox.diagnostics.hostName.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportRestToken",{get:function(){return o.isSetSupported("1.5")},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportNewMessageForm",{get:function(){return o.isSetSupported("1.6")},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportMessageComposeType",{get:function(){return o.isSetSupported("1.10")},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportSessionData",{get:function(){return o.isSetSupported("1.11")},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportActionableMessage",{get:function(){return o.isOutlookDesktop?o.newerThanCutOffOutlookVersion([16,0,8528,1e3]):!!o.isOutlookWebApp},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportRecurrenceMeetingApi",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,9224,1e3])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportNotificationMessage",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,9226,2048])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportChangeEventListeners",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,9226,2048])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportRecurrenceChangedEventListeners",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,9029,1e3])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportThemeChangedEventListener",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,10818,1e4])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"hasFixedTokenCaching",{get:function(){return o.isOutlookDesktop?o.newerThanCutOffOutlookVersion([16,0,7900,1e3]):!!o.isOutlookWebApp},enumerable:!1,configurable:!0}),Object.defineProperty(o,"isValidHostForPinningAgave",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,7900,1e3])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportInternetHeaders",{get:function(){return o.isOutlookDesktop?o.newerThanCutOffOutlookVersion([16,0,10810,1e4]):!!o.isOutlookWebApp},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportInfobarClickedCallback",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,11508,1e4])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportDelayDelivery",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,12016,1e4])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportAttachmentApi",{get:function(){return o.isOutlookDesktop&&o.newerThanCutOffOutlookVersion([16,0,11716,1e4])},enumerable:!1,configurable:!0}),Object.defineProperty(o,"doesSupportEWSCalls",{get:function(){return!o.isOutlookDesktop||o.hostPlatform!==Office.PlatformType[Office.PlatformType.Mac]||!("16.24 (190412.01)"===o.hostVersion||"16.24 (190414.01)"===o.hostVersion||"16.25 (190512.01)"===o.hostVersion)},enumerable:!1,configurable:!0}),o.newerThanCutOffOutlookVersion=function(e){var t=this.hostVersion.split(".")
if(t.length!==e.length)return!1
for(var n=0;n<t.length;n++){if(parseInt(t[n],10)<e[n])return!1
if(parseInt(t[n],10)>e[n])return!0}return!0},o.isSetSupported=function(e){return!!Office.context.requirements.isSetSupported&&Office.context.requirements.isSetSupported("Mailbox",e)},o)
function o(){}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(6)),i=r.__importDefault(n(134)),a=r.__importDefault(n(549)),s=(u.areInsightsEqual=function(e,t){return this.areInsightIdentifiersEqual(this.getInsightIdentifier(e),this.getInsightIdentifier(t))},u.areInsightIdentifiersEqual=function(e,t){return e.insightName===t.insightName&&o.default.shallowEquals(e.identifier,t.identifier)},u.getInsightIdentifierAsString=function(e){return e.primaryId+"_"+e.secondaryId},u.findInsightByIdentifier=function(e,t){return 0<(e=e.filter(function(e){return t.insightName===e.insightName&&t.identifier.primaryId===e.instanceData.identifier.primaryId})).length?e[0]:null},u.findFirstInsightByInsightName=function(e,t){for(var n=0;n<e.length;n++)if(e[n].insightName===t)return e[n]
return null},u.flattenInsights=function(e,n){var r=this
void 0===n&&(n=!1)
var o=[]
return e.forEach(function(e){var t=e.instanceData
o=t.rolledUpInsights?(n&&(o=o.concat(e)),o.concat(r.flattenInsights(t.rolledUpInsights,n))):o.concat(e)}),a.default(o,i.default)},u.getInsightIdentifier=function(e){return{insightName:e.insightName,identifier:e.instanceData.identifier}},u.addPaddingInsightMessage=function(e){return" "+e},u)
function u(){}t.default=s},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=r.__importDefault(n(6)),a=(Object.defineProperty(s,"sessionGuid",{get:function(){return this._sessionGuid||(this._sessionGuid=i.default.getGuid()),this._sessionGuid},set:function(e){this._sessionGuid=e},enumerable:!1,configurable:!0}),Object.defineProperty(s,"sessionStartTime",{get:function(){return s._startTimeFromExternal?s._startTimeFromExternal:window.performance?performance.timing.navigationStart:s._startTime},enumerable:!1,configurable:!0}),Object.defineProperty(s,"startTimeFromExternal",{set:function(e){this._startTimeFromExternal=e},enumerable:!1,configurable:!0}),Object.defineProperty(s,"sessionStartTimeTicks",{get:function(){return i.default.getTicksFromMilliseconds(s.sessionStartTime)},enumerable:!1,configurable:!0}),s.getUserSessionState=function(){return{SessionId:this.sessionGuid,SessionStartTime:this.sessionStartTime}},s.setUserSessionState=function(e){e.SessionId&&(this.sessionGuid=e.SessionId),e.SessionStartTime&&(this.startTimeFromExternal=e.SessionStartTime)},Object.defineProperty(s,"RESTCallbackToken",{get:function(){return s.RESTCallbackTokenWithExpiration&&s.RESTCallbackTokenWithExpiration.expInSec>(new Date).getTime()/o.Constants.oneSecondInMilliseconds?s.RESTCallbackTokenWithExpiration.val:null},enumerable:!1,configurable:!0}),Object.defineProperty(s,"RESTCallbackTokenWithExpiration",{get:function(){return s._RESTCallbackTokenWithExpiration},set:function(e){s._RESTCallbackTokenWithExpiration=e},enumerable:!1,configurable:!0}),Object.defineProperty(s,"ActorIdFromRESTToken",{get:function(){var e=s.RESTCallbackTokenWithExpiration
return!this._ActorIdFromRESTToken&&e&&(s._ActorIdFromRESTToken=i.default.parseJWTToken(e.val).oid),s._ActorIdFromRESTToken},enumerable:!1,configurable:!0}),Object.defineProperty(s,"AadTenantIdFromRESTToken",{get:function(){var e=s.RESTCallbackTokenWithExpiration
return!this._AadTenantIdFromRESTToken&&e&&(s._AadTenantIdFromRESTToken=i.default.parseJWTToken(e.val).tid),s._AadTenantIdFromRESTToken},enumerable:!1,configurable:!0}),s._sessionGuid=null,s._startTime=Date.now(),s._startTimeFromExternal=null,s.externalInsightIdentifier=null,s._RESTCallbackTokenWithExpiration=null,s._ActorIdFromRESTToken=null,s._AadTenantIdFromRESTToken=null,s)
function s(){}t.default=a},function(e,t,n){"use strict"
var r,o,i,a,s,u
Object.defineProperty(t,"__esModule",{value:!0}),t.TimeAwayTaskStatus=t.TimeAwayPreparationTaskNames=t.PreparationStatus=t.TimeAwayType=t.AutomaticRepliesSettingStatus=t.AutomaticRepliesSettingExternalAudience=t.HOLIDAY_CARD_MAXIMUM_LOAD_COUNT=t.UNSCHEDULED_TIME_AWAY_ID=t.TIME_AWAY_FEATURE_NAME=void 0,t.TIME_AWAY_FEATURE_NAME="TimeAway",t.UNSCHEDULED_TIME_AWAY_ID="UnscheduledTimeAwayId",t.HOLIDAY_CARD_MAXIMUM_LOAD_COUNT=2,(r=t.AutomaticRepliesSettingExternalAudience||(t.AutomaticRepliesSettingExternalAudience={}))[r.None=0]="None",r[r.All=1]="All",r[r.ContactsOnly=2]="ContactsOnly",(o=t.AutomaticRepliesSettingStatus||(t.AutomaticRepliesSettingStatus={}))[o.Disabled=0]="Disabled",o[o.AlwaysEnabled=1]="AlwaysEnabled",o[o.Scheduled=2]="Scheduled",(i=t.TimeAwayType||(t.TimeAwayType={})).UserBooked="UserBooked",i.Adhoc="Adhoc",i.PublicHoliday="PublicHoliday",i.TimeAwayMessageDetected="TimeAwayMessageDetected",i.NudgeDetected="NudgeDetected",(a=t.PreparationStatus||(t.PreparationStatus={}))[a.None=0]="None",a[a.InProgress=1]="InProgress",a[a.AllSet=2]="AllSet",a[a.NeedsReview=3]="NeedsReview",a[a.NeedsCatchUp=4]="NeedsCatchUp",(s=t.TimeAwayPreparationTaskNames||(t.TimeAwayPreparationTaskNames={})).ScheduleTimeAway="ScheduleTimeAway",s.SetAutoReply="SetAutoReply",s.NotifyContacts="NotifyContacts",s.ResolveMeetings="ResolveMeetings",s.ScheduleCatchUpTime="ScheduleCatchUpTime",(u=t.TimeAwayTaskStatus||(t.TimeAwayTaskStatus={})).NotCompleted="NotCompleted",u.Done="Done",u.NeedsReview="NeedsReview",u.Changing="Changing",u.NeedsReviewUpdate="NeedsReviewUpdate",u.PendingServerResponse="PendingServerResponse"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i=n(0),r=i.__importDefault(n(2)),o=i.__importDefault(n(24)),a=i.__importStar(n(6)),s=i.__importDefault(n(20)),u=(l.toTimeBlockString=function(e){return r.default.TIME_RANGE(s.default.toHourAndMinuteString(e.startDate),s.default.toHourAndMinuteString(e.endDate))},l.areEqual=function(e,t){return e.startDate.getTime()===t.startDate.getTime()&&e.endDate.getTime()===t.endDate.getTime()},l.findMatchingBlock=function(e,t){return e.filter(function(e){return l.areEqual(e,t)})[0]},l.getUpdatedCalendarItem=function(e,t){var n=l.findMatchingBlock(t,e),r=n&&void 0!==n.isBooked?n.isBooked:e.isBooked,o=n&&void 0!==n.isReminderOn?n.isReminderOn:e.isReminderOn
return i.__assign(i.__assign({},n||e),{isBooked:r,isReminderOn:o})},l.getUpdatedCalendarItems=function(e,t){return e.map(function(e){return l.getUpdatedCalendarItem(e,t)})},l.sortSlotsByStartDate=function(e){return a.default.sortArrayOnKey(e,function(e){return e.startDate.getTime()},a.OrderBy.Ascending)},l.groupAndSortSlotsByDate=function(e){var r={}
return e.forEach(function(e){var t=o.default.startOfDay(e.startDate).getTime(),n=r[t]||[]
n.push(e),r[t]=n}),a.default.sortArrayOnKey(Object.keys(r),function(e){return Number(e)},a.OrderBy.Ascending).map(function(e){return{dateOfDay:new Date(Number(e)),sortedTimeSlots:l.sortSlotsByStartDate(r[e])}})},l.isSlotIncluded=function(e,t){return e.some(function(e){return t.startDate.getTime()>=e.startDate.getTime()&&t.endDate.getTime()<=e.endDate.getTime()})},l)
function l(){}t.default=u},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionMappedReduceStore=void 0
var r,o=n(0),i=n(17),a=n(3),s=o.__importDefault(n(25)),u=o.__importDefault(n(11)),l=o.__importDefault(n(4)),c=o.__importDefault(n(171)),d=o.__importDefault(n(368)),p=o.__importDefault(n(6)),f=(r=i.ReduceStore,o.__extends(g,r),g.prototype.reduce=function(e,t){var n=a.ActionUtils.getActionString(t.actionType),r=this.actionMap[n]
if(r){var o=this.tryProcessAction(r,e,t)
return o!==e&&(o=this.onStateHasChanged(e,o,t)),o}return e},g.prototype.onStateHasChanged=function(e,t,n){return s.default.isInAutoRunJSMode&&n.actionType!==a.Action.LoadFromSessionData&&this.hasMeaningfulChange(e,t)&&this.tryProcessSetToSessionData(t),t},g.prototype.hasMeaningfulChange=function(e,t){var n=this.tryCastToISerializableState(e),r=this.tryCastToISerializableState(t)
if(n&&n.toJSON&&r&&r.toJSON){var o=n.toJSON(),i=r.toJSON()
return!p.default.shallowEquals(o,i)}return!1},g.prototype.tryProcessSetToSessionData=function(e){try{var t=d.default.getSessionDataKey(this.getStoreLoggingName())
if(!t)return
var n=this.tryCastToISerializableState(e)
n&&n.toJSON?c.default.setSessionData(t,n.toJSON()):l.default.logWarning("State didn't implement ISerializableState",this.getStoreLoggingName(),"tryProcessSetToSessionData")}catch(e){l.default.logAssert("Catch error: "+JSON.stringify(e),this.getStoreLoggingName(),"tryProcessSetToSessionData")}},g.prototype.tryProcessLoadFromSessionData=function(e,t){try{var n=d.default.getSessionDataKey(this.getStoreLoggingName())
if(n){var r=t.sessionDataMap[n]
if(r){var o=this.tryCastToISerializableState(e)
if(o&&o.fromJSON)return o.fromJSON(r)
l.default.logWarning("State didn't implement ISerializableState",this.getStoreLoggingName(),"tryProcessLoadFromSessionData")}}}catch(e){l.default.logAssert("Catch error: "+JSON.stringify(e),this.getStoreLoggingName(),"tryProcessLoadFromSessionData")}return e},g.prototype.addActionCallback=function(e,t){this.actionMap[a.ActionUtils.getActionString(e)]=t.bind(this)},g.prototype.tryProcessAction=function(e,t,n){var r=t
try{r=e(t,n)}catch(e){l.default.logAssert("Caught exception while processing "+a.ActionUtils.getActionString(n.actionType),"STORE",this.getStoreLoggingName()+".TryProcessAction")}return r},g.prototype.tryCastToISerializableState=function(e){try{return e}catch(e){return l.default.logAssert("Catch error: "+JSON.stringify(e),this.getStoreLoggingName(),"tryCastToISerializableState"),null}},g.prototype.clearStoreState=function(e,t){return this.getInitialState()},g)
function g(){var e=r.call(this,u.default)||this
return e.actionMap={},e.addActionCallback(a.Action.TEST_ONLY_ClearStoreState,e.clearStoreState),e.addActionCallback(a.Action.RefreshStateForItemChanged,e.setStateForItemChangedEvent),s.default.isInAutoRunJSMode&&e.addActionCallback(a.Action.LoadFromSessionData,e.tryProcessLoadFromSessionData),e}t.ActionMappedReduceStore=f,t.default=f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(4)),o=(i.getUserFlightsMap=function(){return i._UserFlightsMap},i.setUserFlights=function(e){i._UserFlightsMap=e},i.isFlightsDataReady=function(){return!!i._UserFlightsMap},i.isFlightEnabled=function(e){return i.isFlightsDataReady()?i._UserFlightsMap[e.toUpperCase()]:(r.default.logAssert("isFlightEnabled("+e+") is called before flights loaded","UserFlights","isFlightEnabled"),!1)},i.ESTIMATE_TO_RECIPIENTS="EstimateToRecipientsFlight",i.RECURRENCE_API="RECURRENCEAPI",i.DEVELOPER="DEVELOPER",i.SUGGESTED_TIME_FOR_TASKS="SUGGESTEDTIMEFORTASKS",i.FOLLOWUP_REQUEST_TASKS_INSIGHT="FOLLOWUPREQUESTTASKSINSIGHT",i.MANAGER_EFFECTIVENESS_EXPERIENCE_FLIGHT="MANAGEREFFECTIVENESSEXPERIENCEFLIGHT",i.READ_STATS_PREMATURE_TIME_FIFTEEN_MINUTES="READSTATSPREMATURETIMEFIFTEENMINUTES",i.HIDE_READ_STATS_FOR_CALENDAR_ITEMS="HIDEREADSTATSFORCALENDARITEMS",i.FOLLOWUP_TASK_SUGGESTION_MIGRATION_ENABLED="FOLLOWUPTASKSUGGESTIONMIGRATIONENABLED",i.TEAMS_GROUP_SUGGESTION_INSIGHT="TEAMSGROUPSUGGESTIONINSIGHT",i.CATCH_UP_UNREAD_IRANKER_FLIGHT="CATCHUPUNREADIRANKERFLIGHT",i.MEETING_PREPARATION_CARD_AGENDA="AGENDAMEETINGPREPARATIONCARD",i.IMPORTANT_PEOPLE_FOLLOW_UPS_NUDGE="ImportantPeopleFollowUpsFlight",i.COMPOSE_PEOPLE_CATCH_UP_ITEMS_INFOBAR="ComposePeopleCatchUpItemsFlight",i.SMART_RULES_SUGGESTION_INSIGHT="SMARTRULESSUGGESTIONFLIGHT",i.SERVER_SIDE_DISMISS="ServerSideDismiss",i.SENT_MAIL_STATS_INFO_TEXT="SentMailStatsInfoText",i.TASK_INSIGHT_IN_AGAVE="TaskInsightInAgave",i.TASK_INSIGHT_TASK_PROMOTION="TaskInsightTaskPromotionAgaveClientFlight",i.TASK_INSIGHTS_WITH_RANKING_SCORE="TASKSINSIGHTRANKINGSCOREFLIGHT",i.OUT_OF_ROUTINE_CARD="OutOfRoutineCard",i.ENABLE_READ_STATS_FOR_E1_E3="EnableReadStatsForE1E3",i.EXTENDED_SENT_MAIL_STATS="ExtendedSentMailStats",i.STAMP_CALENDAR_EVENT_CLASSIFICATIONS="StampCalendarEventClassifications",i.AUTO_DELAY_DELIVERY_E1_E3_EXPANSION="AutoDelayDeliveryInsightExpansionFlight",i.EXPAND_OOF_NUDGE_TO_E1_E3="ExpandOOFNudgeToE1E3",i.USING_NEW_BRAND_COPIES="BrandCopiesForAgave",i.MULTILINGUAL_OOF_INFOBAR="MultilingualOOFInfoBar",i.INCREASE_ADVERT_CARD_FRENQUENCY_TO_SDD_USER="IncreaseAdvertCardFrequencyToSDDUser",i.TEAMS_FOCUS_PLAN="TeamsFocusPlan",i.USE_XML_DOM_PACKAGE="UseXMLDOMPackage",i.MEETING_PREP_NO_RESPONSE_REQUESTED="MeetingPrepNoResponseRequested",i.EXTENDED_SENT_MAIL_STATS_ENABLE_NEW_BUCKET_SCHEME="ExtendedSentMailStatsEnableNewBucketScheme",i.EMAIL_COMPOSE_TYPE_LOGGING="EmailComposeTypeLogging",i.REFRESH_INFOBAR_FROM_VERTICAL="RefreshInfobarFromVertical",i.P1_LICENSE_CHECK_FOR_MANAGER_INSIGHTS="P1LicenseCheckForManagerInsights",i.DELAY_DELIVERY_P1_LICENSE_EXPANSION="DelayDeliveryP1LicenseExpansion",i.FALLBACK_TO_CONVERSATION_ID="DelayDeliveryPlanFallbackToConversationId",i._UserFlightsMap=null,i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RESTRequestBase=void 0
var a,r=n(0),s=r.__importDefault(n(805)),u=r.__importDefault(n(200)),o=r.__importDefault(n(806)),i=n(5),l=n(16),c=n(377),d=(a=c.RequestBase,r.__extends(p,a),Object.defineProperty(p.prototype,"baseUrl",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"method",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"logCreator",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"selectField",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"orderByField",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"top",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"skip",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"requiresCount",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"expand",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"extendedProperties",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"shouldIncludeMetadata",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"headers",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"version",{get:function(){return u.default.restVersion},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"apiUrl",{get:function(){return this.version+"/"+this.urlPath},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"requestUrl",{get:function(){return new o.default(this.baseUrl(),this.apiUrl,this.getODataOptions(),this.queryParams)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"queryParams",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"singleValueExtendedProperty",{get:function(){if(this.extendedProperties())return"SingleValueExtendedProperties($filter = PropertyId eq '"+this.extendedProperties()+"')"},enumerable:!1,configurable:!0}),p.prototype.toTraceString=function(){return this.apiUrl},p.prototype.getFilterCriteria=function(){return""},p.prototype.getSearchQuery=function(){return""},p.prototype.getlogCreator=function(){return this.logCreator()},p.prototype.postData=function(){return{}},p.prototype.getODataOptions=function(){var e,t
return{select:null===(e=this.selectField())||void 0===e?void 0:e.join(),orderBy:null===(t=this.orderByField())||void 0===t?void 0:t.join(),top:this.top(),skip:this.skip(),count:this.requiresCount(),expand:r.__spreadArrays(this.expand(),[this.singleValueExtendedProperty]).filter(function(e){return!!e}).join(),filter:this.getFilterCriteria(),search:this.getSearchQuery()}},r.__decorate([i.doop],p.prototype,"baseUrl",null),r.__decorate([i.doop],p.prototype,"method",null),r.__decorate([i.doop],p.prototype,"logCreator",null),r.__decorate([i.doop],p.prototype,"selectField",null),r.__decorate([i.doop],p.prototype,"orderByField",null),r.__decorate([i.doop],p.prototype,"top",null),r.__decorate([i.doop],p.prototype,"skip",null),r.__decorate([i.doop],p.prototype,"requiresCount",null),r.__decorate([i.doop],p.prototype,"expand",null),r.__decorate([i.doop],p.prototype,"extendedProperties",null),r.__decorate([i.doop],p.prototype,"shouldIncludeMetadata",null),r.__decorate([i.doop],p.prototype,"headers",null),p=r.__decorate([i.doop],p))
function p(e,t,n,r,o){var i=a.call(this)||this
return i.logCreator(new s.default(t,l.MethodToLogTypeConverter.getLogType(e),n,r,i.requestId(),o)).baseUrl(u.default.restBaseUrl).method(e).expand([]).headers({}),i}t.RESTRequestBase=d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserSettingsStore=t.UserSettingsStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=n(42),c=n(7),d=i.__importStar(n(65)),p=n(817),f=i.__importDefault(n(62)),g=(r=l.CachedDataStreamStateBase,i.__extends(m,r),o=m,Object.defineProperty(m.prototype,"canOptOut",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"hasVivaLicense",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"vivaLicenseType",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isMyAOptedOut",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isAddInOptedOut",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isOutlookNotificationsEnabled",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isOutlookNotificationsEnabledInDelayDelivery",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isManagerInsightsOptedIn",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"hasUserChangedOutlookNotifications",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isProtectedTimeBookingOptedIn",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isAutoDelayDeliveryOptedIn",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isAutoDelayDeliveryOptedOutInOutlookNotifications",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isDigestEmailOptedOut",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isDashboardOptedOut",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"hasUserChangedProtectedTimeBookingOptedIn",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),m.prototype.toJSON=function(){return{canOptOut:this.canOptOut(),hasVivaLicense:this.hasVivaLicense(),vivaLicenseType:this.vivaLicenseType(),isMyAOptedOut:this.isMyAOptedOut(),isAddInOptedOut:this.isAddInOptedOut(),isOutlookNotificationsEnabled:this.isOutlookNotificationsEnabled(),isOutlookNotificationsEnabledInDelayDelivery:this.isOutlookNotificationsEnabledInDelayDelivery(),isProtectedTimeBookingOptedIn:this.isProtectedTimeBookingOptedIn(),isAutoDelayDeliveryOptedIn:this.isAutoDelayDeliveryOptedIn(),isAutoDelayDeliveryOptedOutInOutlookNotifications:this.isAutoDelayDeliveryOptedOutInOutlookNotifications(),isDigestEmailOptedOut:this.isDigestEmailOptedOut(),isDashboardOptedOut:this.isDashboardOptedOut(),hasUserChangedOutlookNotifications:!1,hasUserChangedProtectedTimeBookingOptedIn:!1,isManagerInsightsOptedIn:this.isManagerInsightsOptedIn()}},m.prototype.fromJSON=function(e){return(new o).canOptOut(e.canOptOut).isMyAOptedOut(e.isMyAOptedOut).isAddInOptedOut(e.isAddInOptedOut).isOutlookNotificationsEnabled(e.isOutlookNotificationsEnabled).isOutlookNotificationsEnabledInDelayDelivery(e.isOutlookNotificationsEnabledInDelayDelivery).isProtectedTimeBookingOptedIn(e.isProtectedTimeBookingOptedIn).isAutoDelayDeliveryOptedIn(e.isAutoDelayDeliveryOptedIn).isAutoDelayDeliveryOptedOutInOutlookNotifications(e.isAutoDelayDeliveryOptedOutInOutlookNotifications).isDigestEmailOptedOut(e.isDigestEmailOptedOut).isDashboardOptedOut(e.isDashboardOptedOut).isManagerInsightsOptedIn(e.isManagerInsightsOptedIn).hasVivaLicense(e.hasVivaLicense).vivaLicenseType(e.vivaLicenseType)},i.__decorate([u.doop],m.prototype,"canOptOut",null),i.__decorate([u.doop],m.prototype,"hasVivaLicense",null),i.__decorate([u.doop],m.prototype,"vivaLicenseType",null),i.__decorate([u.doop],m.prototype,"isMyAOptedOut",null),i.__decorate([u.doop],m.prototype,"isAddInOptedOut",null),i.__decorate([u.doop],m.prototype,"isOutlookNotificationsEnabled",null),i.__decorate([u.doop],m.prototype,"isOutlookNotificationsEnabledInDelayDelivery",null),i.__decorate([u.doop],m.prototype,"isManagerInsightsOptedIn",null),i.__decorate([u.doop],m.prototype,"hasUserChangedOutlookNotifications",null),i.__decorate([u.doop],m.prototype,"isProtectedTimeBookingOptedIn",null),i.__decorate([u.doop],m.prototype,"isAutoDelayDeliveryOptedIn",null),i.__decorate([u.doop],m.prototype,"isAutoDelayDeliveryOptedOutInOutlookNotifications",null),i.__decorate([u.doop],m.prototype,"isDigestEmailOptedOut",null),i.__decorate([u.doop],m.prototype,"isDashboardOptedOut",null),i.__decorate([u.doop],m.prototype,"hasUserChangedProtectedTimeBookingOptedIn",null),m=o=i.__decorate([u.doop],m))
function m(){var e=r.call(this)||this
return e.hasUserChangedOutlookNotifications(!1),e.hasUserChangedProtectedTimeBookingOptedIn(!1),e.isProtectedTimeBookingOptedIn(!0),e}t.UserSettingsStoreState=g
var h,y=(h=l.CachedDataStreamStoreBase,i.__extends(_,h),Object.defineProperty(_.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.UserSettings},enumerable:!1,configurable:!0}),_.prototype.getInitialState=function(){return new g},_.prototype.getStoreLoggingName=function(){return"UserSettingsStore"},_.prototype.setStateForItemChangedEvent=function(e,t){return e},_.prototype.loadFromCache=function(){var e=d.default.tryGetRoamingSettings(d.RoamingSettingsKeys.UserSettings)
return Promise.resolve({didCatchException:!1,result:e&&(null==e.expirationTime||Date.now()<e.expirationTime)?e.value:null})},_.prototype.isManagerExperienceEnabled=function(){return f.default.isFlightEnabled(f.default.P1_LICENSE_CHECK_FOR_MANAGER_INSIGHTS)?this.getState().isManagerInsightsOptedIn()&&this.hasP1License():this.getState().isManagerInsightsOptedIn()},_.prototype.hasP1License=function(){return this.getState().hasVivaLicense()&&this.getState().vivaLicenseType()===p.VivaLicenseType.VivaP1License},_.prototype.saveToCache=function(e){var t={value:this.saveStateToJSON(e),expirationTime:Date.now()+1e3*this.CACHE_LIFETIME}
d.default.trySetRoamingSettings(d.RoamingSettingsTypes.Cache,d.RoamingSettingsKeys.UserSettings,t)},_.prototype.processGetUserSettings=function(e,t){var n=(n=this.processGetOptedOutSettings(e,t)).hasVivaLicense(t.hasVivaLicense).vivaLicenseType(t.vivaLicenseType).isManagerInsightsOptedIn(t.isManagerInsightsOptedIn).isAutoDelayDeliveryOptedIn(t.isAutoDelayDeliveryOptedIn),r=this.updateIsProtectedTimeBookingOptedIn(n,t.isProtectedTimeBookingOptedIn)
return this.updateOutlookNotifications(r,t.isOutlookNotificationsEnabled)},_.prototype.processGetOptedOutSettings=function(e,t){return e.canOptOut(t.canOptOut).isMyAOptedOut(t.isMyAOptedOut).isAddInOptedOut(t.isAddInOptedOut).isDigestEmailOptedOut(t.isDigestEmailOptedOut).isDashboardOptedOut(t.isDashboardOptedOut)},_.prototype.processUpdateOutlookNotificationsByUser=function(e,t){return e.isOutlookNotificationsEnabled(t.isOutlookNotificationsEnabled).hasUserChangedOutlookNotifications(!0).isOutlookNotificationsEnabledInDelayDelivery(!1).isAutoDelayDeliveryOptedOutInOutlookNotifications(!1)},_.prototype.processEnableOutlookNotificationsInDelayDelivery=function(e){return e.isOutlookNotificationsEnabledInDelayDelivery(!0)},_.prototype.processUpdateIsProtectedTimeBookingOptedInByUser=function(e,t){return e.isProtectedTimeBookingOptedIn(t.isProtectedTimeBookingOptedIn).hasUserChangedProtectedTimeBookingOptedIn(!0)},_.prototype.updateOutlookNotifications=function(e,t){return e.hasUserChangedOutlookNotifications()?e:e.isOutlookNotificationsEnabled(t)},_.prototype.updateIsProtectedTimeBookingOptedIn=function(e,t){return e.hasUserChangedProtectedTimeBookingOptedIn()?e:e.isProtectedTimeBookingOptedIn(t)},_.prototype.processUpdateIsAutoDelayDeliveryOptedInByUser=function(e,t){return e.isAutoDelayDeliveryOptedIn(t.isAutoDelayDeliveryOptedIn).isOutlookNotificationsEnabledInDelayDelivery(!1).isAutoDelayDeliveryOptedOutInOutlookNotifications(!1)},_.prototype.processOptOutAutoDelayDeliveryInOutlookNotifications=function(e){return e.isAutoDelayDeliveryOptedOutInOutlookNotifications(!0)},_.prototype.updateIsManagerInsightsOptedInByUser=function(e,t){return e.isManagerInsightsOptedIn(t.isManagerInsightsOptedIn)},_)
function _(){var e=h.call(this)||this
return e.ENABLE_IN_BACKGROUND=!0,e.CACHE_LIFETIME=4*c.Constants.oneHourInSeconds,e.addActionCallback(s.default.GetUserSettings,e.processGetUserSettings),e.addActionCallback(s.default.UpdateOutlookNotificationsByUser,e.processUpdateOutlookNotificationsByUser),e.addActionCallback(s.default.EnableOutlookNotificationsInDelayDelivery,e.processEnableOutlookNotificationsInDelayDelivery),e.addActionCallback(s.default.UpdateIsAutoDelayDeliveryOptedInByUser,e.processUpdateIsAutoDelayDeliveryOptedInByUser),e.addActionCallback(s.default.OptOutAutoDelayDeliveryInOutlookNotifications,e.processOptOutAutoDelayDeliveryInOutlookNotifications),e.addActionCallback(s.default.UpdateIsProtectedTimeBookingOptedInByUser,e.processUpdateIsProtectedTimeBookingOptedInByUser),e.addActionCallback(s.default.SetUserOptIn,e.processGetOptedOutSettings),e.addActionCallback(s.default.UpdateManagerInsightsOptedInByUser,e.updateIsManagerInsightsOptedInByUser),e}t.UserSettingsStore=y,t.default=new y},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingsUtils=t.RoamingSettingsAccessor=t.RoamingSettingsTypes=t.RoamingSettingsKeys=void 0
var r,o,i,a,s=n(0).__importDefault(n(815)),u=n(4),l=n(816),c=n(131);(o=r=t.RoamingSettingsKeys||(t.RoamingSettingsKeys={}))[o.SessionsNumFromFirstAccess=0]="SessionsNumFromFirstAccess",o[o.TutorialsShown=1]="TutorialsShown",o[o.EngagedCardsNum=2]="EngagedCardsNum",o[o.HasDismissWelcomeCard=3]="HasDismissWelcomeCard",o[o.HasUserPinnedAgave=4]="HasUserPinnedAgave",o[o.FirstAccessTime=5]="FirstAccessTime",o[o.HasDismissedFocusTimeWorkingHourTip=6]="HasDismissedFocusTimeWorkingHourTip",o[o.HasDismissedAfterHourWorkingHourTip=7]="HasDismissedAfterHourWorkingHourTip",o[o.LastTimeFeedbackSubmitted=8]="LastTimeFeedbackSubmitted",o[o.HasUserVisitedDashboard=9]="HasUserVisitedDashboard",o[o.ShouldIgnorePeopleFirstRun=10]="ShouldIgnorePeopleFirstRun",o[o.HasDismissedGuideCard=11]="HasDismissedGuideCard",o[o.HasCompletedPeopleFirstRun=12]="HasCompletedPeopleFirstRun",o[o.UnReadFromVIPFolder=13]="UnReadFromVIPFolder",o[o.UnReadFromDirectReportFolder=14]="UnReadFromDirectReportFolder",o[o.DeletedItemsFolder=15]="DeletedItemsFolder",o[o.JunkEmailFolder=16]="JunkEmailFolder",o[o.UnReadFromIRankerFolder=17]="UnReadFromIRankerFolder",o[o.HasDismissFocusTitleEditTutorial=18]="HasDismissFocusTitleEditTutorial",o[o.EmptyStateId=19]="EmptyStateId",o[o.EmptyStateDate=20]="EmptyStateDate",o[o.RequestsFolder=21]="RequestsFolder",o[o.ActionLogFolder=22]="ActionLogFolder",o[o.InclusionExclusionApplicationNames=23]="InclusionExclusionApplicationNames",o[o.ShouldShowReduceMeetingLoadInfobarTeachingMoment_V1=24]="ShouldShowReduceMeetingLoadInfobarTeachingMoment_V1",o[o.ShouldShowTrackEmailTeachingMoment_V1=25]="ShouldShowTrackEmailTeachingMoment_V1",o[o.ShouldShowDoNotDisturbFocusTeachingMoment=26]="ShouldShowDoNotDisturbFocusTeachingMoment",o[o.ShouldShowBookSuggestedTimeTeachingMoment=27]="ShouldShowBookSuggestedTimeTeachingMoment",o[o.ShouldShowPinInsightsTimeTeachingMoment=28]="ShouldShowPinInsightsTimeTeachingMoment",o[o.ShouldShowAutoDelayDeliveryTeachingMoment=29]="ShouldShowAutoDelayDeliveryTeachingMoment",o[o.ShouldShowInlineSuggestionsTeachingMoment=30]="ShouldShowInlineSuggestionsTeachingMoment",o[o.InComingWebhookUrl=31]="InComingWebhookUrl",o[o.DeletedMeetingsDuringTimeAway=32]="DeletedMeetingsDuringTimeAway",o[o.AutoDelayDeliveryAdvertisementCount=33]="AutoDelayDeliveryAdvertisementCount",o[o.HasDismissedLongThreadWorkingHourTip=34]="HasDismissedLongThreadWorkingHourTip",o[o.ShouldShowTaskOverflowTeachingMoment=35]="ShouldShowTaskOverflowTeachingMoment",o[o.LastTimeShowPinTutorial=36]="LastTimeShowPinTutorial",o[o.LastTimeFeedbackTutorialDismissed=37]="LastTimeFeedbackTutorialDismissed",o[o.IsFirstRunAgave=38]="IsFirstRunAgave",o[o.LastTimeDismissFeedback=39]="LastTimeDismissFeedback",o[o.LastTimeClickFeedback=40]="LastTimeClickFeedback",o[o.UserSettings=41]="UserSettings",(a=i=t.RoamingSettingsTypes||(t.RoamingSettingsTypes={}))[a.FirstRun=0]="FirstRun",a[a.UnReadMails=1]="UnReadMails",a[a.FocusTime=2]="FocusTime",a[a.SentStats=3]="SentStats",a[a.ImportantPeopleSuggestion=4]="ImportantPeopleSuggestion",a[a.EmptyState=5]="EmptyState",a[a.ExtractedEntity=6]="ExtractedEntity",a[a.ActionLog=7]="ActionLog",a[a.EngineeringProductivity=8]="EngineeringProductivity",a[a.TeachingMoment=9]="TeachingMoment",a[a.Mock=10]="Mock",a[a.TimeAway=11]="TimeAway",a[a.DelayDelivery=12]="DelayDelivery",a[a.Cache=13]="Cache",a[a.Count=14]="Count"
var d=(p.prototype.trySetRoamingSettings=function(e,t,n){if(null==t)return null
var r=f.getRoamingSettingsKeyString(t)
Office.context.roamingSettings.set(r,n)
var o={rsType:e,data:{key:r,value:n}}
return this.buildAndExecuteRoamingSettingsRequest(o,"trySetRoamingSettings")},p.prototype.tryGetRoamingSettings=function(e){var t=null
if(null==e)return t
var n=f.getRoamingSettingsKeyString(e)
return t=Office.context.roamingSettings.get(n)},p.prototype.tryRemoveRoamingSettings=function(e,t){var n=f.getRoamingSettingsKeyString(t)
Office.context.roamingSettings.remove(n)
var r={rsType:e,data:{key:n}}
return this.buildAndExecuteRoamingSettingsRequest(r,"tryRemoveRoamingSettings")},p.prototype.executeSaveAsyncCallbackInQueue=function(e){Office.context.roamingSettings.saveAsync(e)},p.prototype.buildAndExecuteRoamingSettingsRequest=function(e,t){var n=new l.RoamingSettingsRequest(e,c.FeatureName.RoamingSettings,u.LogEventType.Set,t,u.LogRequestType.IndirectAction)
return s.default.executeRequest(n)},p)
function p(){}t.RoamingSettingsAccessor=d,t.default=new d
var f=(g.getRoamingSettingsKeyString=function(e){return r[e]},g.getRoamingSettingsTypeString=function(e){return i[e]},g)
function g(){}t.RoamingSettingsUtils=f},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.TaskType=t.FollowUpType=t.ToDoType=void 0,(r=t.ToDoType||(t.ToDoType={}))[r.Commitment=0]="Commitment",r[r.Request=1]="Request",(o=t.FollowUpType||(t.FollowUpType={}))[o.ActionFollowUp=0]="ActionFollowUp",o[o.ReplyFollowUp=1]="ReplyFollowUp",(i=t.TaskType||(t.TaskType={}))[i.Commitment=0]="Commitment",i[i.Request=1]="Request",i[i.FollowUpActionRequest=2]="FollowUpActionRequest",i[i.FollowUpReplyRequest=3]="FollowUpReplyRequest",i[i.Unsupported=4]="Unsupported"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalInsightConverter=void 0
var r=n(0),o=n(855),i=r.__importDefault(n(52)),a=n(119),s=(u.convertToInsight=function(e){try{var t=o.ExternalInsightConverter_V2.convertToInsight(e)
if(t)return t}catch(e){}return null},u.prototype.convertToRunTimeInstanceData=function(e){var t=this.convertToRuntimeType(e)
return t.identifier=a.ExternalContextUtils_V2.getInsightIdentifier(e.value),t.doesSupportNudgeFeedback=i.default.doesSupportNudgeFeedback(e.value),t.doesSupportServerSideDislikeInsightAction=i.default.doesSupportServerSideDislikeInsightAction(e.value),t.doesSupportServerSideDismissAction=i.default.doesSupportServerSideDismissAction(e.value),t},u)
function u(){}t.ExternalInsightConverter=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),u=r.__importDefault(n(24)),o=r.__importDefault(n(102)),p=r.__importDefault(n(4)),i=r.__importDefault(n(376)),a=n(29),f=n(7),s=n(115),l=(g.getXMLExactlyOneElementOrThrow=function(e,t,n){if(!e){var r="Falsy xmlElementRoot when looking for tag "+n
throw p.default.logAssert(r,"EWS","XMLHelper.getXMLExactlyOneElementOrThrow"),new Error("XML Parsing failed. Unexpected null root element")}var o=e.getElementsByTagNameNS(t,n)
if(o&&1===o.length)return o[0]
var i=0
throw o&&(i=o.length),r="Expected exactly one "+n+" element in children of "+(e.nodeName||"documentRoot")+" with namespace "+t+", but found: ["+i+"] children",p.default.logAssert(r,"EWS","XMLHelper.getXMLExactlyOneElementOrThrow"),new Error("Too many or too few elements matching search tag in XML parsing")},g.getXMLFirstElement=function(e,t,n){var r=g.getXMLOptionalFirstElement(e,t,n)
if(r)return r
throw p.default.logAssert("No element matching the tag "+n,"XML","XMLHelper.getXMLFirstElement"),new Error("XML Parsing failed. No elements or too many elements matching the xmlTag")},g.getXMLElementsByTagNamesNS=function(t,n,e){if(t)return i.default(e.map(function(e){return t.getElementsByTagNameNS(n,e)}),function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n])
return t})
var r="Falsy xmlElementRoot when looking for tags "+JSON.stringify(e)
throw p.default.logAssert(r,"EWS","XMLHelper.getXMLElementsByTagNamesNS"),new Error("XML Parsing failed. Unexpected null root element")},g.getXMLOptionalFirstElement=function(e,t,n){if(!e){var r="Falsy xmlElementRoot when looking for tag "+n
throw p.default.logAssert(r,"EWS","XMLHelper.getXMLOptionalFirstElement"),new Error("XML Parsing failed. Unexpected null root element")}var o=""===t?e.getElementsByTagName(n):e.getElementsByTagNameNS(t,n)
if(o&&0<o.length)return o[0]},g.getXMLOptionalFirstElementTextContent=function(e,t,n){var r="",o=this.getXMLOptionalFirstElement(e,t,n)
return o&&(r=this.getXMLElementTextContentOrEmpty(o)),r},g.getXMLElementTextContentOrEmpty=function(e){var t=""
return e&&(t=e.textContent),t},g.parseEWSIdentifierFromIdElement=function(e){var t=e.attributes.getNamedItem("Id").value,n=null,r=e.attributes.getNamedItem("ChangeKey")
return r&&(n=r.value),{id:t,changeKey:n}},g.getExactlyOneEWSIdentifierOrThrow=function(e,t){var n=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,t)
return g.parseEWSIdentifierFromIdElement(n)},g.getOptionalSingleEWSIdentifier=function(e,t){var n=g.getXMLOptionalFirstElement(e,f.Constants.EWSTypesNamespace,t)
if(void 0!==n)return g.parseEWSIdentifierFromIdElement(n)},g.extractResponseCode=function(e){if(!e)throw new Error("XMLHelper: Null xmlDoc provided.")
var t=e.getElementsByTagNameNS(f.Constants.EWSErrorsNamespace,"ResponseCode")
if(0===t.length&&(t=e.getElementsByTagNameNS(f.Constants.EWSMessagesNamespace,"ResponseCode")),0===t.length)return o.default.NO_RESPONSE_CODE
for(var n=0;n<t.length;n++)if(t[n].textContent!==o.default.NO_ERROR)return t[n].textContent
return o.default.NO_ERROR},g.extractBackOffMilliseconds=function(e){var t
if(!e)throw new Error("XMLHelper: Null xmlDoc provided.")
var n=e.getElementsByTagNameNS(f.Constants.EWSTypesNamespace,"Value")
return 0<n.length&&"BackOffMilliseconds"===(null===(t=n[0].getAttributeNode("Name"))||void 0===t?void 0:t.value)?Number(n[0].textContent):null},g.parseSenderFromXMLElement=function(e,t){void 0===t&&(t="")
var n=g.getXMLOptionalFirstElement(e,f.Constants.EWSTypesNamespace,"Sender")
if(n||!t)return g.parsePersonFromMailboxElement(n,t)
p.default.logWarning("No sender for an item.",t,"parseSenderFromXMLElement")},g.parseRecipientsFromMessageElement=function(e,t,n){var r=e.getElementsByTagNameNS(f.Constants.EWSTypesNamespace,t)
if(0===r.length)return[]
for(var o=[],i=r[0].getElementsByTagNameNS(f.Constants.EWSTypesNamespace,"Mailbox"),a=0;a<i.length;a++){var s=this.parsePersonFromMailboxElement(i[a],n)
s&&o.push(s)}return o},g.parseConversationIdFromXMLElement=function(e){return g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"ConversationId").attributes.getNamedItem("Id").value},g.parseInternetMessageIdFromXMLElement=function(e){return g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"InternetMessageId").textContent},g.parseWorkingHourConfigFromXMLElement=function(e,t){var n=g.getXMLOptionalFirstElement(e,f.Constants.EWSTypesNamespace,"WorkingHours")
if(n){var r=g.getXMLOptionalFirstElement(n,f.Constants.EWSTypesNamespace,"TimeZone"),o=g.getXMLOptionalFirstElementTextContent(n,f.Constants.EWSTypesNamespace,"Bias").trim(),i=g.getXMLFirstElement(n,f.Constants.EWSTypesNamespace,"WorkingPeriod"),a=g.getXMLOptionalFirstElementTextContent(i,f.Constants.EWSTypesNamespace,"StartTimeInMinutes").trim(),s=g.getXMLOptionalFirstElementTextContent(i,f.Constants.EWSTypesNamespace,"EndTimeInMinutes").trim(),u=g.getXMLOptionalFirstElementTextContent(i,f.Constants.EWSTypesNamespace,"DayOfWeek").trim()
if(o&&a&&s&&u){var l=parseInt(a,10),c=parseInt(s,10),d=parseInt(o,10)
if(!(isNaN(l)||isNaN(c)||isNaN(d)))return{startTimeInMinute:l,endTimeInMinute:c,timeZoneBiasInMinute:d,daylightTimeSetting:this.parseDaylightSetting(r,d),workingDays:g.parseWorkDays(u)}
p.default.logWarning("parseInt return NaN.",t,"parseWorkingHourConfigFromXMLElement")}else p.default.logWarning("Couldn't get valid element of WorkingHours config.",t,"parseWorkingHourConfigFromXMLElement")}else p.default.logWarning("Couldn't get WorkingHours config.",t,"parseWorkingHourConfigFromXMLElement")},g.parseWorkDays=function(e){var o=a.WorkingHours.DEFAULT_WORKDAY_SCHEDULE
return e&&(o=[0,0,0,0,0,0,0],e.split(" ").forEach(function(e){var t,n=e.toLocaleLowerCase()
if("day"===n||"alldays"===n)o=[1,1,1,1,1,1,1]
else if("weekday"===n||"weekdays"===n)for(var r=1;r<6;r++)o[r]=1
else"weekendday"===n||"weekenddays"===n?(o[0]=1,o[6]=1):"none"===n?o=[0,0,0,0,0,0,0]:(t=u.default.convertToDayOfWeek(n),o[t]=1)})),{workingDaysSundayStart:o}},g.getMessageAndMeetingRequestElements=function(e){for(var t=[],n=e.getElementsByTagNameNS(f.Constants.EWSTypesNamespace,"*"),r=0;r<n.length;r++)"MeetingRequest"!==n[r].localName&&"Message"!==n[r].localName||t.push(n[r])
return t},g.parseEmailItemBaseFromXMLElement=function(e,t){return{itemId:g.parseEWSIdentifierFromIdElement(g.getXMLFirstElement(e,f.Constants.EWSTypesNamespace,"ItemId")),subject:g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"Subject"),dateTimeSent:g.parseDateTimeSentFromXMLElement(e,t),internetMsgId:g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"InternetMessageId")}},g.parseMergedFreeBusyArrayFromElement=function(e){var t=g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"MergedFreeBusy")
return""===t?(p.default.logAssert("Couldn't get MergedFreeBusy element.","XMLHelper","parseMergedFreeBusyArrayFromElement"),null):t.split("").map(function(e){return a.CalendarTypeUtils.numberToBusyStatus(+e)})},g.parseWorkHours=function(e,t){var n,r,o=u.default.startOfDay(new Date)
return e&&t?{startDate:n=u.default.setTimeOnDate(o,e),endDate:r=u.default.setTimeOnDate(o,t)}:((n=new Date(o.getTime())).setHours(a.WorkingHours.DEFAULT_WORKHOUR_START),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),(r=new Date(o.getTime())).setHours(a.WorkingHours.DEFAULT_WORKHOUR_END),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),{startDate:n,endDate:r})},g.parsePersonFromMailboxElement=function(e,t){if(!e)return null
var n=g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"MailboxType")
if("Mailbox"!==n&&"Contact"!==n&&"OneOff"!==n)return t&&p.default.logWarning("Found person with non-mailbox or non-contact mailbox. Skipping.",t,"parsePersonFromMailboxElement"),null
var r=g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"Name"),o=g.getXMLOptionalFirstElementTextContent(e,f.Constants.EWSTypesNamespace,"EmailAddress")
return o?{name:r||o,smtpAddress:o.toLowerCase(),mailboxType:s.MailboxType[n]}:(t&&p.default.logWarning("Found person without an email address. Skipping.",t,"parsePersonFromMailboxElement"),null)},g.parseDateTimeSentFromXMLElement=function(e,t){void 0===t&&(t="")
var n=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"DateTimeSent"),r=new Date(g.getXMLElementTextContentOrEmpty(n))
return r&&r.getTime()?r:(t&&p.default.logWarning("Not a valid sentTime.",t,"parseDateTimeSentFromXMLElement"),null)},g.parseDaylightSetting=function(e,t){if(e){var n=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"StandardTime"),r=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"DaylightTime"),o=this.parseDaylightTime(n,t),i=this.parseDaylightTime(r,t),a=g.getXMLExactlyOneElementOrThrow(r,f.Constants.EWSTypesNamespace,"Bias").textContent
if(o&&i)return{biasInMinute:parseInt(a,10),daylightTimeStart:i,daylightTimeEnd:o}}},g.parseDaylightTime=function(e,t){var n=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"Time").textContent,r=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"DayOrder").textContent,o=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"Month").textContent,i=g.getXMLExactlyOneElementOrThrow(e,f.Constants.EWSTypesNamespace,"DayOfWeek").textContent,a=parseInt(r,10),s=parseInt(o,10)
return u.default.parseDaylightTimeTransitionDate(s,a,i,n,t)},g)
function g(){}t.default=l},,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(39)),o=(i.convertObservation=function(e,t){r.default.throwIfUndefinedOrNull("observations",e)
var n=e.filter(function(e){return e.Name===t})
return r.default.throwIfNotExactlyOneElement(t,n),n[0].Value},i.convertAndValidateStringObservation=function(e,t){var n=this.convertObservation(e,t)
return r.default.throwIfUndefinedOrEmptyString(t,n),n},i.checkObservationExists=function(e,t){return r.default.throwIfUndefinedOrNull("observations",e),0<e.filter(function(e){return e.Name===t}).length},i)
function i(){}t.default=o},,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamStoreBase=t.DataStreamStoreStateBase=void 0
var r=n(0),o=r.__importDefault(n(61)),i=n(5),a=(Object.defineProperty(s.prototype,"lastUpdatedTime",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),r.__decorate([i.doop],s.prototype,"lastUpdatedTime",null),s=r.__decorate([i.doop],s))
function s(){}t.DataStreamStoreStateBase=a
var u,l=(u=o.default,r.__extends(c,u),c.prototype.dataSource=function(){return{dataSourceType:this.wellKnownDataSourceType,storeName:this.getStoreLoggingName(),lastUpdatedTimeInTicks:this.getState().lastUpdatedTime()}},c.prototype.onStateHasChanged=function(e,t,n){return u.prototype.onStateHasChanged.call(this,e,t.lastUpdatedTime(Date.now()),n)},c)
function c(){return null!==u&&u.apply(this,arguments)||this}t.DataStreamStoreBase=l,t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EWSRequestBase=void 0
var a,r=n(0),s=r.__importDefault(n(282)),o=r.__importDefault(n(102)),i=n(7),u=n(5),l=n(377),c=(a=l.RequestBase,r.__extends(d,a),Object.defineProperty(d.prototype,"logCreator",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"additionalFieldURIProperties",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"additionalExtendedFieldURIProperties",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"nonFatalErrorCodes",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.getSoapEnvelope=function(){return'<?xml version="1.0" encoding="utf-8"?>\n             <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                           xmlns:xsd="http://www.w3.org/2001/XMLSchema"\n                           xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"\n                           xmlns:t="'+i.Constants.EWSTypesNamespace+'"\n                           xmlns:m="'+i.Constants.EWSMessagesNamespace+'">\n                <soap:Header>\n                    <t:RequestServerVersion Version="Exchange2016" />\n                </soap:Header>\n                <soap:Body>\n                    '+this.getSOAPRequest()+"\n                </soap:Body>\n            </soap:Envelope>"},d.prototype.getlogCreator=function(){return this.logCreator()},d.prototype.isNonFatalErrorCode=function(e){return 0<=r.__spreadArrays([o.default.ERROR_SERVER_BUSY,o.default.ERROR_MAILBOX_MOVE_IN_PROGRESS,o.default.ERROR_INTERNAL_SERVER_TRANSIENT_ERROR,o.default.ERROR_MAILBOX_STORE_UNAVAILABLE],this.nonFatalErrorCodes()).indexOf(e)},d.prototype.buildFieldURIPropertiesElements=function(){return this.additionalFieldURIProperties().map(function(e){return'<t:FieldURI FieldURI="'+e+'" />'}).join(" ")},d.prototype.buildExtendedFieldURIPropertiesElement=function(){return this.additionalExtendedFieldURIProperties().map(function(e){return e.buildXMLString()}).join(" ")},r.__decorate([u.doop],d.prototype,"logCreator",null),r.__decorate([u.doop],d.prototype,"additionalFieldURIProperties",null),r.__decorate([u.doop],d.prototype,"additionalExtendedFieldURIProperties",null),r.__decorate([u.doop],d.prototype,"nonFatalErrorCodes",null),d=r.__decorate([u.doop],d))
function d(e,t,n,r,o){var i=a.call(this)||this
return i.additionalExtendedFieldURIProperties([]),i.additionalFieldURIProperties([]),i.logCreator(new s.default(e,t,n,r,o,i.requestId())),i.nonFatalErrorCodes([]),i}t.EWSRequestBase=c},,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentItemActionCreator=void 0
var u=n(0),r=u.__importDefault(n(369)),l=u.__importDefault(n(480)),c=u.__importStar(n(115)),o=u.__importStar(n(144)),a=u.__importStar(n(34)),d=u.__importDefault(n(3)),i=u.__importDefault(n(54)),p=u.__importDefault(n(8)),f=u.__importDefault(n(37)),g=u.__importDefault(n(11)),m=u.__importDefault(n(102)),h=u.__importDefault(n(90)),y=u.__importDefault(n(803)),s=u.__importDefault(n(283)),_=u.__importDefault(n(804)),S=u.__importDefault(n(35)),T=u.__importDefault(n(6)),I=u.__importDefault(n(68)),b=u.__importStar(n(4)),E=n(51),v=n(7),A=u.__importDefault(n(25)),D=n(131),O=(C.prototype.getMessageId=function(){return u.__awaiter(this,void 0,void 0,function(){var t,n,r
return u.__generator(this,function(e){switch(e.label){case 0:return n=t={internetMessageId:null,sourceMethod:"Default"},(r=f.default.asReadItem())&&f.default.getState().isMessage()?[4,this.loadInternetMessageIdForItem(r)]:[3,2]
case 1:n=e.sent()||t,e.label=2
case 2:return g.default.dispatch({actionType:d.default.GetInternetMessageId,internetMessageId:n.internetMessageId}),[2]}})})},C.prototype.getCurrentComposeItemProperties=function(){var e,t
f.default.getState().isCompose()&&(f.default.getState().isAppointmentOrMeeting()?(e=f.default.asComposeAppointment(),A.default.isInBackgroundMode||(this.onAppointmentRequiredRecipientChanged(e),this.onAppointmentOptionalRecipientsChanged(e)),this.onAppointmentRecurrenceObjectChanged(e),this.onAppointmentTimeChanged(e),this.onAttachmentObjectChanged(e)):f.default.getState().isMessage()&&(t=f.default.asComposeMessage(),this.onAttachmentObjectChanged(t),this.getMessageComposeType(),A.default.isInBackgroundMode||(this.onMessageToRecipientChanged(t),this.onMessageCcRecipientChanged(t),this.onMessageBccRecipientChanged(t))))},C.prototype.onMessageToRecipientChanged=function(e){var t=this
e.to.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?b.default.logAssert("Get to recipient for current composing message failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"ToRecipientsChangedEvent"):t.dispatchRecipientsChanged(e.value,d.default.GetComposeMessageToRecipients)})},C.prototype.onMessageCcRecipientChanged=function(e){var t=this
e.cc.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?b.default.logAssert("Get cc recipient for current composing message failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"CcRecipientsChangedEvent"):t.dispatchRecipientsChanged(e.value,d.default.GetComposeMessageCcRecipients)})},C.prototype.onMessageBccRecipientChanged=function(e){var t=this
e.bcc.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?b.default.logAssert("Get bcc recipient for current composing message failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"BccRecipientsChangedEvent"):t.dispatchRecipientsChanged(e.value,d.default.GetComposeMessageBccRecipients)})},C.prototype.onAppointmentRequiredRecipientChanged=function(n){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getRequiredAttendeeList(n)]
case 1:return t=e.sent(),this.dispatchRecipientsChanged(t,d.default.GetComposeMeetingRequiredRecipients),[3,3]
case 2:return e.sent(),[2]
case 3:return[2]}})})},C.prototype.onAppointmentOptionalRecipientsChanged=function(n){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getOptionalAttendeeList(n)]
case 1:return t=e.sent(),this.dispatchRecipientsChanged(t,d.default.GetComposeMeetingOptionalRecipients),[3,3]
case 2:return e.sent(),[2]
case 3:return[2]}})})},C.prototype.onAppointmentBothFieldsChanged=function(a){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i=this
return u.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all([this.getRequiredAttendeeList(a).then(function(e){return i.addMemberCountToRecipientObject(e)}),this.getOptionalAttendeeList(a).then(function(e){return i.addMemberCountToRecipientObject(e)})])]
case 1:return t=e.sent(),n=t[0],r=t[1],g.default.dispatch({actionType:d.default.GetComposeMeetingRequiredAndOptionalRecipients,requiredAttendees:n,optionalAttendees:r}),[3,3]
case 2:return o=e.sent(),b.default.logAssert("get attendee fails due to exception "+JSON.stringify(o),D.FeatureName.CurrentItemActionCreator,"onAppointmentBothFieldsChanged"),[3,3]
case 3:return[2]}})})},C.prototype.isNewComposeMeeting=function(){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(e){switch(e.label){case 0:return f.default.getState().isCompose()&&f.default.getState().isAppointmentOrMeeting()?[4,this.getComposingItemSubject()]:[3,2]
case 1:if(e.sent())return this.dispatchIsNewComposeMeeting(!1),[2]
e.label=2
case 2:return[2]}})})},C.prototype.getComposingItemSubject=function(){var n=this,r=f.default.asComposeItem()
return r?new Promise(function(t,e){r.subject.getAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):(n.getSubjectInternalServerErrorHasBeenLogged||(n.getSubjectInternalServerErrorHasBeenLogged=!0,b.default.logAssert("Get subject for current composing item failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,D.SourceName.GetSubject)),t(""))})}):new Promise(function(e,t){b.default.logAssert("Get subject for current composing item failed as the composing item is null",D.FeatureName.CurrentItemActionCreator,D.SourceName.GetSubject),e("")})},C.prototype.loadInternetMessageIdForItem=function(o){return u.__awaiter(this,void 0,void 0,function(){var t,n,r
return u.__generator(this,function(e){switch(e.label){case 0:return o.internetMessageId?[2,{internetMessageId:o.internetMessageId,sourceMethod:"Local"}]:[3,1]
case 1:return t=new s.default(D.FeatureName.CurrentItemActionCreator,b.LogEventType.Get,"GetMessageId_EWS",b.LogRequestType.Interval).additionalFieldURIProperties(["message:InternetMessageId"]).itemIds([{id:o.itemId}]),[4,h.default.executeRequest(t)]
case 2:if((n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(r=h.default.processEWSResultWithSafeCallback(n,this.processGetItemResponse.bind(this))).isSuccess)return[2,r.result]
e.label=3
case 3:return[2,void 0]}})})},C.prototype.processGetItemResponse=function(e){var t=e.result
return{internetMessageId:I.default.parseInternetMessageIdFromXMLElement(t),sourceMethod:"EWS"}},C.prototype.onAppointmentTimeChanged=function(n){var r=this
Promise.all([new Promise(function(t,e){n.start.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?(b.default.logAssert("Get start date for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"AppointmentTimeChangedEvent"),t(null)):t(new Date(e.value))})}),new Promise(function(t,e){n.end.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?(b.default.logAssert("Get end date for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"AppointmentTimeChangedEvent"),t(null)):t(new Date(e.value))})})]).then(function(e){var t=e[0],n=e[1]
t&&n&&r.dispatchAppointmentTimeChanged(t,n)})},C.prototype.onAppointmentRecurrenceObjectChanged=function(e){var t=this
i.default.doesSupportRecurrenceMeetingApi&&p.default.isRecurrenceApiEnabled&&e.recurrence.getAsync(function(e){e.status===Office.AsyncResultStatus.Failed?b.default.logAssert("Get recurrence results for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"RecurrenceChangedEvent"):t.dispatchRecurrenceObjectChanged(e.value)})},C.prototype.onAttachmentObjectChanged=function(e){var t=this
i.default.doesSupportAttachmentApi&&e.getAttachmentsAsync(function(e){e.status===Office.AsyncResultStatus.Failed?b.default.logAssert("Get attachments results for current composing item failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"AttachmentsChangedEvent"):t.dispatchAttachmentsChanged(e.value)})},C.prototype.getMessageComposeType=function(){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){if(t=f.default.asComposeMessage(),i.default.doesSupportMessageComposeType&&t)try{t.getComposeTypeAsync(function(e){e.status===Office.AsyncResultStatus.Failed?(b.default.logAssert("Get message compose type for current composing item failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"getMessageComposeType"),g.default.dispatch({actionType:d.default.GetComposeMessageType,composeType:o.ItemTypes.Unknown})):g.default.dispatch({actionType:d.default.GetComposeMessageType,composeType:e.value.composeType})})}catch(e){b.default.logAssert("Unable to get message compose type. Exception: ["+e.message+"]",D.FeatureName.CurrentItemActionCreator,"getMessageComposeType")}return[2]})})},C.prototype.dispatchRecipientsChanged=function(e,t){e=this.removeAndLogEmptyEmailAddressRecipients(e),this.addMemberCountToRecipientObject(e).then(function(e){g.default.dispatch({actionType:t,composingRecipients:e})})},C.prototype.removeAndLogEmptyEmailAddressRecipients=function(e){var t=e.filter(function(e){return!!e.emailAddress})
return t.length<e.length&&b.default.logWarning("Office.jS GetAsync api provided an empty email",D.FeatureName.CurrentItemActionCreator,"removeAndLogEmptyEmailAddressRecipients"),t},C.prototype.dispatchAppointmentTimeChanged=function(e,t){g.default.dispatch({actionType:d.default.GetComposeMeetingTime,meetingStartTime:e,meetingEndTime:t})},C.prototype.dispatchRecurrenceObjectChanged=function(e){g.default.dispatch({actionType:d.default.GetComposeMeetingRecurrence,recurrence:e})},C.prototype.dispatchAttachmentsChanged=function(e){g.default.dispatch({actionType:d.default.GetComposeItemAttachments,attachments:e})},C.prototype.updateMeetingRecurringSeries=function(e){var t,n
i.default.doesSupportRecurrenceMeetingApi&&((t=r.default(f.default.getState().recurrence())).seriesTime.setDuration(e),n=f.default.asComposeAppointment(),this.addWindowTimeout(function(){return n.recurrence.setAsync(t,function(e){e.status===Office.AsyncResultStatus.Failed&&b.default.logAssert("Set recurring duration for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"updateMeetingSeriesDuration")})}))},C.prototype.updateMeetingStartTime=function(e){var n=f.default.asComposeAppointment()
return new Promise(function(t){n.start.setAsync(e,function(e){e.status===Office.AsyncResultStatus.Failed?(b.default.logAssert("Set start time for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"updateMeetingStartTime"),t(!1)):t(!0)})})},C.prototype.updateMeetingEndTime=function(e){var n=f.default.asComposeAppointment()
return new Promise(function(t){n.end.setAsync(e,function(e){e.status===Office.AsyncResultStatus.Failed?(b.default.logAssert("Set end time for current composing meeting failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"updateMeetingEndTime"),t(!1)):t(!0)})})},C.prototype.openReplyForm=function(e){var t=f.default.asReadItem()
t?t.displayReplyForm(e):b.default.logAssert("Unable to open reply form as not in read mode",D.FeatureName.CurrentItemActionCreator,"openReplyForm")},C.prototype.updateEmailPropertiesFromConversation=function(){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s
return u.__generator(this,function(e){switch(e.label){case 0:return(t=f.default.asComposeMessage())?(n=!!t.conversationId,o=!(r=[]),t.conversationId?(i=new y.default(D.FeatureName.CurrentItemActionCreator,b.LogEventType.Get,"getConversationItem",b.LogRequestType.Interval).conversationIds([t.conversationId]).nonFatalErrorCodes([m.default.ERROR_ITEM_NOT_FOUND]).maxRetries(0),[4,h.default.executeRequest(i)]):[3,3]):[2]
case 1:return(a=e.sent()).error===m.default.ERROR_ITEM_NOT_FOUND&&(n=!1),n&&a.status===Office.AsyncResultStatus.Succeeded&&p.default.isEstimateToRecipientsEnabled&&(s=h.default.processEWSResultWithSafeCallback(a,this.parseGetConversationItemsResponse.bind(this))).isSuccess?[4,this.getInternalRecipients(s.result)]:[3,3]
case 2:r=e.sent(),o=r.length!==s.result.length,e.label=3
case 3:return g.default.dispatch({actionType:d.default.UpdateEmailProperties,estimatedToRecipients:r,isInConversation:n,hasExternalRecipients:o}),[2]}})})},C.prototype.parseGetConversationItemsResponse=function(e){for(var t=[],n=e.result.getElementsByTagNameNS(v.Constants.EWSTypesNamespace,"ConversationNode"),r=0;r<n.length;r++){var o,i=n[r].getElementsByTagNameNS(v.Constants.EWSTypesNamespace,"Message")
0!==i.length&&"IPM.Note"===I.default.getXMLOptionalFirstElementTextContent(i[0],v.Constants.EWSTypesNamespace,"ItemClass")&&(o=I.default.parseRecipientsFromMessageElement(i[0],"ToRecipients",D.FeatureName.CurrentItemActionCreator),t=t.concat(o))}return T.default.dedupObjectArrayByKey(t,function(e){return e.smtpAddress},function(e){return e[0]}).filter(function(e){return e.smtpAddress!==T.default.userEmailLowerCase})},C.prototype.dispatchIsNewComposeMeeting=function(e){g.default.dispatch({actionType:d.default.GetIsNewComposeMeeting,isNewComposeMeeting:e})},C.prototype.addWindowTimeout=function(e){setTimeout(e,0)},C.prototype.addMemberCountToRecipientObject=function(i){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return u.__generator(this,function(e){switch(e.label){case 0:return t=i.map(function(e){return{displayName:e.displayName,emailAddress:e.emailAddress.toLowerCase(),recipientType:e.recipientType,totalMemberCount:0,externalMemberCount:0}}),n=c.IRecipientType.User,r=t.filter(function(e){return e.recipientType===n}).map(function(e){return e.totalMemberCount=1,e.externalMemberCount=0,e}),[4,this.getMemberCountFromMailTips(t.filter(function(e){return e.recipientType!==n}))]
case 1:return o=e.sent(),[2,u.__spreadArrays(r,o)]}})})},C.prototype.getMemberCountFromMailTips=function(i){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return u.__generator(this,function(e){switch(e.label){case 0:return 0===i.length?[2,i]:(t=i.map(function(e){return e.emailAddress}),n=new _.default(D.FeatureName.CurrentItemActionCreator,"getMemberCountFromMailTips",b.LogRequestType.IndirectAction).emailAddresses(t).mailTipsOptions(["ExternalMemberCount","TotalMemberCount"].join(",")),[4,S.default.executeRequest(n,a.RequestPriority.High)])
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(o=r.result.value,i.forEach(function(t){var e=l.default(o,function(e){return e.EmailAddress.Address===t.emailAddress})
e&&(t.totalMemberCount=e.TotalMemberCount||0,t.externalMemberCount=e.ExternalMemberCount||0)})),[2,i]}})})},C.prototype.getInternalRecipients=function(s){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a=this
return u.__generator(this,function(e){switch(e.label){case 0:return t=s.map(function(e){return e.smtpAddress}),n=new _.default(D.FeatureName.CurrentItemActionCreator,"getRecipientScopeFromMailTips",b.LogRequestType.IndirectAction).emailAddresses(t).mailTipsOptions("RecipientScope").maxRetries(0),[4,S.default.executeRequest(n)]
case 1:return r=e.sent(),o=[],r.status===Office.AsyncResultStatus.Succeeded&&(i=r.result.value,s.forEach(function(t){var e=l.default(i,function(e){return e.EmailAddress.Address===t.smtpAddress})
e&&a.isInternalRecipient(e.RecipientScope)&&o.push({displayName:t.name,emailAddress:t.smtpAddress,externalMemberCount:0,totalMemberCount:1,recipientType:c.IRecipientType.User})})),[2,o]}})})},C.prototype.isInternalRecipient=function(e){return-1!==e.indexOf("Internal")},C.prototype.getRequiredAttendeeList=function(e){return new Promise(function(t,n){e.requiredAttendees.getAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):(b.default.logAssert("Get required attendees for appointment composing failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"getRequiredAttendeeList"),n(e.error))})})},C.prototype.getOptionalAttendeeList=function(e){return new Promise(function(t,n){e.optionalAttendees.getAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):(b.default.logAssert("Get optional attendees for appointment composing failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"getOptionalAttendeeList"),n(e.error))})})},C.prototype.getAppointmentComposeCustomProperty=function(n,r,o){return new Promise(function(t,e){n.loadCustomPropertiesAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value.get(r)):(b.default.logAssert("Load custom properties to get "+r+" for current composing appointment failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"getAppointmentComposeCustomProperty_"+o),t(!1))})})},C.prototype.setAppointmentComposeCustomProperty=function(e,r,o,i){return new Promise(function(n){e.loadCustomPropertiesAsync(function(e){var t
e.status===Office.AsyncResultStatus.Succeeded?((t=e.value).set(r,o),t.saveAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?n(!0):(b.default.logAssert("Save "+r+" for current composing appointment failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"setAppointmentComposeCustomProperty_"+i),n(!1))})):(b.default.logAssert("Load custom properties to set "+r+" for current composing appointment failed with error: "+e.error.message,D.FeatureName.CurrentItemActionCreator,"setAppointmentComposeCustomProperty_"+i),n(!1))})})},u.__decorate([E.expirable(E.ExpirationTypes.ByItemChange)],C.prototype,"getMessageId",null),C=u.__decorate([E.expirable()],C))
function C(){this.getSubjectInternalServerErrorHasBeenLogged=!1}t.CurrentItemActionCreator=O,t.default=new O},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var l=n(0),c=l.__importStar(n(34)),d=l.__importDefault(n(102)),p=l.__importDefault(n(4)),f=l.__importDefault(n(375)),r=l.__importDefault(n(199)),o=l.__importDefault(n(6)),g=l.__importDefault(n(68)),m=n(7),i=l.__importDefault(n(798)),a=(h.executeRequest=function(r,o){return void 0===o&&(o=c.RequestPriority.Normal),l.__awaiter(this,void 0,void 0,function(){var t,n
return l.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,f.default.executePromiseWithRetry(r,this.executeRequestPromise,o)]
case 1:return(t=e.sent()).status===Office.AsyncResultStatus.Succeeded?r.logCreator().success():t.status===Office.AsyncResultStatus.Failed&&r.isNonFatalErrorCode(t.error)?r.logCreator().expectedFail(t.error):r.logCreator().ewsFail(t.error),[2,t]
case 2:return n=e.sent(),p.default.logUnhandledPromiseRejection(n,h.LOG_FEATURE_NAME,"executeRequest"),[2,{status:Office.AsyncResultStatus.Failed,result:null,error:n,sourceRequest:r}]
case 3:return[2]}})})},h.executeRequestSupportingPartialSuccess=function(i,a,s,u){return void 0===u&&(u=c.RequestPriority.Normal),l.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return l.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,f.default.executePromiseRetryWithPartialSuccess(i,this.executeRequestPromise,a,s,u)]
case 1:return(t=e.sent()).status===Office.AsyncResultStatus.Succeeded?(n=Object.keys(t.result).length,r=i.getTotalItemCountInside()-n,i.getlogCreator().batchCompleted(n,r)):i.logCreator().ewsFail(t.error),[2,t]
case 2:return o=e.sent(),p.default.logUnhandledPromiseRejection(o,h.LOG_FEATURE_NAME,"executeRequestSupportingPartialSuccess"),[2,{status:Office.AsyncResultStatus.Failed,result:{},error:o,sourceRequest:i}]
case 3:return[2]}})})},h.processEWSResultWithSafeCallback=function(t,e){var n={isSuccess:!1,result:null,error:null}
try{return n.result=e(t),n.isSuccess=!0,n}catch(e){n.isSuccess=!1
var r=o.default.scrubXMLFromException(e)
return t.sourceRequest.logCreator().ewsFailWithDebuggingInformation("[XML Parsing Error] "+r,t.result),n.error=r,n}},h.processEWSResultByParseHandler=function(i,a){for(var s=[],u=i.result.getElementsByTagNameNS(m.Constants.EWSMessagesNamespace,i.sourceRequest.getParseXMLTag()),l=this,e=0;e<u.length;e++)!function(e){var t,n=g.default.getXMLExactlyOneElementOrThrow(u[e],m.Constants.EWSMessagesNamespace,"ResponseCode"),r=g.default.getXMLElementTextContentOrEmpty(n),o={isSuccess:!1,result:null,error:r,shouldRetry:!0}
r===d.default.NO_ERROR&&(t={error:"",status:i.status,result:u[e],sourceRequest:i.sourceRequest,responseStatusCode:i.responseStatusCode},o=h.processEWSResultWithSafeCallback(t,a.bind(l))),r!==d.default.NO_ERROR&&!i.sourceRequest.getIgnoredRetryErrorCodes().some(function(e){return e===r})||(o.shouldRetry=!1),s.push(o)}(e)
return s},h.executeRequestPromise=function(e,t){return void 0===t&&(t=c.RequestPriority.Normal),r.default.execute(function(){return i.default.generateRequestPromise(e)},t)},h.LOG_FEATURE_NAME="EWSService",h)
function h(){}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CalendarStore=t.CalendarStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=i.__importDefault(n(201)),c=i.__importDefault(n(202)),d=n(7),p=n(5),f=(r=u.CachedDataStreamStateBase,i.__extends(g,r),o=g,Object.defineProperty(g.prototype,"calendarItems",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"scheduleItems",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"meetingSuggestionCalendarItems",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"includedDateRange",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"workingHours",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"freeBlocksWithinWorkingHours",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"freeBlocks",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"hasLoadedCalendarItems",{get:function(){return p.doop()},enumerable:!1,configurable:!0}),g.prototype.toJSON=function(){return{calendarItems:this.calendarItems(),meetingSuggestionCalendarItems:this.meetingSuggestionCalendarItems(),freeBlocks:this.freeBlocks(),freeBlocksWithinWorkingHours:this.freeBlocksWithinWorkingHours(),hasLoadedCalendarItems:this.hasLoadedCalendarItems(),includedDateRange:this.includedDateRange(),workingHours:this.workingHours(),scheduleItems:this.scheduleItems()}},g.prototype.fromJSON=function(e){return(new o).calendarItems(e.calendarItems).meetingSuggestionCalendarItems(e.meetingSuggestionCalendarItems).freeBlocks(e.freeBlocks).freeBlocksWithinWorkingHours(e.freeBlocksWithinWorkingHours).hasLoadedCalendarItems(e.hasLoadedCalendarItems).workingHours(e.workingHours).includedDateRange(e.includedDateRange).scheduleItems(e.scheduleItems)},i.__decorate([p.doop],g.prototype,"calendarItems",null),i.__decorate([p.doop],g.prototype,"scheduleItems",null),i.__decorate([p.doop],g.prototype,"meetingSuggestionCalendarItems",null),i.__decorate([p.doop],g.prototype,"includedDateRange",null),i.__decorate([p.doop],g.prototype,"workingHours",null),i.__decorate([p.doop],g.prototype,"freeBlocksWithinWorkingHours",null),i.__decorate([p.doop],g.prototype,"freeBlocks",null),i.__decorate([p.doop],g.prototype,"hasLoadedCalendarItems",null),g=o=i.__decorate([p.doop],g))
function g(){var e=r.call(this)||this
return e.calendarItems([]),e.meetingSuggestionCalendarItems([]),e.freeBlocksWithinWorkingHours([]),e.freeBlocks([]),e.hasLoadedCalendarItems(!1),e}t.CalendarStoreState=f
var m,h=(m=u.default,i.__extends(y,m),y.prototype.getStoreLoggingName=function(){return"CalendarStore"},y.prototype.getInitialState=function(){return new f},y.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(y.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.CalendarData},enumerable:!1,configurable:!0}),y.prototype.processGetUserAvailability=function(e,t){return e=e.freeBlocks(t.userAvailability.freeTime),e=this.findFreeBlocksInWorkingHours(e)},y.prototype.processGetCalendarItems=function(e,t){return e=e.calendarItems(t.calendarItems).includedDateRange(t.includedDateRange).hasLoadedCalendarItems(!0),this.findFreeBlocksInWorkingHours(e)},y.prototype.processGetMeetingSuggestionCalendarItems=function(e,t){return e.meetingSuggestionCalendarItems(t.calendarItems)},y.prototype.processGetWorkingHours=function(e,t){return e=e.workingHours(t.workingHours),this.findFreeBlocksInWorkingHours(e)},y.prototype.processCreateCalendarItems=function(e,t){var n=this,r=t.calendarItems
e=e.calendarItems(e.calendarItems().concat(r))
var o=r.reduce(function(e,t){return n.removeFromFreeBlocks(e,t)},e.freeBlocksWithinWorkingHours())
return e=e.freeBlocks(o),this.findFreeBlocksInWorkingHours(e)},y.prototype.processManagerEffectivenessCalendarItem=function(e,t){var n=t.slot,r=this.removeFromFreeBlocks(e.freeBlocksWithinWorkingHours(),n)
return e=e.freeBlocks(r),this.findFreeBlocksInWorkingHours(e)},y.prototype.processDeleteCalendarItemsREST=function(e,t){var n,r=[]
if(e.calendarItems().forEach(function(e){e.identifier.id===t.calendarItem.identifier.id?n=e:r.push(e)}),!n)return e
var o=e.freeBlocksWithinWorkingHours()
return o.push(n),e=(e=e.calendarItems(r)).freeBlocks(o),this.findFreeBlocksInWorkingHours(e)},y.prototype.processUpdateFocusTimeSubject=function(e,t){for(var n=e.calendarItems(),r=0;r<n.length;r++)if(n[r].identifier.id===t.eventId){n[r].subject=t.subject
break}return e.calendarItems(n)},y.prototype.processGetSchedule=function(e,t){return e.scheduleItems(t.scheduleItems)},y.prototype.removeFromFreeBlocks=function(e,t){for(var n=[],r=0;r<e.length;++r)c.default.isWithin(t,e[r])?(e[r].startDate.getTime()!==t.startDate.getTime()&&n.push({startDate:e[r].startDate,endDate:t.startDate}),t.endDate.getTime()!==e[r].endDate.getTime()&&n.push({startDate:t.endDate,endDate:e[r].endDate})):n.push(e[r])
return n},y.prototype.findFreeBlocksInWorkingHours=function(t){if(0!==t.freeBlocks().length&&t.workingHours()){var e=new Date,n=t.workingHours().workingDays.workingDaysSundayStart,r=t.workingHours().workingHoursTimeBlock,o=t.freeBlocks().map(function(e){return l.default.trimTimeBlocksByWorkHours(e,r.startDate,r.endDate)})
return o=(o=o.filter(function(e){return 1===n[e.startDate.getDay()]&&1===n[e.endDate.getDay()]})).filter(function(e){return l.default.isWorkingTime(e,t.workingHours())}),o=this.getFreeBlocksByNow(o,new Date(this.roundToCeilingFifteenMinutes(e.getTime()))),t=t.freeBlocksWithinWorkingHours(o)}return t},y.prototype.getFreeBlocksByNow=function(e,t){var n,r=e.filter(function(e){return e.startDate>=t})
return e.some(function(e){return e.startDate<t&&e.endDate>t})&&((n=e.filter(function(e){return e.startDate<t&&e.endDate>t})[0]).startDate=t,r.push(n)),r},y.prototype.roundToCeilingFifteenMinutes=function(e){return 15*Math.ceil(e/(15*d.Constants.oneMinuteInMilliSeconds))*d.Constants.oneMinuteInMilliSeconds},y)
function y(){var e=m.call(this)||this
return e.addActionCallback(s.default.GetCalendarItems,e.processGetCalendarItems),e.addActionCallback(s.default.GetCalendarItemsForMeetingSuggestion,e.processGetMeetingSuggestionCalendarItems),e.addActionCallback(s.default.GetWorkingHours,e.processGetWorkingHours),e.addActionCallback(s.default.BookFocusBlock,e.processCreateCalendarItems),e.addActionCallback(s.default.AddTaskCalendarItem,e.processCreateCalendarItems),e.addActionCallback(s.default.AddDocumentCalendarItem,e.processCreateCalendarItems),e.addActionCallback(s.default.DeleteFocusBlock,e.processDeleteCalendarItemsREST),e.addActionCallback(s.default.UpdateFocusTime,e.processUpdateFocusTimeSubject),e.addActionCallback(s.default.GetUserAvailability,e.processGetUserAvailability),e.addActionCallback(s.default.GetScheduleItems,e.processGetSchedule),e.addActionCallback(s.default.DraftInviteToBook,e.processManagerEffectivenessCalendarItem),e.addActionCallback(s.default.RescheduleOneOnOne,e.processManagerEffectivenessCalendarItem),e.addActionCallback(s.default.BookFocusBlocks,e.processCreateCalendarItems),e}t.CalendarStore=h,t.default=new h},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserSettingsActionCreator=void 0
var l=n(0),c=l.__importDefault(n(3)),d=l.__importDefault(n(11)),p=l.__importStar(n(4)),f=l.__importDefault(n(35)),r=l.__importDefault(n(199)),g=l.__importDefault(n(845)),m=l.__importDefault(n(64)),o=l.__importStar(n(65)),i=l.__importDefault(n(237)),a=n(133),s=n(7),u=n(51),h=n(34),y=n(505),_=n(846),S=l.__importDefault(n(175)),T=l.__importDefault(n(8)),I=(b.prototype.getUserSettings=function(){return l.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u
return l.__generator(this,function(e){switch(e.label){case 0:return t=new g.default("UserSettingsActionCreator","getUserSettings",p.LogRequestType.Interval),n=m.default.getState().isMyAOptedOut(),r=m.default.getState().isAddInOptedOut(),void 0!==n&&void 0!==r&&void 0!==m.default.getState().isOutlookNotificationsEnabled()?((n||r)&&this.processOptedOut(),[2]):[4,f.default.executeWESRequest(t)]
case 1:return(o=e.sent()).status===Office.AsyncResultStatus.Succeeded?(i=o.result,a=i.ServiceSettings.IsOptedOut,s=i.FeatureSettings.IsAddInOptedOut,u=i.ActionsServiceSettings.OutlookNotificationsEnabled,a?this.processAndLogOptedOut("MyAnalytics"):(u||p.default.logWarning("Outlook notification is disabled","OutlookNotificationsEnabled","UserSettingsActionCreator"),s&&this.processAndLogOptedOut("AddIn")),d.default.dispatch({actionType:c.default.GetUserSettings,canOptOut:i.ServiceSettings.CanOptOut,hasVivaLicense:i.ServiceSettings.HasVivaLicense,vivaLicenseType:i.ServiceSettings.VivaLicenseType,isMyAOptedOut:a,isAddInOptedOut:s,isOutlookNotificationsEnabled:u,isProtectedTimeBookingOptedIn:i.FeatureSettings.IsProtectedTimeBookingOptedIn,isAutoDelayDeliveryOptedIn:i.FeatureSettings.IsAutoDelayDeliveryOptedIn,isDigestEmailOptedOut:i.FeatureSettings.IsDigestEmailOptedOut,isDashboardOptedOut:i.FeatureSettings.IsDashboardOptedOut,isManagerInsightsOptedIn:!1!==i.FeatureSettings.IsManagerInsightsOptedIn})):(d.default.dispatch({actionType:c.default.FailedAjaxConnection}),S.default.updateDebugMessage("Failed to load user settings.")),[2]}})})},b.prototype.enableOutlookNotifications=function(){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.setOutlookNotificationsEnabled(!0)]
case 1:return(t=e.sent())&&i.default.resetTeachingMomentWithDelay(a.TeachingMomentTypes.InlineSuggestions),[2,t]}})})},b.prototype.disableOutlookNotifications=function(){return this.setOutlookNotificationsEnabled(!1)},b.prototype.setOutlookNotificationsEnabled=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return this.dispatchOutlookNotificationsByUser(n),t=new _.PatchActionsServiceSettingsRequestWES("UserSettingsActionCreator","patchOutlookNotificationsEnabled",p.LogRequestType.Action).settingName(_.ActionsServiceSettingNames.OutlookNotificationsEnabled).settingValue(n),[4,f.default.executeWESRequest(t,h.RequestPriority.High)]
case 1:return e.sent().status!==Office.AsyncResultStatus.Succeeded?(this.dispatchOutlookNotificationsByUser(!n),[2,!1]):[2,!0]}})})},b.prototype.setIsProtectedTimeBookingOptedIn=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return this.dispatchIsProtectedTimeBookingOptedInByUser(n),T.default.isTeamsFocusPlanEnabled?[3,2]:(t=new y.PatchUserSettingsRequestWES("UserSettingsActionCreator","patchIsProtectedTimeBookingOptedIn",p.LogRequestType.Action).isProtectedTimeBookingOptedIn(n),[4,f.default.executeWESRequest(t,h.RequestPriority.High)])
case 1:if(e.sent().status!==Office.AsyncResultStatus.Succeeded)return this.dispatchIsProtectedTimeBookingOptedInByUser(!n),[2,!1]
e.label=2
case 2:return[2,!0]}})})},b.prototype.setIsManagerInsightsOptedIn=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return t=new y.PatchUserSettingsRequestWES("UserSettingsActionCreator","patchIsManagerInsightsOptedIn",p.LogRequestType.Action).isManagerInsightsOptedIn(n),[4,f.default.executeWESRequest(t,h.RequestPriority.High)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded?(d.default.dispatch({actionType:c.default.UpdateManagerInsightsOptedInByUser,isManagerInsightsOptedIn:n}),[2,!0]):[2,!1]}})})},b.prototype.setIsAutoDelayDeliveryOptedIn=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return this.dispatchIsAutoDelayDeliveryOptedInByUser(n),t=new y.PatchUserSettingsRequestWES("UserSettingsActionCreator","patchIsAutoDelayDeliveryOptedIn",p.LogRequestType.Action).isAutoDelayDeliveryOptedIn(n),[4,f.default.executeWESRequest(t,h.RequestPriority.High)]
case 1:return e.sent().status!==Office.AsyncResultStatus.Succeeded?(this.dispatchIsAutoDelayDeliveryOptedInByUser(!n),[2,!1]):(n&&o.default.tryRemoveRoamingSettings(o.RoamingSettingsTypes.DelayDelivery,o.RoamingSettingsKeys.AutoDelayDeliveryAdvertisementCount),[2,!0])}})})},b.prototype.dispatchOutlookNotificationsByUser=function(e){d.default.dispatch({actionType:c.default.UpdateOutlookNotificationsByUser,isOutlookNotificationsEnabled:e})},b.prototype.dispatchIsProtectedTimeBookingOptedInByUser=function(e){d.default.dispatch({actionType:c.default.UpdateIsProtectedTimeBookingOptedInByUser,isProtectedTimeBookingOptedIn:e})},b.prototype.dispatchIsAutoDelayDeliveryOptedInByUser=function(e){d.default.dispatch({actionType:c.default.UpdateIsAutoDelayDeliveryOptedInByUser,isAutoDelayDeliveryOptedIn:e})},b.prototype.processAndLogOptedOut=function(e){this.processOptedOut(),p.default.logWarning("User is opted out "+e,"OptedOut","UserSettingsActionCreator")},b.prototype.processOptedOut=function(){r.default.resetQueue()},l.__decorate([u.expirable(u.ExpirationTypes.ByEvery_Minutes,s.Constants.oneDayInMinutes)],b.prototype,"getUserSettings",null),b=l.__decorate([u.expirable()],b))
function b(){}t.UserSettingsActionCreator=I,t.default=new I},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SearchContextInsightsStore=t.State=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(114)),l=n(5),c=(r=u.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"lockedInsightName",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"lockedExternalInsightType",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isAwaitingRequest",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"insightRequestsCount",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"latestRequestTimeInTicks",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"lastKnownEmailProperties",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"lastKnownMeetingProperties",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"detectOOFComposingInfobarInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"autoDelayDeliveryInfobarInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"suggestedDelayDeliveryInfobarInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"trackEmailInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"peopleCatchUpItemsInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"meetingPreparationInfobarInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasLoggedMessageComposeType",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).detectOOFComposingInfobarInsight(e.detectOOFComposingInfobarInsight).autoDelayDeliveryInfobarInsight(e.autoDelayDeliveryInfobarInsight).suggestedDelayDeliveryInfobarInsight(e.suggestedDelayDeliveryInfobarInsight).latestRequestTimeInTicks(e.latestRequestTimeInTicks).trackEmailInsight(e.trackEmailInsight).peopleCatchUpItemsInsight(e.peopleCatchUpItemsInsight).meetingPreparationInfobarInsight(e.meetingPreparationInfobarInsight).lockedInsightName(e.lockedInsightName).lockedExternalInsightType(e.lockedExternalInsightType).insightRequestsCount(e.insightRequestsCount).lastKnownEmailProperties(e.lastKnownEmailProperties).lastKnownMeetingProperties(e.lastKnownMeetingProperties).hasLoggedMessageComposeType(e.hasLoggedMessageComposeType)},d.prototype.toJSON=function(){return{detectOOFComposingInfobarInsight:this.detectOOFComposingInfobarInsight(),autoDelayDeliveryInfobarInsight:this.autoDelayDeliveryInfobarInsight(),suggestedDelayDeliveryInfobarInsight:this.suggestedDelayDeliveryInfobarInsight(),latestRequestTimeInTicks:this.latestRequestTimeInTicks(),trackEmailInsight:this.trackEmailInsight(),peopleCatchUpItemsInsight:this.peopleCatchUpItemsInsight(),meetingPreparationInfobarInsight:this.meetingPreparationInfobarInsight(),lockedInsightName:this.lockedInsightName(),lockedExternalInsightType:this.lockedExternalInsightType(),insightRequestsCount:this.insightRequestsCount(),lastKnownEmailProperties:this.lastKnownEmailProperties(),lastKnownMeetingProperties:this.lastKnownMeetingProperties(),hasLoggedMessageComposeType:this.hasLoggedMessageComposeType(),isAwaitingRequest:!1}},i.__decorate([l.doop],d.prototype,"lockedInsightName",null),i.__decorate([l.doop],d.prototype,"lockedExternalInsightType",null),i.__decorate([l.doop],d.prototype,"isAwaitingRequest",null),i.__decorate([l.doop],d.prototype,"insightRequestsCount",null),i.__decorate([l.doop],d.prototype,"latestRequestTimeInTicks",null),i.__decorate([l.doop],d.prototype,"lastKnownEmailProperties",null),i.__decorate([l.doop],d.prototype,"lastKnownMeetingProperties",null),i.__decorate([l.doop],d.prototype,"detectOOFComposingInfobarInsight",null),i.__decorate([l.doop],d.prototype,"autoDelayDeliveryInfobarInsight",null),i.__decorate([l.doop],d.prototype,"suggestedDelayDeliveryInfobarInsight",null),i.__decorate([l.doop],d.prototype,"trackEmailInsight",null),i.__decorate([l.doop],d.prototype,"peopleCatchUpItemsInsight",null),i.__decorate([l.doop],d.prototype,"meetingPreparationInfobarInsight",null),i.__decorate([l.doop],d.prototype,"hasLoggedMessageComposeType",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.latestRequestTimeInTicks(0),e.insightRequestsCount(0),e.isAwaitingRequest(!1),e}t.State=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.addActionCallbackWithRequestTimeCheck=function(e,r){var o=this
this.addActionCallback(e,function(e,t){if(o.isNewerResponseComparedToStoreState(t.requestTimeInTicks)){var n=o.getInitialState().insightRequestsCount(e.insightRequestsCount()).latestRequestTimeInTicks(t.requestTimeInTicks).lastKnownEmailProperties(e.lastKnownEmailProperties()).lastKnownMeetingProperties(e.lastKnownMeetingProperties()).lockedExternalInsightType(e.lockedExternalInsightType()).lockedInsightName(e.lockedInsightName())
return r(n,t)}return e})},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.SearchContextInsights},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"SearchContextInsightsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},g.prototype.processMeetingPreparationInfobar=function(e,t){return e.meetingPreparationInfobarInsight(t.insight)},g.prototype.processAutoDelayDelivery=function(e,t){return e.autoDelayDeliveryInfobarInsight(t.autoDelayDeliveryInfobar)},g.prototype.processSuggestedDelayDelivery=function(e,t){return e.suggestedDelayDeliveryInfobarInsight(t.suggestedDelayDeliveryInsight)},g.prototype.processTrackEmailInfobar=function(e,t){return e.trackEmailInsight(t.insight)},g.prototype.processPeopleCatchUpItemsInfobar=function(e,t){return e.peopleCatchUpItemsInsight(t.insight)},g.prototype.processDetectOOFComposing=function(e,t){return e.detectOOFComposingInfobarInsight(t.detectOOFComposingInfobar)},g.prototype.processUpsertLockedInsightNameAndType=function(e,t){return e.lockedInsightName(t.insightName).lockedExternalInsightType(t.externalInsightType)},g.prototype.processUpdateSearchContextInsightsRequestStatus=function(e,t){var n=t.isAwaitingRequest
if(n){var r=e.insightRequestsCount()
return e.isAwaitingRequest(n).insightRequestsCount(r+1)}return e.isAwaitingRequest(n)},g.prototype.processUpdateLastKnownEmailProperties=function(e,t){return e.lastKnownEmailProperties(t.properties)},g.prototype.processUpdateLastKnownMeetingProperties=function(e,t){return e.lastKnownMeetingProperties(t.properties)},g.prototype.processCleanUpInfobar=function(e,t){return e},g.prototype.isNewerResponseComparedToStoreState=function(e){return e>this.getState().latestRequestTimeInTicks()},g.prototype.setHasLoggedMessageComposeType=function(e,t){return e.hasLoggedMessageComposeType(t.logged)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.UpdateSearchContextInsightsRequestStatus,e.processUpdateSearchContextInsightsRequestStatus),e.addActionCallback(s.default.UpsertLockedInsightNameAndType,e.processUpsertLockedInsightNameAndType),e.addActionCallback(s.default.UpdateLastKnownEmailProperties,e.processUpdateLastKnownEmailProperties),e.addActionCallback(s.default.UpdateLastKnownMeetingProperties,e.processUpdateLastKnownMeetingProperties),e.addActionCallbackWithRequestTimeCheck(s.default.GetDetectOOFComposingInfobar,e.processDetectOOFComposing),e.addActionCallbackWithRequestTimeCheck(s.default.GetAutoDelayDeliveryInfobar,e.processAutoDelayDelivery),e.addActionCallback(s.default.SetHasLoggedComposeMessageType,e.setHasLoggedMessageComposeType),e.addActionCallbackWithRequestTimeCheck(s.default.GetSuggestedDelayDeliveryInfobar,e.processSuggestedDelayDelivery),e.addActionCallbackWithRequestTimeCheck(s.default.CleanUpInfobarInsight,e.processCleanUpInfobar),e.addActionCallbackWithRequestTimeCheck(s.default.TrackEmailInsightInfobar,e.processTrackEmailInfobar),e.addActionCallbackWithRequestTimeCheck(s.default.PeopleCatchUpItemsInsightInfobar,e.processPeopleCatchUpItemsInfobar),e.addActionCallbackWithRequestTimeCheck(s.default.MeetingPreparationInfobar,e.processMeetingPreparationInfobar),e}t.SearchContextInsightsStore=f,t.default=new f},,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=(o.NO_ERROR="NoError",o.NO_RESPONSE_CODE="CouldNotFindResponseCode",o.ERROR_ITEM_NOT_FOUND="ErrorItemNotFound",o.ERROR_FOLDER_EXISTS="ErrorFolderExists",o.ERROR_NAME_RESOLUTION_MULTIPLE_RESULTS="ErrorNameResolutionMultipleResults",o.ERROR_NAME_RESOLUTION_NO_RESULTS="ErrorNameResolutionNoResults",o.ERROR_SERVER_BUSY="ErrorServerBusy",o.ERROR_MAILBOX_MOVE_IN_PROGRESS="ErrorMailboxMoveInProgress",o.ERROR_INTERNAL_SERVER_TRANSIENT_ERROR="ErrorInternalServerTransientError",o.ERROR_IRRESOLVABLE_CONFLICT="ErrorIrresolvableConflict",o.ERROR_MAIL_RECIPIENT_NOT_FOUND="ErrorMailRecipientNotFound",o.ERROR_AUTO_DISCOVER_FAILED="ErrorAutoDiscoverFailed",o.ERROR_FREE_BUSY_DL_LIMIT_REACHED="ErrorFreeBusyDLLimitReached",o.ERROR_EXCEEDED_FIND_COUNT_LIMIT="ErrorExceededFindCountLimit",o.ERROR_MESSAGE_PER_FOLDER_COUNT_RECEIVED_QUOTA_EXCEEDED="ErrorMessagePerFolderCountReceiveQuotaExceeded",o.ERROR_RESULT_SET_TOO_BIG="ErrorResultSetTooBig",o.ERROR_INVALID_CHANGE_KEY="ErrorInvalidChangeKey",o.ERROR_TIME_ZONE="ErrorTimeZone",o.ERROR_MAILBOX_STORE_UNAVAILABLE="ErrorMailboxStoreUnavailable",o.ERROR_SCHEMA_VALIDATION="ErrorSchemaValidation",o.ERROR_TOO_MANY_OBJECTS_OPENED="ErrorTooManyObjectsOpened",o)
function o(){}t.default=r},function(e,t,n){"use strict"
var r,o,i,a,s
Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationType=t.ThrottledScope=t.ThumbsPairState=t.AvatarIconType=t.IButtonType=void 0,(r=t.IButtonType||(t.IButtonType={}))[r.normal=0]="normal",r[r.primary=1]="primary",(o=t.AvatarIconType||(t.AvatarIconType={}))[o.NoStar=0]="NoStar",o[o.NormalStar=1]="NormalStar",o[o.RollUpStar=2]="RollUpStar",o[o.DetailsStar=3]="DetailsStar",o[o.DeclinedMeeting=4]="DeclinedMeeting",o[o.AcceptedMeeting=5]="AcceptedMeeting",o[o.TentativeMeeting=6]="TentativeMeeting",(i=t.ThumbsPairState||(t.ThumbsPairState={}))[i.None=0]="None",i[i.ThumbsUpHover=1]="ThumbsUpHover",i[i.ThumbsUpRequestComplete=2]="ThumbsUpRequestComplete",i[i.ThumbsDownHover=3]="ThumbsDownHover",i[i.ThumbsDownRequestComplete=4]="ThumbsDownRequestComplete",(a=t.ThrottledScope||(t.ThrottledScope={})).Mailbox="Mailbox",a.Request="Request",(s=t.ConfirmationType||(t.ConfirmationType={}))[s.Ok=0]="Ok",s[s.Cancel=1]="Cancel"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CalendarActionCreatorExecutor=void 0
var d=n(0),l=d.__importStar(n(34)),c=d.__importDefault(n(3)),p=d.__importDefault(n(832)),y=d.__importDefault(n(24)),f=d.__importDefault(n(833)),g=d.__importDefault(n(11)),o=d.__importDefault(n(90)),s=d.__importDefault(n(174)),r=d.__importDefault(n(834)),u=d.__importDefault(n(381)),a=d.__importDefault(n(835)),i=d.__importDefault(n(836)),m=d.__importStar(n(4)),h=d.__importDefault(n(35)),_=d.__importDefault(n(837)),S=d.__importDefault(n(6)),T=d.__importDefault(n(68)),I=d.__importDefault(n(493)),b=d.__importDefault(n(201)),E=d.__importDefault(n(838)),v=d.__importDefault(n(839)),A=n(29),D=n(34),O=n(58),C=n(7),R=n(51),M=n(4),P=(N.prototype.getCalendarItems=function(n,r,o){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=new u.default(o,"GetCalendarItemsOdata",m.LogRequestType.Interval).startDate(y.default.generatePriorDate(n)).endDate(y.default.generatePriorDate(r)).selectField(["Id","IsCancelled","Subject","Type","Attendees","Start","End","Organizer","ShowAs","Sensitivity","WebLink","IsOrganizer","LastModifiedDateTime","OnlineMeeting"]).top(this.MAX_ITEMS_PER_PAGE).extendedProperties(s.default.IS_BOOKED_FREE_BLOCKS.buildJSONString()),[4,h.default.executeRequestWithPaging(t)]
case 1:return[2,e.sent()]}})})},N.prototype.getCalendarItemById=function(n,r){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=this.buildGetCalendarItemByIdRequest(n,r),[4,this.executeGetCalendarItemByIdRequest(t)]
case 1:return[2,e.sent()]}})})},N.prototype.getCalendarItemByIdWithNonFatalErrorCodes=function(n,r){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=this.buildGetCalendarItemByIdRequest(n,r).nonFatalErrorCodes(["404"]),[4,this.executeGetCalendarItemByIdRequest(t)]
case 1:return[2,e.sent()]}})})},N.prototype.getUserSchedule=function(r,o,i){return void 0===i&&(i=D.RequestPriority.Normal),d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return t=new a.default("GetUserSchedule","GetSchedule",m.LogRequestType.Init).start(r).end(o),[4,h.default.executeRequest(t,i)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&g.default.dispatch({actionType:c.default.GetScheduleItems,scheduleItems:n.result.value[0].ScheduleItems.map(function(e){return{startDate:new Date(e.Start.DateTime+"Z"),endDate:new Date(e.End.DateTime+"Z"),freeBusyStatus:A.CalendarTypeUtils.strToBusyStatus(e.Status)}})}),[2]}})})},N.prototype.bookFocusBlock=function(n){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=this.buildCreateFocusTimeRequest(n,"BookFocusTimeREST"),[4,h.default.executeRequest(t,l.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.bookFocusBlocks=function(r){return d.__awaiter(this,void 0,void 0,function(){var t,n=this
return d.__generator(this,function(e){switch(e.label){case 0:return t=r.map(function(e){return n.buildCreateFocusTimeRequest(e,"BookFocusTimeREST_Batch")}),[4,h.default.executeBatchRequests(t,D.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.bookLunchTimeAndReturn=function(n,r,o,i,a){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.bookRecurringLunchBlock(n,r,o,i,a)]
case 1:return(t=e.sent()).status===Office.AsyncResultStatus.Succeeded?[2,{isSuccessful:!0,result:this.processBookOrUpdateTimeBlock(t)}]:[2,{isSuccessful:!1}]}})})},N.prototype.bookRecurringLunchBlock=function(o,i,a,s,u){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t=y.default.startOfDay(o),n={pattern:{patternType:A.RecurrencePatternType.Weekly,interval:1,month:0,dayOfMonth:0,daysOfWeek:a,firstDayOfWeek:A.DayInWeek[0],index:"First"},range:{rangeType:A.RecurrenceRangeType.NoEnd,startDate:new Date>o?y.default.addDays(t,1):t,endDate:null,recurrenceTimeZone:S.default.Timezone,numberOfOccurrences:0}},r=new p.default("LunchTime","BookLunchTimeREST",m.LogRequestType.Action).start(o).end(i).subject(s).calendarItemType(A.CalendarItemType.LunchTime).category("Purple Category").recurrence(n).isReminderOn(!1).body(u).selectField(["Start","End","Subject","ChangeKey","Recurrence"]),[4,h.default.executeRequest(r,l.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.updateCalendarItem=function(o,i,a,s,u){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t=new _.default(s,a,m.LogRequestType.Action).eventId(i.id).subject(o.subject).bodyContent(o.body).recurrence(o.recurrence).start(o.startTime).end(o.endTime).calendarItemType(u),[4,h.default.executeRequest(t,l.RequestPriority.High)]
case 1:if(n=e.sent(),s===O.TIME_AWAY_FEATURE_NAME)return[2,n]
switch(u){case A.CalendarItemType.FocusTime:r=c.default.MoveFocusBlock
break
case A.CalendarItemType.LunchTime:return[2,n]
default:m.default.logAssert("Unexpected calendarItemType: "+u,s,a)}return n.status===Office.AsyncResultStatus.Succeeded&&void 0!==r&&g.default.dispatch({actionType:r,calendarItems:[this.processBookOrUpdateTimeBlock(n)]}),[2,n]}})})},N.prototype.updateFocusBlockTime=function(n,r,o){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t={startTime:r,endTime:o},[4,this.updateCalendarItem(t,n,"UpdateFocusBlockTime","FocusTimeConflict",A.CalendarItemType.FocusTime)]
case 1:return e.sent(),[2]}})})},N.prototype.removeBookedTimeBlock=function(t,n){return d.__awaiter(this,void 0,void 0,function(){return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.removeBookedTimeBlockAndReturn(t,n,"RemoveBookedTimeBlock")]
case 1:return e.sent(),[2]}})})},N.prototype.removeBookedTimeBlockAndReturn=function(r,o,i){return d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.deleteBookedTimeBlock(r.identifier.id,o,i)]
case 1:return t=e.sent(),(n=t.status===Office.AsyncResultStatus.Succeeded||404===t.responseStatusCode)&&this.processRemoveTimeBlock(t.sourceRequest,r),[2,{isSuccessful:n,result:null}]}})})},N.prototype.deleteBookedTimeBlock=function(n,r,o){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=new f.default(r,o,m.LogRequestType.Action).eventId(n),[4,h.default.executeRequest(t,D.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.processGetCalendarItems=function(e){var t=this
return e.result.value.filter(function(e){return!1===e.IsCancelled}).map(function(e){return t.parseCalendarItemJson(e)})},N.prototype.processGetCalendarItemById=function(e){return this.parseCalendarItemJson(e.result)},N.prototype.processBookOrUpdateTimeBlock=function(e){var t=e.sourceRequest
return{busyStatus:A.BusyStatus.Busy,endDate:t.end(),identifier:{id:e.result.Id,changeKey:e.result.ChangeKey},calendarItemType:t.calendarItemType(),startDate:t.start(),subject:e.result.Subject,attendees:[],webLink:e.result.WebLink,recurrence:e.result.Recurrence}},N.prototype.processBookOrUpdateTimeBlocks=function(e){var t=this
return e.map(function(e){return t.processBookOrUpdateTimeBlock(e)})},N.prototype.bookOOFBlock=function(n,r,o,i){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return t=new p.default(n,"BookOOFBlockREST",m.LogRequestType.Action).start(r).end(o).subject(i).category("Purple Category").showAs(A.BusyStatus[A.BusyStatus.Oof]).calendarItemType(A.CalendarItemType.OOFTime).selectField(["Id","Start","End"]).isReminderOn(!1),[4,h.default.executeRequest(t,D.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.deleteBookedBlock=function(u,l,c){return d.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.getBookedBlocksDuringDateTimeRange(u,l,new Date(l.getTime()+1),c)]
case 1:if((t=e.sent()).status!==Office.AsyncResultStatus.Succeeded)return[2,{isSuccessful:!1}]
n=this.processGetCalendarItems(t),r=0,o=n,e.label=2
case 2:return r<o.length?(i=o[r]).calendarItemType!==c?[3,4]:(a=new f.default(u,"DeleteBookedBlock",m.LogRequestType.Action).eventId(i.identifier.id),[4,h.default.executeRequest(a,D.RequestPriority.High)]):[3,5]
case 3:return(s=e.sent()).status===Office.AsyncResultStatus.Succeeded||404===s.responseStatusCode?[2,{isSuccessful:!0}]:[2,{isSuccessful:!1}]
case 4:return r++,[3,2]
case 5:return[2,{isSuccessful:!0}]}})})},N.prototype.updateBookedBlockSubject=function(s,u,l,c){return d.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return d.__generator(this,function(e){switch(e.label){case 0:return t={subject:c},[4,this.getBookedBlocksDuringDateTimeRange(s,u,new Date(u.getTime()+1),l)]
case 1:if((n=e.sent()).status!==Office.AsyncResultStatus.Succeeded)return[2,{isSuccessful:!1}]
r=this.processGetCalendarItems(n),o=0,i=r,e.label=2
case 2:return o<i.length?(a=i[o]).calendarItemType!==l?[3,4]:[4,this.updateCalendarItem(t,a.identifier,"updateBookedTime",s,l)]:[3,5]
case 3:if(e.sent().status!==Office.AsyncResultStatus.Succeeded)return[2,{isSuccessful:!1}]
e.label=4
case 4:return o++,[3,2]
case 5:return[2,{isSuccessful:!0}]}})})},N.prototype.cancelOrDeclineMeeting=function(o,i,a,s){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t=o.isOrganizer?E.default:v.default,n=new t(i,o.isOrganizer?"cancelMeetingREST":"declineMeetingREST",m.LogRequestType.Action).eventId(o.id),(o.isOrganizer||o.responseRequested)&&n.comment(s),o.isOrganizer||n.sendResponse(o.responseRequested),[4,h.default.executeRequest(n,a)]
case 1:return[2,{isSuccessful:202===(r=e.sent()).responseStatusCode||404===r.responseStatusCode,result:o.id}]}})})},N.prototype.getWorkingHours=function(){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t=new i.default("FocusTime",M.LogEventType.Get,"FindWorkingHours",m.LogRequestType.Interval).userConfigurationName("WorkHours").userConfigurationProperties("calendar").maxRetries(3),[4,o.default.executeRequest(t)]
case 1:return(n=e.sent()).status!==Office.AsyncResultStatus.Succeeded||(r=o.default.processEWSResultWithSafeCallback(n,this.processGetWorkingHoursResponse.bind(this))).isSuccess&&g.default.dispatch({actionType:c.default.GetWorkingHours,workingHours:r.result}),[2]}})})},N.prototype.getBookedBlocksDuringDateTimeRange=function(r,o,i,a){return d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:switch(a){case A.CalendarItemType.FocusTime:t=s.default.IS_BOOKED_FREE_BLOCKS.buildJSONString()
break
case A.CalendarItemType.OOFTime:t=s.default.IS_BOOKED_OOF_TIME.buildJSONString()
break
default:return m.default.logAssert("Unsupported calendarItemType: "+a,r,"getBookedBlocksDuringDateTimeRange"),[2]}return n=new u.default(r,"GetCalendarItemsREST",m.LogRequestType.Interval).startDate(o).endDate(i).selectField(["Id","IsCancelled","Start","End","ShowAs","Attendees"]).extendedProperties(t),[4,h.default.executeRequestWithPaging(n,l.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.processRemoveTimeBlock=function(e,t){var n
switch(t.calendarItemType){case A.CalendarItemType.FocusTime:n=c.default.DeleteFocusBlock
break
case A.CalendarItemType.LunchTime:return
default:return void m.default.logAssert("Can't processing remove calendar item with type "+A.CalendarItemType[t.calendarItemType],e.logCreator().feature,"processBookTimeBlock")}g.default.dispatch({actionType:n,calendarItem:t})},N.prototype.parseCalendarItemJson=function(e){var t,n,r,o,i,a,s,u,l,c,d=this,p=(null!==(t=e.Attendees)&&void 0!==t?t:[]).map(function(e){return d.parseAttendeeJson(e)}),f=this.parseOnlineMeetingJson(e.OnlineMeeting),g=new Date(e.Start.DateTime+(e.IsAllDay?"":"Z")),m=new Date(e.End.DateTime+(e.IsAllDay?"":"Z")),h=null
return e.Recurrence&&(l=e.Recurrence.Pattern,c=e.Recurrence.Range,h={pattern:{patternType:A.CalendarTypeUtils.recurrencePatternStringToType(l.Type),interval:l.Interval,month:l.Month,dayOfMonth:l.DayOfMonth,daysOfWeek:l.DaysOfWeek,firstDayOfWeek:l.FirstDayOfWeek,index:l.Index},range:{rangeType:A.CalendarTypeUtils.recurrenceRangeStringToType(c.Type),startDate:y.default.addMinutes(new Date(c.StartDate),y.default.getCurrentTimeZoneOffsetInMinute()),endDate:y.default.addMinutes(new Date(c.EndDate),y.default.getCurrentTimeZoneOffsetInMinute()),recurrenceTimeZone:c.RecurrenceTimeZone,numberOfOccurrences:c.NumberOfOccurrences}}),{attendees:p,busyStatus:A.CalendarTypeUtils.strToBusyStatus(e.ShowAs),endDate:m,identifier:{id:e.Id},isRecurring:"Occurrence"===e.Type,startDate:g,subject:e.Subject,sensitivity:A.CalendarTypeUtils.strToSensitivity(e.Sensitivity),calendarItemType:this.getCalendarItemType(e),webLink:e.WebLink,isOrganizer:e.IsOrganizer,responseRequested:null!==(n=e.ResponseRequested)&&void 0!==n&&n,onlineMeeting:f,lastModifiedDateTime:new Date(e.LastModifiedDateTime),body:null!==(o=null===(r=e.Body)||void 0===r?void 0:r.Content)&&void 0!==o?o:"",organizerMailAddress:null!==(a=null===(i=e.Organizer)||void 0===i?void 0:i.EmailAddress.Address)&&void 0!==a?a:"",organizerName:null!==(u=null===(s=e.Organizer)||void 0===s?void 0:s.EmailAddress.Name)&&void 0!==u?u:"",recurrence:h,isAllDay:e.IsAllDay}},N.prototype.parseAttendeeJson=function(e){return{isRequired:"Required"===e.Type,name:e.EmailAddress.Name||e.EmailAddress.Address,responseType:A.CalendarTypeUtils.strToResponseType(e.Status.Response),smtpAddress:e.EmailAddress.Address}},N.prototype.parseOnlineMeetingJson=function(e){return e&&e.JoinUrl?{joinUrl:e.JoinUrl}:{joinUrl:null}},N.prototype.getCalendarItemType=function(t){var e
if(t.SingleValueExtendedProperties)for(var n=0;n<t.SingleValueExtendedProperties.length;++n)if("true"===t.SingleValueExtendedProperties[n].Value)switch(t.SingleValueExtendedProperties[n].PropertyId.toLowerCase()){case s.default.IS_BOOKED_FREE_BLOCKS.buildJSONString().toLowerCase():return A.CalendarItemType.FocusTime
case s.default.IS_BOOKED_LUNCH_TIME.buildJSONString().toLowerCase():return A.CalendarItemType.LunchTime
case s.default.IS_BOOKED_OOF_TIME.buildJSONString().toLowerCase():return A.CalendarItemType.OOFTime}var r=(null!==(e=t.Attendees)&&void 0!==e?e:[]).map(function(e){return e.EmailAddress})
return t.Organizer&&(r=r.filter(function(e){return e.Address!==t.Organizer.EmailAddress.Address}).concat(t.Organizer.EmailAddress)),0===r.length||1===r.length&&r[0].Address.toLowerCase()===S.default.userEmail.toLowerCase()?A.CalendarItemType.Appointment:A.CalendarItemType.Meeting},N.prototype.buildCreateFocusTimeRequest=function(e,t){return new p.default("FocusTime",t,m.LogRequestType.Action).start(e.startDate).end(e.endDate).subject(e.subject).body(e.body).calendarItemType(A.CalendarItemType.FocusTime).category("Green Category").isReminderOn(e.isReminderOn).selectField(["Start","End","Subject","Attendees","ChangeKey"])},N.prototype.buildGetCalendarItemByIdRequest=function(e,t){return new r.default(t,"GetCalendarItemsOdata",m.LogRequestType.IndirectAction).itemId(e.id).selectField(["Id","IsCancelled","Subject","Type","Attendees","Start","End","Organizer","ShowAs","Sensitivity","WebLink","IsOrganizer","Body","LastModifiedDateTime","OnlineMeeting","Recurrence"])},N.prototype.executeGetCalendarItemByIdRequest=function(t){return d.__awaiter(this,void 0,void 0,function(){return d.__generator(this,function(e){switch(e.label){case 0:return[4,h.default.executeRequest(t,l.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},N.prototype.processGetWorkingHoursResponse=function(e){var t=S.default.atob(T.default.getXMLOptionalFirstElementTextContent(e.result,C.Constants.EWSTypesNamespace,"XmlData")),n=I.default.parseXML(t),r=T.default.getXMLOptionalFirstElementTextContent(n,C.Constants.EWSGetUserConfigWorkingHoursNS,"Start").trim(),o=T.default.getXMLOptionalFirstElementTextContent(n,C.Constants.EWSGetUserConfigWorkingHoursNS,"End").trim(),i=T.default.getXMLOptionalFirstElementTextContent(n,C.Constants.EWSGetUserConfigWorkingHoursNS,"WorkDays").trim(),a=T.default.getXMLOptionalFirstElementTextContent(n,C.Constants.EWSGetUserConfigWorkingHoursNS,"Bias").trim()
return b.default.buildWorkingHours(T.default.parseWorkHours(r,o),T.default.parseWorkDays(i),y.default.parseTimeZone(a))},d.__decorate([R.expirable(R.ExpirationTypes.ByEvery_Minutes,C.Constants.oneDayInMinutes)],N.prototype,"getWorkingHours",null),N=d.__decorate([R.expirable()],N))
function N(){this.MAX_ITEMS_PER_PAGE=200}t.CalendarActionCreatorExecutor=P,t.default=new P},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FeedWESInsightActionCreator=void 0
var a=n(0),r=n(51),s=a.__importDefault(n(35)),u=n(4),o=n(238),i=a.__importStar(n(13)),l=a.__importDefault(n(856)),c=n(67),d=a.__importDefault(n(857)),p=n(34),f=n(52),g=a.__importDefault(n(858)),m=a.__importDefault(n(860)),h=a.__importDefault(n(864)),y=a.__importDefault(n(866)),_=a.__importDefault(n(868)),S=a.__importDefault(n(869)),T=a.__importDefault(n(870)),I=a.__importDefault(n(872)),b=a.__importDefault(n(874)),E=a.__importDefault(n(876)),v=a.__importDefault(n(878)),A=a.__importDefault(n(8)),D=a.__importDefault(n(514)),O=(C.prototype.getTaskInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isTaskInsightEnabled&&this.processAndDispatchInsights(_.default,o.ExternalInsightType.TasksInsight),[2]})})},C.prototype.getFollowUpsInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isFollowUpsTaskSuggestionMigrationEnabled&&this.processAndDispatchInsights(S.default,o.ExternalInsightType.FollowUpsInsight),[2]})})},C.prototype.getMeetingPreparationCardInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isMeetingPreparationCardEnabled&&this.processAndDispatchInsights(m.default,o.ExternalInsightType.MeetingReadinessInsight),[2]})})},C.prototype.getMeetingRelatedDocumentsInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return this.processAndDispatchInsights(h.default,o.ExternalInsightType.MeetingRelatedDocumentsInsight),[2]})})},C.prototype.getDocumentsToCatchupInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isDocumentsToCatchupEnabled&&this.processAndDispatchInsights(y.default,o.ExternalInsightType.DocumentsToCatchupInsight),[2]})})},C.prototype.getFocusGoalDaysToBookInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isOutcomeEnabled&&this.processAndDispatchInsights(T.default,o.ExternalInsightType.FocusGoalDaysToBookInsight),[2]})})},C.prototype.getDirectReportBookOneOnOneInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isManagerEffectivenessEnabled&&this.processAndDispatchInsights(I.default,o.ExternalInsightType.DirectReportsBookOneOnOneInsight),[2]})})},C.prototype.getDirectReportConflictingOneOnOneInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isManagerEffectivenessEnabled&&this.processAndDispatchInsights(b.default,o.ExternalInsightType.DirectReportsConflictingOneOnOneInsight),[2]})})},C.prototype.getSmartRulesSuggestionInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isSmartRulesSuggestionEnabled&&this.processAndDispatchInsights(E.default,o.ExternalInsightType.SmartRulesSuggestionInsight),[2]})})},C.prototype.getTeamsGroupSuggestionInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isTeamsGroupSuggestionInsightEnabled&&this.processAndDispatchInsights(v.default,o.ExternalInsightType.TeamsGroupSuggestionInsight),[2]})})},C.prototype.getCatchUpImportantMailInsight=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){return A.default.isIRankerInOneEngineEnabled&&this.processAndDispatchInsights(g.default,o.ExternalInsightType.CatchUpImportantMailInsight),[2]})})},C.prototype.dismissFeedInsights=function(e){var n=this,t=[]
if((t=A.default.isServerSideDismissEnabled?e.filter(function(e){return e.instanceData.doesSupportServerSideDislikeInsightAction||e.instanceData.doesSupportServerSideDismissAction}):e.filter(function(e){return e.instanceData.doesSupportServerSideDislikeInsightAction}))&&0<t.length){var r=t.map(function(e){var t=n.getAction(e)
return new d.default(e.instanceData.identifier.primaryId,e.instanceData.identifier.secondaryId,"dismissFeedInsights",u.LogRequestType.Action).getAction(t)})
return this.executeBatchInsightWESAction(r)}},C.prototype.executeInsightWESAction=function(n,r,o,i){return a.__awaiter(this,void 0,void 0,function(){var t
return a.__generator(this,function(e){switch(e.label){case 0:return t=new d.default(n,r,i,u.LogRequestType.Action).getAction(o),[4,s.default.executeWESRequest(t,p.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},C.prototype.recordInsightWESAction=function(n,r,o,i){return a.__awaiter(this,void 0,void 0,function(){var t
return a.__generator(this,function(e){switch(e.label){case 0:return t=new D.default(n,r,i,u.LogRequestType.Action).getAction(o),[4,s.default.executeWESRequest(t,p.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},C.prototype.executeBatchInsightWESAction=function(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return t&&0!==t.length?[4,s.default.executeWESBatchRequests(t,p.RequestPriority.High)]:[2]
case 1:return[2,e.sent()]}})})},C.prototype.processAndDispatchInsights=function(r,o){return a.__awaiter(this,void 0,void 0,function(){var t,n
return a.__generator(this,function(e){switch(e.label){case 0:return t=Date.now(),n=[],[4,this.getFeedInsightByName(o)]
case 1:return n=e.sent(),r.processAndDispatchInsights(n,t),[2]}})})},C.prototype.getFeedInsightByName=function(o){return a.__awaiter(this,void 0,void 0,function(){var t,n,r=this
return a.__generator(this,function(e){switch(e.label){case 0:return t=new l.default(o,"getFeedInsightByName",u.LogRequestType.Interval).insightNames([o]),[4,s.default.executeWESRequest(t)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?[2,n.result.value.map(function(e){return r.extractInsight(e)})]:[2,[]]}})})},C.prototype.extractInsight=function(e){return c.ExternalInsightConverter.convertToInsight(e)},C.prototype.getAction=function(e){var t=""
if(e.instanceData.doesSupportServerSideDislikeInsightAction)t=f.DISLIKE_INSIGHT_ACTION
else{if(!e.instanceData.doesSupportServerSideDismissAction)throw Error("insight doesnt have dismiss or dislike actions")
t=f.DISMISS_ACTION}return{Name:t,InsightName:i.InsightName[e.insightName]}},a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getTaskInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getFollowUpsInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getMeetingPreparationCardInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getMeetingRelatedDocumentsInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getDocumentsToCatchupInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getFocusGoalDaysToBookInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getDirectReportBookOneOnOneInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getDirectReportConflictingOneOnOneInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getSmartRulesSuggestionInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getTeamsGroupSuggestionInsight",null),a.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,15,r.ExpirableInBackground.Suppressed)],C.prototype,"getCatchUpImportantMailInsight",null),C=a.__decorate([r.expirable()],C))
function C(){}t.FeedWESInsightActionCreator=O,t.default=new O},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FeedWESInsightProcessor=void 0
var r=n(0),o=r.__importDefault(n(11)),i=r.__importDefault(n(4)),a=(s.prototype.parseRawInsight=function(e){return this.feedInsightConverter.convertToRunTimeInstanceData(e)},s.prototype.processAndDispatchInsights=function(e,t){var n=this
try{var r=e.map(function(e){return n.processInsight(e)})
this.dispatchInsights(r,t)}catch(e){i.default.logAssert("Caught error: "+JSON.stringify(e),"FeedWESInsightProcessor","ProcessInsights")}},s.prototype.requestAdditionalData=function(e){},s.prototype.dispatchInsights=function(e,t){o.default.dispatch({actionType:this.dispatchAction,insights:e,requestTimeInTicks:t})},s.prototype.processInsight=function(e){var t=this.parseRawInsight(e)
return this.requestAdditionalData(t),t},s)
function s(){}t.FeedWESInsightProcessor=a},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.Routes=void 0,(r=t.Routes||(t.Routes={}))[r.CleanUp=0]="CleanUp",r[r.Feed=1]="Feed",r[r.InsightTransitionLeavePage=2]="InsightTransitionLeavePage",r[r.Details=3]="Details",r[r.Settings=4]="Settings",r[r.Feedback=5]="Feedback",r[r.Mock=6]="Mock",r[r.NudgeFeedback=7]="NudgeFeedback",r[r.OutcomeEnrollment=8]="OutcomeEnrollment",r[r.FocusPlanEnrollmentConfirmation=9]="FocusPlanEnrollmentConfirmation",r[r.EditTeam=10]="EditTeam"},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.ExplicitMessageType=t.ActionableMessageAction=t.ContextVersion=void 0,(r=t.ContextVersion||(t.ContextVersion={}))[r.V1=0]="V1",r[r.V2=1]="V2",(o=t.ActionableMessageAction||(t.ActionableMessageAction={}))[o.Insight=0]="Insight",o[o.Feedback=1]="Feedback",o[o.DigestFeedback=2]="DigestFeedback",(i=t.ExplicitMessageType||(t.ExplicitMessageType={})).AdaptiveCard="AdaptiveCard",i.MessageCard="MessageCard"},,,,,function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.Layout=t.ExperienceType=t.Environment=void 0,(r=t.Environment||(t.Environment={})).Unknown="Unknown",r.Debug="Debug",r.Dev="Dev",r.PPE="PPE",r.Prod="Prod",(o=t.ExperienceType||(t.ExperienceType={})).Advanced="Advanced",o.Basic="Basic",(i=t.Layout||(t.Layout={})).Background="Background",i.Vertical="Vertical",i.AutoRunJS="AutoRunJS",i.Unknown="Unknown"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableDataStreamStoreBase=t.LoadableDataStreamStateBase=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=o.__importStar(n(83)),s=o.__importDefault(n(4)),u=n(5),l=(r=a.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"hasCheckedCache",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"hasCheckedInfobar",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"wasLoadedFromJSON",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),c.prototype.toJSON=function(){return{}},o.__decorate([u.doop],c.prototype,"hasCheckedCache",null),o.__decorate([u.doop],c.prototype,"hasCheckedInfobar",null),o.__decorate([u.doop],c.prototype,"wasLoadedFromJSON",null),c=o.__decorate([u.doop],c))
function c(){return null!==r&&r.apply(this,arguments)||this}t.LoadableDataStreamStateBase=l
var d,p=(d=a.default,o.__extends(f,d),f.prototype.processUpdateLoadedCache=function(e,t){return t.storeName!==this.getStoreLoggingName()?e:(!t.cachedResult.didCatchException&&t.cachedResult.result&&(e=this.loadStateFromJSON(e,t.cachedResult.result,"Cache")),e=e.hasCheckedCache(!0))},f.prototype.processInfobarContext=function(e,t){var n=t.infobarContextData.contextStores[this.getStoreLoggingName()]
return n&&(e=this.loadStateFromJSON(e,n,"InfobarContext").hasCheckedInfobar(!0)),e},f.prototype.loadStateFromJSON=function(e,t,n){try{e=this.hydrateStateFromJSON(e,t)}catch(e){s.default.logAssert("Failed to deserialize store state with exception: "+e.message+".",this.getStoreLoggingName(),"loadStateFromJSON: "+n)}return e},f.prototype.hydrateStateFromJSON=function(e,t){return e.fromJSON(t).lastUpdatedTime(t.lastUpdatedTime).wasLoadedFromJSON(!0)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(i.default.UpdateLoadedCache,e.processUpdateLoadedCache),e.addActionCallback(i.default.GetInfobarContext,e.processInfobarContext),e}t.LoadableDataStreamStoreBase=p,t.default=p},function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.IRecipientType=t.comparePeopleByRelevanceRank=t.comparePeopleByEmailAddress=t.MailboxType=void 0,(r=t.MailboxType||(t.MailboxType={}))[r.Mailbox=0]="Mailbox",r[r.Contact=1]="Contact",r[r.OneOff=2]="OneOff",t.comparePeopleByEmailAddress=function(e,t){return e.smtpAddress.toLowerCase()<t.smtpAddress.toLowerCase()?-1:e.smtpAddress.toLowerCase()>t.smtpAddress.toLowerCase()?1:0},t.comparePeopleByRelevanceRank=function(e,t){return e.relevanceRank-t.relevanceRank},(o=t.IRecipientType||(t.IRecipientType={})).Other="other",o.DistributionList="distributionList",o.User="user",o.ExternalUser="externalUser"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PersistedStorageAccessor=t.PersistedStorageKeys=void 0
var c,r,d=n(0),o=d.__importDefault(n(25)),p=d.__importDefault(n(4)),l=d.__importDefault(n(6)),i=d.__importDefault(n(809)),a=d.__importDefault(n(810));(r=c=t.PersistedStorageKeys||(t.PersistedStorageKeys={}))[r.AvatarPicture=0]="AvatarPicture",r[r.Flights=1]="Flights",r[r.LocalizationStrings=2]="LocalizationStrings",r[r.IdentityToken=3]="IdentityToken",r[r.PinTutorial=4]="PinTutorial",r[r.RESTToken=5]="RESTToken",r[r.ActionLogItems_V1=6]="ActionLogItems_V1",r[r.SentMailsProps_V1=7]="SentMailsProps_V1",r[r.ActionLogItems_V1_1=8]="ActionLogItems_V1_1",r[r.SentMailsProps_V1_1=9]="SentMailsProps_V1_1",r[r.DefaultStrings=10]="DefaultStrings",r[r.SentMailsProps_V1_2=11]="SentMailsProps_V1_2",r[r.UserFlights_V1=12]="UserFlights_V1"
var s=(f.prototype.isPersistedStorageEnabled=function(){return d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),void 0!==f.isEnabled?[3,2]:(f.storage=o.default.isInAutoRunJSMode?new i.default:new a.default,[4,(t=f).storage.isEnabled()])
case 1:t.isEnabled=e.sent(),!1===f.isEnabled&&p.default.logWarning("Persisted Storage is disabled.","PersistedStorageAccessor","isPersistedStorageEnabled"),e.label=2
case 2:return[3,4]
case 3:return n=e.sent(),f.isEnabled=!1,p.default.logAssert("Catch  error: "+JSON.stringify(n),"PersistedStorageAccessor","isPersistedStorageEnabled"),[3,4]
case 4:return[2,f.isEnabled]}})})},f.prototype.trySaveToPersistedStorage=function(s,u,l){return d.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.isPersistedStorageEnabled()]
case 1:if(!1===e.sent())return[2,{didCatchException:!0}]
t=!1,n=c[s]||s,e.label=2
case 2:return e.trys.push([2,4,,5]),r=this.buildStorageCacheKey(n),o=l?Date.now()+1e3*l:null,i={value:JSON.stringify(u),expirationTime:o},[4,f.storage.setItem(r,JSON.stringify(i))]
case 3:return e.sent(),[3,5]
case 4:return a=e.sent(),p.default.logAssert("Unable to save key: ["+n+"] to persisted storage with exception: "+this.processException(a),"App","PersistedStorageAccessor"),t=!0,[3,5]
case 5:return[2,{didCatchException:t}]}})})},f.prototype.tryLoadFromPersistedStorage=function(u){return d.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.isPersistedStorageEnabled()]
case 1:if(!1===e.sent())return[2,{didCatchException:!0,result:void 0}]
t=!1,n=null,r=c[u]||u,e.label=2
case 2:return e.trys.push([2,4,,5]),o=this.buildStorageCacheKey(r),[4,f.storage.getItem(o)]
case 3:return i=e.sent(),(a=JSON.parse(i))&&(null==a.expirationTime||Date.now()<a.expirationTime)&&(n=JSON.parse(a.value,l.default.dateReviver)),[3,5]
case 4:return s=e.sent(),p.default.logAssert("Unable to load key: ["+r+"] from persisted storage with exception: "+this.processException(s),"App","PersistedStorageAccessor"),t=!0,[3,5]
case 5:return[2,{didCatchException:t,result:n}]}})})},f.prototype.tryRemoveFromPersistedStorage=function(r){return d.__awaiter(this,void 0,void 0,function(){var t,n
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.isPersistedStorageEnabled()]
case 1:if(!1===e.sent())return[2]
t=c[r]||r
try{n=this.buildStorageCacheKey(t),f.storage.removeItem(n)}catch(e){p.default.logAssert("Unable to remove key: ["+t+"] from persisted storage with exception: "+this.processException(e),"App","PersistedStorageAccessor")}return[2]}})})},f.prototype.tryClearPersistedStorage=function(){return d.__awaiter(this,void 0,void 0,function(){var t
return d.__generator(this,function(e){switch(e.label){case 0:return[4,this.isPersistedStorageEnabled()]
case 1:if(!1===e.sent())return[2]
e.label=2
case 2:return e.trys.push([2,4,,5]),[4,f.storage.clear()]
case 3:return e.sent(),[3,5]
case 4:return t=e.sent(),p.default.logAssert("Unable to clear persisted storage with exception: "+this.processException(t),"App","PersistedStorageAccessor"),[3,5]
case 5:return[2]}})})},f.prototype.buildStorageCacheKey=function(e){return Office.context.mailbox.userProfile.emailAddress+"=="+e},f.prototype.processException=function(e){return e?("string"==typeof e?e:JSON.stringify(e)).replace(""+Office.context.mailbox.userProfile.emailAddress,""):""},f)
function f(){}t.PersistedStorageAccessor=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogItemActionCreator=void 0
var r=n(0),o=r.__importStar(n(284)),i=r.__importDefault(n(3)),a=r.__importDefault(n(173)),s=r.__importDefault(n(501)),u=r.__importDefault(n(11)),l=r.__importDefault(n(828)),c=r.__importDefault(n(4)),d=r.__importDefault(n(6)),p=n(7),f=n(51),g=(m.prototype.loadActionLogItemsState=function(){return r.__awaiter(this,void 0,void 0,function(){var t,n
return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.default.loadUnexpiredLogItemsFromLocalStorage()]
case 1:return t=e.sent(),l.default.filterAndProcessCachedActionLogs(t),[4,s.default.loadUnexpiredLogItemsFromExchange()]
case 2:return n=e.sent(),l.default.filterAndProcessEWSActionLogs(t,n),t||n||c.default.logAssert("ActionLog loading ultimately failed","ActionLogItemActionCreator","loadActionLogState"),[2]}})})},m.prototype.clearInsightAsActedUpon=function(e,t){void 0===t&&(t=p.Constants.fourteenDays),this.dispatchAndSaveActionLogItems(o.ActionLogTypes.ActedUpon,[e])},m.prototype.dismissInsights=function(e){this.dispatchAndSaveActionLogItems(o.ActionLogTypes.Dismiss,e)},m.prototype.cleanUpActionLog=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,s.default.cleanUpActionLogFolder()]
case 1:return e.sent(),[4,this.loadActionLogItemsState()]
case 2:return e.sent(),[2]}})})},m.prototype.dispatchAndSaveActionLogItems=function(t,e){var n=this,r=e.map(function(e){return n.buildInsightActionLogItem(t,e)})
u.default.dispatch({actionType:i.default.InsightActionLogItem,logItems:r}),d.default.isInMockMode||this.saveInsightActionLogToBackingStore(r)},m.prototype.buildInsightActionLogItem=function(e,t){var n=0
return e===o.ActionLogTypes.ActedUpon?n=t.confirmationExpirationInMilliseconds:e===o.ActionLogTypes.Dismiss?n=t.dismissExpirationInMilliseconds:c.default.logAssert("ActionLogItem with unknown actionLogType: ["+e+"].","ActionLogItemActionCreator","buildActionLogItem"),{creationDate:new Date,expirationTimeInTicks:Date.now()+n,insightIdentifer:t.instanceData.identifier,insightName:t.insightName,logItemType:e}},m.prototype.saveInsightActionLogToBackingStore=function(e){var t=a.default.getInsightActionLog()
s.default.saveLogItemsToPermanentStore(e,t)},r.__decorate([f.expirable(f.ExpirationTypes.ByEvery_Minutes,5)],m.prototype,"loadActionLogItemsState",null),m=r.__decorate([f.expirable()],m))
function m(){}t.ActionLogItemActionCreator=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ImportantPeopleStore=t.ImportantPeopleStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importStar(n(115)),u=i.__importDefault(n(3)),l=i.__importStar(n(42)),c=n(5),d=(r=l.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"sortedVIPs",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{sortedVIPs:this.sortedVIPs()}},p.prototype.fromJSON=function(e){return(new o).sortedVIPs(e.sortedVIPs)},i.__decorate([c.doop],p.prototype,"sortedVIPs",null),p=o=i.__decorate([c.doop],p))
function p(){var e=r.call(this)||this
return e.sortedVIPs([]),e}t.ImportantPeopleStoreState=d
var f,g=(f=l.default,i.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"ImportantPeopleStore"},m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ImportantPeople},enumerable:!1,configurable:!0}),m.prototype.processGetSortedVIPsAction=function(e,t){return e.sortedVIPs(t.sortedVIPs)},m.prototype.processPinUserAction=function(e,t){return this.pinUser(e,t.user)},m.prototype.processUnpinUserAction=function(e,t){return this.unpinUser(e,t.user)},m.prototype.pinUser=function(e,t){t.isPinned=!0
var n=e.sortedVIPs().filter(function(e){return e.smtpAddress!==t.smtpAddress}).concat(t).sort(s.comparePeopleByEmailAddress)
return e.sortedVIPs(n)},m.prototype.unpinUser=function(e,t){var n=e.sortedVIPs().filter(function(e){return e.smtpAddress!==t.smtpAddress})
return e.sortedVIPs(n)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(u.default.GetSortedVIPs,e.processGetSortedVIPsAction),e.addActionCallback(u.default.PeoplePin,e.processPinUserAction),e.addActionCallback(u.default.PeopleUnpin,e.processUnpinUserAction),e}t.ImportantPeopleStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalContextUtils_V2=t.CalendarUtils_V2=void 0
var r=n(0).__importDefault(n(39)),o=(i.convertVersionedDateTimeRangeToContinuousTimeBlock=function(e){return r.default.throwIfUndefinedOrInvalidDate("startDate",e.StartTime),r.default.throwIfUndefinedOrInvalidDate("endDate",e.EndTime),{startDate:e.StartTime,endDate:e.EndTime}},i)
function i(){}t.CalendarUtils_V2=o
var a=(s.getInsightIdentifier=function(e){return r.default.throwIfUndefinedOrEmptyString("InsightId",e.Id),r.default.throwIfUndefinedOrEmptyString("InsightName",e.Name),{primaryId:e.Id,secondaryId:e.Name}},s.getDigestFeedback=function(e){return r.default.throwIfUndefinedOrEmptyString("DigestFeedbackId",e.Id),r.default.throwIfUndefinedOrEmptyString("DigestFeedbackSource",e.Source),r.default.throwIfUndefinedOrEmptyString("DigestFeedbackTemplateName",e.TemplateName),{id:e.Id,source:e.Source,templateName:e.TemplateName}},s)
function s(){}t.ExternalContextUtils_V2=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportsStore=t.DirectReportsState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=i.__importDefault(n(134)),d=(r=u.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"directReports",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{directReports:this.directReports()}},p.prototype.fromJSON=function(e){return(new o).directReports(e.directReports)},i.__decorate([l.doop],p.prototype,"directReports",null),p=o=i.__decorate([l.doop],p))
function p(){var e=r.call(this)||this
return e.directReports([]),e}t.DirectReportsState=d
var f,g=(f=u.default,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DirectReports},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"DirectReportsStore"},m.prototype.processDirectReports=function(e,t){var n=t.directReports.sort(function(e,t){return e.name.localeCompare(t.name)})
return c.default(e.directReports(),n)?e:e.directReports(n)},m.prototype.addDirectReport=function(e,t){if(!e.directReports().some(function(e){return e.externalDirectoryObjectId===t.person.externalDirectoryObjectId}))return e.directReports([t.person].concat(e.directReports()))},m.prototype.removeDirectReport=function(e,t){var n=e.directReports().filter(function(e){return e.smtpAddress!==t.primarySmtpAddress})
return e.directReports(n)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.GetDirectReports,e.processDirectReports),e.addActionCallback(s.default.AddDirectReport,e.addDirectReport),e.addActionCallback(s.default.RemoveDirectReport,e.removeDirectReport),e}t.DirectReportsStore=g,t.default=new g},,,,,,,,,,,function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.SourceName=t.FeatureName=void 0,(r=t.FeatureName||(t.FeatureName={})).RoamingSettings="RoamingSettings",r.Log="Log",r.CurrentItemActionCreator="CurrentItemActionCreator",r.DelayDeliveryActionCreator="DelayDeliveryActionCreator",(o=t.SourceName||(t.SourceName={})).OfficeInitialize="Office.initialize",o.LogEvent="logEvent",o.GetSubject="getSubject",o.GetDelayDeliveryTimeAndCustomProperties="getDelayDeliveryTimeAndCustomProperties",o.GetDelayDeliveryTime="getDelayDeliveryTime"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryActionCreator=void 0
var s=n(0),u=s.__importDefault(n(503)),r=s.__importDefault(n(92)),o=s.__importDefault(n(237)),i=n(133),l=s.__importDefault(n(3)),c=s.__importDefault(n(25)),d=s.__importDefault(n(11)),p=s.__importDefault(n(8)),f=s.__importDefault(n(4)),a=s.__importDefault(n(24)),g=s.__importDefault(n(37)),m=s.__importDefault(n(176)),h=s.__importDefault(n(149)),y=s.__importStar(n(65)),_=n(51),S=n(131),T=(I.prototype.enableDelayDeliveryAndOutlookNotification=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,r.default.setIsAutoDelayDeliveryOptedIn(!0)]
case 1:return e.sent()?[4,r.default.enableOutlookNotifications()]:[2,!1]
case 2:return(t=e.sent())?d.default.dispatch({actionType:l.default.EnableOutlookNotificationsInDelayDelivery}):f.default.logWarning("Succeed in turning on AutoDelayDelivery, but failed in turning on InlineSuggestions",S.FeatureName.DelayDeliveryActionCreator,n),[2,t]}})})},I.prototype.disableOutlookNotificationAndDelayDelivery=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,r.default.disableOutlookNotifications()]
case 1:return e.sent()?[4,this.disableDelayDelivery()]:[2,!1]
case 2:return(t=e.sent())?d.default.dispatch({actionType:l.default.OptOutAutoDelayDeliveryInOutlookNotifications}):f.default.logWarning("Succeed in turning off InlineSuggestions, but failed in turning off AutoDelayDelivery",S.FeatureName.DelayDeliveryActionCreator,n),[2,t]}})})},I.prototype.disableDelayDelivery=function(){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,r.default.setIsAutoDelayDeliveryOptedIn(!1)]
case 1:return(t=e.sent())&&o.default.resetTeachingMomentWithDelay(i.TeachingMomentTypes.AutoDelayDelivery),[2,t]}})})},I.prototype.getAndDispatchAutoDelayDeliveryAdvertisementCount=function(){var e
!c.default.isInBackgroundMode&&p.default.hasDelayDeliveryPrerequisites&&(e=this.getAutoDelayDeliveryAdvertisementCount(),d.default.dispatch({actionType:l.default.GetAutoDelayDeliveryAdvertisementCount,advertisementCount:e}))},I.prototype.updateAutoDelayDeliveryAdvertisementCount=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return t=this.getAutoDelayDeliveryAdvertisementCount(),n=(t+1)%6,[4,y.default.trySetRoamingSettings(y.RoamingSettingsTypes.DelayDelivery,y.RoamingSettingsKeys.AutoDelayDeliveryAdvertisementCount,n)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&d.default.dispatch({actionType:l.default.UpdateAutoDelayDeliveryAdvertisementCount}),[2]}})})},I.prototype.getToRecipientsWorkingHourConfigs=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a=this
return s.__generator(this,function(e){switch(e.label){case 0:return c.default.isInBackgroundMode||!p.default.hasDelayDeliveryPrerequisites||!g.default.asComposeMessage()||m.default.getState().hasErrorHappened()||m.default.getState().isDelayDeliveryCancelled()||!(t=m.default.getState().scheduledDelayDeliveryDateTime())||t.getTime()<=Date.now()?[2]:(n=h.default.getToRecipients().map(function(e){return e.emailAddress}),[4,u.default.getAndDispatchRecipientsWorkingHourConfigs(n,S.FeatureName.DelayDeliveryActionCreator)])
case 1:return r=e.sent(),o={},Object.keys(r).forEach(function(e){o[e]=a.getTimeZoneWithDaylightTime(r[e])}),i=m.default.getState().shouldDisplayRecipientsTimeZone()||!this.areRecipientsInSimilarTimeZones(o),d.default.dispatch({actionType:l.default.GetUserAddressToTimeZoneMap,userAddressToTimeZoneMap:o,shouldDisplayRecipientsTimeZone:i}),[2]}})})},I.prototype.getDelayDeliveryTimeAndCustomProperties=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return s.__generator(this,function(e){switch(e.label){case 0:if(!p.default.hasDelayDeliveryPrerequisites||m.default.getState().hasErrorHappened()||m.default.getState().isDelayDeliveryCancelled())return[2]
if(!(t=g.default.asComposeMessage()))return[2]
e.label=1
case 1:return e.trys.push([1,8,,9]),[4,this.getDelayDeliveryTime(t)]
case 2:return n=e.sent(),(o=m.default.getState().isScheduledByMyAnalytics())?[3,4]:[4,this.getCustomProperty(t,this.IS_SCHEDULED_BY_MY_ANALYTICS_NAME)]
case 3:o=e.sent(),e.label=4
case 4:return r=o,0!==n.getTime()?[3,6]:[4,this.getCustomProperty(t,this.IS_DELAY_DELIVERY_CANCELLED_NAME)]
case 5:return i=e.sent(),[3,7]
case 6:i=!1,e.label=7
case 7:return d.default.dispatch({actionType:l.default.GetDelayDeliveryProperties,delayDeliveryTime:n,isScheduledByMyAnalytics:r,isDelayDeliveryCancelled:i}),[3,9]
case 8:return a=e.sent(),d.default.dispatch({actionType:l.default.SetHasErrorHappenedInDelayDelivery}),f.default.logAssert("Stop polling data due to error: "+JSON.stringify(a),S.FeatureName.DelayDeliveryActionCreator,"getDelayDeliveryTimeAndCustomProperties"),[3,9]
case 9:return[2]}})})},I.prototype.scheduleDelayDelivery=function(e){var t=g.default.asComposeMessage()
this.setDelayDeliveryTime(t,e),this.setCustomProperty(t,this.IS_SCHEDULED_BY_MY_ANALYTICS_NAME,!0)},I.prototype.updateDelayDelivery=function(e){var t=g.default.asComposeMessage()
this.setDelayDeliveryTime(t,e)},I.prototype.cancelDelayDelivery=function(){var n=this,r=g.default.asComposeMessage()
return new Promise(function(t){n.setDelayDeliveryTime(r,new Date(0)).then(function(e){e?n.setCustomProperty(r,n.IS_DELAY_DELIVERY_CANCELLED_NAME,!0):t(!1)})})},I.prototype.setDelayDeliveryTime=function(e,n){var r=this
return new Promise(function(t){e.delayDeliveryTime.setAsync(n,function(e){e.status===Office.AsyncResultStatus.Succeeded?(r.dispatchDelayDeliveryTime(n),t(!0)):(f.default.logAssert("Set delay delivery time for current composing message failed with error: "+e.error.message,S.FeatureName.DelayDeliveryActionCreator,"setDelayDeliveryTime"),t(!1))})})},I.prototype.getDelayDeliveryTime=function(e){return new Promise(function(t,n){e.delayDeliveryTime.getAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(new Date(e.value)):(f.default.logAssert("Get delay delivery time for current composing message failed with error: "+e.error.message,S.FeatureName.DelayDeliveryActionCreator,S.SourceName.GetDelayDeliveryTime),n(e.error))})})},I.prototype.setCustomProperty=function(e,r,o){return new Promise(function(n){e.loadCustomPropertiesAsync(function(e){var t
e.status===Office.AsyncResultStatus.Succeeded?((t=e.value).set(r,o),t.saveAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?n(!0):(f.default.logAssert("Save "+r+" for current composing message failed with error: "+e.error.message,S.FeatureName.DelayDeliveryActionCreator,"setCustomProperty"),n(!1))})):(f.default.logAssert("Load custom properties to set "+r+" for current composing message failed with error: "+e.error.message,S.FeatureName.DelayDeliveryActionCreator,"setCustomProperty"),n(!1))})})},I.prototype.getCustomProperty=function(e,r){return new Promise(function(t,n){e.loadCustomPropertiesAsync(function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value.get(r)):(f.default.logAssert("Load custom properties to get "+r+" for current composing message failed with error: "+e.error.message,S.FeatureName.DelayDeliveryActionCreator,"getCustomProperty"),n(e.error))})})},I.prototype.dispatchDelayDeliveryTime=function(e){d.default.dispatch({actionType:l.default.SetDelayDeliveryTime,delayDeliveryTime:e})},I.prototype.getTimeZoneWithDaylightTime=function(e){return a.default.getTimeZoneWithDaylightTime(new Date,e.timeZoneBiasInMinute,e.daylightTimeSetting)},I.prototype.areRecipientsInSimilarTimeZones=function(t){var n=-Number.MAX_VALUE,r=Number.MAX_VALUE
return Object.keys(t).forEach(function(e){n=Math.max(n,t[e]),r=Math.min(r,t[e])}),n-r<=this.SIMILAR_TIME_ZONE_THRESHOLD_IN_MINUTES},I.prototype.getAutoDelayDeliveryAdvertisementCount=function(){var e=y.default.tryGetRoamingSettings(y.RoamingSettingsKeys.AutoDelayDeliveryAdvertisementCount)
return null!=e?e:0},s.__decorate([_.expirable(_.ExpirationTypes.ByEvery_Minutes,.1)],I.prototype,"getToRecipientsWorkingHourConfigs",null),s.__decorate([_.expirable(_.ExpirationTypes.ByItemChange),_.expirable(_.ExpirationTypes.ByEvery_Minutes,.1,_.ExpirableInBackground.Allowed)],I.prototype,"getDelayDeliveryTimeAndCustomProperties",null),I=s.__decorate([_.expirable()],I))
function I(){this.IS_DELAY_DELIVERY_CANCELLED_NAME="IsDelayDeliveryCancelled",this.IS_SCHEDULED_BY_MY_ANALYTICS_NAME="IsScheduledByMyAnalytics",this.SIMILAR_TIME_ZONE_THRESHOLD_IN_MINUTES=180}t.DelayDeliveryActionCreator=T,t.default=new T},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.TeachingMomentTypes=void 0,(r=t.TeachingMomentTypes||(t.TeachingMomentTypes={}))[r.TrackEmailTip=0]="TrackEmailTip",r[r.DoNotDisturbFocus=1]="DoNotDisturbFocus",r[r.BookSuggestedTime=2]="BookSuggestedTime",r[r.PinInsights=3]="PinInsights",r[r.AutoDelayDelivery=4]="AutoDelayDelivery",r[r.InlineSuggestions=5]="InlineSuggestions"},,,,,,,,,,,function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.ItemTypes=t.Modes=void 0,(r=t.Modes||(t.Modes={})).Unknown="Unknown",r.Read="Read",r.Compose="Compose",(o=t.ItemTypes||(t.ItemTypes={})).Unknown="Unknown",o.Message="Message",o.Meeting="Meeting",o.Contextless="Contextless"},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FirstRunStore=t.FirstRunStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(114)),l=n(5),c=(r=u.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"hasFinishedInitialization",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"sessionsNumFromFirstAccess",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"shouldIgnorePeopleFirstRun",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasDismissedFocusTimeWorkingHourTip",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasDismissedAfterHourWorkingHourTip",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasUserVisitedDashboard",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).hasFinishedInitialization(e.hasFinishedInitialization).sessionsNumFromFirstAccess(e.sessionsNumFromFirstAccess).shouldIgnorePeopleFirstRun(e.shouldIgnorePeopleFirstRun).hasDismissedFocusTimeWorkingHourTip(e.hasDismissedFocusTimeWorkingHourTip).hasDismissedAfterHourWorkingHourTip(e.hasDismissedAfterHourWorkingHourTip).hasUserVisitedDashboard(e.hasUserVisitedDashboard)},i.__decorate([l.doop],d.prototype,"hasFinishedInitialization",null),i.__decorate([l.doop],d.prototype,"sessionsNumFromFirstAccess",null),i.__decorate([l.doop],d.prototype,"shouldIgnorePeopleFirstRun",null),i.__decorate([l.doop],d.prototype,"hasDismissedFocusTimeWorkingHourTip",null),i.__decorate([l.doop],d.prototype,"hasDismissedAfterHourWorkingHourTip",null),i.__decorate([l.doop],d.prototype,"hasUserVisitedDashboard",null),d=o=i.__decorate([l.doop],d))
function d(){return r.call(this)||this}t.FirstRunStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"FirstRunStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.getInitialState=function(){return new c},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.FirstRun},enumerable:!1,configurable:!0}),g.prototype.processInitializeRoamingSettings=function(e,t){return e.hasFinishedInitialization(!0).sessionsNumFromFirstAccess(t.roamingSettings.sessionsNumFromFirstAccess).shouldIgnorePeopleFirstRun(t.roamingSettings.shouldIgnorePeopleFirstRun).hasDismissedFocusTimeWorkingHourTip(t.roamingSettings.hasDismissedFocusTimeWorkingHourTip).hasDismissedAfterHourWorkingHourTip(t.roamingSettings.hasDismissedAfterHourWorkingHourTip).hasUserVisitedDashboard(t.roamingSettings.hasUserVisitedDashboard)},g.prototype.processIgnorePeopleSuggestionsFirstRun=function(e,t){return e.shouldIgnorePeopleFirstRun(!0)},g.prototype.processCloseFocusTimeWorkingHourTip=function(e,t){return e.hasDismissedFocusTimeWorkingHourTip(!0)},g.prototype.processCloseAfterHoursWorkingHourTip=function(e,t){return e.hasDismissedAfterHourWorkingHourTip(!0)},g.prototype.processVisitDashboard=function(e,t){return e.hasUserVisitedDashboard(!0)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.InitializeRoamingSettings,e.processInitializeRoamingSettings),e.addActionCallback(s.default.IgnorePeopleFirstRun,e.processIgnorePeopleSuggestionsFirstRun),e.addActionCallback(s.default.DismissFocusTimeWorkingHourTip,e.processCloseFocusTimeWorkingHourTip),e.addActionCallback(s.default.DismissAfterHoursWorkingHourTip,e.processCloseAfterHoursWorkingHourTip),e.addActionCallback(s.default.VisitDashboard,e.processVisitDashboard),e}t.FirstRunStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.OutcomeNames=void 0,(t.OutcomeNames||(t.OutcomeNames={})).IncreaseFocusTime="IncreaseFocus"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o,i=n(0),a=n(115),s=i.__importDefault(n(6)),u=i.__importDefault(n(8)),l=i.__importDefault(n(37)),c=i.__importDefault(n(54)),d=i.__importDefault(n(25)),p=i.__importDefault(n(62));(o=r=r||{}).Reply="reply",o.NewMail="newMail",o.Forward="forward",o.ForwardOrReply="forwarOrReply",o.NewOrDraft="newOrDraft",o.Unknown="unknown"
var f=(g.shouldEstimateToRecipients=function(){return!(!u.default.isEstimateToRecipientsEnabled||0!==l.default.getState().toRecipients().length)&&(c.default.doesSupportMessageComposeType?l.default.getState().messageComposeType()===Office.MailboxEnums.ComposeType.Reply:u.default.isFallbackToConversationId&&l.default.getState().isInConversation())},g.getComposeTypeStringWhenDDTriggered=function(){if(c.default.doesSupportMessageComposeType){if(void 0!==l.default.getState().messageComposeType())switch(l.default.getState().messageComposeType()){case Office.MailboxEnums.ComposeType.Reply:return r.Reply
case Office.MailboxEnums.ComposeType.Forward:return r.Forward
case Office.MailboxEnums.ComposeType.NewMail:return r.NewMail
default:return r.Unknown}return r.Unknown}return l.default.getState().isInConversation()?r.ForwardOrReply:r.NewOrDraft},g.hasExternalRecipients=function(){return l.default.getState().hasExternalRecipients()},g.getToRecipients=function(){return g.shouldEstimateToRecipients()?l.default.getState().estimatedToRecipients():l.default.getState().toRecipientsInUserType()},g.getSortedTimeZoneSupplementList=function(e,t){var n=g.getTimeZoneToRecipientsCountMap(e,t),r=[]
return Object.keys(n).sort(function(e,t){return n[t]-n[e]}).forEach(function(e){r.push({timeZoneBiasInMinute:Number(e),recipientsCount:n[e]})}),r},g.qualifyLicensesCheck=function(e){return d.default.IsAdvancedExperience||e&&p.default.isFlightEnabled(p.default.DELAY_DELIVERY_P1_LICENSE_EXPANSION)||d.default.IsBasicExperience&&p.default.isFlightEnabled(p.default.AUTO_DELAY_DELIVERY_E1_E3_EXPANSION)},g.getTimeZoneToRecipientsCountMap=function(e,t){var n=g.filterAddressToTimeZoneMap(e,t),r=s.default.aggregateObjectArrayByKey(Object.keys(n),function(e){return n[e]}),o={}
return Object.keys(r).forEach(function(e){return o[e]=r[e].length}),o},g.filterAddressToTimeZoneMap=function(e,t){var n={}
return e.filter(function(e){return e.recipientType===a.IRecipientType.User}).map(function(e){return e.emailAddress}).forEach(function(e){t[e]&&(n[e]=t[e])}),n},g)
function g(){}t.default=f},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SearchContextComparerBase=void 0
var r=n(0).__importDefault(n(4)),o=(i.prototype.hasMeaningfulChange=function(e,t){if(!e&&!t)return!1
if(!!e!=!!t)return!0
try{return this.hasInterestingChange(e,t)}catch(e){return r.default.logAssert("Unexpected error: "+e,"SearchContextCheckerBase",this.logSourceName),!1}},i)
function i(){}t.SearchContextComparerBase=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TimeAwayActionCreator=void 0
var s=n(0),a=s.__importStar(n(58)),u=s.__importDefault(n(35)),l=s.__importDefault(n(3)),c=s.__importDefault(n(11)),d=s.__importDefault(n(381)),o=s.__importDefault(n(942)),r=s.__importDefault(n(943)),p=s.__importDefault(n(104)),i=s.__importDefault(n(8)),f=s.__importStar(n(65)),g=s.__importDefault(n(944)),m=s.__importDefault(n(244)),h=s.__importDefault(n(24)),y=s.__importDefault(n(949)),_=s.__importDefault(n(57)),S=s.__importStar(n(4)),T=n(7),I=n(51),b=n(34),E=n(29),v=n(16),A=(D.prototype.getTimeAwayRecordWESAndDispatch=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return i.default.isTimeAwayPreparationEnabled?(t=new y.default(v.HTTPRequestMethod.GET,a.TIME_AWAY_FEATURE_NAME,"getTimeAwayRecordWES",S.LogRequestType.Interval).StartTime(new Date).orderByField(["IsConfirmed desc","Priority","StartTime"]).top(1),[4,u.default.executeWESRequest(t)]):[2]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?1===n.result.value.length&&new Date(n.result.value[0].EndTime)>new Date?(c.default.dispatch({actionType:l.default.GetTimeAwayRecord,timeAwayRecord:n.result.value[0]}),this.getOptionalTasksDependencies(new Date(n.result.value[0].StartTime),new Date(n.result.value[0].EndTime),b.RequestPriority.Low)):c.default.dispatch({actionType:l.default.SetNoTimeAway}):c.default.dispatch({actionType:l.default.UpdateGetActiveContactsStatus,isSuccess:!1}),[2]}})})},D.prototype.getOptionalTasksDependencies=function(e,t,n){this.getAutomaticRepliesSettingWESAndDispatch(n),g.default.getActiveNetworkContactsWESAndDispatch(a.TIME_AWAY_FEATURE_NAME,n),this.getMeetingsDuringTimeAwayAndDispatch(e,t),m.default.getProtectedTimeAroundTimeAwayAndDispatch(e,t)},D.prototype.getMeetingsDuringTimeAwayAndDispatch=function(o,i,a){return void 0===a&&(a=b.RequestPriority.Low),s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){return new Date>o&&(o=new Date),t=h.default.addDays(o,2),n=i.getTime()>t.getTime(),r=n?t:i,this.pullMeetingsDuringTimeAway(o,r,a,!0),n&&this.pullMeetingsDuringTimeAway(r,i,a,!1),[2]})})},D.prototype.getAutomaticRepliesSettingWES=function(r){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return t=new o.default(a.TIME_AWAY_FEATURE_NAME,"getAutomaticRepliesSettingWES",S.LogRequestType.Interval),[4,u.default.executeWESRequest(t,r)]
case 1:return n=e.sent(),[2,this.convertIAutomaticRepliesSettingFromJson(n.result)]}})})},D.prototype.cancelTimeAwayAndDispatch=function(r,o,i){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.cancelOOFEventAndLog(r,o)]
case 1:return(t=e.sent()).isSuccessful?[4,this.cancelTimeAwayWES(i)]:[2,t]
case 2:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded||404===n.responseStatusCode?(this.clearMeetingsDuringTimeAway(),c.default.dispatch({actionType:l.default.ForceSetNoTimeAway}),[2,{isSuccessful:!0}]):[2,{isSuccessful:!1}]}})})},D.prototype.cancelOOFEventAndLog=function(n,r){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,p.default.deleteBookedBlock(a.TIME_AWAY_FEATURE_NAME,n,E.CalendarItemType.OOFTime)]
case 1:return(t=e.sent()).isSuccessful?(this.logScheduleTimeAwayInfo(n,r),[2,{isSuccessful:!0}]):[2,t]}})})},D.prototype.logScheduleTimeAwayInfo=function(e,t){var n={duration:t.getTime()-e.getTime()}
S.default.logInformation(JSON.stringify(n),a.TIME_AWAY_FEATURE_NAME,"ScheduleTimeAwayInfo")},D.prototype.postNewTimeAwayWESAndDispatch=function(n,r){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return r?[4,this.updateTimeAwayStateWESAndDispatch(n)]:[3,2]
case 1:return[2,e.sent()]
case 2:return t=new y.default(v.HTTPRequestMethod.POST,a.TIME_AWAY_FEATURE_NAME,"postTimeAwayStateWES",S.LogRequestType.Action).targetEntity(this.convertTimeAwayStateToJSON(n)),[4,u.default.executeWESRequest(t,b.RequestPriority.High)]
case 3:return e.sent().status===Office.AsyncResultStatus.Succeeded?(this.dispatchNewTimeAwayState(n),[2,{isSuccessful:!0}]):[2,{isSuccessful:!1}]}})})},D.prototype.updateTimeAwayStateWESAndDispatch=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.updateTimeAwayStateWES(t)]
case 1:return e.sent().status!==Office.AsyncResultStatus.Succeeded?[2,{isSuccessful:!1}]:(this.dispatchNewTimeAwayState(t),[2,{isSuccessful:!0}])}})})},D.prototype.dispatchNewTimeAwayState=function(e){var t,n=null!==(t=f.default.tryGetRoamingSettings(f.RoamingSettingsKeys.DeletedMeetingsDuringTimeAway))&&void 0!==t?t:0
e=e.deletedMeetingsCount(n),c.default.dispatch({actionType:l.default.SetTimeAwayState,timeAwayState:e})},D.prototype.updateAutoReplySettingWESAndDispatch=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return t=new r.default(a.TIME_AWAY_FEATURE_NAME,"UpdateAutoReplySettingWES",S.LogRequestType.Action).AutomaticRepliesSetting(this.convertIAutomaticRepliesSettingToJson(n)),[4,u.default.executeWESRequest(t,b.RequestPriority.High)]
case 1:return e.sent().status!==Office.AsyncResultStatus.Succeeded?[2,{isSuccessful:!1}]:(c.default.dispatch({actionType:l.default.SetAutoReplySetting,automaticRepliesSetting:n}),[2,{isSuccessful:!0}])}})})},D.prototype.getMeetingsDuringTimeAway=function(e,t){c.default.dispatch({actionType:t?l.default.GetMeetingsDuringTimeAway1stBatch:l.default.GetMeetingsDuringTimeAway2ndBatch,meetings:e})},D.prototype.clearMeetingsDuringTimeAway=function(){f.default.trySetRoamingSettings(f.RoamingSettingsTypes.TimeAway,f.RoamingSettingsKeys.DeletedMeetingsDuringTimeAway,0),c.default.dispatch({actionType:l.default.ClearDeletedMeetingsCount}),this.getMeetingsDuringTimeAway([],!0),this.getMeetingsDuringTimeAway([],!1)},D.prototype.dismissAll=function(){c.default.dispatch({actionType:l.default.DismissAllTimeAwayInstances})},D.prototype.updateHolidayCardLoadHistoryAndDispatch=function(e,t){var n
if(t&&t.id===e){if(t.sessions.some(function(e){return e===_.default.sessionGuid}))return
n={id:e,sessions:t.sessions.concat(_.default.sessionGuid)}}else n={id:e,sessions:[_.default.sessionGuid]}
c.default.dispatchAsync({actionType:l.default.UpdateHolidayCardLoadHistory,holidayCardLoadHistory:n})},D.prototype.dismissHoliday=function(e){c.default.dispatch({actionType:l.default.DismissHoliday,holidayTimeAwayId:e})},D.prototype.autoExpandNextTask=function(){c.default.dispatch({actionType:l.default.ExpandNextPreparationTask})},D.prototype.executeScheduleTimeAwayCalloutVisibilityChange=function(e){c.default.dispatch({actionType:l.default.UpdateScheduleTimeAwayCallout,showCallout:e})},D.prototype.setStartTimeRescheduleStatus=function(e){c.default.dispatch({actionType:l.default.SetStartTimeRescheduleStatus,isRescheduling:e})},D.prototype.setEndTimeRescheduleStatus=function(e){c.default.dispatch({actionType:l.default.SetEndTimeRescheduleStatus,isRescheduling:e})},D.prototype.setPullingMeetingsDuringTimeAwayStatus=function(e,t){c.default.dispatch({actionType:t?l.default.SetPullingMeetingsDuringTimeAway1stBatchStatus:l.default.SetPullingMeetingsDuringTimeAway2ndBatchStatus,isPulling:e})},D.prototype.setPullingMeetingsDuringTimeAwayError=function(e,t){c.default.dispatch({actionType:t?l.default.SetPullingMeetingsDuringTimeAway1stBatchError:l.default.SetPullingMeetingsDuringTimeAway2ndBatchError,failed:e})},D.prototype.updateExpandStatus=function(e,t){c.default.dispatch({actionType:l.default.ChangeTimeAwayDropDown,taskName:e,expandStatus:t})},D.prototype.pullMeetingsDuringTimeAway=function(e,t,n,r){var o=this
this.setPullingMeetingsDuringTimeAwayStatus(!0,r)
var i=new d.default(a.TIME_AWAY_FEATURE_NAME,"getMeetingsDuringTimeAwayREST",S.LogRequestType.Action).startDate(e).endDate(t).selectField(["Id","IsCancelled","Start","End","ShowAs","Attendees","Subject","isOrganizer","ResponseRequested","IsAllDay"]).orderByField(["Start/DateTime"]).top(p.default.MAX_ITEMS_PER_PAGE)
u.default.executeRequestWithPaging(i,n).then(function(e){e.status===Office.AsyncResultStatus.Succeeded?(o.setPullingMeetingsDuringTimeAwayError(!1,r),o.getMeetingsDuringTimeAway(p.default.processGetCalendarItems(e).filter(function(e){return e.calendarItemType===E.CalendarItemType.Meeting&&e.busyStatus!==E.BusyStatus.Free}),r)):o.setPullingMeetingsDuringTimeAwayError(!0,r),o.setPullingMeetingsDuringTimeAwayStatus(!1,r)})},D.prototype.getAutomaticRepliesSettingWESAndDispatch=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.getAutomaticRepliesSettingWES(n)]
case 1:return t=e.sent(),c.default.dispatch({actionType:l.default.SetAutoReplySetting,automaticRepliesSetting:t}),[2]}})})},D.prototype.cancelTimeAwayWES=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return t=new y.default(v.HTTPRequestMethod.DELETE,a.TIME_AWAY_FEATURE_NAME,"deleteTimeAwayWES",S.LogRequestType.Action).targetEntityKey(n),[4,u.default.executeWESRequest(t,b.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},D.prototype.updateTimeAwayStateWES=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return t=new y.default(v.HTTPRequestMethod.PUT,a.TIME_AWAY_FEATURE_NAME,"updateTimeAwayStateWES",S.LogRequestType.Action).targetEntityKey(n.id()).targetEntity(this.convertTimeAwayStateToJSON(n)),[4,u.default.executeWESRequest(t,b.RequestPriority.High)]
case 1:return[2,e.sent()]}})})},D.prototype.convertIAutomaticRepliesSettingFromJson=function(e){return{status:a.AutomaticRepliesSettingStatus[e.Status],externalAudience:a.AutomaticRepliesSettingExternalAudience[e.ExternalAudience],internalReplyMessage:e.InternalReplyMessage,externalReplyMessage:e.ExternalAudience,scheduledStartDateTime:new Date(e.ScheduledStartDateTime),scheduledEndDateTime:new Date(e.ScheduledEndDateTime)}},D.prototype.convertIAutomaticRepliesSettingToJson=function(e){var t={Status:a.AutomaticRepliesSettingStatus[e.status]}
return e.status!==a.AutomaticRepliesSettingStatus.Disabled&&(t.ExternalAudience=a.AutomaticRepliesSettingExternalAudience[e.externalAudience],t.InternalReplyMessage=e.internalReplyMessage,t.ExternalReplyMessage=e.externalReplyMessage,e.status===a.AutomaticRepliesSettingStatus.Scheduled&&(t.ScheduledStartDateTime=e.scheduledStartDateTime.toISOString(),t.ScheduledEndDateTime=e.scheduledEndDateTime.toISOString())),t},D.prototype.convertTimeAwayStateToJSON=function(e){var t={}
return t[a.TimeAwayPreparationTaskNames.SetAutoReply]=e.preparation().setAutoReplyStatus,t[a.TimeAwayPreparationTaskNames.NotifyContacts]=e.preparation().notifyContactsStatus,t[a.TimeAwayPreparationTaskNames.ResolveMeetings]=e.preparation().resolveMeetingsStatus,t[a.TimeAwayPreparationTaskNames.ScheduleCatchUpTime]=e.preparation().scheduleCatchUpTimeStatus,{Id:e.id(),StartTime:e.startTime().toISOString(),EndTime:e.endTime().toISOString(),TimeAwayType:e.timeAwayType(),IsConfirmed:e.isConfirmed(),TasksStatus:t,AdditionalDetails:{HolidayName:e.holidayName(),BookTime:h.default.toISOString(e.bookTime()),ConfirmTime:h.default.toISOString(e.confirmTime()),TimeAwayMessageSentTime:h.default.toISOString(e.timeAwayMessageSentTime())}}},s.__decorate([I.expirable(I.ExpirationTypes.ByEvery_Minutes,T.Constants.halfHourInMinutes)],D.prototype,"getTimeAwayRecordWESAndDispatch",null),D=s.__decorate([I.expirable()],D))
function D(){}t.TimeAwayActionCreator=A,t.default=new A},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeSettingsStore=t.FocusTimeSettingsStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=i.__importDefault(n(8)),d=(r=l.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"hoursPerDay",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isDoNotDisturbEnabled",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isTeamsReminderEnabled",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"preferredTimeOfDay",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"preferredStartMinute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastModifiedTime",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hasLoaded",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"shouldEnableCalendarReminder",{get:function(){return!c.default.isFocusReminderSettingEnabled||!this.isTeamsReminderEnabled()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{hoursPerDay:this.hoursPerDay(),isDoNotDisturbEnabled:this.isDoNotDisturbEnabled(),isTeamsReminderEnabled:this.isTeamsReminderEnabled(),preferredTimeOfDay:this.preferredTimeOfDay(),preferredStartMinute:this.preferredStartMinute(),lastModifiedTime:this.lastModifiedTime(),hasLoaded:this.hasLoaded()}},p.prototype.fromJSON=function(e){return(new o).hoursPerDay(e.hoursPerDay).isDoNotDisturbEnabled(e.isDoNotDisturbEnabled).isTeamsReminderEnabled(e.isTeamsReminderEnabled).preferredTimeOfDay(e.preferredTimeOfDay).preferredStartMinute(e.preferredStartMinute).lastModifiedTime(e.lastModifiedTime).hasLoaded(e.hasLoaded)},i.__decorate([u.doop],p.prototype,"hoursPerDay",null),i.__decorate([u.doop],p.prototype,"isDoNotDisturbEnabled",null),i.__decorate([u.doop],p.prototype,"isTeamsReminderEnabled",null),i.__decorate([u.doop],p.prototype,"preferredTimeOfDay",null),i.__decorate([u.doop],p.prototype,"preferredStartMinute",null),i.__decorate([u.doop],p.prototype,"lastModifiedTime",null),i.__decorate([u.doop],p.prototype,"hasLoaded",null),p=o=i.__decorate([u.doop],p))
function p(){var e=r.call(this)||this
return e.hasLoaded(!1),e}t.FocusTimeSettingsStoreState=d
var f,g=(f=l.default,i.__extends(m,f),Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.FocusTimeSettings},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"FocusTimeSettingsStore"},m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},m.prototype.processFocusTimeSettings=function(e,t){return e.hoursPerDay(t.hoursPerDay).isDoNotDisturbEnabled(t.isDoNotDisturbEnabled).isTeamsReminderEnabled(t.isTeamsReminderEnabled).preferredTimeOfDay(t.preferredTimeOfDay).preferredStartMinute(t.preferredStartMinute).lastModifiedTime(t.lastModifiedTime).hasLoaded(!0)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.FocusTimeSettings,e.processFocusTimeSettings),e}t.FocusTimeSettingsStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RoutesStore=t.RoutesStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importDefault(n(134)),u=n(5),l=n(107),c=o.__importStar(n(83)),d=(r=c.DataStreamStoreStateBase,o.__extends(p,r),Object.defineProperty(p.prototype,"activeRoute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"previousRoutes",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isCurrentlyGoBack",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],p.prototype,"activeRoute",null),o.__decorate([u.doop],p.prototype,"previousRoutes",null),o.__decorate([u.doop],p.prototype,"isCurrentlyGoBack",null),p=o.__decorate([u.doop],p))
function p(){var e=r.call(this)||this
return e.activeRoute({routeName:l.Routes.Feed,context:void 0,digestContext:void 0}),e.previousRoutes([]),e.isCurrentlyGoBack(!1),e}t.RoutesStoreState=d
var f,g=(f=c.default,o.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"RoutesStore"},m.prototype.setStateForItemChangedEvent=function(e,t){return e},m.prototype.getInitialState=function(){return new d},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.Navigation},enumerable:!1,configurable:!0}),m.prototype.processNavigateTo=function(e,t){var n=e.previousRoutes()
return t.route.routeName===l.Routes.Feed?this.getInitialState():s.default(t.route,e.activeRoute())?e:(n=n.concat(e.activeRoute()),e.previousRoutes(n).activeRoute(t.route).isCurrentlyGoBack(!1))},m.prototype.processNavigateBack=function(e,t){var n=e.previousRoutes()
return 0===n.length?this.getInitialState():e.activeRoute(n.pop()).previousRoutes(n).isCurrentlyGoBack(!0)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(a.default.NavigateTo,e.processNavigateTo),e.addActionCallback(a.default.NavigateBack,e.processNavigateBack),e}t.RoutesStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionableMessageConverterBase=void 0
var r=n(0),o=r.__importDefault(n(11)),i=r.__importDefault(n(52)),a=r.__importDefault(n(4)),s=n(1016),u=(l.prototype.dispatchConvertedInsight=function(e){o.default.dispatch({actionType:this.dispatchActionName,insight:e})},l.prototype.additionalDependency=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,Promise.resolve()]})})},l.prototype.convertAndDispatchInsight=function(e){var t=this.parseAsInsightInstance(e.version,e.context),n=t
n.identifier=e.insightIdentifier.identifier
var r=e.context
n.doesSupportNudgeFeedback=i.default.doesSupportNudgeFeedback(r.Insight),this.dispatchConvertedInsight(n),this.additionalDependency(t)},l.convertToActionableMessageContext=function(e){var t=s.ActionableMessageConverter_V2.convertToActionableMessageContext(e)
if(t)return t
a.default.logAssert("No mapping for actionable message found","ExternalInsightConverter","parseAsActionableMessageContext")},l)
function l(){}t.ActionableMessageConverterBase=u},,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDataAccessor=t.SessionDataKeys=void 0
var a,r,o=n(0),i=o.__importDefault(n(3)),s=o.__importDefault(n(25)),u=o.__importDefault(n(11)),l=o.__importDefault(n(8)),c=o.__importDefault(n(4)),d=o.__importDefault(n(6));(r=a=t.SessionDataKeys||(t.SessionDataKeys={})).UserSessionState="UserSessionState",r.IsInfobarControlTakenByVertical="IsInfobarControlTakenByVertical",r.BootStoreState="BootStoreState",r.InfobarStoreState="InfobarStoreState",r.InfobarInsightsStoreState="InfobarInsightsStoreState",r.SearchContextInsightsStoreState="SearchContextInsightsStoreState",r.UserSettingsStoreState="UserSettingsStoreState",r.DelayDeliveryStoreState="DelayDeliveryStoreState",r.FollowUpRequestTaskEntitiesStoreState="FollowUpRequestTaskEntitiesStoreState",r.FollowUpsInsightStoreState="FollowUpsInsightStoreState",r.MeetingPreparationInfobarStoreState="MeetingPreparationInfobarStoreState",r.TasksInsightStoreState="TasksInsightStoreState",r.TimeAwayStoreState="TimeAwayStoreState"
var p=(f.prototype.getAllSessionDataAndDispatch=function(){var o=this
if(l.default.doesSupportSessionData)return new Promise(function(r){Office.context.mailbox.item.sessionData.getAllAsync(function(e){try{var t,n
e.status===Office.AsyncResultStatus.Succeeded?(t=o.buildSessionDataMap(e.value),0<(n=Object.keys(t).length)&&u.default.dispatch({actionType:i.default.LoadFromSessionData,sessionDataMap:t}),c.default.logInformation("Succeed in getting "+n+" keys",o.LOG_FEATURE_NAME,"getAllSessionData")):c.default.logAssert("Failed: "+JSON.stringify(e.error),o.LOG_FEATURE_NAME,"getAllSessionData")}catch(e){c.default.logAssert("Caught: "+e,o.LOG_FEATURE_NAME,"getAllSessionData")}finally{r()}})})},f.prototype.getSessionData=function(r,o){var i=this
if(l.default.doesSupportSessionData)return new Promise(function(n){Office.context.mailbox.item.sessionData.getAsync(r,function(e){var t
e.status===Office.AsyncResultStatus.Succeeded?(t=JSON.parse(e.value,d.default.dateReviver),o&&o(t),c.default.logInformation("Succeed in getting key: "+a[r],i.LOG_FEATURE_NAME,"getSessionData"),n(t)):(e.error.name!==i.KEY_NOT_FOUND_ERROR_NAME&&c.default.logAssert("Failed in getting "+a[r]+", error is "+JSON.stringify(e.error),i.LOG_FEATURE_NAME,"getSessionData"),n(void 0))})})},f.prototype.setSessionData=function(n,e){var r=this
if(l.default.doesSupportSessionData)return new Promise(function(t){Office.context.mailbox.item.sessionData.setAsync(n,JSON.stringify(e),function(e){e.status===Office.AsyncResultStatus.Succeeded?(s.default.isLocalDebugging&&c.default.logInformation("Succeed in setting key: "+a[n],r.LOG_FEATURE_NAME,"setSessionData"),t(!0)):(c.default.logAssert("Failed in setting "+a[n]+", error is "+JSON.stringify(e.error),r.LOG_FEATURE_NAME,"setSessionData"),t(!1))})})},f.prototype.buildSessionDataMap=function(t){"string"==typeof t&&(t=JSON.parse(t,d.default.dateReviver))
var n={}
return Object.keys(t).forEach(function(e){n[e]=JSON.parse(t[e],d.default.dateReviver)}),n},f)
function f(){this.LOG_FEATURE_NAME="SessionDataAccessor",this.KEY_NOT_FOUND_ERROR_NAME="KeyNotFound"}t.SessionDataAccessor=p,t.default=new p},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogStore=t.ActionLogStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(284)),s=i.__importStar(n(15)),u=i.__importDefault(n(3)),l=i.__importStar(n(114)),c=n(5),d=(r=l.LoadableDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"dismissActions",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actedUponActions",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hasLoadedFromStorage",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"hasLoadedFeedbackLogsByEWS",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),p.prototype.fromJSON=function(e){return(new o).dismissActions(e.dismissActions).actedUponActions(e.actedUponActions).hasLoadedFromStorage(e.hasLoadedFromStorage).hasLoadedFeedbackLogsByEWS(e.hasLoadedFeedbackLogsByEWS)},i.__decorate([c.doop],p.prototype,"dismissActions",null),i.__decorate([c.doop],p.prototype,"actedUponActions",null),i.__decorate([c.doop],p.prototype,"hasLoadedFromStorage",null),i.__decorate([c.doop],p.prototype,"hasLoadedFeedbackLogsByEWS",null),p=o=i.__decorate([c.doop],p))
function p(){var e=r.call(this)||this
return e.dismissActions([]),e.actedUponActions([]),e}t.ActionLogStoreState=d
var f,g=(f=l.default,i.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"ActionLogStore"},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return s.WellKnownDataSources.ActionLog},enumerable:!1,configurable:!0}),m.prototype.setStateForItemChangedEvent=function(e,t){return e},m.prototype.getInitialState=function(){return new d},m.prototype.getInsightActionLog=function(){return this.getState().dismissActions().concat(this.getState().actedUponActions())},m.prototype.processInsightActionLogItem=function(e,t){var n=t.logItems.filter(function(e){return e.logItemType===a.ActionLogTypes.Dismiss}),r=t.logItems.filter(function(e){return e.logItemType===a.ActionLogTypes.ActedUpon})
return e.dismissActions(e.dismissActions().concat(n)).actedUponActions(e.actedUponActions().concat(r))},m.prototype.processHistoricalInsightActionLogItems=function(e,t){return e=(e=(e=e.dismissActions(t.logItems.filter(function(e){return e.logItemType===a.ActionLogTypes.Dismiss}))).actedUponActions(t.logItems.filter(function(e){return e.logItemType===a.ActionLogTypes.ActedUpon}))).hasLoadedFromStorage(!0)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(u.default.InsightActionLogItem,e.processInsightActionLogItem),e.addActionCallback(u.default.HistoricalInsightActionLogItems,e.processHistoricalInsightActionLogItems),e}t.ActionLogStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PropertySetExtendedFieldURI=t.DistinguishedPropertySetExtendedFieldURI=void 0
var o=n(0).__importDefault(n(68)),i=n(7),r=(a.prototype.buildXMLString=function(){return'<t:ExtendedFieldURI\n                    DistinguishedPropertySetId="'+this.distinguishedPropertySetId+'"\n                    PropertyName="'+this.propertyName+'"\n                    PropertyType="'+this.propertyType+'"/>'},a.prototype.doesMatchExtendedPropertyElement=function(e){var t=o.default.getXMLExactlyOneElementOrThrow(e,i.Constants.EWSTypesNamespace,"ExtendedFieldURI"),n=t.attributes.getNamedItem("PropertyName"),r=t.attributes.getNamedItem("DistinguishedPropertySetId")
return n&&n.value.toLowerCase()===this.propertyName.toLowerCase()&&r&&r.value.toLowerCase()===this.distinguishedPropertySetId.toLowerCase()},a.prototype.buildJSONString=function(){return this.propertyType+" {"+this.distinguishedPropertySetId+"} Name "+this.propertyName},a)
function a(e,t,n){this.distinguishedPropertySetId=e,this.propertyName=t,this.propertyType=n}t.DistinguishedPropertySetExtendedFieldURI=r
var s=(u.prototype.buildXMLString=function(){return'<t:ExtendedFieldURI\n                    PropertySetId="'+this.propertySetId+'"\n                    PropertyName="'+this.propertyName+'"\n                    PropertyType="'+this.propertyType+'"/>'},u.prototype.doesMatchExtendedPropertyElement=function(e){var t=o.default.getXMLExactlyOneElementOrThrow(e,i.Constants.EWSTypesNamespace,"ExtendedFieldURI"),n=t.attributes.getNamedItem("PropertyName"),r=t.attributes.getNamedItem("PropertySetId")
return n&&n.value.toLowerCase()===this.propertyName.toLowerCase()&&r&&r.value.toLowerCase()===this.propertySetId.toLowerCase()},u.prototype.buildJSONString=function(){return this.propertyType+" {"+this.propertySetId+"} Name "+this.propertyName},u)
function u(e,t,n){this.propertySetId=e,this.propertyName=t,this.propertyType=n}t.PropertySetExtendedFieldURI=s
var l=(c.COMPLETED_FOLLOWUP_REQUESTS_V1=new s("00062008-0000-0000-C000-000000000046","MyAnalytics/CompletedFollowUpRequestIDs_V1","String"),c.SCHEDULE_ACTION_V1=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/ScheduleAction1.0","String"),c.ACTION_V1=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/Action1.0","String"),c.FOLLOWUP_SCHEDULE_ACTION_V1=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/FollowUpScheduleAction1.0","String"),c.FOLLOWUP_SCHEDULE_REPLY_REQUEST_V1=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/FollowUpScheduleReplyRequest1.0","String"),c.FOLLOWUP_SCHEDULE_ACTION_REQUEST_V1=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/FollowUpScheduleActionRequest1.0","String"),c.IS_MENTIONED=new s("41F28F13-83F4-4114-A584-EEDB5A6B0BFF","IsMentioned","Boolean"),c.MENTIONS_EX=new s("E550B918-9859-47B9-8095-97E4E72F1926","MentionsEx","String"),c.IS_DO_NOT_DISTURB_TIME=new s("6ED8DA90-450B-101B-98DA-00AA003F1305","IsDoNotDisturbTime","Boolean"),c.IS_BOOKED_FREE_BLOCKS=new s("6ED8DA90-450B-101B-98DA-00AA003F1305","IsBookedFreeBlocks","Boolean"),c.IS_BOOKED_LUNCH_TIME=new s("6ED8DA90-450B-101B-98DA-00AA003F1305","IsBookedLunchTime","Boolean"),c.IS_BOOKED_OOF_TIME=new s("6ED8DA90-450B-101B-98DA-00AA003F1305","IsBookedOOFTime","Boolean"),c.IRANKER_SCORE=new s("00062008-0000-0000-C000-000000000046","EntityExtraction/IRankerScore1.0","String"),c)
function c(){}t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(11)),o=n(3),i=(a.updateDebugMessage=function(e){r.default.dispatch({actionType:o.Action.UpdateDebugMessage,message:e})},a.clearDebugMessage=function(){r.default.dispatch({actionType:o.Action.UpdateDebugMessage,message:""})},a)
function a(){}t.default=i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryStore=t.DelayDeliveryStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(114)),l=n(5),c=(r=u.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"scheduledDelayDeliveryDateTime",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isScheduledByMyAnalytics",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isDelayDeliveryCancelled",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"shouldDisplayRecipientsTimeZone",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userAddressToTimeZoneMap",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"shouldDisplayAdvertisement",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasUpdatedAdvertisementCount",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"hasErrorHappened",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).scheduledDelayDeliveryDateTime(e.scheduledDelayDeliveryDateTime).isScheduledByMyAnalytics(e.isScheduledByMyAnalytics).isDelayDeliveryCancelled(e.isDelayDeliveryCancelled).shouldDisplayRecipientsTimeZone(e.shouldDisplayRecipientsTimeZone).userAddressToTimeZoneMap(e.userAddressToTimeZoneMap).hasErrorHappened(e.hasErrorHappened)},d.prototype.toJSON=function(){return{scheduledDelayDeliveryDateTime:this.scheduledDelayDeliveryDateTime(),isScheduledByMyAnalytics:this.isScheduledByMyAnalytics(),isDelayDeliveryCancelled:this.isDelayDeliveryCancelled(),shouldDisplayRecipientsTimeZone:this.shouldDisplayRecipientsTimeZone(),userAddressToTimeZoneMap:this.userAddressToTimeZoneMap(),hasErrorHappened:this.hasErrorHappened(),shouldDisplayAdvertisement:!1,hasUpdatedAdvertisementCount:!1}},i.__decorate([l.doop],d.prototype,"scheduledDelayDeliveryDateTime",null),i.__decorate([l.doop],d.prototype,"isScheduledByMyAnalytics",null),i.__decorate([l.doop],d.prototype,"isDelayDeliveryCancelled",null),i.__decorate([l.doop],d.prototype,"shouldDisplayRecipientsTimeZone",null),i.__decorate([l.doop],d.prototype,"userAddressToTimeZoneMap",null),i.__decorate([l.doop],d.prototype,"shouldDisplayAdvertisement",null),i.__decorate([l.doop],d.prototype,"hasUpdatedAdvertisementCount",null),i.__decorate([l.doop],d.prototype,"hasErrorHappened",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.scheduledDelayDeliveryDateTime(null),e.isScheduledByMyAnalytics(void 0),e.isDelayDeliveryCancelled(void 0),e.shouldDisplayRecipientsTimeZone(!1),e.userAddressToTimeZoneMap({}),e.shouldDisplayAdvertisement(!1),e.hasUpdatedAdvertisementCount(!1),e.hasErrorHappened(!1),e}t.DelayDeliveryStoreState=c
var p,f=(p=u.default,i.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DelayDelivery},enumerable:!1,configurable:!0}),g.prototype.getInitialState=function(){return new c},g.prototype.getStoreLoggingName=function(){return"DelayDeliveryStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},g.prototype.processSetDelayDeliveryTime=function(e,t){return this.processDelayDeliveryTimeChange(e,t.delayDeliveryTime)},g.prototype.processGetDelayDeliveryProperties=function(e,t){return this.processDelayDeliveryTimeChange(e,t.delayDeliveryTime).isScheduledByMyAnalytics(t.isScheduledByMyAnalytics).isDelayDeliveryCancelled(t.isDelayDeliveryCancelled)},g.prototype.processHasErrorHappened=function(e){return e.hasErrorHappened(!0)},g.prototype.processGetUserAddressToTimeZoneMap=function(e,t){var n=e.userAddressToTimeZoneMap(),r=!1
return Object.keys(t.userAddressToTimeZoneMap).forEach(function(e){n[e]||(n[e]=t.userAddressToTimeZoneMap[e],r=!0)}),r?e.userAddressToTimeZoneMap(i.__assign({},n)).shouldDisplayRecipientsTimeZone(t.shouldDisplayRecipientsTimeZone):e.shouldDisplayRecipientsTimeZone(t.shouldDisplayRecipientsTimeZone)},g.prototype.processGetAdvertisementCount=function(e,t){return e.shouldDisplayAdvertisement(t.advertisementCount<3)},g.prototype.processUpdateAdvertisementCount=function(e){return e.hasUpdatedAdvertisementCount(!0)},g.prototype.processDelayDeliveryTimeChange=function(e,t){var n=e.scheduledDelayDeliveryDateTime()
return n&&t&&n.getTime()===t.getTime()?e:e.scheduledDelayDeliveryDateTime(t)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.SetDelayDeliveryTime,e.processSetDelayDeliveryTime),e.addActionCallback(s.default.GetDelayDeliveryProperties,e.processGetDelayDeliveryProperties),e.addActionCallback(s.default.SetHasErrorHappenedInDelayDelivery,e.processHasErrorHappened),e.addActionCallback(s.default.GetUserAddressToTimeZoneMap,e.processGetUserAddressToTimeZoneMap),e.addActionCallback(s.default.GetAutoDelayDeliveryAdvertisementCount,e.processGetAdvertisementCount),e.addActionCallback(s.default.UpdateAutoDelayDeliveryAdvertisementCount,e.processUpdateAdvertisementCount),e}t.DelayDeliveryStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.IS_MEETING_PREPARATION_INFOBAR_SHOWN_DURING_COMPOSE_CUSTOM_PROP=t.SHORT_PREPARATION_TIME_DURATION=t.LONG_PREPARATION_TIME_DURATION=t.MEETING_PREPARATION_APPOINTMENTID_CUSTOM_PROP=t.MEETING_PREPARATION_INFOBAR_INSIGHT_NAME=void 0,t.MEETING_PREPARATION_INFOBAR_INSIGHT_NAME="MeetingPreparationInsight",t.MEETING_PREPARATION_APPOINTMENTID_CUSTOM_PROP="PreparationAppointmentId",t.LONG_PREPARATION_TIME_DURATION=30,t.SHORT_PREPARATION_TIME_DURATION=15,t.IS_MEETING_PREPARATION_INFOBAR_SHOWN_DURING_COMPOSE_CUSTOM_PROP="IsMeetingPreparationInfobarShownDuringCompose"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.OutcomeStore=t.OutcomeStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=n(42),c=n(148),d=(r=l.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"isFocusOutcomeEnrolled",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"wasOutcomeAPISuccessful",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{isFocusOutcomeEnrolled:this.isFocusOutcomeEnrolled(),wasOutcomeAPISuccessful:this.wasOutcomeAPISuccessful()}},p.prototype.fromJSON=function(e){return(new o).isFocusOutcomeEnrolled(e.isFocusOutcomeEnrolled).wasOutcomeAPISuccessful(e.wasOutcomeAPISuccessful)},i.__decorate([u.doop],p.prototype,"isFocusOutcomeEnrolled",null),i.__decorate([u.doop],p.prototype,"wasOutcomeAPISuccessful",null),p=o=i.__decorate([u.doop],p))
function p(){return r.call(this)||this}t.OutcomeStoreState=d
var f,g=(f=l.CachedDataStreamStoreBase,i.__extends(m,f),Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.Outcome},enumerable:!1,configurable:!0}),m.prototype.getInitialState=function(){return new d},m.prototype.getStoreLoggingName=function(){return"OutcomeStore"},m.prototype.setStateForItemChangedEvent=function(e){return e},m.prototype.processGetUserOutcomes=function(e,t){return e.isFocusOutcomeEnrolled(t.isFocusOutcomeEnrolled).wasOutcomeAPISuccessful(!0)},m.prototype.processUpdateUserOutcomeEnrollment=function(e,t){return t.outcomeName!==c.OutcomeNames.IncreaseFocusTime?e:e.isFocusOutcomeEnrolled(t.isEnrolled).wasOutcomeAPISuccessful(t.wasAPISuccessful)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.GetUserOutcomesEnrollment,e.processGetUserOutcomes),e.addActionCallback(s.default.UpdateUserOutcomeEnrollment,e.processUpdateUserOutcomeEnrollment),e}t.OutcomeStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TimeAwayStore=t.TimeAwayState=void 0
var r,o,i=n(0),a=i.__importStar(n(58)),s=i.__importDefault(n(3)),u=i.__importDefault(n(6)),l=i.__importDefault(n(24)),c=i.__importDefault(n(57)),d=n(5),p=n(42),f=n(58),g=n(15),m=n(29),h=(r=p.CachedDataStreamStateBase,i.__extends(y,r),o=y,Object.defineProperty(y.prototype,"id",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"startTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"endTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"createdTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"timeAwayType",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isConfirmed",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"preparation",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"automaticRepliesSetting",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"meetingsDuringTimeAway1stBatch",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"meetingsDuringTimeAway2ndBatch",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"protectedTimeBeforeTimeAway",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"protectedTimeAfterTimeAway",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"dataReady",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"deletedMeetingsCount",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"dismissedAll",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"holidayName",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"bookTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"confirmTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"timeAwayMessageSentTime",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"holidayCardLoadHistory",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"dismissedHoliday",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"expandStatus",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"shouldShowCustomFeedCard",{get:function(){return!(!this.customFeedCardEligibility||this.timeAwayType()===a.TimeAwayType.PublicHoliday&&this.holidaySuppressed)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"initialState",{get:function(){return this.isConfirmed(!1).createdTime(null).meetingsDuringTimeAway1stBatch([]).meetingsDuringTimeAway2ndBatch([]).protectedTimeBeforeTimeAway([]).protectedTimeAfterTimeAway([]).dataReady(!0).preparation(this.getInitialPreparationStatus()).expandStatus(new Map)},enumerable:!1,configurable:!0}),y.prototype.getInitialPreparationStatus=function(){return{scheduleTimeAwayStatus:f.TimeAwayTaskStatus.NotCompleted,setAutoReplyStatus:f.TimeAwayTaskStatus.NotCompleted,notifyContactsStatus:f.TimeAwayTaskStatus.NotCompleted,resolveMeetingsStatus:f.TimeAwayTaskStatus.NotCompleted,scheduleCatchUpTimeStatus:f.TimeAwayTaskStatus.NotCompleted}},y.prototype.toJSON=function(){return{id:this.id(),startTime:this.startTime(),endTime:this.endTime(),createdTime:this.createdTime(),timeAwayType:this.timeAwayType(),isConfirmed:this.isConfirmed(),preparation:this.preparation(),automaticRepliesSetting:this.automaticRepliesSetting(),meetingsDuringTimeAway1stBatch:this.meetingsDuringTimeAway1stBatch(),meetingsDuringTimeAway2ndBatch:this.meetingsDuringTimeAway2ndBatch(),deletedMeetingsCount:this.deletedMeetingsCount(),protectedTimeBeforeOOF:this.protectedTimeBeforeTimeAway(),protectedTimeAfterOOF:this.protectedTimeAfterTimeAway(),holidayName:this.holidayName(),bookTime:this.bookTime(),confirmTime:this.confirmTime(),timeAwayMessageSentTime:this.timeAwayMessageSentTime(),holidayCardLoadHistory:this.holidayCardLoadHistory(),dismissedHoliday:this.dismissedHoliday()}},y.prototype.fromJSON=function(e){return e.timeAwayType===a.TimeAwayType.TimeAwayMessageDetected&&!e.isConfirmed||e.endTime&&e.endTime<new Date?(new o).initialState:(e.preparation.resolveMeetingsStatus===f.TimeAwayTaskStatus.PendingServerResponse&&(e.preparation.resolveMeetingsStatus=f.TimeAwayTaskStatus.NotCompleted),(new o).id(e.id).startTime(e.startTime).endTime(e.endTime).createdTime(e.createdTime).timeAwayType(e.timeAwayType).isConfirmed(e.isConfirmed).preparation(e.preparation).automaticRepliesSetting(e.automaticRepliesSetting).meetingsDuringTimeAway1stBatch(e.meetingsDuringTimeAway1stBatch).meetingsDuringTimeAway2ndBatch(e.meetingsDuringTimeAway2ndBatch).deletedMeetingsCount(e.deletedMeetingsCount).protectedTimeBeforeTimeAway(e.protectedTimeBeforeOOF).protectedTimeAfterTimeAway(e.protectedTimeAfterOOF).holidayName(e.holidayName).bookTime(e.bookTime).confirmTime(e.confirmTime).timeAwayMessageSentTime(e.timeAwayMessageSentTime).holidayCardLoadHistory(e.holidayCardLoadHistory).dismissedHoliday(e.dismissedHoliday).dataReady(!0).expandStatus(new Map))},Object.defineProperty(y.prototype,"holidaySuppressed",{get:function(){return!this.holidayName()||!this.startTime()||!(!this.holidayCardLoadHistory()||this.holidayCardLoadHistory().id!==this.id()||!(this.holidayCardLoadHistory().sessions.length>a.HOLIDAY_CARD_MAXIMUM_LOAD_COUNT||this.holidayCardLoadHistory().sessions.length===a.HOLIDAY_CARD_MAXIMUM_LOAD_COUNT&&!this.holidayCardLoadHistory().sessions.some(function(e){return e===c.default.sessionGuid})))||this.dismissedHoliday()===this.id()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"customFeedCardEligibility",{get:function(){return!this.isConfirmed()&&this.id()!==a.UNSCHEDULED_TIME_AWAY_ID&&(this.timeAwayType()===a.TimeAwayType.PublicHoliday&&!!this.endTime()&&this.endTime()>new Date||this.timeAwayType()===a.TimeAwayType.TimeAwayMessageDetected)},enumerable:!1,configurable:!0}),i.__decorate([d.doop],y.prototype,"id",null),i.__decorate([d.doop],y.prototype,"startTime",null),i.__decorate([d.doop],y.prototype,"endTime",null),i.__decorate([d.doop],y.prototype,"createdTime",null),i.__decorate([d.doop],y.prototype,"timeAwayType",null),i.__decorate([d.doop],y.prototype,"isConfirmed",null),i.__decorate([d.doop],y.prototype,"preparation",null),i.__decorate([d.doop],y.prototype,"automaticRepliesSetting",null),i.__decorate([d.doop],y.prototype,"meetingsDuringTimeAway1stBatch",null),i.__decorate([d.doop],y.prototype,"meetingsDuringTimeAway2ndBatch",null),i.__decorate([d.doop],y.prototype,"protectedTimeBeforeTimeAway",null),i.__decorate([d.doop],y.prototype,"protectedTimeAfterTimeAway",null),i.__decorate([d.doop],y.prototype,"dataReady",null),i.__decorate([d.doop],y.prototype,"deletedMeetingsCount",null),i.__decorate([d.doop],y.prototype,"dismissedAll",null),i.__decorate([d.doop],y.prototype,"holidayName",null),i.__decorate([d.doop],y.prototype,"bookTime",null),i.__decorate([d.doop],y.prototype,"confirmTime",null),i.__decorate([d.doop],y.prototype,"timeAwayMessageSentTime",null),i.__decorate([d.doop],y.prototype,"holidayCardLoadHistory",null),i.__decorate([d.doop],y.prototype,"dismissedHoliday",null),i.__decorate([d.doop],y.prototype,"expandStatus",null),y=o=i.__decorate([d.doop],y))
function y(){return r.call(this)||this}t.TimeAwayState=h
var _,S=(_=p.CachedDataStreamStoreBase,i.__extends(T,_),T.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(T.prototype,"wellKnownDataSourceType",{get:function(){return g.WellKnownDataSources.TimeAway},enumerable:!1,configurable:!0}),T.prototype.getInitialState=function(){return(new h).initialState},T.prototype.getStoreLoggingName=function(){return"TimeAwayStore"},T.prototype.processForceSetNoTimeAway=function(e){return e.initialState.id(a.UNSCHEDULED_TIME_AWAY_ID)},T.prototype.processSetNoTimeAway=function(e){return e.shouldShowCustomFeedCard?e:e.initialState},T.prototype.processGetTimeAway=function(e,t){var n,r=t.timeAwayRecord,o={scheduleTimeAwayStatus:r.IsConfirmed?f.TimeAwayTaskStatus.Done:f.TimeAwayTaskStatus.NotCompleted,setAutoReplyStatus:this.getTaskNewStatus(e.preparation().setAutoReplyStatus,r.TasksStatus[a.TimeAwayPreparationTaskNames.SetAutoReply]),notifyContactsStatus:this.getTaskNewStatus(e.preparation().notifyContactsStatus,r.TasksStatus[a.TimeAwayPreparationTaskNames.NotifyContacts]),resolveMeetingsStatus:this.getTaskNewStatus(e.preparation().resolveMeetingsStatus,r.TasksStatus[a.TimeAwayPreparationTaskNames.ResolveMeetings]),scheduleCatchUpTimeStatus:this.getTaskNewStatus(e.preparation().scheduleCatchUpTimeStatus,r.TasksStatus[a.TimeAwayPreparationTaskNames.ScheduleCatchUpTime])}
return e.timeAwayType()===a.TimeAwayType.NudgeDetected&&e.startTime()&&e.endTime()&&!r.IsConfirmed||(n=e.startTime(l.default.wrapString(r.StartTime)).endTime(l.default.wrapString(r.EndTime))),n.timeAwayType(a.TimeAwayType[r.TimeAwayType]).isConfirmed(r.IsConfirmed).preparation(o).bookTime(l.default.wrapString(r.AdditionalDetails.BookTime)).confirmTime(l.default.wrapString(r.AdditionalDetails.ConfirmTime)).timeAwayMessageSentTime(l.default.wrapString(r.AdditionalDetails.TimeAwayMessageSentTime)).holidayName(r.AdditionalDetails.HolidayName).id(r.Id).dataReady(!0)},T.prototype.getTaskNewStatus=function(e,t){var n
return e===f.TimeAwayTaskStatus.Changing||e===f.TimeAwayTaskStatus.PendingServerResponse?e:null!==(n=f.TimeAwayTaskStatus[t])&&void 0!==n?n:f.TimeAwayTaskStatus.NotCompleted},T.prototype.processSetTimeAwayState=function(e,t){return e.id(t.timeAwayState.id()).timeAwayType(t.timeAwayState.timeAwayType()).startTime(t.timeAwayState.startTime()).endTime(t.timeAwayState.endTime()).createdTime(t.timeAwayState.createdTime()).preparation(t.timeAwayState.preparation()).deletedMeetingsCount(t.timeAwayState.deletedMeetingsCount()).isConfirmed(t.timeAwayState.isConfirmed()).dataReady(!0)},T.prototype.processSetAutoReplySetting=function(e,t){return e.automaticRepliesSetting(t.automaticRepliesSetting)},T.prototype.processGetMeetingsDuringTimeAway1stBatch=function(e,t){return e.meetingsDuringTimeAway1stBatch(this.getMeetings(t))},T.prototype.processGetMeetingsDuringTimeAway2ndBatch=function(e,t){return e.meetingsDuringTimeAway2ndBatch(this.getMeetings(t))},T.prototype.processDeleteMeetingsDuringTimeAway=function(e,n){function t(t){return!n.ids.some(function(e){return e===t.id})}return e.meetingsDuringTimeAway1stBatch(e.meetingsDuringTimeAway1stBatch().filter(t)).meetingsDuringTimeAway2ndBatch(e.meetingsDuringTimeAway2ndBatch().filter(t))},T.prototype.processClearDeletedMeetingsCount=function(e){return e.deletedMeetingsCount(0)},T.prototype.processSetProtectedTimeAroundTimeAway=function(e,t){var n=t.protectedTimeBeforeTimeAway.filter(function(e){return e.StartTime.getDate()===t.protectedTimeBeforeTimeAway[t.protectedTimeBeforeTimeAway.length-1].StartTime.getDate()}),r=t.protectedTimeAfterTimeAway.filter(function(e){return e.StartTime.getDate()===t.protectedTimeAfterTimeAway[0].StartTime.getDate()})
return e.protectedTimeBeforeTimeAway(n).protectedTimeAfterTimeAway(r)},T.prototype.processUpdateProtectedTimeBeforeTimeAway=function(e,t){return e.protectedTimeBeforeTimeAway(this.updateProtectedTime(e.protectedTimeBeforeTimeAway(),t))},T.prototype.processUpdateProtectedTimeAfterTimeAway=function(e,t){return e.protectedTimeAfterTimeAway(this.updateProtectedTime(e.protectedTimeAfterTimeAway(),t))},T.prototype.updateProtectedTime=function(e,t){return u.default.replaceFirstMatchingItem(e,function(e){return e.Id===t.newBlock.Id},t.newBlock)},T.prototype.processDismissAll=function(e){return e.dismissedAll(!0)},T.prototype.processDetectOOFComposingInfobar=function(e,t){return e.startTime(t.detectOOFComposingInfobar.startTime).endTime(t.detectOOFComposingInfobar.endTime).timeAwayType(a.TimeAwayType.NudgeDetected).dataReady(!0)},T.prototype.processUpdateHolidayCardLoadCount=function(e,t){return e.holidayCardLoadHistory(t.holidayCardLoadHistory)},T.prototype.processDismissHoliday=function(e,t){return e.dismissedHoliday(t.holidayTimeAwayId)},T.prototype.processDropDownOrLiftUpTimeAwayCard=function(e,t){var n=e.expandStatus()
return n.set(t.taskName,t.expandStatus),e.expandStatus(n)},T.prototype.processExpandNextPreparationTask=function(e){var t
this.checkIfPreparationTaskIsDone(e.preparation().scheduleTimeAwayStatus)?this.checkIfPreparationTaskIsDone(e.preparation().setAutoReplyStatus)?this.checkIfPreparationTaskIsDone(e.preparation().notifyContactsStatus)?this.checkIfPreparationTaskIsDone(e.preparation().resolveMeetingsStatus)?this.checkIfPreparationTaskIsDone(e.preparation().scheduleCatchUpTimeStatus)||(t=a.TimeAwayPreparationTaskNames.ScheduleCatchUpTime):t=a.TimeAwayPreparationTaskNames.ResolveMeetings:t=a.TimeAwayPreparationTaskNames.NotifyContacts:t=a.TimeAwayPreparationTaskNames.SetAutoReply:t=a.TimeAwayPreparationTaskNames.ScheduleTimeAway
var n=e.expandStatus()
return n.set(t,!0),e.expandStatus(n)},T.prototype.checkIfPreparationTaskIsDone=function(e){return e===a.TimeAwayTaskStatus.Done||e===a.TimeAwayTaskStatus.NeedsReview||e===a.TimeAwayTaskStatus.PendingServerResponse},T)
function T(){var e=_.call(this)||this
return e.CACHE_LIFETIME=null,e.getMeetings=function(e){return e.meetings.map(function(e){return{id:e.identifier.id,startDate:e.startDate,subject:e.subject,isOrganizer:e.isOrganizer,responseRequested:e.responseRequested,isAllDay:e.isAllDay,showAsFree:e.busyStatus===m.BusyStatus.Free}})},e.addActionCallback(s.default.GetTimeAwayRecord,e.processGetTimeAway),e.addActionCallback(s.default.ForceSetNoTimeAway,e.processForceSetNoTimeAway),e.addActionCallback(s.default.SetNoTimeAway,e.processSetNoTimeAway),e.addActionCallback(s.default.SetTimeAwayState,e.processSetTimeAwayState),e.addActionCallback(s.default.GetDetectOOFComposingInfobar,e.processDetectOOFComposingInfobar),e.addActionCallback(s.default.SetAutoReplySetting,e.processSetAutoReplySetting),e.addActionCallback(s.default.GetMeetingsDuringTimeAway1stBatch,e.processGetMeetingsDuringTimeAway1stBatch),e.addActionCallback(s.default.GetMeetingsDuringTimeAway2ndBatch,e.processGetMeetingsDuringTimeAway2ndBatch),e.addActionCallback(s.default.DeleteMeetingsDuringTimeAway,e.processDeleteMeetingsDuringTimeAway),e.addActionCallback(s.default.ClearDeletedMeetingsCount,e.processClearDeletedMeetingsCount),e.addActionCallback(s.default.SetProtectedTimeAroundTimeAway,e.processSetProtectedTimeAroundTimeAway),e.addActionCallback(s.default.UpdateProtectedTimeBeforeTimeAway,e.processUpdateProtectedTimeBeforeTimeAway),e.addActionCallback(s.default.UpdateProtectedTimeAfterTimeAway,e.processUpdateProtectedTimeAfterTimeAway),e.addActionCallback(s.default.DismissAllTimeAwayInstances,e.processDismissAll),e.addActionCallback(s.default.UpdateHolidayCardLoadHistory,e.processUpdateHolidayCardLoadCount),e.addActionCallback(s.default.DismissHoliday,e.processDismissHoliday),e.addActionCallback(s.default.ChangeTimeAwayDropDown,e.processDropDownOrLiftUpTimeAwayCard),e.addActionCallback(s.default.ExpandNextPreparationTask,e.processExpandNextPreparationTask),e}t.TimeAwayStore=S,t.default=new S},,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarStore=t.InfobarStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(114)),l=n(5),c=(r=u.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"currentInfobarIdentifier",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInfobarDismissed",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).currentInfobarIdentifier(e.currentInfobarIdentifier).isInfobarDismissed(e.isInfobarDismissed)},d.prototype.toJSON=function(){return{currentInfobarIdentifier:this.currentInfobarIdentifier(),isInfobarDismissed:this.isInfobarDismissed()}},i.__decorate([l.doop],d.prototype,"currentInfobarIdentifier",null),i.__decorate([l.doop],d.prototype,"isInfobarDismissed",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.isInfobarDismissed(!1),e}t.InfobarStoreState=c
var p,f=(p=u.default,i.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.Infobar},enumerable:!1,configurable:!0}),g.prototype.getInitialState=function(){return new c},g.prototype.getStoreLoggingName=function(){return"InfobarStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},g.prototype.processUpdateInfobar=function(e,t){return e.currentInfobarIdentifier(t.infobarIdentifier)},g.prototype.processAnyInsightDismissed=function(e){return e.isInfobarDismissed(!0)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.UpdateInfobar,e.processUpdateInfobar),e.addActionCallback(s.default.DismissInfobarInsight,e.processAnyInsightDismissed),e}t.InfobarStore=f,t.default=new f},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExchangeRequestQueue=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=o.__importDefault(n(11)),s=n(790),u=n(791),l=(r=s.FlexibleRequestQueueBase,o.__extends(c,r),Object.defineProperty(c.prototype,"concurrentOperation",{get:function(){return this._concurrentOperation},enumerable:!1,configurable:!0}),c.prototype.requestCompleteActionCreatorCallback=function(){a.default.dispatchAsync({actionType:i.default.SetExchangeRequestsDone},200)},c)
function c(){var e=null!==r&&r.apply(this,arguments)||this
return e._concurrentOperation=new u.ConcurrentOperation({minConcurrent:3,maxConcurrent:4,defaultLimit:4}),e}t.ExchangeRequestQueue=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(265),o=(Object.defineProperty(i,"restBaseUrl",{get:function(){return Office.context.mailbox.restUrl?Office.context.mailbox.restUrl:(Office.context.mailbox.ewsUrl||"").replace("EWS/Exchange.asmx",i.API_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(i,"restVersion",{get:function(){return"beta"},enumerable:!1,configurable:!0}),Object.defineProperty(i,"restVersion2_0",{get:function(){return"v2.0"},enumerable:!1,configurable:!0}),Object.defineProperty(i,"wesBaseUrl",{get:function(){return new r(i.restBaseUrl).setPath("weveb2/api").toString()},enumerable:!1,configurable:!0}),i.API_ROOT="api",i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),a=r.__importDefault(n(24)),i=r.__importDefault(n(6)),s=r.__importDefault(n(202)),u=n(29),l=n(7),o=(c.isWorkingTime=function(e,t){var n=new Date(t.workingHoursTimeBlock.startDate.getTime()),r=new Date(t.workingHoursTimeBlock.endDate.getTime())
return n.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate()),r.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate()),e.startDate>=n&&e.endDate<=r},c.getLastWorkDayThisWeek=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
for(var n=new Date(e.getTime()),r=1,o=0;o<t.length;o++)if(1===t[6-o]){r=6-o
break}var i=e.getDay()-r
return n.setDate(e.getDate()-i),a.default.startOfDay(n)},c.getFirstWorkDayNextWeek=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
var n=c.getFirstWorkDayThisWeek(e,t)
return n.setDate(n.getDate()+7),a.default.startOfDay(n)},c.getFirstWorkDayThisWeek=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
for(var n=new Date(e.getTime()),r=1,o=0;o<t.length;o++)if(1===t[o]){r=o
break}var i=e.getDay()-r
return n.setDate(e.getDate()-i),a.default.startOfDay(n)},c.getNextKWorkingDay=function(e,t,n){void 0===n&&(n=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
for(var r=0;r<Math.abs(e);r++)t=e<0?c.getPreviousWorkingDay(t,n):c.getNextWorkingDay(t,n)
return t},c.getPreviousWorkingDay=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
for(var n=e.getDay()-1;0<=n;n--)if(1===t[n]){var r=n-e.getDay()
return a.default.startOfDay(new Date(e.getTime()+r*l.Constants.oneDay))}return a.default.startOfDay(c.getLastWorkDayLastWeek(e))},c.getNextWorkingDay=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
for(var n=e.getDay()+1;n<7;n++)if(1===t[n]){var r=n-e.getDay()
return a.default.startOfDay(new Date(e.getTime()+r*l.Constants.oneDay))}return a.default.startOfDay(this.getFirstWorkDayNextWeek(e))},c.getLastWorkDayLastWeek=function(e,t){void 0===t&&(t=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE)
var n=this.getLastWorkDayThisWeek(e,t)
return n.setDate(n.getDate()-7),a.default.startOfDay(n)},c.buildWorkingHoursOverKWorkingDays=function(e,t,n){if(t<=0||n.workingDays.workingDaysSundayStart.every(function(e){return 0===e}))return[]
for(var r=[],o=c.getWorkingHoursInDate(e,n);r.length<t;)1===n.workingDays.workingDaysSundayStart[o.startDate.getDay()]&&r.push(o),o={startDate:a.default.addDays(o.startDate,1),endDate:a.default.addDays(o.endDate,1)}
if(e.getTime()>r[0].startDate.getTime()){if(!(e.getTime()<r[0].endDate.getTime()))return r.slice(1)
r[0].startDate=e}return r},c.buildWorkingHours=function(e,t,n){var r=e.endDate.getTime()-e.startDate.getTime(),o=t.workingDaysSundayStart.filter(function(e){return 1===e}).length
return{workingDays:t,workingHoursTimeBlock:e,totalWorkingTimeInMilliseconds:o*r,timeZoneInMinute:n}},c.getWorkingHoursInDate=function(e,t){return{startDate:new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.workingHoursTimeBlock.startDate.getHours(),t.workingHoursTimeBlock.startDate.getMinutes(),t.workingHoursTimeBlock.startDate.getSeconds()),endDate:new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.workingHoursTimeBlock.endDate.getHours(),t.workingHoursTimeBlock.endDate.getMinutes(),t.workingHoursTimeBlock.endDate.getSeconds())}},c.isOofDuringPeriod=function(t,e,n,r){return void 0===r&&(r=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE),!s.default.seperateTimePeriodByDay(e,n).some(function(e){return!c.isOofByDay(t,e.startDate,r)})},c.isOofByDay=function(e,t,n){if(void 0===n&&(n=u.WorkingHours.DEFAULT_WORKDAY_SCHEDULE),0===n[t.getDay()])return!0
var r={startDate:a.default.startOfDay(t),endDate:a.default.tomorrow(t)},o=s.default.getTimeBlocksBetween(e,r).filter(function(e){return e.freeBusyStatus===u.BusyStatus.Oof}).map(function(e){return e.endDate.getTime()-e.startDate.getTime()})
return i.default.sumElementsInArray(o,function(e){return e})>=8*l.Constants.oneHourInMilliSeconds},c.trimTimeBlocksByWorkHours=function(e,t,n){var r=new Date(t.getTime()),o=new Date(n.getTime())
return r.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate()),o.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate()),r>e.startDate&&r<e.endDate&&(e.startDate=r),o>e.startDate&&o<e.endDate&&(e.endDate=o),e},c)
function c(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),d=r.__importDefault(n(24)),p=n(7),o=(i.filterByLength=function(e,t){return e.filter(function(e){return e.endDate.getTime()-e.startDate.getTime()>=t})},i.segmentToMultipleBlocks=function(e,a){var s=[]
return e.forEach(function(e){var t=e.endDate.getTime()-e.startDate.getTime()
if(t===a)s.push(e)
else if(a<t)for(var n=Math.floor(t/a),r=0;r<n;r++){var o=e.startDate.getTime()+r*a,i=o+a
s.push({startDate:new Date(o),endDate:new Date(i)})}}),s},i.getTimeBlocksBetween=function(e,t){return e.filter(function(e){return e.startDate>=t.startDate&&e.endDate<=t.endDate})},i.groupByDate=function(e){var r={}
return e.forEach(function(e){var t=d.default.startOfDay(e.startDate).getTime(),n=r[t]||[]
n.push(e),r[t]=n}),Object.keys(r).sort().map(function(e){return{dateOfDay:new Date(Number(e)),sortedTimeSlots:r[e]}})},i.trimToMinuteMarker=function(e,a){var s=[]
return e.forEach(function(e){var t=e.startDate.getMinutes()%a,n=0==t?0:a-t,r=e.startDate.getTime()+n*p.Constants.oneMinuteInMilliSeconds,o=e.endDate.getMinutes()%a,i=e.endDate.getTime()-o*p.Constants.oneMinuteInMilliSeconds
r<i&&s.push({startDate:new Date(r),endDate:new Date(i)})}),s},i.isWithin=function(e,t){return t.startDate<=e.startDate&&t.endDate>=e.endDate},i.doesOverlap=function(e,t){return e.startDate<t.endDate&&e.endDate>t.startDate},i.parseFreeBusyIntoTimeSlots=function(e,t,n){if(0===t.length)return[]
var r,o=[]
e=d.default.startOfDay(e)
for(var i,a,s=function(e,t){r={startDate:e,endDate:null,freeBusyStatus:t}},u=function(e){r.endDate=e,o.push(r),r=null},l=0;l<t.length;l++){var c=new Date(e.getTime()+l*n*p.Constants.oneMinuteInMilliSeconds)
r?d.default.isSameDay(c,a)?i!==t[l]&&(u(new Date(c.getTime())),s(c,t[l])):(u(new Date(c.getTime()-1)),s(c,t[l])):s(c,t[l]),i=t[l],a=c}return r&&u(new Date(e.getTime()+t.length*n*p.Constants.oneMinuteInMilliSeconds)),o},i.seperateTimePeriodByDay=function(e,t){if(t<=e)return[]
for(var n=[],r=new Date(e.getTime());!d.default.isSameDay(r,t);)n=n.concat({startDate:r,endDate:d.default.endOfDay(r)}),r=d.default.tomorrow(r)
return n=n.concat({startDate:r,endDate:t})},i.addReminderSetting=function(e,t){return e.map(function(e){return r.__assign(r.__assign({},e),{isReminderOn:t})})},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AccumulatingInsightsStoreBase=t.AccumulatingInsightsStoreBaseState=void 0
var r,o,i=n(0),a=n(5),s=i.__importStar(n(83)),u=i.__importDefault(n(6)),l=(r=s.DataStreamStoreStateBase,i.__extends(c,r),o=c,Object.defineProperty(c.prototype,"insights",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),c.prototype.fromJSON=function(e){return(new o).insights(e.insights)},c.prototype.toJSON=function(){return{insights:this.insights()}},i.__decorate([a.doop],c.prototype,"insights",null),c=o=i.__decorate([a.doop],c))
function c(){var e=r.call(this)||this
return e.insights([]),e}t.AccumulatingInsightsStoreBaseState=l
var d,p=(d=s.default,i.__extends(f,d),f.prototype.getFirstInsightOrDefault=function(){return u.default.firstOrDefault(this.getState().insights())},f.prototype.setStateForItemChangedEvent=function(e,t){return e},f.prototype.getInitialState=function(){return new l},f.prototype.tryGetFirstInsightByName=function(t){return u.default.firstOrDefault(this.getState().insights().filter(function(e){return e.insightName===t}),null)},f.prototype.processAccumulatingInsightsAction=function(e,t){var n=e.insights().filter(function(e){return e.insightName!==t.insightName}).concat(t.insights)
return e.insights(n)},f.prototype.processNotApplicableInsightAction=function(e,t){var n=e.insights().filter(function(e){return e.insightName!==t.insightName})
return n.length===e.insights().length?e:e.insights(n)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(e.actionValueToAccumulate(),e.processAccumulatingInsightsAction),e.addActionCallback(e.actionValueForNotApplicable(),e.processNotApplicableInsightAction),e}t.AccumulatingInsightsStoreBase=p,t.default=p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpRequestTaskEntitiesStore=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=o.__importDefault(n(508)),s=n(5),u=(r=a.default,o.__extends(l,r),l.prototype.getStoreLoggingName=function(){return"FollowUpRequestTaskEntitiesStore"},l.prototype.actionValueToUpsertExtractedEntities=function(){return i.default.UpsertExtractedFollowUpRequestTasks},l.prototype.actionValueToUpsertEntityIdsAsDone=function(){return i.default.UpsertFollowUpRequestTaskIdsAsDone},l=o.__decorate([s.doop],l))
function l(){return null!==r&&r.apply(this,arguments)||this}t.FollowUpRequestTaskEntitiesStore=u,t.default=new u},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightVersion=void 0,(r=t.InsightVersion||(t.InsightVersion={}))[r.v1=0]="v1",r[r.v2=1]="v2"},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.SharingReferenceType=t.DocumentProviderType=t.DocumentFileType=void 0,(r=t.DocumentFileType||(t.DocumentFileType={}))[r.DOCX=0]="DOCX",r[r.XLSX=1]="XLSX",r[r.PPTX=2]="PPTX",r[r.DOC=3]="DOC",r[r.XLS=4]="XLS",r[r.PPT=5]="PPT",r[r.PDF=6]="PDF",r[r.VSDX=7]="VSDX",r[r.VSDM=8]="VSDM",r[r.VSD=9]="VSD",r[r.VDX=10]="VDX",r[r.VDW=11]="VDW",r[r.VSS=12]="VSS",r[r.VSSM=13]="VSSM",r[r.VSSX=14]="VSSX",r[r.VST=15]="VST",r[r.VSTM=16]="VSTM",r[r.VSTX=17]="VSTX",r[r.VTX=18]="VTX",r[r.VSX=19]="VSX",r[r.ODC=20]="ODC",r[r.ODS=21]="ODS",r[r.ODT=22]="ODT",r[r.ODP=23]="ODP",r[r.ONE=24]="ONE",r[r.CSV=25]="CSV",r[r.TXT=26]="TXT",r[r.UnknownFileType=27]="UnknownFileType",(o=t.DocumentProviderType||(t.DocumentProviderType={}))[o.OneDrivePro=0]="OneDrivePro",o[o.NativeAttachment=1]="NativeAttachment",o[o.Unknown=2]="Unknown",(i=t.SharingReferenceType||(t.SharingReferenceType={})).Mail="Mail",i.CalendarEvent="CalendarEvent",i.Teams="Teams",i.Unknown="Unknown"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TasksInsightStore=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importDefault(n(523)),u=(r=s.default,o.__extends(l,r),Object.defineProperty(l.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.TasksInsight},enumerable:!1,configurable:!0}),l.prototype.getStoreLoggingName=function(){return"TasksInsightStore"},l.prototype.insightAction=function(){return a.default.TasksInsightAction},l.prototype.markAsDoneAction=function(){return a.default.MarkTaskAsDoneAction},l.prototype.markAsNotAnEntityAction=function(){return a.default.MarkAsNotATaskAction},l.prototype.promoteTaskAction=function(){return a.default.PromoteTaskAction},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.TasksInsightStore=u,t.default=new u},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.InContextStatus=t.StatisticsBreakdownTypes=t.SentMailType=void 0,(r=t.SentMailType||(t.SentMailType={}))[r.Message=0]="Message",r[r.MeetingRequest=1]="MeetingRequest",r[r.MeetingResponse=2]="MeetingResponse",(o=t.StatisticsBreakdownTypes||(t.StatisticsBreakdownTypes={})).READ_STATISTICS_BREAKDOWN="#MICROSOFT.O365INSIGHTS.SDK.ANALYTICS.V1.MESSAGEREADSTATISTICSBREAKDOWN",o.REPLY_AND_FORWARD_STATISTICS_BREAKDOWN="#MICROSOFT.O365INSIGHTS.SDK.ANALYTICS.V1.MESSAGEREPLYANDFORWARDSTATISTICSBREAKDOWN",o.DWELL_STATISTICS_BREAKDOWN="#MICROSOFT.O365INSIGHTS.SDK.ANALYTICS.V1.MESSAGEDWELLTIMESTATISTICSBREAKDOWN",o.EXTENDED_SENT_MAIL_STATISTICS_BREAKDOWN="#MICROSOFT.O365INSIGHTS.SDK.ANALYTICS.V1.EXTENDEDSENTMAILSTATISTICSBREAKDOWN",(i=t.InContextStatus||(t.InContextStatus={}))[i.None=0]="None",i[i.Ok=1]="Ok",i[i.InsufficientData=2]="InsufficientData",i[i.Expired=3]="Expired",i[i.ServerError=4]="ServerError",i[i.Processing=5]="Processing",i[i.Loading=6]="Loading"},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogger=t.TableNames=void 0
var r,o,i=n(0),a=i.__importDefault(n(54)),s=i.__importDefault(n(25)),u=i.__importDefault(n(6)),l=i.__importDefault(n(57)),c=n(349);(o=r=t.TableNames||(t.TableNames={})).Information="Information",o.Warning="Warning",o.Error="Error",o.UserInteractions="UserInteractions",o.BackgroundAddIn="BackgroundAddIn",o.RoamingSettings="RoamingSettings"
var d=(p.prototype.logDiagnosticEvent=function(e){this.log(e,this.populateDiagnosticEntry.bind(this),this.logDiagnosticEntry.bind(this))},p.prototype.logUserInteractionEvent=function(e){this.log(e,this.populateInteractionEntry.bind(this),this.logInteractionEntry.bind(this))},p.prototype.log=function(t,e,n){try{var r=e(t)
s.default.isLocalDebugging||u.default.isInMockMode?this.logToConsole(r):n(r)}catch(e){this.logErrorToAppInsights(e,t)}},p.prototype.populateDiagnosticEntry=function(e){var t=Date.now()-l.default.sessionStartTime
return i.__assign(i.__assign({},e),{HostName:a.default.hostName,HostVersion:a.default.hostVersion,HostPlatform:a.default.hostPlatform,TimeZone:u.default.Timezone,SessionGuid:l.default.sessionGuid,ExperienceType:s.default.ExperienceType,TimeElapsedSinceAppStart:t,IdAsEmail:u.default.userEmail,MyAnalyticsAddInBuildName:s.default.BuildName,AadTenantId:l.default.AadTenantIdFromRESTToken,ActorId:l.default.ActorIdFromRESTToken})},p.prototype.populateInteractionEntry=function(e){var t=(new Date).toISOString()
return i.__assign(i.__assign({},e),{Type:e.Event,StartTime:t,EndTime:t,CV:l.default.sessionGuid,AadAppId:"00000002-0000-0ff1-ce00-000000000000",AppName:a.default.hostName,AppVer:a.default.hostVersion,AadTenantId:l.default.AadTenantIdFromRESTToken,ActorId:l.default.ActorIdFromRESTToken})},p.prototype.logDiagnosticEntry=function(e){var t,n=JSON.stringify(null!==(t=e.Properties)&&void 0!==t?t:{}),r=new microsoft.applications.telemetry.EventProperties
r.name=e.TableName,r.setProperty("FeatureName",e.FeatureName),r.setProperty("Event",e.Event),r.setProperty("HostName",e.HostName),r.setProperty("HostVersion",e.HostVersion),r.setProperty("HostPlatform",e.HostPlatform),r.setProperty("TimeZone",e.TimeZone),r.setProperty("SessionGuid",e.SessionGuid),r.setProperty("ExperienceType",e.ExperienceType),r.setProperty("TimeElapsedSinceAppStart",e.TimeElapsedSinceAppStart),r.setProperty("IdAsEmail",e.IdAsEmail,microsoft.applications.telemetry.datamodels.PIIKind.SmtpAddress),r.setProperty("AadTenantId",e.AadTenantId),r.setProperty("ActorId",e.ActorId),r.setProperty("Properties",n),r.setProperty("MyAnalyticsAddInBuildName",e.MyAnalyticsAddInBuildName),this.ariaLogger.logEvent(r)},p.prototype.logInteractionEntry=function(e){var t,n=JSON.stringify(null!==(t=e.Properties)&&void 0!==t?t:{}),r=new microsoft.applications.telemetry.EventProperties
r.name=e.TableName,r.setProperty("Type",e.Type),r.setProperty("StartTime",e.StartTime),r.setProperty("EndTime",e.EndTime),r.setProperty("CV",e.CV),r.setProperty("AadAppId",e.AadAppId),r.setProperty("AppName",e.AppName),r.setProperty("AppVer",e.AppVer),r.setProperty("AadTenantId",e.AadTenantId),r.setProperty("ActorId",e.ActorId),r.setProperty("Details",n),this.ariaLogger.logEvent(r)},p.prototype.logToConsole=function(e){var t=JSON.stringify(e)
switch(e.TableName){case r.BackgroundAddIn:case r.Information:case r.RoamingSettings:return void console.log(t)
case r.UserInteractions:return
case r.Warning:return void console.warn(t)
case r.Error:default:return void console.error(t)}},p.prototype.logErrorToAppInsights=function(e,t){var n
console.error("Exception during logging: "+e.message),c.AppInsights&&(n=i.__assign({name:t.TableName,feature:t.FeatureName,event:t.Event,sessionGuid:l.default.sessionGuid},t.Properties),c.AppInsights.trackException(e,0,n))},p)
function p(){var e
this.ariaLogger=null,this.ariaLogger||(e=s.default.AriaToken,microsoft.applications.telemetry.LogManager.initialize(e),this.ariaLogger=new microsoft.applications.telemetry.Logger(e))}t.ActionLogger=d,t.default=new d},,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(4)),o=(i.prototype.setResponseRequestId=function(e){this.responseRequestId=e},i.prototype.success=function(e){var t=this.successProperties(e)
this.logApiCall(t)},i.prototype.expectedFail=function(e,t){var n=this.expectedFailProperties(e,t)
this.logApiCall(n)},i.prototype.unexpectedFail=function(e,t,n){var r=this.unexpectedFailProperties(e,t,n)
this.logApiCall(r)},i.prototype.successProperties=function(e){return{region:this.region,source:this.source,sourceValue:e,isSuccessful:!0,duration:Date.now()-this.createTime,isProxied:this.isProxied,requestType:this.requestType,requestId:this.requestId,serverRequestId:this.responseRequestId}},i.prototype.expectedFailProperties=function(e,t){return{region:this.region,source:this.source,isSuccessful:!1,duration:Date.now()-this.createTime,isExpected:!0,errorCode:t,errorMessage:e,isProxied:this.isProxied,requestType:this.requestType,requestId:this.requestId,serverRequestId:this.responseRequestId}},i.prototype.unexpectedFailProperties=function(e,t,n){return{region:this.region,source:this.source,sourceValue:n,isSuccessful:!1,duration:Date.now()-this.createTime,isExpected:!1,errorCode:t,errorMessage:e,isProxied:this.isProxied,requestType:this.requestType,requestId:this.requestId,serverRequestId:this.responseRequestId}},i.prototype.logApiCall=function(e){r.default.logApiCallEvent(this.feature,this.callType,e)},i)
function i(e,t,n,r,o,i){this.feature=e,this.callType=t,this.source=n,this.region=o,this.createTime=Date.now(),this.startExecuteTime=new Date,this.isProxied=!1,this.requestType=r,this.requestId=i}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CalendarActionCreator=void 0
var l=n(0),c=l.__importDefault(n(840)),d=l.__importStar(n(29)),r=l.__importDefault(n(3)),a=l.__importDefault(n(104)),o=l.__importDefault(n(11)),i=n(7),s=n(51),u=l.__importDefault(n(2)),p=(f.prototype.getCalendarItemsAndDispatch=function(){return l.__awaiter(this,void 0,void 0,function(){var t,n
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.getCalendarItems()]
case 1:return(t=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(n=this.processGetCalendarItems(t),this.dispatchCalendarItems(n,t.sourceRequest)),[2]}})})},f.prototype.bookFocusBlockAndDispatch=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.bookFocusBlockAndReturn(n)]
case 1:return(t=e.sent()).isSuccessful&&this.dispatchBookFocusBlock(t.result),[2]}})})},f.prototype.bookFocusBlockAndReturn=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.bookFocusBlock(n)]
case 1:return t=e.sent(),[2,this.processBookFocusBlock(t)]}})})},f.prototype.bookFocusBlocksAndDispatch=function(r){return l.__awaiter(this,void 0,void 0,function(){var t,n
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.bookFocusBlocksAndReturn(r)]
case 1:return t=e.sent(),n=t.map(function(e){return e.result}),this.dispatchBookFocusBlocks(n),[2]}})})},f.prototype.bookFocusBlocksAndReturn=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.bookFocusBlocks(n)]
case 1:return t=e.sent(),[2,this.processBookFocusBlocks(t)]}})})},f.prototype.appendMeetingBodyAndSubject=function(i,a,s,u){return l.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.getCalendarItemById(s,u)]
case 1:return(t=e.sent()).status!==Office.AsyncResultStatus.Succeeded?[3,3]:(n=this.processGetCalendarItemById(t),r=c.default(n.subject,a)?n.subject:n.subject+" "+a,o={body:n.body+i,subject:r},[4,this.updateCalendarItem(o,s,"bookFocusBlock",u,d.CalendarItemType.FocusTime)])
case 2:if(e.sent().status===Office.AsyncResultStatus.Succeeded)return n.body=o.body,[2,{isSuccessful:!0,result:n}]
e.label=3
case 3:return[2,{isSuccessful:!1}]}})})},f.prototype.updateFocusBlockSubjectAndDispatch=function(r,o,i,a){return void 0===a&&(a="FocusTime"),l.__awaiter(this,void 0,void 0,function(){var t,n
return l.__generator(this,function(e){switch(e.label){case 0:return t={subject:r},[4,this.updateCalendarItem(t,o,i,a,d.CalendarItemType.FocusTime)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&this.dispatchFocusBlockSubjectUpdate(n),[2]}})})},f.prototype.getMeetingSuggestionCalendarItemsAndDispatch=function(){return l.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return l.__generator(this,function(e){switch(e.label){case 0:return t=2*i.Constants.oneMonthInDays,n=2*-i.Constants.oneWeekInDays,[4,this.getCalendarItems(t,n,"MeetingSuggestion")]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(o=this.processGetCalendarItems(r),this.dispatchMeetingSuggestionCalendarItems(o)),[2]}})})},f.prototype.getCalendarItems=function(t,n,r){return void 0===t&&(t=6),void 0===n&&(n=-14),void 0===r&&(r="FocusTime"),l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.getCalendarItems(t,n,r)]
case 1:return[2,e.sent()]}})})},f.prototype.updateCalendarItem=function(t,n,r,o,i){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.updateCalendarItem(t,n,r,o,i)]
case 1:return[2,e.sent()]}})})},f.prototype.getCalendarItemById=function(t,n){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.getCalendarItemById(t,n)]
case 1:return[2,e.sent()]}})})},f.prototype.processGetCalendarItems=function(e){return a.default.processGetCalendarItems(e)},f.prototype.processGetCalendarItemById=function(e){return a.default.processGetCalendarItemById(e)},f.prototype.processBookFocusBlock=function(e){return e.status!==Office.AsyncResultStatus.Succeeded?{isSuccessful:!1}:{isSuccessful:!0,result:a.default.processBookOrUpdateTimeBlock(e)}},f.prototype.processBookFocusBlocks=function(e){var t=e.filter(function(e){return e.status===Office.AsyncResultStatus.Succeeded})
return a.default.processBookOrUpdateTimeBlocks(t).map(function(e){return{isSuccessful:!0,result:e}})},f.prototype.bookFocusBlock=function(n){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return t=this.populateFocusBlockSubjectAndBody(n),[4,a.default.bookFocusBlock(t)]
case 1:return[2,e.sent()]}})})},f.prototype.bookFocusBlocks=function(r){return l.__awaiter(this,void 0,void 0,function(){var t,n=this
return l.__generator(this,function(e){switch(e.label){case 0:return t=r.map(function(e){return n.populateFocusBlockSubjectAndBody(e)}),[4,a.default.bookFocusBlocks(t)]
case 1:return[2,e.sent()]}})})},f.prototype.populateFocusBlockSubjectAndBody=function(e){var t,n
return e.subject=null!==(t=e.subject)&&void 0!==t?t:u.default.FOCUS_TIME_SUBJECT(),e.body=null!==(n=e.body)&&void 0!==n?n:"",e},f.prototype.dispatchBookFocusBlock=function(e){o.default.dispatch({actionType:r.default.BookFocusBlock,calendarItems:[e]})},f.prototype.dispatchBookFocusBlocks=function(e){o.default.dispatch({actionType:r.default.BookFocusBlocks,calendarItems:e})},f.prototype.dispatchCalendarItems=function(e,t){o.default.dispatch({actionType:r.default.GetCalendarItems,calendarItems:e,includedDateRange:{endDate:t.endDate(),startDate:t.startDate()}})},f.prototype.dispatchMeetingSuggestionCalendarItems=function(e){o.default.dispatch({actionType:r.default.GetCalendarItemsForMeetingSuggestion,calendarItems:e})},f.prototype.dispatchFocusBlockSubjectUpdate=function(e){o.default.dispatch({actionType:r.default.UpdateFocusTime,eventId:e.result.Id,subject:e.sourceRequest.subject()})},l.__decorate([s.expirable(s.ExpirationTypes.ByEvery_Minutes,5)],f.prototype,"getCalendarItemsAndDispatch",null),l.__decorate([s.expirable(s.ExpirationTypes.ByEvery_Minutes,i.Constants.oneHourInMinutes)],f.prototype,"getMeetingSuggestionCalendarItemsAndDispatch",null),f=l.__decorate([s.expirable()],f))
function f(){}t.CalendarActionCreator=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TeachingMomentActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importDefault(n(4)),s=r.__importStar(n(65)),u=n(7),l=n(133),c=(d.prototype.initializeTeachingMomentStatusFromRoamingSettings=function(){var n=this,r=[]
Object.keys(l.TeachingMomentTypes).forEach(function(e){var t
isNaN(l.TeachingMomentTypes[e])||null!=(t=n.getTeachingMomentFromRoamingSettings(l.TeachingMomentTypes[e]))&&!0!==t||r.push(l.TeachingMomentTypes[e])}),i.default.dispatch({actionType:o.default.InitializeTeachingMoment,pendingTeachingMoments:r})},d.prototype.completeTeachingMoment=function(e){this.saveTeachingMomentToRoamingSettings(e,!1),this.logAmplitudeClickEvent(e,"CompleteTeachingMoment"),i.default.dispatchAsync({actionType:o.default.CompleteTeachingMoment,teachingMoment:e})},d.prototype.resetTeachingMomentWithDelay=function(e){var t=this
window.setTimeout(function(){t.resetTeachingMoment(e)},this.DELAY_TIME_TO_RESET_TEACHING_MOMENT)},d.prototype.convertFromTeachingMomentTypeToRoamingSettingsKey=function(e){switch(e){case l.TeachingMomentTypes.TrackEmailTip:return s.RoamingSettingsKeys.ShouldShowTrackEmailTeachingMoment_V1
case l.TeachingMomentTypes.DoNotDisturbFocus:return s.RoamingSettingsKeys.ShouldShowDoNotDisturbFocusTeachingMoment
case l.TeachingMomentTypes.BookSuggestedTime:return s.RoamingSettingsKeys.ShouldShowBookSuggestedTimeTeachingMoment
case l.TeachingMomentTypes.PinInsights:return s.RoamingSettingsKeys.ShouldShowPinInsightsTimeTeachingMoment
case l.TeachingMomentTypes.AutoDelayDelivery:return s.RoamingSettingsKeys.ShouldShowAutoDelayDeliveryTeachingMoment
case l.TeachingMomentTypes.InlineSuggestions:return s.RoamingSettingsKeys.ShouldShowInlineSuggestionsTeachingMoment
default:return this.logIfNotMapped(e)}},d.prototype.resetTeachingMoment=function(e){this.resetTeachingMomentToRoamingSettings(e),i.default.dispatchAsync({actionType:o.default.ResetTeachingMoment,teachingMoment:e})},d.prototype.logAmplitudeClickEvent=function(e,t){function n(){return{teachingMomentType:l.TeachingMomentTypes[e]}}a.default.logClick(t,{getFeatureNameForLogging:function(){return"TeachingMoment"},getRegionNameForLogging:function(){return"TeachingMomentActionCreator"},getClickEventLoggingProperties:n,getLoadEventLoggingProperties:n})},d.prototype.logIfNotMapped=function(e){return a.default.logAssert("Unexpected teaching moment type "+e,"TeachingMomentActionCreator","convertFromTeachingMomentTypeToRoamingSettingsKey"),null},d.prototype.saveTeachingMomentToRoamingSettings=function(e,t){var n=this.convertFromTeachingMomentTypeToRoamingSettingsKey(e)
s.default.trySetRoamingSettings(s.RoamingSettingsTypes.TeachingMoment,n,t)},d.prototype.resetTeachingMomentToRoamingSettings=function(e){var t=this.convertFromTeachingMomentTypeToRoamingSettingsKey(e)
s.default.tryRemoveRoamingSettings(s.RoamingSettingsTypes.TeachingMoment,t)},d.prototype.getTeachingMomentFromRoamingSettings=function(e){var t=this.convertFromTeachingMomentTypeToRoamingSettingsKey(e)
return s.default.tryGetRoamingSettings(t)},d)
function d(){this.DELAY_TIME_TO_RESET_TEACHING_MOMENT=10*u.Constants.oneSecondInMilliseconds}t.TeachingMomentActionCreator=c,t.default=new c},function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.NudgeType=t.ExternalInsightType=void 0,(r=t.ExternalInsightType||(t.ExternalInsightType={})).AutoDelayDeliveryInsight="AutoDelayDeliveryInsight",r.SuggestedDelayDeliveryInsight="SuggestedDelayDeliveryInsight",r.TrackEmailInsightInfobar="TrackEmailInsightInfobar",r.DetectOOFComposingInfobar="DetectOOFComposingInfobar",r.MeetingPreparationInfobar="MeetingPreparationInfobar",r.MeetingReadinessInsight="MeetingReadinessInsight",r.MeetingRelatedDocumentsInsight="MeetingRelatedDocumentsInsight",r.DocumentsToCatchupInsight="DocumentsToCatchupInsight",r.TasksInsight="TasksInsight",r.FollowUpsInsight="FollowUpsInsight",r.FocusGoalDaysToBookInsight="FocusGoalDaysToBookInsight",r.ComposePeopleCatchUpItemsInsightInfobar="ComposePeopleCatchUpItemsInsightInfobar",r.DirectReportsBookOneOnOneInsight="DirectReportsBookOneOnOneInsight",r.DirectReportsConflictingOneOnOneInsight="DirectReportsConflictingOneOnOneInsight",r.SmartRulesSuggestionInsight="SmartRulesSuggestionInsight",r.TeamsGroupSuggestionInsight="TeamsGroupSuggestionInsight",r.CatchUpImportantMailInsight="CatchUpImportantMailInsight",(o=t.NudgeType||(t.NudgeType={})).ActionableMessage="ActionableMessage",o.Infobar="Infobar"},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ImportantPeopleActionCreator=void 0
var i=n(0),r=i.__importStar(n(115)),a=i.__importDefault(n(3)),s=i.__importDefault(n(11)),u=i.__importDefault(n(384)),l=i.__importDefault(n(147)),o=i.__importDefault(n(916)),c=i.__importDefault(n(118)),d=i.__importDefault(n(35)),p=i.__importDefault(n(296)),f=i.__importDefault(n(6)),g=n(7),m=n(4),h=n(16),y=n(925),_=n(51),S=i.__importDefault(n(927)),T=n(34),I=i.__importDefault(n(928)),b=(E.prototype.getImportantPeople=function(t){return void 0===t&&(t=!0),i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return[2,this.getImportantPeopleFromWES(t)]})})},E.prototype.getImportantPeopleFromWES=function(r){return void 0===r&&(r=!0),i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:return t=new o.default(h.HTTPRequestMethod.GET,this.FEATURE_NAME,"GetPinnedUsersWES",m.LogRequestType.Interval),n=null,r?[4,this.myCache.getItem(this.myCacheKey)]:[3,2]
case 1:n=e.sent(),e.label=2
case 2:return n?(t.logCreator().success("Data retrieved from cache for "+this.myCacheKey),[3,5]):[3,3]
case 3:return[4,d.default.executeWESRequest(t)]
case 4:n=e.sent(),e.label=5
case 5:return n.status===Office.AsyncResultStatus.Succeeded&&this.processPinnedContactsResults(n),[2,n]}})})},E.prototype.processPinnedContactsResults=function(o){return i.__awaiter(this,void 0,void 0,function(){var t,n,r
return i.__generator(this,function(e){switch(e.label){case 0:return t=this.parseGetPinnedUsersResponse(o),n=c.default.getState().sortedVIPs(),r=!f.default.shallowEquals(t.map(function(e){return e.smtpAddress}),n.map(function(e){return e.smtpAddress})),o.useRelevantPeopleForSearchFolder=!1,t.length<=1&&!l.default.getState().shouldIgnorePeopleFirstRun()&&(o.useRelevantPeopleForSearchFolder=!0),r&&(t.length>this.MAX_PINNED_PEOPLE&&u.default.setIgnorePeopleFirstRun(),s.default.dispatch({actionType:a.default.GetSortedVIPs,sortedVIPs:t}),o.useRelevantPeopleForSearchFolder||p.default.updateVIPSearchFolderWithSortedEmailAddressList(t.map(function(e){return e.smtpAddress}))),[4,this.myCache.setItem(this.myCacheKey,o,{ttl:300})]
case 1:return e.sent(),[2]}})})},E.prototype.parseGetPinnedUsersResponse=function(e){return this.parseGetPinnedUsersWESResponse(e)},E.prototype.parseGetPinnedUsersWESResponse=function(e){if(e.result)return e.result.value.filter(function(e){return!!e.Id}).map(function(e){return{isPinned:!0,name:e.Contact.DisplayName||e.Contact.PrimarySmtpAddress.toLowerCase(),relevanceRank:0,smtpAddress:e.Contact.PrimarySmtpAddress.toLowerCase()}}).sort(r.comparePeopleByEmailAddress)},E.prototype.pinUsers=function(n){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return[4,this.bulkPinUsersRequestWES(n)]
case 1:return e.sent(),t=c.default.getState().sortedVIPs(),p.default.updateVIPSearchFolderWithSortedEmailAddressList(t.map(function(e){return e.smtpAddress})),[2]}})})},E.prototype.unpinUsers=function(r){return i.__awaiter(this,void 0,void 0,function(){var t,n=this
return i.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.all(r.map(function(e){return n.unpinSingleUserRequestWES(e)}))]
case 1:return e.sent(),t=c.default.getState().sortedVIPs(),p.default.updateVIPSearchFolderWithSortedEmailAddressList(t.map(function(e){return e.smtpAddress})),[2]}})})},E.prototype.pinSingleUser=function(t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return[2,this.bulkPinUsersRequestWES([t])]})})},E.prototype.unpinSingleUser=function(n){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return s.default.dispatch({actionType:a.default.PeopleUnpin,user:n}),t=new S.default(this.FEATURE_NAME,"PostUnpinUserRequestWES",m.LogRequestType.Action,"UnpinUser").unpinContactEmailAddress(n.smtpAddress),[4,d.default.executeWESRequest(t,T.RequestPriority.High)]
case 1:return e.sent().status===Office.AsyncResultStatus.Failed&&s.default.dispatch({actionType:a.default.PeoplePin,user:n}),[2]}})})},E.prototype.bulkPinUsersRequestWES=function(n){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return 0===n.length?[2]:(t=new I.default(this.FEATURE_NAME,"PostPinUserRequestWES",m.LogRequestType.Action,"PinUser").pinContactsEmailAddresses(n.map(function(e){return e.smtpAddress})),[4,d.default.executeWESRequest(t,T.RequestPriority.High)])
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&n.map(function(e){s.default.dispatch({actionType:a.default.PeoplePin,user:e})}),[2]}})})},E.prototype.unpinSingleUserRequestWES=function(n){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return t=new S.default(this.FEATURE_NAME,"PostUnpinUserRequestWES",m.LogRequestType.Action,"UnpinUser").unpinContactEmailAddress(n.smtpAddress),[4,d.default.executeWESRequest(t,T.RequestPriority.High)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&s.default.dispatch({actionType:a.default.PeopleUnpin,user:n}),[2]}})})},Object.defineProperty(E.prototype,"MAX_PINNED_PEOPLE",{get:function(){return 10},enumerable:!1,configurable:!0}),i.__decorate([_.expirable(_.ExpirationTypes.ByEvery_Minutes,g.Constants.oneHourInMinutes)],E.prototype,"getImportantPeople",null),E=i.__decorate([_.expirable()],E))
function E(){this.FEATURE_NAME="ImportantPeople",this.myCacheKey="ImportantPeople",this.myCache=new y.ExpirationStrategy(new y.MemoryStorage)}t.ImportantPeopleActionCreator=b,t.default=new b},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleSuggestionsStore=t.PeopleSuggestionsStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"isDataReady",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"relevantPeople",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"relevantPeopleForDefaultSearchFolder",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{isDataReady:this.isDataReady(),relevantPeople:this.relevantPeople(),relevantPeopleForDefaultSearchFolder:this.relevantPeopleForDefaultSearchFolder()}},d.prototype.fromJSON=function(e){return(new o).isDataReady(e.isDataReady).relevantPeople(e.relevantPeople).relevantPeopleForDefaultSearchFolder(e.relevantPeopleForDefaultSearchFolder)},i.__decorate([l.doop],d.prototype,"isDataReady",null),i.__decorate([l.doop],d.prototype,"relevantPeople",null),i.__decorate([l.doop],d.prototype,"relevantPeopleForDefaultSearchFolder",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.isDataReady(!1),e.relevantPeople([]),e.relevantPeopleForDefaultSearchFolder([]),e}t.PeopleSuggestionsStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"PeopleSuggestionsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.PeopleSuggestions},enumerable:!1,configurable:!0}),g.prototype.processPeopleSuggestionsAction=function(e,t){return e.relevantPeople(t.relevantPeople).relevantPeopleForDefaultSearchFolder(t.relevantPeopleForDefaultSearchFolder).isDataReady(!0)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.PeopleSuggestions,e.processPeopleSuggestionsAction),e}t.PeopleSuggestionsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpsInsightStore=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importDefault(n(523)),u=(r=s.default,o.__extends(l,r),Object.defineProperty(l.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.FollowUpInsights},enumerable:!1,configurable:!0}),l.prototype.getStoreLoggingName=function(){return"FollowUpsInsightStore"},l.prototype.insightAction=function(){return a.default.FollowUpsInsight},l.prototype.markAsDoneAction=function(){return a.default.MarkFollowUpAsDone},l.prototype.markAsNotAnEntityAction=function(){return a.default.MarkAsNotAFollowUp},l.prototype.promoteTaskAction=function(){return a.default.PromoteFollowUpAction},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.FollowUpsInsightStore=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailAnalyticsUtils=void 0
var r=n(0).__importDefault(n(8)),o=n(7),i=n(385),a=(s.prototype.computeSecondsUntilReadByMost=function(e,t){if(!e)return-1
var n=e.getTime()-t.getTime()
return this.roundEstimationTime(n/o.Constants.oneSecondInMilliseconds)},s.prototype.areMessageReadsStable=function(e){return e.analytics&&(e.analytics.readActivityType===i.ReadActivityType.High||this.computeSecondsUntilCurrentTime(e.analytics.mostReadByDateTime)>o.Constants.oneDayInSeconds)},s.prototype.getPercentOpened=function(e){return e.ReadPercent},s.prototype.computeSecondsUntilCurrentTime=function(e){if(!e)return-1
var t=Date.now()-e.getTime()
return this.roundEstimationTime(t/o.Constants.oneSecondInMilliseconds)},s.prototype.roundEstimationTime=function(e){var t=Math.ceil(e)
return 30<t&&(t=30*Math.round(t/30)),t},s.prototype.getReadStatsPrematureTime=function(){return r.default.isReadStatsPrematureTimeFifteenMinutes?15:30},s)
function s(){}t.SentMailAnalyticsUtils=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedTimeActionCreator=void 0
var l=n(0),s=l.__importStar(n(29)),c=l.__importDefault(n(3)),u=l.__importDefault(n(24)),d=l.__importDefault(n(11)),p=l.__importDefault(n(35)),f=l.__importDefault(n(946)),g=l.__importDefault(n(92)),m=l.__importDefault(n(503)),h=l.__importDefault(n(201)),a=l.__importDefault(n(947)),i=l.__importDefault(n(104)),y=n(4),r=n(948),_=n(34),o=(S.prototype.optInAndBookProtectedTime=function(){return l.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return l.__generator(this,function(e){switch(e.label){case 0:return[4,g.default.setIsProtectedTimeBookingOptedIn(!0)]
case 1:return e.sent()?(t=new Date,n=u.default.getEndOfNextWeek(t),r=new f.default("ProtectedTimeActionCreator","BookProtectedTime",y.LogRequestType.Action).startDate(t).endDate(n),[4,p.default.executeWESRequest(r,_.RequestPriority.High)]):(this.dispatchProtectedTimeBookFailed(s.ProtectedTimeErrorTypes.OptInFail),[2])
case 2:return(o=e.sent()).status===Office.AsyncResultStatus.Succeeded?(i=this.extractProtectedTimeBlocksFromResponseJson(o.result),this.dispatchProtectedTimeBookSucceeded(this.getTotalDaysBooked(i))):(a=this.getProtectedTimeErrorFromBookingErrorCode(o.error),this.dispatchProtectedTimeBookFailed(a)),[2]}})})},S.prototype.getProtectedTimeAroundTimeAwayAndDispatch=function(a,s,u){return void 0===u&&(u=_.RequestPriority.Low),l.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return l.__generator(this,function(e){switch(e.label){case 0:return[4,m.default.getAndDispatchUserWorkingHourConfig("TimeAway")]
case 1:return t=e.sent(),n=h.default.getNextKWorkingDay(-2,a,t.workingDays.workingDaysSundayStart),r=h.default.getNextKWorkingDay(2,s,t.workingDays.workingDaysSundayStart),this.setPullingProtectedTimeAroundTimeAwayStatus(!0),[4,this.getProtectedTimeByDateTimeRange(n,a,u)]
case 2:return o=e.sent(),[4,this.getProtectedTimeByDateTimeRange(s,r,u)]
case 3:return i=e.sent(),o.failed||i.failed?this.setPullingProtectedTimeAroundTimeAwayError(!0):this.setPullingProtectedTimeAroundTimeAwayError(!1),d.default.dispatch({actionType:c.default.SetProtectedTimeAroundTimeAway,protectedTimeBeforeTimeAway:o.block,protectedTimeAfterTimeAway:i.block}),this.setPullingProtectedTimeAroundTimeAwayStatus(!1),[2]}})})},S.prototype.updateProtectedTimeSubjectAndDispatch=function(n,r,o){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return n.IsBooked?[4,i.default.updateBookedBlockSubject(o,n.StartTime,s.CalendarItemType.FocusTime,n.Subject)]:[3,2]
case 1:if(!(t=e.sent()).isSuccessful)return[2,t]
e.label=2
case 2:return d.default.dispatch({actionType:r?c.default.UpdateProtectedTimeBeforeTimeAway:c.default.UpdateProtectedTimeAfterTimeAway,newBlock:n}),[2,{isSuccessful:!0}]}})})},S.prototype.bookProtectedTimeAroundTimeAwayAndDispatch=function(n,r){return l.__awaiter(this,void 0,void 0,function(){var t
return l.__generator(this,function(e){switch(e.label){case 0:return t={startDate:n.StartTime,endDate:n.EndTime,subject:n.Subject,isReminderOn:n.IsReminderOn},[4,i.default.bookFocusBlock(t)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&d.default.dispatch({actionType:r?c.default.UpdateProtectedTimeBeforeTimeAway:c.default.UpdateProtectedTimeAfterTimeAway,newBlock:l.__assign(l.__assign({},n),{IsBooked:!0})}),[2]}})})},S.prototype.unBookProtectedTimeAroundTimeAwayAndDispatch=function(t,n){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){switch(e.label){case 0:return[4,i.default.deleteBookedBlock("TimeAway",t.StartTime,s.CalendarItemType.FocusTime)]
case 1:return e.sent().isSuccessful&&d.default.dispatch({actionType:n?c.default.UpdateProtectedTimeBeforeTimeAway:c.default.UpdateProtectedTimeAfterTimeAway,newBlock:l.__assign(l.__assign({},t),{IsBooked:!1})}),[2]}})})},S.prototype.dispatchProtectedTimeBookSucceeded=function(e){d.default.dispatch({actionType:c.default.BookingProtectedTimeSucceeded,totalDaysBooked:e})},S.prototype.getTotalDaysBooked=function(e){for(var t=new Set,n=0;n<e.length;n++){var r=u.default.startOfDay(e[n].startTime).getTime()
t.add(r)}return t.size},S.prototype.getProtectedTimeErrorFromBookingErrorCode=function(e){switch(e){case r.ProtectedTimeBookingResponseCodes.ERROR_NO_TIME_ZONE_AND_WORKING_HOURS:return s.ProtectedTimeErrorTypes.NoTimeZoneAndWorkingHours
case r.ProtectedTimeBookingResponseCodes.ERROR_NO_PROTECTED_TIME_BOOKED:return s.ProtectedTimeErrorTypes.NoneBooked
case r.ProtectedTimeBookingResponseCodes.ERROR_PARTIAL_PROTECTED_TIME_BOOKED:return s.ProtectedTimeErrorTypes.PartialBooked
default:return s.ProtectedTimeErrorTypes.Other}},S.prototype.extractProtectedTimeBlocksFromResponseJson=function(e){return e.value.map(function(e){return{startTime:new Date(e.StartTime),endTime:new Date(e.EndTime)}})},S.prototype.dispatchProtectedTimeBookFailed=function(e){d.default.dispatch({actionType:c.default.BookingProtectedTimeFailed,error:e})},S.prototype.getProtectedTimeByDateTimeRange=function(r,o,i){return l.__awaiter(this,void 0,void 0,function(){var t,n
return l.__generator(this,function(e){switch(e.label){case 0:return r<new Date&&(r=new Date),o<=r?[2,{block:[],failed:!1}]:(t=new a.default("TimeAway","getProtectedTimeBeforeTimeAway",y.LogRequestType.Action).startTime(r).endTime(o),[4,p.default.executeWESRequest(t,i)])
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?[2,{block:n.result.value.map(this.convertProtectedTimeFromJSON),failed:!1}]:[2,{block:[],failed:!0}]}})})},S.prototype.convertProtectedTimeFromJSON=function(e){return l.__assign(l.__assign({},e),{StartTime:new Date(e.StartTime),EndTime:new Date(e.EndTime)})},S.prototype.setPullingProtectedTimeAroundTimeAwayStatus=function(e){d.default.dispatch({actionType:c.default.SetPullingProtectedTimeAroundTimeAwayStatus,isPulling:e})},S.prototype.setPullingProtectedTimeAroundTimeAwayError=function(e){d.default.dispatch({actionType:c.default.SetPullingProtectedTimeAroundTimeAwayError,failed:e})},S)
function S(){}t.ProtectedTimeActionCreator=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FeedInsightsStore=t.FeedStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importStar(n(42)),u=o.__importDefault(n(55)),l=o.__importStar(n(6)),c=n(7),d=n(5),p=(r=s.CachedDataStreamStateBase,o.__extends(f,r),Object.defineProperty(f.prototype,"allInsightsAsFlattenedList",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"insights",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"identifierToLastComputedTicks",{get:function(){return d.doop()},enumerable:!1,configurable:!0}),f.prototype.toJSON=function(){return{identifierToLastComputedTicks:this.identifierToLastComputedTicks()}},f.prototype.fromJSON=function(t){return Object.keys(t.identifierToLastComputedTicks).forEach(function(e){t.identifierToLastComputedTicks[e].wasLoadedFromCache=!0}),this.identifierToLastComputedTicks(t.identifierToLastComputedTicks)},o.__decorate([d.doop],f.prototype,"allInsightsAsFlattenedList",null),o.__decorate([d.doop],f.prototype,"insights",null),o.__decorate([d.doop],f.prototype,"identifierToLastComputedTicks",null),f=o.__decorate([d.doop],f))
function f(){var e=r.call(this)||this
return e.allInsightsAsFlattenedList([]),e.insights([]),e.identifierToLastComputedTicks({}),e}t.FeedStoreState=p
var g,m=(g=s.default,o.__extends(h,g),h.prototype.getStoreLoggingName=function(){return"FeedInsightsStore"},Object.defineProperty(h.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.FeedInsights},enumerable:!1,configurable:!0}),h.prototype.setStateForItemChangedEvent=function(e,t){return e},h.prototype.getInitialState=function(){return new p},h.prototype.processInsightsAction=function(e,t){var n=t.insightsWithRollups.concat(t.flattenedInsightsList)
return e=e.allInsightsAsFlattenedList(u.default.flattenInsights(n,!0)),e=this.copyOverPreviousLastComputedTimeIfExists(e,t.insightsWithRollups)},h.prototype.copyOverPreviousLastComputedTimeIfExists=function(i,e){var a=i.identifierToLastComputedTicks(),t=e.map(function(t){var e,n,r,o=i.insights().filter(function(e){return u.default.areInsightsEqual(e,t)})
return 1===o.length?(e=Math.min(o[0].lastComputedTimeInTicks,t.lastComputedTimeInTicks),t.lastComputedTimeInTicks=e,t.wasPositionLoadedFromCache=o[0].wasPositionLoadedFromCache):(n=u.default.getInsightIdentifierAsString(t.instanceData.identifier),(r=a[n])&&r.expirationDateInTicks>Date.now()?(t.lastComputedTimeInTicks=r.lastComputedTicks,t.wasPositionLoadedFromCache=r.wasLoadedFromCache):a[n]={lastComputedTicks:t.lastComputedTimeInTicks,expirationDateInTicks:Date.now()+c.Constants.oneDay,wasLoadedFromCache:!1}),t}),n=l.default.sortArrayOnKey(t,function(e){return e.lastComputedTimeInTicks},l.OrderBy.Ascending)
return i.insights(n).identifierToLastComputedTicks(a)},h)
function h(){var e=g.call(this)||this
return e.addActionCallback(a.default.Insights,e.processInsightsAction),e}t.FeedInsightsStore=m,t.default=new m},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExpirationStrategy=void 0
var r,i=n(0),a=i.__importDefault(n(457)),o=n(361),s=(r=o.AbstractBaseStrategy,i.__extends(u,r),u.prototype.getItem=function(n){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return[4,this.storage.getItem(n)]
case 1:return(t=e.sent())&&this.isItemExpired(t)?[4,this.storage.setItem(n,void 0)]:[3,3]
case 2:return e.sent(),[2,void 0]
case 3:return[2,t?t.content:void 0]}})})},u.prototype.setItem=function(n,r,o){return i.__awaiter(this,void 0,void 0,function(){var t=this
return i.__generator(this,function(e){switch(e.label){case 0:return(o=a.default({ttl:60,isLazy:!0},o)).isLazy||setTimeout(function(){t.removeItem(n)},o.ttl),[4,this.storage.setItem(n,{meta:{ttl:1e3*o.ttl,createdAt:Date.now()},content:r})]
case 1:return e.sent(),[2]}})})},u.prototype.clear=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return this.storage.clear(),[2]})})},u.prototype.removeItem=function(t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,this.storage.removeItem(t)]
case 1:return e.sent(),[2]}})})},u.prototype.isItemExpired=function(e){return Date.now()>e.meta.createdAt+e.meta.ttl},u)
function u(e){return r.call(this,e)||this}t.ExpirationStrategy=s},,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=void 0
var r=n(0),o=(i.prototype.getItem=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,this.memCache[t]]})})},i.prototype.setItem=function(t,n){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.memCache[t]=n,[2]})})},i.prototype.removeItem=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.memCache[t]=void 0,[2]})})},i.prototype.clear=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return this.memCache={},[2]})})},i)
function i(){this.memCache={}}t.MemoryStorage=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarConstants=void 0
var r=(Object.defineProperty(o,"InfobarKey",{get:function(){return"MyAnalytics"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"InfobarType",{get:function(){return"insightMessage"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"InfobarIcon",{get:function(){return"icon1_16x16"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"InfobarFeatureName",{get:function(){return"Infobar"},enumerable:!1,configurable:!0}),o)
function o(){}t.InfobarConstants=r},,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=o.__importDefault(n(102)),a=o.__importDefault(n(495)),s=o.__importDefault(n(68)),u=(r=a.default,o.__extends(l,r),l.prototype.ewsStartExecuting=function(){r.prototype.startExecuting.call(this)},l.prototype.ewsFailWithDebuggingInformation=function(e,t){var n=i.default.NO_RESPONSE_CODE
try{n=s.default.extractResponseCode(t)}catch(e){}this.logScrubbedXMLResponse(e,n,t)},l.prototype.ewsFail=function(e){this.unexpectedFail(e)},l.prototype.logScrubbedXMLResponse=function(e,t,n){var r=this.scrubPIIFromResponse(n)
this.unexpectedFail(e,t,r)},l.prototype.batchCompletedProperties=function(e,t,n){return o.__assign(o.__assign({},r.prototype.batchCompletedProperties.call(this,e,t,n)),{region:"BatchRequest",source:"EWSService"})},l.prototype.scrubPIIFromResponse=function(e){if(!e)return"Null or undefined XML document."
try{for(var t=0;t<e.all.length;t++)0===e.all[t].childElementCount&&(e.all[t].textContent="")
return(new XMLSerializer).serializeToString(e)}catch(e){return"Could not remove PII values with ["+e+"]"}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(84),s=(r=a.EWSRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"itemIds",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return"<m:GetItem>\n                <m:ItemShape>\n                    <t:BodyType>Text</t:BodyType>\n                    <t:BaseShape>IdOnly</t:BaseShape>\n                    <t:AdditionalProperties>\n                        "+this.buildFieldURIPropertiesElements()+"\n                        "+this.buildExtendedFieldURIPropertiesElement()+"\n                    </t:AdditionalProperties>\n                </m:ItemShape>\n                <m:ItemIds>\n                    "+this.buildItemIdElements()+"\n                </m:ItemIds>\n            </m:GetItem>"},u.prototype.buildItemIdElements=function(){return this.itemIds().map(function(e){return'<t:ItemId Id="'+e.id+'" />'}).join(" ")},u.prototype.toTraceString=function(){return"GetItemRequest"},o.__decorate([i.doop],u.prototype,"itemIds",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogTypes=void 0,(o=r=t.ActionLogTypes||(t.ActionLogTypes={}))[o.Dismiss=0]="Dismiss",o[o.ActedUpon=1]="ActedUpon",o[o.LegacyType=2]="LegacyType",t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BootStore=t.BootStoreState=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(61)),a=r.__importDefault(n(44)),s=r.__importDefault(n(57)),u=n(5),l=r.__importDefault(n(6)),c=r.__importDefault(n(62)),d=(Object.defineProperty(p.prototype,"userFlights",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"localizationStrings",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"defaultStrings",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"exToken",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"restToken",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),p.prototype.fromJSON=function(e){return this.userFlights(e.userFlights)},p.prototype.toJSON=function(){return{userFlights:this.userFlights()}},r.__decorate([u.doop],p.prototype,"userFlights",null),r.__decorate([u.doop],p.prototype,"localizationStrings",null),r.__decorate([u.doop],p.prototype,"defaultStrings",null),r.__decorate([u.doop],p.prototype,"exToken",null),r.__decorate([u.doop],p.prototype,"restToken",null),p=r.__decorate([u.doop],p))
function p(){}t.BootStoreState=d
var f,g=(f=i.default,r.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"BootStore"},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"isCoreRequiredDataReady",{get:function(){var e=this.getState()
return this.areLocalizationStringsReady&&!!e.userFlights()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isIdentityTokenDataReady",{get:function(){return!!this.getState().exToken()},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isRESTCallbackTokenReady",{get:function(){return!!this.getState().restToken()},enumerable:!1,configurable:!0}),m.prototype.getInitialState=function(){return new d},Object.defineProperty(m.prototype,"areLocalizationStringsReady",{get:function(){var e=this.getState()
return!!e.localizationStrings()||!!e.defaultStrings()},enumerable:!1,configurable:!0}),m.prototype.tryProcessLoadFromSessionData=function(e,t){var n=f.prototype.tryProcessLoadFromSessionData.call(this,e,t)
return n.userFlights()&&c.default.setUserFlights(n.userFlights()),n},m.prototype.processgetUserFlightsFromControlTower=function(e,t){var n=this.convertUserFlightsArrayToMap(t.userFlights)
return this.updateUserFlightsState(e,n)},m.prototype.processGetUserFlightsFromExternalContext=function(e,t){return this.updateUserFlightsState(e,t.userFlightsMap)},m.prototype.convertUserFlightsArrayToMap=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=!0
return t},m.prototype.updateUserFlightsState=function(e,t){return c.default.setUserFlights(t),l.default.shallowEquals(e.userFlights(),t)?e:e.userFlights(t)},m.prototype.processGetLocalizationStringsAction=function(e,t){return a.default.localizationStrings=t.nameValueMappings,e.localizationStrings(t.nameValueMappings)},m.prototype.processGetDefaultStringsAction=function(e,t){return a.default.defaultStrings=t.nameValueMappings,e.defaultStrings(t.nameValueMappings)},m.prototype.processRESTCallbackTokenReadyAction=function(e,t){return s.default.RESTCallbackTokenWithExpiration=t.token,e.restToken(t.token.val)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(o.default.GetLocalizationStrings,e.processGetLocalizationStringsAction),e.addActionCallback(o.default.GetDefaultStrings,e.processGetDefaultStringsAction),e.addActionCallback(o.default.RESTCallbackTokenReady,e.processRESTCallbackTokenReadyAction),e.addActionCallback(o.default.GetUserFlightsFromControlTower,e.processgetUserFlightsFromControlTower),e.addActionCallback(o.default.GetUserFlightsFromExternalContext,e.processGetUserFlightsFromExternalContext),e}t.BootStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CatchUpImportantMailStore=t.CatchUpImportantMailStoreState=void 0
var r,o,i=n(0),a=n(5),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=i.__importStar(n(15)),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"unreadMail",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"irankerMailInstances",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{unreadMail:this.unreadMail(),irankerMailInstances:this.irankerMailInstances()}},d.prototype.fromJSON=function(e){return(new o).unreadMail(e.unreadMail).irankerMailInstances(e.irankerMailInstances)},i.__decorate([a.doop],d.prototype,"unreadMail",null),i.__decorate([a.doop],d.prototype,"irankerMailInstances",null),d=o=i.__decorate([a.doop],d))
function d(){var e=r.call(this)||this
return e.unreadMail([]),e.irankerMailInstances([]),e}t.CatchUpImportantMailStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"CatchUpImportantMailStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return l.WellKnownDataSources.CatchUpImportantMails},enumerable:!1,configurable:!0}),g.prototype.processGetUnreadMails=function(e,t){return e.unreadMail(t.unreadMail)},g.prototype.processMarkEmailItemAsRead=function(e,t){var n=e.unreadMail().filter(function(e){return e.itemId.id!==t.emailItem.itemId.id})
return e.unreadMail(n)},g.prototype.processIRankerMailInstances=function(e,t){return e.irankerMailInstances(t.insights)},g.prototype.processMarkMailAsNotImportant=function(e,t){var n=e.irankerMailInstances().filter(function(e){return e.unreadEmailItem.itemId.id!==t.emailItemId})
return e.irankerMailInstances(n)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetUnreadMailFromIRankerSearchFolder,e.processGetUnreadMails),e.addActionCallback(s.default.MarkEmailItemAsReadAction,e.processMarkEmailItemAsRead),e.addActionCallback(s.default.GetIRankerUnreadMail,e.processIRankerMailInstances),e.addActionCallback(s.default.MarkMailAsNotImportant,e.processMarkMailAsNotImportant),e}t.CatchUpImportantMailStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WorkingHourConfigsStore=t.WorkingHourConfigsStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"userWorkingHourConfig",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"recipientsWorkingHourConfig",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{userWorkingHourConfig:this.userWorkingHourConfig(),recipientsWorkingHourConfig:this.recipientsWorkingHourConfig()}},d.prototype.fromJSON=function(e){return(new o).userWorkingHourConfig(e.userWorkingHourConfig).recipientsWorkingHourConfig(e.recipientsWorkingHourConfig)},i.__decorate([l.doop],d.prototype,"userWorkingHourConfig",null),i.__decorate([l.doop],d.prototype,"recipientsWorkingHourConfig",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.userWorkingHourConfig(null),e.recipientsWorkingHourConfig({}),e}t.WorkingHourConfigsStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"WorkingHourConfigsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.WorkingHourConfigs},enumerable:!1,configurable:!0}),g.prototype.processGetUserWorkingHourConfig=function(e,t){return e.userWorkingHourConfig(t.workingHourConfig)},g.prototype.processGetRecipientsWorkingHourConfig=function(e,t){var n=e.recipientsWorkingHourConfig(),r=!1
return Object.keys(t.recipientsWorkingHourConfig).forEach(function(e){!n[e]&&t.recipientsWorkingHourConfig[e]&&(n[e]=t.recipientsWorkingHourConfig[e],r=!0)}),r?e.recipientsWorkingHourConfig(i.__assign({},n)):e},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetWorkingHourConfig,e.processGetUserWorkingHourConfig),e.addActionCallback(s.default.GetRecipientsWorkingHourConfig,e.processGetRecipientsWorkingHourConfig),e}t.WorkingHourConfigsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EmailComposeContext=t.MeetingComposeContext=void 0
var r=n(0),o=r.__importStar(n(115)),i=r.__importDefault(n(8)),a=r.__importDefault(n(54)),s=r.__importDefault(n(6)),u=n(5),l=n(16),c=n(38),d=n(851),p=(f.prototype.getContext=function(){var e,t={Subject:{Kind:d.SubjectKind.MeetingRequest,Value:d.SubjectValue.Me,Subject:this.meetingProperties.meetingSubject,MeetingStartTime:this.meetingProperties.start.toISOString(),MeetingEndTime:this.meetingProperties.end.toISOString(),"RequiredAttendees@odata.type":"#Collection(String)",RequiredAttendees:this.getAttendeeEmails(this.meetingProperties.requiredAttendees),"OptionalAttendees@odata.type":"#Collection(String)",OptionalAttendees:this.getAttendeeEmails(this.meetingProperties.optionalAttendees),DisplayLanguage:Office.context.displayLanguage.toLowerCase()},UserAction:"Compose"}
return i.default.isMeetingPreparationInfobarEnabled&&(e=this.meetingProperties.requiredAttendees.concat(this.meetingProperties.optionalAttendees),t.Subject.InternalAttendeeCount=this.computeInternalAttendeeCount(e),t.Subject.ExternalAttendeeCount=this.computeExternalAttendeeCount(e),t.Subject.IsNewComposeMeeting=this.meetingProperties.isNewComposeMeeting,t.Subject.IsRecurring=this.meetingProperties.isRecurring,t.Subject["Attachments@odata.type"]="#Collection(Microsoft.O365Insights.Sdk.Analytics.V1.ReferenceAttachment)",t.Subject.Attachments=this.getRequiredAttachmentsDetails(this.meetingProperties.attachments)),t},f.prototype.getAttendeeEmails=function(e){return e.map(function(e){return e.emailAddress}).filter(function(e){return e!==s.default.userEmailLowerCase})},f.prototype.getRequiredAttachmentsDetails=function(e){return e.map(function(e){return{"@odata.type":"#Microsoft.O365Insights.Sdk.Analytics.V1.ReferenceAttachment",Name:e.name,Id:e.id,SourceUrl:null,ProviderType:null,IsInline:e.isInline,IsFolder:!1}})},f.prototype.computeExternalAttendeeCount=function(e){return e.filter(function(e){return e.recipientType===o.IRecipientType.ExternalUser}).length},f.prototype.computeInternalAttendeeCount=function(e){return e.filter(function(e){return e.recipientType!==o.IRecipientType.ExternalUser}).reduce(function(e,t){return e+t.totalMemberCount-t.externalMemberCount},0)},f)
function f(e){this.meetingProperties=e}t.MeetingComposeContext=p
var g=(m.prototype.getContext=function(){return{Subject:{Kind:d.SubjectKind.Email,Value:d.SubjectValue.Me,Subject:this.emailProperties.subject,InternetMessageId:this.emailProperties.encodedImid,"ToRecipients@odata.type":"#Collection(String)",ToRecipients:this.emailProperties.toRecipients.map(function(e){return e.emailAddress}),"EstimatedToRecipients@odata.type":"#Collection(String)",EstimatedToRecipients:this.emailProperties.estimatedToRecipients.map(function(e){return e.emailAddress}),RecipientCount:this.emailProperties.recipientCount,ToRecipientCount:this.emailProperties.toRecipientCount,IsMessageReply:this.emailProperties.isMessageReply,IsNewMessage:!Office.context.mailbox.item.conversationId,CheckMinimumEligibility:this.emailProperties.checkMinimumEligibility,ComposeTimeSpan:this.emailProperties.composeTimeSpan,DoesSupportDelayDelivery:a.default.doesSupportDelayDelivery,ScheduledDelayDeliveryDateTime:this.emailProperties.scheduledDelayDeliveryDateTime.toISOString(),DisplayLanguage:Office.context.displayLanguage.toLowerCase()},UserAction:"Compose"}},m)
function m(e){this.emailProperties=e}t.EmailComposeContext=g
var h,y=(h=c.WESRequestBase,r.__extends(_,h),Object.defineProperty(_.prototype,"contextProvider",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),r.__decorate([u.doop],_.prototype,"contextProvider",null),_=r.__decorate([u.doop],_))
function _(e,t,n,r){var o=h.call(this,l.HTTPRequestMethod.POST,e,t,n,r)||this
return o.shouldIncludeMetadata(!0),o}t.default=y},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ReadActivityUtils=void 0
var r=n(0),o=n(385),i=r.__importDefault(n(4)),a=r.__importDefault(n(2)),s=(u.prototype.getAccessLevel=function(e){switch(e){case"Low":return o.ReadActivityType.Low
case"Normal":return o.ReadActivityType.Normal
case"High":return o.ReadActivityType.High
default:throw new Error("Invalid access level "+e+".")}},u.prototype.readActivityString=function(e,t){switch(e){case o.ReadActivityType.High:return a.default.NUM_GREATER_THAN_READ_PERCENTAGE(String(Math.floor(t)))
case o.ReadActivityType.Low:return a.default.NUM_LESS_THAN_READ_PERCENTAGE(String(Math.floor(t)))
case o.ReadActivityType.Normal:return a.default.NUM_READ_PERCENTAGE(String(Math.floor(t)))
default:i.default.logAssert("Encountered Unknown ReadActivityType: "+e,"ReadActivityUtils","readActivityString")}},u.prototype.emailEngagementActivityString=function(e){if(!e)return null
var t=e.ReadLevel,n=e.Percentage
switch(t){case o.ReadActivityType.High:return a.default.EXTENDED_SENT_STATS_EMAIL_ENGAGEMENT_VALUE_GREATER_THAN(n)
case o.ReadActivityType.Low:return a.default.EXTENDED_SENT_STATS_EMAIL_ENGAGEMENT_VALUE_LESS_THAN(n)
case o.ReadActivityType.Normal:return a.default.EXTENDED_SENT_STATS_EMAIL_ENGAGEMENT_VALUE(n)
default:i.default.logAssert("Encountered Unknown Access Level: "+t,"ReadActivityUtils","emailEngagmentReadActivityString")}},u)
function u(){}t.ReadActivityUtils=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),a=n(66),s=n(52),o=r.__importDefault(n(39)),i=r.__importDefault(n(894)),u=r.__importStar(n(6)),l=(c.removeCompletedTasks=function(e,n){return e.filter(function(t){return!n.some(function(e){return e.entityId===t.entity.entityId})})},c.convertTaskInstanceToToDo=function(e){return o.default.throwIfNullOrEmptyArray("requesters",e.Requesters),{identifier:e.identifier,taskId:e.TaskId,entity:{entityId:e.ToDoEntityId,description:e.Description,confidenceScore:e.Confidence,entitySource:e.EntitySource},toDoType:c.convertToDoType(e.ActionType),numberOfPeopleOnToLine:e.NumberOfRecipientsOnToLine,numberOfPeopleOnCcLine:e.NumberOfRecipientsOnCcLine,createdDateTime:e.CreatedDateTime,dueDateTime:e.DueDateTime,sourceItem:{dateTimeSent:new Date(e.SourceReceivedDateTime),itemId:{id:e.SourceMailId},subject:e.SourceMailSubject},targetPerson:{smtpAddress:e.Requesters[0].MailAddress,name:e.Requesters[0].DisplayName},markAsNotATaskAction:e.MarkAsNotATaskAction,markTaskAsDoneAction:e.MarkTaskAsDoneAction,promoteTaskAction:e.PromoteTaskAction,isPromotedTask:e.IsPromotedTask,promotedTaskLink:e.PromotedTaskLink,rankingScores:{overallRankScore:e.OverallRankScore,emailImportanceScore:e.EmailImportanceScore,peopleImportanceScore:e.PeopleImportanceScore,userMentionedScore:e.UserMentionedScore,dueDateOrCreationTimeScore:e.DueDateOrCreationTimeScore}}},c.convertToDoToTaskInstance=function(e){var t,n,r,o,i
return{identifier:{primaryId:e.identifier.primaryId,secondaryId:e.identifier.secondaryId},TaskId:e.taskId,ToDoEntityId:e.entity.entityId,ActionType:a.ToDoType[e.toDoType],Confidence:e.entity.confidenceScore,Description:e.entity.description,EntitySource:e.entity.entitySource,CreatedDateTime:e.createdDateTime,DueDateTime:e.dueDateTime,SourceMailId:e.sourceItem.itemId.id,SourceMailSubject:e.sourceItem.subject,SourceReceivedDateTime:e.sourceItem.dateTimeSent.toDateString(),Requesters:[{MailAddress:e.targetPerson.smtpAddress,DisplayName:e.targetPerson.name}],NumberOfRecipientsOnToLine:e.numberOfPeopleOnToLine,NumberOfRecipientsOnCcLine:e.numberOfPeopleOnCcLine,MarkAsNotATaskAction:{Name:s.MARK_AS_NOT_A_TASK_ACTION,TaskSuggestionId:e.taskId,Text:null},MarkTaskAsDoneAction:{Name:s.MARK_TASK_AS_DONE_ACTION,TaskSuggestionId:e.taskId,Text:null},PromoteTaskAction:{Name:s.PROMOTE_TASK_ACTION,TaskSuggestionId:e.taskId,Text:null},IsPromotedTask:e.isPromotedTask,PromotedTaskLink:e.promotedTaskLink,OverallRankScore:(null===(t=e.rankingScores)||void 0===t?void 0:t.overallRankScore)||0,EmailImportanceScore:(null===(n=e.rankingScores)||void 0===n?void 0:n.emailImportanceScore)||0,PeopleImportanceScore:(null===(r=e.rankingScores)||void 0===r?void 0:r.peopleImportanceScore)||0,UserMentionedScore:(null===(o=e.rankingScores)||void 0===o?void 0:o.userMentionedScore)||0,DueDateOrCreationTimeScore:(null===(i=e.rankingScores)||void 0===i?void 0:i.dueDateOrCreationTimeScore)||0}},c.filterTaskPresentInTaskStore=function(e,t){return i.default(t,e,function(e,t){return e.entity.entityId===t.entity.entityId})},c.sortAndWrapTasksAsInstances=function(e,t){return u.default.sortArrayOnKey(e,function(e){return e.sourceItem.dateTimeSent.getTime()},u.OrderBy.Descending).map(function(e){return{task:e,identifier:{primaryId:e.entity.entityId,secondaryId:t.identifier.secondaryId},doesSupportNudgeFeedback:t.doesSupportNudgeFeedback}})},c.convertToDoType=function(e){switch(e){case"Commitment":return a.ToDoType.Commitment
case"Request":return a.ToDoType.Request
default:throw Error("Invalid ToDo actionType: "+e)}},c)
function c(){}t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(39)),o=n(66),a=n(52),i=(s.isIdentifierValid=function(e){return!!e&&!!e.primaryId&&!!e.secondaryId},s.convertTaskInstanceToFollowUp=function(e){return r.default.throwIfNullOrEmptyArray("requesters",e.Requesters),{identifier:e.identifier,taskId:e.TaskId,entity:{entityId:e.ToDoEntityId,description:e.Description,confidenceScore:e.Confidence,entitySource:e.EntitySource},followUpType:s.convertFollowUpType(e.ActionType),numberOfPeopleOnToLine:e.NumberOfRecipientsOnToLine,numberOfPeopleOnCcLine:e.NumberOfRecipientsOnCcLine,createdDateTime:e.CreatedDateTime,dueDateTime:e.DueDateTime,sourceItem:{dateTimeSent:new Date(e.SourceReceivedDateTime),itemId:{id:e.SourceMailId},subject:e.SourceMailSubject},targetPerson:{smtpAddress:e.Requesters[0].MailAddress,name:e.Requesters[0].DisplayName},duplicateEntityIds:[],conversationId:e.SourceConversationId,markAsNotATaskAction:e.MarkAsNotATaskAction,markTaskAsDoneAction:e.MarkTaskAsDoneAction,promoteTaskAction:e.PromoteTaskAction,isPromotedTask:e.IsPromotedTask,promotedTaskLink:e.PromotedTaskLink,rankingScores:{overallRankScore:e.OverallRankScore,emailImportanceScore:e.EmailImportanceScore,peopleImportanceScore:e.PeopleImportanceScore,userMentionedScore:e.UserMentionedScore,dueDateOrCreationTimeScore:e.DueDateOrCreationTimeScore}}},s.convertFollowUpToTaskInstance=function(e){var t,n,r,o,i
return{TaskId:e.taskId,ActionType:s.convertFollowUpTypeToString(e.followUpType),Confidence:e.entity.confidenceScore,SourceMailId:e.sourceItem.itemId.id,identifier:e.identifier,NumberOfRecipientsOnToLine:e.numberOfPeopleOnToLine,NumberOfRecipientsOnCcLine:e.numberOfPeopleOnCcLine,SourceMailSubject:e.sourceItem.subject,ToDoEntityId:e.entity.entityId,Description:e.entity.description,EntitySource:e.entity.entitySource,CreatedDateTime:e.createdDateTime,DueDateTime:e.dueDateTime,Requesters:[{MailAddress:e.targetPerson.smtpAddress,DisplayName:e.targetPerson.name}],SourceReceivedDateTime:e.sourceItem.dateTimeSent.toDateString(),MarkAsNotATaskAction:{Name:a.MARK_AS_NOT_A_TASK_ACTION,TaskSuggestionId:e.taskId,Text:null},MarkTaskAsDoneAction:{Name:a.MARK_TASK_AS_DONE_ACTION,TaskSuggestionId:e.taskId,Text:null},PromoteTaskAction:e.promoteTaskAction?{Name:a.PROMOTE_TASK_ACTION,TaskSuggestionId:e.taskId,Text:null}:null,IsPromotedTask:e.isPromotedTask,PromotedTaskLink:e.promotedTaskLink,OverallRankScore:(null===(t=e.rankingScores)||void 0===t?void 0:t.overallRankScore)||0,EmailImportanceScore:(null===(n=e.rankingScores)||void 0===n?void 0:n.emailImportanceScore)||0,PeopleImportanceScore:(null===(r=e.rankingScores)||void 0===r?void 0:r.peopleImportanceScore)||0,UserMentionedScore:(null===(o=e.rankingScores)||void 0===o?void 0:o.userMentionedScore)||0,DueDateOrCreationTimeScore:(null===(i=e.rankingScores)||void 0===i?void 0:i.dueDateOrCreationTimeScore)||0}},s.convertFollowUpType=function(e){switch(e){case"FollowUpActionRequest":return o.FollowUpType.ActionFollowUp
case"FollowUpReplyRequest":return o.FollowUpType.ReplyFollowUp
default:throw Error("Invalid FollowUp actionType: "+e)}},s.convertFollowUpTypeToString=function(e){switch(e){case o.FollowUpType.ActionFollowUp:return"FollowUpActionRequest"
case o.FollowUpType.ReplyFollowUp:return"FollowUpReplyRequest"
default:throw Error("Invalid FollowUp Type: "+e)}},s)
function s(){}t.default=i},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationCardInsightStore=t.MeetingPreparationCardInsightStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=n(52),d=(r=l.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"meetingInsights",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actedUponInsightId",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"performedActionName",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actionSlotDurationInMinutes",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bookedMeetingId",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"documentStats",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{meetingInsights:this.meetingInsights(),actedUponInsightId:this.actedUponInsightId(),performedActionName:this.performedActionName(),actionSlotDurationInMinutes:this.actionSlotDurationInMinutes(),bookedMeetingId:this.bookedMeetingId(),documentStats:this.documentStats()}},p.prototype.fromJSON=function(e){return(new o).meetingInsights(e.meetingInsights).actedUponInsightId(e.actedUponInsightId).performedActionName(e.performedActionName).actionSlotDurationInMinutes(e.actionSlotDurationInMinutes).bookedMeetingId(e.bookedMeetingId).documentStats(e.documentStats)},i.__decorate([u.doop],p.prototype,"meetingInsights",null),i.__decorate([u.doop],p.prototype,"actedUponInsightId",null),i.__decorate([u.doop],p.prototype,"performedActionName",null),i.__decorate([u.doop],p.prototype,"actionSlotDurationInMinutes",null),i.__decorate([u.doop],p.prototype,"bookedMeetingId",null),i.__decorate([u.doop],p.prototype,"documentStats",null),p=o=i.__decorate([u.doop],p))
function p(){var e=r.call(this)||this
return e.meetingInsights([]),e.actedUponInsightId(null),e.performedActionName(null),e.actionSlotDurationInMinutes(0),e.bookedMeetingId(null),e.documentStats([]),e}t.MeetingPreparationCardInsightStoreState=d
var f,g=(f=l.default,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.MeetingPreparationInsights},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"MeetingPreparationCardInsightStore"},m.prototype.setStateForItemChangedEvent=function(e,t){return e},m.prototype.processMeetingPreparationInsights=function(e,t){return this.getInitialState().meetingInsights(t.insights)},m.prototype.processBookPreparationTimeAction=function(e,t){return e.actedUponInsightId(t.insightId).performedActionName(c.BOOK_PREPARATION_TIME_ACTION).actionSlotDurationInMinutes(t.actionSlotDurationInMinutes).bookedMeetingId(t.bookedMeetingId)},m.prototype.processCancelPreparationTimeAction=function(e,t){return e.actedUponInsightId(t.insightId).performedActionName(c.CANCEL_BOOKED_TIME_ACTION).actionSlotDurationInMinutes(t.actionSlotDurationInMinutes)},m.prototype.updateMeetingInsights=function(e,t){var n=(n=e.meetingInsights()).filter(function(e){return e.meetingId!==t.insight.meetingId}).concat(t.insight)
return e.meetingInsights(n)},m.prototype.processDocumentAnalytics=function(e,t){var n=(n=e.documentStats()).filter(function(e){return e.insightId!==t.insightId}).concat({insightId:t.insightId,documentStats:t.documentAnalytics})
return e.documentStats(n)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.MeetingPreparationCardInsightAction,e.processMeetingPreparationInsights),e.addActionCallback(s.default.MeetingDocumentStatsCardAction,e.processDocumentAnalytics),e.addActionCallback(s.default.BookMeetingPreparationTimeAction,e.processBookPreparationTimeAction),e.addActionCallback(s.default.CancelMeetingPreparationTimeAction,e.processCancelPreparationTimeAction),e.addActionCallback(s.default.RespondToMeeting,e.updateMeetingInsights),e}t.MeetingPreparationCardInsightStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationInfobarStore=t.MeetingPreparationInfobarStoreState=void 0
var r,o,i=n(0),a=n(5),s=i.__importDefault(n(3)),u=n(15),l=n(83),c=n(52),d=(r=l.DataStreamStoreStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"actedUponInsightId",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"performedActionName",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actionSlotDurationInMinutes",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bookedMeetingId",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),p.prototype.fromJSON=function(e){return(new o).actedUponInsightId(e.actedUponInsightId).performedActionName(e.performedActionName).actionSlotDurationInMinutes(e.actionSlotDurationInMinutes).bookedMeetingId(e.bookedMeetingId)},p.prototype.toJSON=function(){return{actedUponInsightId:this.actedUponInsightId(),performedActionName:this.performedActionName(),actionSlotDurationInMinutes:this.actionSlotDurationInMinutes(),bookedMeetingId:this.bookedMeetingId()}},i.__decorate([a.doop],p.prototype,"actedUponInsightId",null),i.__decorate([a.doop],p.prototype,"performedActionName",null),i.__decorate([a.doop],p.prototype,"actionSlotDurationInMinutes",null),i.__decorate([a.doop],p.prototype,"bookedMeetingId",null),p=o=i.__decorate([a.doop],p))
function p(){var e=r.call(this)||this
return e.actedUponInsightId(null),e.performedActionName(null),e.actionSlotDurationInMinutes(0),e.bookedMeetingId(null),e}t.MeetingPreparationInfobarStoreState=d
var f,g=(f=l.DataStreamStoreBase,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return u.WellKnownDataSources.MeetingPreparationInsights},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"MeetingPreparationInfobarStore"},m.prototype.setStateForItemChangedEvent=function(e,t){return e},m.prototype.processBookPreparationTimeAction=function(e,t){return e.actedUponInsightId(t.insightId).performedActionName(c.BOOK_PREPARATION_TIME_ACTION).actionSlotDurationInMinutes(t.actionSlotDurationInMinutes).bookedMeetingId(t.bookedMeetingId)},m.prototype.processCancelPreparationTimeAction=function(e,t){return e.actedUponInsightId(t.insightId).performedActionName(c.CANCEL_BOOKED_TIME_ACTION).actionSlotDurationInMinutes(t.actionSlotDurationInMinutes)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.BookMeetingPreparationTimeInfobarAction,e.processBookPreparationTimeAction),e.addActionCallback(s.default.CancelMeetingPreparationTimeInfobarAction,e.processCancelPreparationTimeAction),e}t.MeetingPreparationInfobarStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingRelatedDocumentsInsightStore=t.MeetingRelatedDocumentsInsightStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"meetingRelatedDocumentsInsights",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{meetingRelatedDocumentsInsights:this.meetingRelatedDocumentsInsights()}},d.prototype.fromJSON=function(e){return(new o).meetingRelatedDocumentsInsights(e.meetingRelatedDocumentsInsights)},i.__decorate([u.doop],d.prototype,"meetingRelatedDocumentsInsights",null),d=o=i.__decorate([u.doop],d))
function d(){var e=r.call(this)||this
return e.meetingRelatedDocumentsInsights([]),e}t.MeetingRelatedDocumentsInsightStoreState=c
var p,f=(p=l.default,i.__extends(g,p),g.prototype.getInitialState=function(){return new c},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.MeetingRelatedDocumentsInsights},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"MeetingRelatedDocumentsInsightStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processMeetingRelatedDocumentsInsights=function(e,t){return e.meetingRelatedDocumentsInsights(t.insights)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.MeetingRelatedDocumentsAction,e.processMeetingRelatedDocumentsInsights),e}t.MeetingRelatedDocumentsInsightStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UnreadMailActionCreator=void 0
var r,s=n(0),o=s.__importDefault(n(3)),i=s.__importDefault(n(917)),a=s.__importDefault(n(918)),u=s.__importDefault(n(102)),l=s.__importDefault(n(90)),c=s.__importDefault(n(105)),d=s.__importDefault(n(919)),p=s.__importStar(n(4)),f=s.__importStar(n(65)),g=s.__importDefault(n(920)),m=s.__importDefault(n(6)),h=s.__importDefault(n(68)),y=n(7),_=n(51),S=n(522),T=s.__importDefault(n(11)),I=(r=S.UnreadMailActionBase,s.__extends(b,r),b.prototype.processFindSearchFolderId=function(e){if(e.status===Office.AsyncResultStatus.Succeeded)return h.default.getExactlyOneEWSIdentifierOrThrow(e.result,"FolderId")
throw new Error("Unable to find Search Folder with error: ["+e.error+"].")},b.prototype.getUnreadMailFromIRanker=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return(t=f.default.tryGetRoamingSettings(f.RoamingSettingsKeys.UnReadFromIRankerFolder))?(n={folderId:t,folderName:y.Constants.UnreadFromIRankerFolderName},this.findAndDispatchUnreadMail(n,!1,o.default.GetUnreadMailFromIRankerSearchFolder),[3,3]):[3,1]
case 1:return[4,this.createIRankerSearchFolder()]
case 2:e.sent(),e.label=3
case 3:return[2]}})})},b.prototype.updateVIPSearchFolderWithSortedEmailAddressList=function(a){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return s.__generator(this,function(e){switch(e.label){case 0:if(0===a.length)return p.default.logWarning("Trying to update search folder with 0 VIP.",this.LOG_FEATURE_NAME,"updateVIPEmailAddressList"),[2]
t=!1,e.label=1
case 1:return e.trys.push([1,6,,7]),(n=f.default.tryGetRoamingSettings(f.RoamingSettingsKeys.UnReadFromVIPFolder))?[3,3]:(r={},[4,this.createVIPSearchFolder(a)])
case 2:r.folderId=e.sent(),r.vipEmailAddressList=a,n=r,t=!0,e.label=3
case 3:return m.default.shallowEquals(a,n.vipEmailAddressList)?[3,5]:(n.vipEmailAddressList=a,o=n,[4,this.updateSearchFolder(n)])
case 4:o.folderId=e.sent(),t=!0,e.label=5
case 5:return t&&f.default.trySetRoamingSettings(f.RoamingSettingsTypes.UnReadMails,f.RoamingSettingsKeys.UnReadFromVIPFolder,n),[3,7]
case 6:return i=e.sent(),this.logUpdateVIPEmailAddressListError(i),[3,7]
case 7:return[2]}})})},b.prototype.markMailAsNotImportant=function(e,t){try{c.default.executeInsightWESAction(e,this.LOG_FEATURE_NAME,t,"markMailAsNotImportant")}catch(e){p.default.logAssert("markMailAsNotImportant action fails with error "+JSON.stringify(e),this.LOG_FEATURE_NAME,"markMailAsNotImportant")}T.default.dispatch({actionType:o.default.MarkMailAsNotImportant,emailItemId:t.EmailItemId})},b.prototype.createVIPSearchFolder=function(o){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.getDeletedItemsFolderId()]
case 1:return t=e.sent(),n=new i.default(this.LOG_FEATURE_NAME,p.LogEventType.Set,"createUnreadFromVIPFolder",p.LogRequestType.IndirectAction).vipEmailAddressList(o).folderIdToIgnore(t).nonFatalErrorCodes([u.default.ERROR_FOLDER_EXISTS]).displayFolderName(y.Constants.UnreadFromVIPFolderName),[4,l.default.executeRequest(n)]
case 2:return(r=e.sent()).status!==Office.AsyncResultStatus.Succeeded?[3,3]:[2,h.default.getExactlyOneEWSIdentifierOrThrow(r.result,"FolderId")]
case 3:return r.error!==u.default.ERROR_FOLDER_EXISTS?[3,5]:[4,this.findSearchFolderId(y.Constants.UnreadFromVIPFolderName)]
case 4:return[2,e.sent()]
case 5:throw new Error("Unable to create VIP Search Folder with error: ["+r.error+"].")}})})},b.prototype.updateSearchFolder=function(o){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.getDeletedItemsFolderId()]
case 1:return t=e.sent(),n=new g.default(this.LOG_FEATURE_NAME,p.LogEventType.Set,"updateUnreadFromVIPFolder",p.LogRequestType.IndirectAction).folderId(o.folderId).vipEmailAddressList(o.vipEmailAddressList).folderIdToIgnore(t),[4,l.default.executeRequest(n)]
case 2:if((r=e.sent()).status===Office.AsyncResultStatus.Succeeded)return[2,h.default.getExactlyOneEWSIdentifierOrThrow(r.result,"FolderId")]
throw r.error===u.default.ERROR_ITEM_NOT_FOUND&&f.default.tryRemoveRoamingSettings(f.RoamingSettingsTypes.UnReadMails,f.RoamingSettingsKeys.UnReadFromVIPFolder),new Error("Unable to update VIP search folder with error: ["+r.error+"].")}})})},b.prototype.getDeletedItemsFolderId=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return(t=f.default.tryGetRoamingSettings(f.RoamingSettingsKeys.DeletedItemsFolder))?[2,t]:(n=new d.default(this.LOG_FEATURE_NAME,p.LogEventType.Get,"findDeletedItemsFolderId",p.LogRequestType.IndirectAction),[4,l.default.executeRequest(n)])
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded?(t=h.default.getExactlyOneEWSIdentifierOrThrow(r.result,"FolderId"),f.default.trySetRoamingSettings(f.RoamingSettingsTypes.UnReadMails,f.RoamingSettingsKeys.DeletedItemsFolder,t)):p.default.logAssert("Unable to find DeletedItems Folder with error: ["+r.error+"].",this.LOG_FEATURE_NAME,"findDeletedItemsFolderId"),[2,t]}})})},b.prototype.createIRankerSearchFolder=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.getDeletedItemsFolderId()]
case 1:return t=e.sent(),r=new a.default(this.LOG_FEATURE_NAME,p.LogEventType.Set,"createUnreadFromIRankerFolder",p.LogRequestType.IndirectAction).folderIdToIgnore(t).nonFatalErrorCodes([u.default.ERROR_FOLDER_EXISTS]).displayFolderName(y.Constants.UnreadFromIRankerFolderName),[4,l.default.executeRequest(r)]
case 2:return(o=e.sent()).status!==Office.AsyncResultStatus.Succeeded?[3,3]:(n=h.default.getExactlyOneEWSIdentifierOrThrow(o.result,"FolderId"),f.default.trySetRoamingSettings(f.RoamingSettingsTypes.UnReadMails,f.RoamingSettingsKeys.UnReadFromIRankerFolder,n),[2,n])
case 3:return o.error!==u.default.ERROR_FOLDER_EXISTS?[3,5]:[4,this.findSearchFolderId(y.Constants.UnreadFromIRankerFolderName)]
case 4:return n=e.sent(),f.default.trySetRoamingSettings(f.RoamingSettingsTypes.UnReadMails,f.RoamingSettingsKeys.UnReadFromIRankerFolder,n),[2,n]
case 5:throw new Error("Unable to create IRanker Search Folder with error: ["+o.error+"].")}})})},b.prototype.logUpdateVIPEmailAddressListError=function(e){-1===e.message.indexOf(u.default.ERROR_INTERNAL_SERVER_TRANSIENT_ERROR)&&-1===e.message.indexOf(u.default.ERROR_SERVER_BUSY)&&p.default.logAssert(e,this.LOG_FEATURE_NAME,"updateVIPEmailAddressList")},s.__decorate([_.expirable(_.ExpirationTypes.ByEvery_Minutes,5)],b.prototype,"getUnreadMailFromIRanker",null),b=s.__decorate([_.expirable()],b))
function b(){var e=null!==r&&r.apply(this,arguments)||this
return e.LOG_FEATURE_NAME="UnreadMail",e}t.UnreadMailActionCreator=I,t.default=new I},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsStore=t.State=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"messageAnalytics",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"documentAnalytics",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{messageAnalytics:this.messageAnalytics(),documentAnalytics:this.documentAnalytics()}},d.prototype.fromJSON=function(e){return(new o).messageAnalytics(e.messageAnalytics).documentAnalytics(e.documentAnalytics)},i.__decorate([l.doop],d.prototype,"messageAnalytics",null),i.__decorate([l.doop],d.prototype,"documentAnalytics",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.messageAnalytics([]),e.documentAnalytics([]),e}t.State=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"SentMailStatsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.SentMailStats},enumerable:!1,configurable:!0}),g.prototype.processSentMailStatisticsAction=function(e,t){var n=this.upsertSentMailStatistics(e.messageAnalytics(),t.messageAnalytics)
return e.messageAnalytics(n)},g.prototype.processSentMailDocumentStatisticsAction=function(e,t){var n=this.upsertSentMailDocumentStatistics(e.documentAnalytics(),t.documentAnalytics)
return e.documentAnalytics(n)},g.prototype.upsertSentMailStatistics=function(e,n){return e.filter(function(t){return!n.some(function(e){return e.internetMsgId===t.internetMsgId})}).concat(n)},g.prototype.upsertSentMailDocumentStatistics=function(e,n){return e.filter(function(t){return!n.some(function(e){return e.internetMessageId===t.internetMessageId})}).concat(n)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.SentMailStatistics,e.processSentMailStatisticsAction),e.addActionCallback(s.default.SentMailDocumentStatistics,e.processSentMailDocumentStatisticsAction),e}t.SentMailStatsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportUnreadMailStore=t.DirectReportUnreadMailStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"unreadMail",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{unreadMail:this.unreadMail()}},d.prototype.fromJSON=function(e){return(new o).unreadMail(e.unreadMail)},i.__decorate([l.doop],d.prototype,"unreadMail",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.unreadMail([]),e}t.DirectReportUnreadMailStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"DirectReportUnreadMailStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.UnreadMails},enumerable:!1,configurable:!0}),g.prototype.processGetUnreadMail=function(e,t){return e.unreadMail(t.unreadMail)},g.prototype.processMarkEmailItemAsRead=function(e,t){var n=e.unreadMail().filter(function(e){return e.itemId!==t.emailItem.itemId})
return e.unreadMail(n)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetUnreadMailFromDirectReportSearchFolder,e.processGetUnreadMail),e.addActionCallback(s.default.MarkEmailItemAsReadAction,e.processMarkEmailItemAsRead),e}t.DirectReportUnreadMailStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserAvailabilityStore=t.UserAvailabilityStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"importantPeopleOofStatusMap",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userOofStatus",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{importantPeopleOofStatusMap:this.importantPeopleOofStatusMap(),userOofStatus:this.userOofStatus()}},d.prototype.fromJSON=function(e){return(new o).importantPeopleOofStatusMap(e.importantPeopleOofStatusMap).userOofStatus(e.userOofStatus)},i.__decorate([l.doop],d.prototype,"importantPeopleOofStatusMap",null),i.__decorate([l.doop],d.prototype,"userOofStatus",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.importantPeopleOofStatusMap({}),e}t.UserAvailabilityStoreState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"UserAvailabilityStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.CalendarData},enumerable:!1,configurable:!0}),g.prototype.processGetImportantPeopleAvailability=function(e,t){return e.importantPeopleOofStatusMap(t.oofStatusMap)},g.prototype.processGetUserAvailability=function(e,t){return e.userOofStatus(t.userAvailability.oofStatus)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetImportantPeopleAvailability,e.processGetImportantPeopleAvailability),e.addActionCallback(s.default.GetUserAvailability,e.processGetUserAvailability),e}t.UserAvailabilityStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentsToCatchupInsightStore=t.DocumentsToCatchupInsightStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"documentsToCatchupInsights",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{documentsToCatchupInsights:this.documentsToCatchupInsights()}},d.prototype.fromJSON=function(e){return(new o).documentsToCatchupInsights(e.documentsToCatchupInsights)},i.__decorate([u.doop],d.prototype,"documentsToCatchupInsights",null),d=o=i.__decorate([u.doop],d))
function d(){var e=r.call(this)||this
return e.documentsToCatchupInsights([]),e}t.DocumentsToCatchupInsightStoreState=c
var p,f=(p=l.default,i.__extends(g,p),g.prototype.getInitialState=function(){return new c},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DocumentsToCatchupInsights},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"DocumentsToCatchupInsightStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processDocumentsToCatchupInsights=function(e,t){return e.documentsToCatchupInsights(t.insights)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.DocumentsToCatchupInsightAction,e.processDocumentsToCatchupInsights),e}t.DocumentsToCatchupInsightStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportConflictingOneOnOneInsightStore=t.DirectReportConflictingOneOnOneInsightState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=n(5),u=i.__importStar(n(42)),l=i.__importDefault(n(3)),c=i.__importDefault(n(134)),d=(r=u.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"conflictingOneOnOneInsights",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actedOnInsightIds",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{conflictingOneOnOneInsights:this.conflictingOneOnOneInsights(),actedOnInsightIds:this.actedOnInsightIds()}},p.prototype.fromJSON=function(e){return(new o).conflictingOneOnOneInsights(e.conflictingOneOnOneInsights).actedOnInsightIds(e.actedOnInsightIds)},i.__decorate([s.doop],p.prototype,"conflictingOneOnOneInsights",null),i.__decorate([s.doop],p.prototype,"actedOnInsightIds",null),p=o=i.__decorate([s.doop],p))
function p(){var e=r.call(this)||this
return e.conflictingOneOnOneInsights([]),e.actedOnInsightIds([]),e}t.DirectReportConflictingOneOnOneInsightState=d
var f,g=(f=u.default,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DirectReportConflictingOneOnOneInsights},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"DirectReportConflictingOneOnOneInsightStore"},m.prototype.processConflictingOneOnOneInsights=function(e,t){return c.default(e.conflictingOneOnOneInsights(),t.insights)?e:e.conflictingOneOnOneInsights(t.insights).actedOnInsightIds([])},m.prototype.processRescheduleAction=function(e,t){return e.actedOnInsightIds().push(t.insightId.primaryId),e},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(l.default.ConflictingOneOnOneInsight,e.processConflictingOneOnOneInsights),e.addActionCallback(l.default.RescheduleOneOnOne,e.processRescheduleAction),e}t.DirectReportConflictingOneOnOneInsightStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportBookOneOnOneInsightStore=t.DirectReportBookOneOnOneInsightState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=n(5),u=i.__importStar(n(42)),l=i.__importDefault(n(3)),c=i.__importDefault(n(134)),d=(r=u.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"bookOneOnOneInsights",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"actedOnInsightIds",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{bookOneOnOneInsights:this.bookOneOnOneInsights(),actedOnInsightIds:this.actedOnInsightIds()}},p.prototype.fromJSON=function(e){return(new o).bookOneOnOneInsights(e.bookOneOnOneInsights).actedOnInsightIds(e.actedOnInsightIds)},i.__decorate([s.doop],p.prototype,"bookOneOnOneInsights",null),i.__decorate([s.doop],p.prototype,"actedOnInsightIds",null),p=o=i.__decorate([s.doop],p))
function p(){var e=r.call(this)||this
return e.bookOneOnOneInsights([]),e.actedOnInsightIds([]),e}t.DirectReportBookOneOnOneInsightState=d
var f,g=(f=u.default,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DirectReportBookOneOnOneInsights},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"DirectReportBookOneOnOneInsightStore"},m.prototype.processBookOneOnOneInsights=function(e,t){return c.default(e.bookOneOnOneInsights(),t.insights)?e:e.bookOneOnOneInsights(t.insights).actedOnInsightIds([])},m.prototype.processDraftInviteAction=function(e,t){return e.actedOnInsightIds().push(t.insightId.primaryId),e},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(l.default.BookOneOnOneInsight,e.processBookOneOnOneInsights),e.addActionCallback(l.default.DraftInviteToBook,e.processDraftInviteAction),e}t.DirectReportBookOneOnOneInsightStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SmartRulesSuggestionInsightStore=t.State=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=n(5),u=i.__importDefault(n(3)),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"smartRulesSuggestionInsights",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{smartRulesSuggestionInsights:this.smartRulesSuggestionInsights()}},d.prototype.fromJSON=function(e){return(new o).smartRulesSuggestionInsights(e.smartRulesSuggestionInsights)},i.__decorate([s.doop],d.prototype,"smartRulesSuggestionInsights",null),d=o=i.__decorate([s.doop],d))
function d(){var e=r.call(this)||this
return e.smartRulesSuggestionInsights([]),e}t.State=c
var p,f=(p=l.default,i.__extends(g,p),g.prototype.getInitialState=function(){return new c},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.SmartRulesSuggestionInsights},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"SmartRulesSuggestionInsightStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processSmartRulesSuggestionInsights=function(e,t){return e.smartRulesSuggestionInsights(t.insights)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(u.default.SmartRulesSuggestionInsightAction,e.processSmartRulesSuggestionInsights),e}t.SmartRulesSuggestionInsightStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MailFoldersStore=t.MailFoldersState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=i.__importDefault(n(134)),d=(r=u.CachedDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"mailFolders",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),p.prototype.toJSON=function(){return{mailFolders:this.mailFolders()}},p.prototype.fromJSON=function(e){return(new o).mailFolders(e.mailFolders)},i.__decorate([l.doop],p.prototype,"mailFolders",null),p=o=i.__decorate([l.doop],p))
function p(){var e=r.call(this)||this
return e.mailFolders([]),e}t.MailFoldersState=d
var f,g=(f=u.default,i.__extends(m,f),m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.MailFolders},enumerable:!1,configurable:!0}),m.prototype.getStoreLoggingName=function(){return"MailFoldersStore"},m.prototype.processMailFolders=function(e,t){return c.default(e.mailFolders(),t.mailFolders)?e:e.mailFolders(t.mailFolders)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.GetMailFolders,e.processMailFolders),e}t.MailFoldersStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.StoreObserver=void 0
var r=n(0),o=n(366),i=r.__importDefault(n(6)),a=(s.prototype.initialize=function(){function t(){r=!0}var n=this,e=this.storesToListenForChange,r=!1
this.fluxContainerSubscriptions=e.map(function(e){return e.addListener(t)}),this.fluxContainerStoreGroup=new o(e,function(){var e
r&&(e=n.state,n.state=n.calculateStateCallback(e),i.default.shallowEquals(n.state,e)||n.onStateChangeCallback(n.state)),r=!1}),this.onStateChangeCallback(this.state)},s.prototype.dispose=function(){this.fluxContainerStoreGroup.release()
for(var e=0,t=this.fluxContainerSubscriptions;e<t.length;e++)t[e].remove()
this.fluxContainerSubscriptions=[]},s)
function s(e,t,n){this.onStateChangeCallback=e,this.calculateStateCallback=t,this.storesToListenForChange=n,this.state=this.calculateStateCallback(null),this.initialize()}t.StoreObserver=a,t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LunchTimeSettingsStore=t.LunchTimeSettingsStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"startMinute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"endMinute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"shouldBookRecurringAppointment",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"recurringAppointmentIdentifier",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"lastModifiedTime",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{startMinute:this.startMinute(),endMinute:this.endMinute(),shouldBookRecurringAppointment:this.shouldBookRecurringAppointment(),recurringAppointmentIdentifier:this.recurringAppointmentIdentifier(),lastModifiedTime:this.lastModifiedTime()}},d.prototype.fromJSON=function(e){return(new o).startMinute(e.startMinute).endMinute(e.endMinute).shouldBookRecurringAppointment(e.shouldBookRecurringAppointment).recurringAppointmentIdentifier(e.recurringAppointmentIdentifier).lastModifiedTime(e.lastModifiedTime)},i.__decorate([u.doop],d.prototype,"startMinute",null),i.__decorate([u.doop],d.prototype,"endMinute",null),i.__decorate([u.doop],d.prototype,"shouldBookRecurringAppointment",null),i.__decorate([u.doop],d.prototype,"recurringAppointmentIdentifier",null),i.__decorate([u.doop],d.prototype,"lastModifiedTime",null),d=o=i.__decorate([u.doop],d))
function d(){var e=r.call(this)||this
return e.shouldBookRecurringAppointment(!0),e}t.LunchTimeSettingsStoreState=c
var p,f=(p=l.default,i.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.LunchTimeSettings},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"LunchTimeSettingsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processLunchTimeSettings=function(e,t){return e.startMinute(t.startMinute).endMinute(t.endMinute).shouldBookRecurringAppointment(t.shouldBookRecurringAppointment).recurringAppointmentIdentifier(t.recurringAppointmentIdentifier).lastModifiedTime(t.lastModifiedTime)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.UpdateLunchTimeSettings,e.processLunchTimeSettings),e}t.LunchTimeSettingsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SearchContextInsightsComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(396)),a=o.__importDefault(n(93)),s=(r=i.default,o.__extends(u,r),u.prototype.getBaseStores=function(){return o.__spreadArrays([a.default],r.prototype.getBaseStores.call(this))},u.prototype.computeInsightInstances=function(e){var t=this.computeNudgeInstances(e),n=!!e.insightData&&e.insightData.doesSupportNudgeFeedback
return t.forEach(function(e){var t
e.doesSupportNudgeFeedback=null!==(t=e.doesSupportNudgeFeedback)&&void 0!==t?t:n}),t},u.prototype.mergeNewStateWhenFrozen=function(e,t){return t.insightData=e.insightData,t},u.prototype.shouldFreezeDetailPage=function(e,t){return!!e&&this.isEmptyInsightFromState(t)&&!this.isEmptyInsightFromState(e)},u.prototype.isEmptyInsightFromState=function(e){var t=e.insightData
return!t||!(!Array.isArray(t)||0!==t.length)},u)
function u(){return null!==r&&r.apply(this,arguments)||this}t.SearchContextInsightsComputeBase=s,t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeDetailsStore=t.FocusTimeDetailsStoreState=void 0
var r,s=n(0),o=s.__importStar(n(15)),i=s.__importDefault(n(3)),a=s.__importStar(n(83)),u=s.__importDefault(n(531)),l=n(5),c=(r=a.DataStreamStoreStateBase,s.__extends(d,r),Object.defineProperty(d.prototype,"timeSlotInEditing",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"editedBlocks",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),s.__decorate([l.doop],d.prototype,"timeSlotInEditing",null),s.__decorate([l.doop],d.prototype,"editedBlocks",null),d=s.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.editedBlocks([]),e}t.FocusTimeDetailsStoreState=c
var p,f=(p=a.default,s.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return o.WellKnownDataSources.CalendarData},enumerable:!1,configurable:!0}),g.prototype.getInitialState=function(){return new c},g.prototype.getStoreLoggingName=function(){return"FocusTimeDetailsStore_V2"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processEditFocusTimeSubject=function(e,t){return e.timeSlotInEditing(t.timeSlot)},g.prototype.processUpdateFocusBlockSubject=function(e,t){var n=this,r=t.timeSlot,o=u.default(e.editedBlocks(),function(e){return n.areTimeBlocksEqual(e,r)}),i=o[0],a=o[1]
return e.timeSlotInEditing(null).editedBlocks(a.concat(s.__assign(s.__assign({},r),{isBooked:i.length?i[0].isBooked:void 0})))},g.prototype.processRemoveFocusBlock=function(e,t){return this.updateBookedState(e,t.calendarItem,!1)},g.prototype.processBookFocusBlocks=function(e,t){var n=this
return t.calendarItems.reduce(function(e,t){return n.updateBookedState(e,t,!0)},e)},g.prototype.updateBookedState=function(e,t,n){var r=this
return e.editedBlocks(e.editedBlocks().filter(function(e){return!r.areTimeBlocksEqual(e,t)}).concat(s.__assign(s.__assign({},t),{isBooked:n})))},g.prototype.areTimeBlocksEqual=function(e,t){return e.startDate.getTime()===t.startDate.getTime()&&e.endDate.getTime()===t.endDate.getTime()},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(i.default.EditFocusTimeSubject,e.processEditFocusTimeSubject),e.addActionCallback(i.default.UpdateFocusTimeSubject,e.processUpdateFocusBlockSubject),e.addActionCallback(i.default.BookFocusBlock,e.processBookFocusBlocks),e.addActionCallback(i.default.DeleteFocusBlock,e.processRemoveFocusBlock),e.addActionCallback(i.default.BookFocusBlocks,e.processBookFocusBlocks),e}t.FocusTimeDetailsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingType=t.ShortenMeetingConstants=void 0
var r,o=(i.MIN_PEOPLE_FOR_GROUP=4,i.TIME_SAVE_PER_MEETING_PER_PERSON_15_MINS=.25,i.TIME_SAVE_PER_MEETING_PER_PERSON_30_MINS=.5,i)
function i(){}t.ShortenMeetingConstants=o,(r=t.MeetingType||(t.MeetingType={}))[r.RecurringGroup=1]="RecurringGroup",r[r.RecurringOneOnOne=2]="RecurringOneOnOne",r[r.OneTimeGroup=3]="OneTimeGroup"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a=n(0).__importDefault(n(265)),r=n(113),s=(o.extPoint="autorunjs",o.urlPageName="AutoRunJS_ExperiencePageName",o.environment="AutoRunJS_Environment",o)
function o(){}var i=(u.createConfigurationContent=function(){var e=u.getQueryStringValuesInLowerCase()
return{layout:u.extractLayout(e.extpoint),buildName:window.$$MyAnalyticsAddIn_BuildName$$,environment:u.extractEnvironment(e.environment),experienceType:u.extractExperienceType(),infobarEnabled:e.infobarEnabled,stopReloadInBackgroundMode:e.stopbg}},u.extractLayout=function(e){if(e===s.extPoint)return r.Layout.AutoRunJS
if("bgaddin"===e)return r.Layout.Background
switch(u.getPageNameFromURLInLowerCase()){case"vertical.html":case"vertical-advanced.html":return r.Layout.Vertical
default:return r.Layout.Unknown}},u.extractEnvironment=function(e){switch(e){case"prod":return r.Environment.Prod
case"ppe":return r.Environment.PPE
case"dev":return r.Environment.Dev
case"debug":return r.Environment.Debug
default:return r.Environment.Unknown}},u.extractExperienceType=function(){var e=u.getPageNameFromURLInLowerCase()
switch(e){case"context.html":case"vertical-advanced.html":case"autorun-advanced.js":return r.ExperienceType.Advanced
case"vertical.html":case"autorun-basic.js":return r.ExperienceType.Basic
default:throw new Error("Unrecognized page: "+e+" used to determine ExperienceType")}},u.getQueryStringValuesInLowerCase=function(){var e,t,n,r,o=u.getWindowLocation()
if(!o)return{environment:s.environment.toLowerCase(),extpoint:s.extPoint.toLowerCase(),stopbg:!0,infobarEnabled:!0}
var i=new a.default(o)
return{environment:null===(e=i.getQueryParamValue("environment"))||void 0===e?void 0:e.toLowerCase(),extpoint:null===(t=i.getQueryParamValue("extpoint"))||void 0===t?void 0:t.toLowerCase(),stopbg:"true"===(null===(n=i.getQueryParamValue("stopbg"))||void 0===n?void 0:n.toLowerCase()),infobarEnabled:"true"===(null===(r=i.getQueryParamValue("infobarenabled"))||void 0===r?void 0:r.toLowerCase())}},u.getPageNameFromURLInLowerCase=function(){var e=u.getWindowLocation()
if(!e)return s.urlPageName.toLowerCase()
var t=new a.default(e).uriParts.file
if(null==t||!t.length)throw new Error("Cannot parse URL, file name is empty")
return t.toLowerCase()},u.getWindowLocation=function(){var e
return null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.href},u.assertUnreachableError=function(e,t){var n=Object.keys(t).filter(function(e){return isNaN(Number(e))})
throw new Error("Unexpected key: "+e+"; Please ensure all elements in {"+n+"} are specified in the switch-case and no extra element.")},u)
function u(){}t.default=i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AutoRunEventNameConverter=t.AutoRunEventNames=void 0
var r,o,i=n(144);(o=r=t.AutoRunEventNames||(t.AutoRunEventNames={})).OnMessageCompose="OnMessageCompose",o.OnMessageRecipientsChanged="OnMessageRecipientsChanged",o.OnMessageAttachmentsChanged="OnMessageAttachmentsChanged",o.OnAppointmentOrganizer="OnAppointmentOrganizer",o.OnAppointmentAttendeesChanged="OnAppointmentAttendeesChanged",o.OnAppointmentAttachmentsChanged="OnAppointmentAttachmentsChanged",o.OnAppointmentTimeChanged="OnAppointmentTimeChanged",o.OnAppointmentRecurrenceChanged="OnAppointmentRecurrenceChanged",o.OnInfoBarDismissClicked="OnInfoBarDismissClicked"
var a=(s.AutoRunEventNameToItemTypeMap=function(e){switch(e){case r.OnMessageCompose:case r.OnMessageRecipientsChanged:case r.OnMessageAttachmentsChanged:return i.ItemTypes.Message
case r.OnAppointmentOrganizer:case r.OnAppointmentAttendeesChanged:case r.OnAppointmentAttachmentsChanged:case r.OnAppointmentTimeChanged:case r.OnAppointmentRecurrenceChanged:return i.ItemTypes.Meeting
default:return i.ItemTypes.Unknown}},s)
function s(){}t.AutoRunEventNameConverter=a},,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractBaseStrategy=void 0
function r(e){this.storage=e}t.AbstractBaseStrategy=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LogSampler=void 0
var r=n(0),o=r.__importDefault(n(57)),i=r.__importDefault(n(6)),a=r.__importDefault(n(363)),s=(u.shouldSuppressLog=function(e,t){return!!a.default.isSamplingEnabled&&u.sessionGuidHash>a.default.getSamplingRate(e,t)},Object.defineProperty(u,"isSampledSession",{get:function(){return void 0===u._isSampledSession&&(u._isSampledSession=!!a.default.isSamplingEnabled&&u.sessionGuidHash>a.default.lowestSamplingRate),u._isSampledSession},enumerable:!1,configurable:!0}),Object.defineProperty(u,"sessionGuidHash",{get:function(){return void 0===u._sessionGuidHash&&(u._sessionGuidHash=i.default.getHashValue(o.default.sessionGuid)),u._sessionGuidHash},enumerable:!1,configurable:!0}),u)
function u(){}t.LogSampler=s},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0})
var a=n(0).__importDefault(n(25)),s=n(113),u=n(226),l=n(131),c=(Object.defineProperty(d,"lowestSamplingRate",{get:function(){var r
return void 0===d._lowestSamplingRate&&(r=d.NO_SAMPLING_RATE,Object.keys(d.TABLE_POLICIES).forEach(function(e){var t,n=d.TABLE_POLICIES[e]
n.defaultRate<r&&(r=n.defaultRate),Object.keys(null!==(t=n.customRates)&&void 0!==t?t:{}).forEach(function(e){var t=n.customRates[e]
t<r&&(r=t)})}),d._lowestSamplingRate=r),d._lowestSamplingRate},enumerable:!1,configurable:!0}),Object.defineProperty(d,"isSamplingEnabled",{get:function(){return void 0===d._isSamplingEnabled&&(d._isSamplingEnabled=d.SAMPLING_ENVIRONMENT===a.default.Environment),d._isSamplingEnabled},enumerable:!1,configurable:!0}),d.getSamplingRate=function(e,t){var n,r
if(!d.TABLE_POLICIES[t])return d.NO_SAMPLING_RATE
var o=d.TABLE_POLICIES[t]
return null!==(r=(null!==(n=o.customRates)&&void 0!==n?n:{})[e])&&void 0!==r?r:o.defaultRate},d.NO_SAMPLING_RATE=1,d.SAMPLING_ENVIRONMENT=s.Environment.Prod,d.TABLE_POLICIES=((r={})[u.TableNames.BackgroundAddIn]={defaultRate:.1,customRates:((o={})[l.SourceName.OfficeInitialize]=d.NO_SAMPLING_RATE,o)},r[u.TableNames.Error]={defaultRate:d.NO_SAMPLING_RATE,customRates:((i={})[l.SourceName.GetSubject]=.1,i[l.SourceName.GetDelayDeliveryTime]=.1,i[l.SourceName.GetDelayDeliveryTimeAndCustomProperties]=.1,i)},r),d)
function d(){}t.default=c},function(e,t,n){"use strict"
var r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarActionType=t.AgaveType=void 0,(r=t.AgaveType||(t.AgaveType={})).BackgroundAgave="BackgroundAgave",r.StickyAgave="StickyAgave",(o=t.InfobarActionType||(t.InfobarActionType={})).Add="addInfobar",o.Remove="removeInfobar",o.Replace="replaceInfobar"},function(e,t,n){"use strict"
var r,o,i
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarType=t.InfobarButtonActionType=t.CommandId=void 0,(r=t.CommandId||(t.CommandId={})).MessageRead="apptorganizerTabMessageRead.grp1.btnView",r.MessageCompose="apptorganizerTabMessageCompose.grp1.btnView",r.AppointmentOrganizer="apptorganizerTabAppointmentOrganizer.grp1.btnView",r.AppointmentAttendee="apptorganizerTabAppointmentAttendee.grp1.btnView",(o=t.InfobarButtonActionType||(t.InfobarButtonActionType={}))[o.Unknown=0]="Unknown",o[o.Dismiss=1]="Dismiss",o[o.Install=2]="Install",o[o.Details=3]="Details",o[o.Custom=4]="Custom",(i=t.InfobarType||(t.InfobarType={}))[i.Informational=0]="Informational",i[i.ProgressIndicator=1]="ProgressIndicator",i[i.Error=2]="Error",i[i.Insight=3]="Insight"},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.StoreNameToSessionDataKeyMap=void 0
var r=n(171),o=(i.prototype.getSessionDataKey=function(e){switch(e){case i.BOOT_STORE_NAME:return r.SessionDataKeys.BootStoreState
case i.INFOBAR_STORE_NAME:return r.SessionDataKeys.InfobarStoreState
case i.INFOBAR_INSIGHTS_STORE_NAME:return r.SessionDataKeys.InfobarInsightsStoreState
case i.SEARCH_CONTEXT_INSIGHTS_STORE_NAME:return r.SessionDataKeys.SearchContextInsightsStoreState
case i.USER_SETTINGS_STORE_NAME:return r.SessionDataKeys.UserSettingsStoreState
case i.DELAY_DELIVERY_STORE_NAME:return r.SessionDataKeys.DelayDeliveryStoreState
case i.FOLLOW_UPS_INSIGHT_STORE:return r.SessionDataKeys.FollowUpsInsightStoreState
case i.FOLLOW_UP_REQUEST_TASK_ENTITIES_STORE_NAME:return r.SessionDataKeys.FollowUpRequestTaskEntitiesStoreState
case i.MEETING_PREPARATION_INFOBAR_STORE:return r.SessionDataKeys.MeetingPreparationInfobarStoreState
case i.TASKS_INSIGHT_STORE:return r.SessionDataKeys.TasksInsightStoreState
case i.TIME_AWAY_STORE_NAME:return r.SessionDataKeys.TimeAwayStoreState
default:return null}},i.BOOT_STORE_NAME="BootStore",i.INFOBAR_STORE_NAME="InfobarStore",i.INFOBAR_INSIGHTS_STORE_NAME="InfobarInsightsStore",i.SEARCH_CONTEXT_INSIGHTS_STORE_NAME="SearchContextInsightsStore",i.USER_SETTINGS_STORE_NAME="UserSettingsStore",i.DELAY_DELIVERY_STORE_NAME="DelayDeliveryStore",i.FOLLOW_UP_REQUEST_TASK_ENTITIES_STORE_NAME="FollowUpRequestTaskEntitiesStore",i.FOLLOW_UPS_INSIGHT_STORE="FollowUpsInsightStore",i.MEETING_PREPARATION_INFOBAR_STORE="MeetingPreparationInfobarStore",i.TASKS_INSIGHT_STORE="TasksInsightStore",i.TIME_AWAY_STORE_NAME="TimeAwayStore",i)
function i(){}t.StoreNameToSessionDataKeyMap=o,t.default=new o},,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RetryEnabledRequestService=void 0
var f=n(0),r=f.__importStar(n(34)),g=f.__importDefault(n(90)),m=f.__importDefault(n(4)),h=f.__importDefault(n(789)),o=(i.prototype.executePromiseRetryWithPartialSuccess=function(u,l,c,d,p){return void 0===p&&(p=r.RequestPriority.Normal),f.__awaiter(this,void 0,void 0,function(){var o,i,a,t,s,n,r
return f.__generator(this,function(e){switch(e.label){case 0:o={error:"",status:Office.AsyncResultStatus.Failed,result:{},sourceRequest:u},e.label=1
case 1:e.trys.push([1,5,,6]),i=[],a=[],h.default.addUnfulfilledRequestToStore(u),t=function(){var r,t,n
return f.__generator(this,function(e){switch(e.label){case 0:return[4,l(u,p)]
case 1:if(r=e.sent(),t=[],r.result){if(o.status=Office.AsyncResultStatus.Succeeded,(t=g.default.processEWSResultByParseHandler(r,c.bind(s))).forEach(function(e,t){var n=r.sourceRequest.getOrderedKeySelector(t)
n&&e.isSuccess?(o.result[n]=e.result,u.getlogCreator().success()):n||u.getlogCreator().unexpectedFail("Parse result doesn't match the order of request keys.")}),i=s.updateIgnoredErrors(t,i),a=s.getRetryErrors(t),!(u=d(t,r.sourceRequest)))return o.error=i.join(","),h.default.removeFulfilledRequestFromStore(o.sourceRequest),[2,{value:o}]}else a=[r.error]
return(u=u.retryCount(u.retryCount()+1)).canRetryRequest()?(s.logOnRetry(a.join(","),u),n=Math.max(u.retryDelayInMilliseconds(),null===(e=o.throttled)||void 0===e?void 0:e.retryAfterInMilliseconds),[4,new Promise(function(e){return setTimeout(e,n)})]):[2,"break"]
case 2:return e.sent(),[2]}})},s=this,e.label=2
case 2:return u.canRetryRequest()?[5,t()]:[3,4]
case 3:return"object"==typeof(n=e.sent())?[2,n.value]:"break"===n?[3,4]:[3,2]
case 4:return o.error=i.concat(a).join(","),h.default.removeFulfilledRequestFromStore(o.sourceRequest),[3,6]
case 5:return r=e.sent(),m.default.logUnhandledPromiseRejection(r,this.LOG_FEATURE_NAME,"executePromiseRetryWithPartialSuccess"),o.error=r,[3,6]
case 6:return[2,o]}})})},i.prototype.executePromiseWithRetry=function(a,s,u){return void 0===u&&(u=r.RequestPriority.Normal),f.__awaiter(this,void 0,void 0,function(){var n,t,r,o,i
return f.__generator(this,function(e){switch(e.label){case 0:n={error:"",status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:a},e.label=1
case 1:e.trys.push([1,5,,6]),h.default.addUnfulfilledRequestToStore(a),t=function(){var t
return f.__generator(this,function(e){switch(e.label){case 0:return[4,s(a,u)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?(h.default.removeFulfilledRequestFromStore(a),[2,{value:n}]):n.shouldNotRetry?(a.getlogCreator().expectedFail("Abandoning retry."),h.default.removeFulfilledRequestFromStore(a),[2,{value:n}]):(a=a.retryCount(a.retryCount()+1)).canRetryRequest()?(r.logOnRetry(n.error,a),t=Math.max(a.retryDelayInMilliseconds(),null===(e=n.throttled)||void 0===e?void 0:e.retryAfterInMilliseconds),[4,new Promise(function(e){return setTimeout(e,t)})]):[2,"break"]
case 2:return e.sent(),[2]}})},r=this,e.label=2
case 2:return a.canRetryRequest()?[5,t()]:[3,4]
case 3:return"object"==typeof(o=e.sent())?[2,o.value]:"break"===o?[3,4]:[3,2]
case 4:return h.default.removeFulfilledRequestFromStore(a),[3,6]
case 5:return i=e.sent(),m.default.logUnhandledPromiseRejection(i,this.LOG_FEATURE_NAME,"executePromiseWithRetry"),n.error=i,[3,6]
case 6:return[2,n]}})})},i.prototype.logOnRetry=function(e,t){var n="Request fails with cause "+e+". Retrying: "+t.toTraceString()+" with retryCount "+t.retryCount()
t.isNonFatalErrorCode(e)?t.getlogCreator().expectedFail(n):t.getlogCreator().unexpectedFail(n)},i.prototype.updateIgnoredErrors=function(e,n){return e.forEach(function(t){!t.error||t.shouldRetry||n.some(function(e){return e===t.error})||n.push(t.error)}),n},i.prototype.getRetryErrors=function(e){var n=[]
return e.forEach(function(t){t.error&&t.shouldRetry&&!n.some(function(e){return e===t.error})&&n.push(t.error)}),n},i)
function i(){this.LOG_FEATURE_NAME="RetryEnabledRequestService"}t.RetryEnabledRequestService=o,t.default=new o},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RequestBase=void 0
var r=n(0),o=r.__importDefault(n(6)),i=n(5),a=n(7),s=(Object.defineProperty(u.prototype,"retryCount",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"maxRetries",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"retryDelayInMilliseconds",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"requestId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"createTime",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.canRetryRequest=function(){return!this.hasExpired()&&this.retryCount()<=this.maxRetries()},u.prototype.isNonFatalErrorCode=function(e){return!1},u.prototype.hasExpired=function(){return(new Date).getTime()-this.createTime()>=a.Constants.fiveMinutesInMilliSeconds},r.__decorate([i.doop],u.prototype,"retryCount",null),r.__decorate([i.doop],u.prototype,"maxRetries",null),r.__decorate([i.doop],u.prototype,"retryDelayInMilliseconds",null),r.__decorate([i.doop],u.prototype,"requestId",null),r.__decorate([i.doop],u.prototype,"createTime",null),u)
function u(e){void 0===e&&(e=1),this.maxRetries(e).retryCount(0).retryDelayInMilliseconds(0).requestId(o.default.getGuid()).createTime((new Date).getTime())}t.RequestBase=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0).__importDefault(n(6)),o=(i.getInitialWESHeaders=function(e){return e["X-RoutingParameter-SessionKey"]=r.default.userEmail,e},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorStore=t.ErrorStoreState=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(61)),a=n(5),s=(Object.defineProperty(u.prototype,"isInPhysicalError",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),r.__decorate([a.doop],u.prototype,"isInPhysicalError",null),u=r.__decorate([a.doop],u))
function u(){}t.ErrorStoreState=s
var l,c=(l=i.default,r.__extends(d,l),d.prototype.getInitialState=function(){return new s},d.prototype.getStoreLoggingName=function(){return"ErrorStore"},d.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},d.prototype.processFailedAjaxConnectionAction=function(e,t){return e.isInPhysicalError(!0)},d)
function d(){var e=l.call(this)||this
return e.addActionCallback(o.default.FailedAjaxConnection,e.processFailedAjaxConnectionAction),e}t.ErrorStore=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.OutcomeActionCreator=void 0
var i=n(0),o=i.__importDefault(n(3)),a=i.__importDefault(n(8)),s=i.__importDefault(n(35)),u=i.__importDefault(n(829)),l=i.__importDefault(n(11)),c=i.__importDefault(n(830)),r=n(51),d=n(7),p=n(148),f=n(34),g=n(4),m=(h.prototype.getAllOutcomes=function(){return i.__awaiter(this,void 0,void 0,function(){var t,n,r
return i.__generator(this,function(e){switch(e.label){case 0:return a.default.isOutcomeEnabled?(t=new u.default(this.FEATURE_NAME,"getAllOutcomes",g.LogRequestType.Interval),[4,s.default.executeWESRequest(t)]):[2]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(r=this.parseGetAllOutcomesResponse(n.result.value),l.default.dispatch({actionType:o.default.GetUserOutcomesEnrollment,isFocusOutcomeEnrolled:r.isFocusOutcomeEnrolled})),[2]}})})},h.prototype.enrollOutcome=function(t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return[2,this.updateOutcomeEnrollment(t,!0)]})})},h.prototype.unenrollOutcome=function(t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return[2,this.updateOutcomeEnrollment(t,!1)]})})},h.prototype.updateOutcomeEnrollment=function(n,r){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return this.dispatchOutcomeEnrollment(n,r),[4,this.patchOutcomeEnrollment(n,r)]
case 1:return(t=e.sent())?this.dispatchOutcomeEnrollment(n,r,!0):this.dispatchOutcomeEnrollment(n,!r,!1),[2,t]}})})},h.prototype.dispatchOutcomeEnrollment=function(e,t,n){l.default.dispatch({actionType:o.default.UpdateUserOutcomeEnrollment,outcomeName:e,isEnrolled:t,wasAPISuccessful:n})},h.prototype.patchOutcomeEnrollment=function(r,o){return i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:return t=!0===o?"EnrollOutcome":"UnenrollOutcome",n=new c.default(this.FEATURE_NAME,t,g.LogRequestType.Action).outcomeName(r).isEnroll(o),[4,s.default.executeWESRequest(n,f.RequestPriority.High)]
case 1:return[2,e.sent().status===Office.AsyncResultStatus.Succeeded]}})})},h.prototype.parseGetAllOutcomesResponse=function(e){var t={isFocusOutcomeEnrolled:!1}
return e.forEach(function(e){e.Name===p.OutcomeNames.IncreaseFocusTime&&(t.isFocusOutcomeEnrolled=e.IsEnrolled)}),t},i.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,d.Constants.oneDayInMinutes)],h.prototype,"getAllOutcomes",null),h=i.__decorate([r.expirable()],h))
function h(){this.FEATURE_NAME="Outcome"}t.OutcomeActionCreator=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(63),s=n(16),u=(o=a.RESTRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/calendarview"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"startDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"endDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"queryParams",{get:function(){return{startDateTime:this.startDate().toISOString(),endDateTime:this.endDate().toISOString()}},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"startDate",null),r.__decorate([i.doop],l.prototype,"endDate",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,s.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(7),o=(i.getTimeElapsedInSeconds=function(e){return(new Date(Date.now()).getTime()-e)/r.Constants.oneSecondInMilliseconds},i.parseWorkHourWithBuffer=function(e,t){var n=e+t
return n<0||1440<=n?e:n},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FilteredOutInsightsStore=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(203)),s=o.__importDefault(n(3)),u=(r=a.default,o.__extends(l,r),l.prototype.getStoreLoggingName=function(){return"FilteredOutInsightsStore"},Object.defineProperty(l.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.FilteredOutInsights},enumerable:!1,configurable:!0}),l.prototype.actionValueToAccumulate=function(){return s.default.FilteredOutInsights},l.prototype.actionValueForNotApplicable=function(){return s.default.HasNoFilteredOutInsights},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.FilteredOutInsightsStore=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FirstRunActionCreators=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importStar(n(65)),s=(u.prototype.getRoamingSettings=function(){var e=this.initializeFirstRunRoamingSettings()
i.default.dispatch({actionType:o.default.InitializeRoamingSettings,roamingSettings:{sessionsNumFromFirstAccess:e.sessionsNumFromFirstAccess,hasUserVisitedDashboard:e.hasUserVisitedDashboard,shouldIgnorePeopleFirstRun:e.shouldIgnorePeopleFirstRun,hasDismissedFocusTimeWorkingHourTip:e.hasDismissedFocusTimeWorkingHourTip,hasDismissedAfterHourWorkingHourTip:e.hasDismissedAfterHourWorkingHourTip}})},u.prototype.initializeFirstRunRoamingSettings=function(){var e=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.SessionsNumFromFirstAccess),t=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.HasUserVisitedDashboard),n=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.ShouldIgnorePeopleFirstRun),r=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.HasDismissedFocusTimeWorkingHourTip),o=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.HasDismissedAfterHourWorkingHourTip)
return null==e?e=1:e+=1,a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.SessionsNumFromFirstAccess,e),null==t&&(t=!1,a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.HasUserVisitedDashboard,t)),null==n&&(n=!1,a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.ShouldIgnorePeopleFirstRun,n)),null==o&&(o=!1,a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.HasDismissedAfterHourWorkingHourTip,o)),null==r&&(r=!1,a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.HasDismissedFocusTimeWorkingHourTip,r)),{sessionsNumFromFirstAccess:e,hasUserVisitedDashboard:t,shouldIgnorePeopleFirstRun:n,hasDismissedFocusTimeWorkingHourTip:r,hasDismissedAfterHourWorkingHourTip:o}},u.prototype.setIgnorePeopleFirstRun=function(){i.default.dispatchAsync({actionType:o.default.IgnorePeopleFirstRun}),a.default.trySetRoamingSettings(a.RoamingSettingsTypes.FirstRun,a.RoamingSettingsKeys.ShouldIgnorePeopleFirstRun,!0)},u)
function u(){}t.FirstRunActionCreators=s,t.default=new s},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.ReadActivityType=void 0,(r=t.ReadActivityType||(t.ReadActivityType={}))[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High"},,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UnreadSearchFolderRequestBase=void 0
var a,r=n(0),o=r.__importDefault(n(24)),i=n(5),s=n(84),u=(a=s.EWSRequestBase,r.__extends(l,a),Object.defineProperty(l.prototype,"vipEmailAddressList",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"folderIdToIgnore",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"displayFolderName",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"parentDistinguishedFolderId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.buildSearchParameters=function(){return'<t:SearchParameters Traversal="Deep">\n                <t:Restriction>\n                    <t:And>\n                        '+this.buildFolderToIgnoreRestriction()+'\n                        <t:IsGreaterThan>\n                            <t:FieldURI FieldURI="item:DateTimeReceived"/>\n                            <t:FieldURIOrConstant>\n                                <t:Constant Value="'+o.default.generatePriorDate(7).toISOString()+'"/>\n                            </t:FieldURIOrConstant>\n                        </t:IsGreaterThan>\n                        <t:IsEqualTo>\n                            <t:FieldURI FieldURI="message:IsRead"></t:FieldURI>\n                            <t:FieldURIOrConstant>\n                                <t:Constant Value="false"></t:Constant>\n                            </t:FieldURIOrConstant>\n                        </t:IsEqualTo>\n                        <t:Or>\n                            <t:IsEqualTo>\n                                <t:FieldURI FieldURI="item:ItemClass"></t:FieldURI>\n                                <t:FieldURIOrConstant>\n                                    <t:Constant Value="IPM.Note"></t:Constant>\n                                </t:FieldURIOrConstant>\n                            </t:IsEqualTo>\n                            <t:IsEqualTo>\n                                <t:FieldURI FieldURI="item:ItemClass"></t:FieldURI>\n                                <t:FieldURIOrConstant>\n                                    <t:Constant Value="IPM.Schedule.Meeting.Request"></t:Constant>\n                                </t:FieldURIOrConstant>\n                            </t:IsEqualTo>\n                         </t:Or>\n                         '+this.buildRestriction()+'\n                    </t:And>\n                </t:Restriction>\n                <t:BaseFolderIds>\n                    <t:DistinguishedFolderId Id="msgfolderroot" />\n                </t:BaseFolderIds>\n            </t:SearchParameters>'},l.prototype.buildFolderToIgnoreRestriction=function(){return this.folderIdToIgnore()?'<t:IsNotEqualTo>\n                        <t:FieldURI FieldURI="item:ParentFolderId"></t:FieldURI>\n                        <t:FieldURIOrConstant>\n                            <t:Constant Value="'+this.folderIdToIgnore().id+'"></t:Constant>\n                        </t:FieldURIOrConstant>\n                    </t:IsNotEqualTo>':""},r.__decorate([i.doop],l.prototype,"vipEmailAddressList",null),r.__decorate([i.doop],l.prototype,"folderIdToIgnore",null),r.__decorate([i.doop],l.prototype,"displayFolderName",null),r.__decorate([i.doop],l.prototype,"parentDistinguishedFolderId",null),l)
function l(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.parentDistinguishedFolderId("root"),i}t.UnreadSearchFolderRequestBase=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o=n(0),i=o.__importDefault(n(3)),a=o.__importDefault(n(11)),s=o.__importStar(n(4)),u=o.__importDefault(n(35)),l=o.__importDefault(n(935)),r=n(51),c=n(7),d=o.__importDefault(n(936)),p=o.__importDefault(n(937)),f=o.__importDefault(n(105)),g=(m.prototype.getAllDirectReports=function(){return o.__awaiter(this,void 0,void 0,function(){var t,n,r
return o.__generator(this,function(e){switch(e.label){case 0:return t=new l.default("DirectReportsActionCreator","DirectReportsAction",s.LogRequestType.Interval),[4,u.default.executeWESRequest(t)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(r=this.extractContactTypesFromResponseJson(n.result),a.default.dispatch({actionType:i.default.GetDirectReports,directReports:r})),[2]}})})},m.prototype.addDirectReport=function(n){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return t=new p.default("DirectReportsActionCreator","DirectReportsAddAction",s.LogRequestType.Interval).externalDirectoryObjectId(n.externalDirectoryObjectId),[4,u.default.executeWESRequest(t)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded?(a.default.dispatch({actionType:i.default.AddDirectReport,person:n}),f.default.getDirectReportBookOneOnOneInsight(),f.default.getDirectReportConflictingOneOnOneInsight(),[2,!0]):[2,!1]}})})},m.prototype.removeDirectReport=function(n){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return t=new d.default("DirectReportsActionCreator","DirectReportsRemoveAction",s.LogRequestType.Interval).externalDirectoryObjectId(n.externalDirectoryObjectId),[4,u.default.executeWESRequest(t)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded?(a.default.dispatch({actionType:i.default.RemoveDirectReport,primarySmtpAddress:n.smtpAddress}),[2,!0]):[2,!1]}})})},m.prototype.extractContactTypesFromResponseJson=function(e){var t,n=this
return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[]).map(function(e){return n.extractPerson(e)}).filter(function(e){return!!e})},m.prototype.extractPerson=function(e){var t,n=null===(t=e.Person)||void 0===t?void 0:t.PrimarySmtpAddress
return n?{smtpAddress:n,name:e.Person.DisplayName,externalDirectoryObjectId:e.Person.ExternalDirectoryObjectId}:(s.default.logAssert("Direct Report smtpAddress is null.","DirectReportsActionCreator","DirectReportsAction"),null)},o.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,c.Constants.oneDayInMinutes)],m.prototype,"getAllDirectReports",null),m=o.__decorate([r.expirable()],m))
function m(){}t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LunchTimeSettingsActionCreator=void 0
var d=n(0),r=n(51),u=d.__importDefault(n(35)),l=n(34),o=d.__importDefault(n(3)),i=n(7),a=d.__importDefault(n(11)),c=n(4),s=d.__importDefault(n(940)),p=d.__importDefault(n(104)),f=n(941),g=d.__importDefault(n(24)),m=d.__importDefault(n(4)),h=d.__importDefault(n(39)),y="LunchTimeSettingsActionCreator",_=(S.prototype.getLunchTimeSettings=function(){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t="getLunchTimeSettings",n=new s.default(y,t,c.LogRequestType.Interval),[4,u.default.executeWESRequest(n)]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&this.dispatchLunchTimeSettings(r.result,t),[2]}})})},S.prototype.setLunchTimeSettings=function(o,i,a,s){return d.__awaiter(this,void 0,void 0,function(){var t,n,r
return d.__generator(this,function(e){switch(e.label){case 0:return t="patchLunchTimeSettings",n=new f.PatchUserLunchTimeSettingsRequestWES(y,t,c.LogRequestType.Action).shouldBookRecurringAppointment(s).startMinute(i).endMinute(a).recurringAppointmentIdentifier(o),[4,u.default.executeWESRequest(n,l.RequestPriority.High)]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&this.dispatchLunchTimeSettings(r.result,t),[2]}})})},S.prototype.setLunchAdvertSettings=function(i,a,s,u,l,c){return d.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return d.__generator(this,function(e){switch(e.label){case 0:return t="EMPTY",s?(n=g.default.toDate(i),r=g.default.toDate(a),[4,p.default.bookLunchTimeAndReturn(n,r,u,l,c)]):[3,2]
case 1:o=e.sent(),t=o.result.identifier.id,e.label=2
case 2:return this.setLunchTimeSettings(t,i,a,s),[2]}})})},S.prototype.dispatchLunchTimeSettings=function(e,t){var n
try{this.validateLunchTimeSettings(e,t),n=new Date(e.LastModifiedTime),h.default.throwIfUndefinedOrInvalidDate("LastModifiedTime",n)}catch(e){var r="Failed to parse lunchtimesettings with exception: "+JSON.stringify(e)
return void m.default.logAssert(r,y,t)}a.default.dispatch({actionType:o.default.UpdateLunchTimeSettings,startMinute:e.LunchTime.StartMinute,endMinute:e.LunchTime.EndMinute,shouldBookRecurringAppointment:e.ShouldBookRecurringAppointment,recurringAppointmentIdentifier:e.RecurringAppointmentId,lastModifiedTime:new Date(e.LastModifiedTime)})},S.prototype.validateLunchTimeSettings=function(e,t){h.default.throwIfUndefinedOrNull("Settings",e),h.default.throwIfUndefinedOrNull("AppointmentId",e.RecurringAppointmentId),h.default.throwIfUndefinedOrNull("LunchTime",e.LunchTime),h.default.throwIfUndefinedOrNull("StartMinute",e.LunchTime.StartMinute),h.default.throwIfUndefinedOrNull("EndMinute",e.LunchTime.EndMinute),h.default.throwIfUndefinedOrNull("LastModifiedTime",e.LastModifiedTime)},d.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,i.Constants.oneDayInMinutes)],S.prototype,"getLunchTimeSettings",null),S=d.__decorate([r.expirable()],S))
function S(){}t.LunchTimeSettingsActionCreator=_,t.default=new _},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogFilterBase=void 0
var r=n(0),o=r.__importDefault(n(173)),i=r.__importDefault(n(6)),a=(s.prototype.extendStateWithActionLog=function(e,t){var n=this,r=o.default.getInsightActionLog().filter(function(e){return e.insightName===n.insightName&&Date.now()<e.expirationTimeInTicks})
return e&&(t.activeInsightActionLogs=e.activeInsightActionLogs),e&&i.default.shallowEquals(e.activeInsightActionLogs,r)||(t.activeInsightActionLogs=r),t},s.prototype.filterInstancesAgainstActionLog=function(e,t){var n=this
return e.filter(function(e){return!n.isInstanceFiltered(e,t)})},s.prototype.isInstanceFiltered=function(t,e){var n=this
return!!e.activeInsightActionLogs&&e.activeInsightActionLogs.some(function(e){return n.shouldInstanceBeFilteredOut(t,e)})},s)
function s(e){this.insightName=e}t.ActionLogFilterBase=a,t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeActionableMessageStore=t.FocusTimeActionableMessageStoreState=void 0
var r,o=n(0),i=o.__importStar(n(29)),a=o.__importStar(n(15)),s=o.__importDefault(n(3)),u=o.__importDefault(n(530)),l=n(83),c=n(5),d=(r=l.DataStreamStoreStateBase,o.__extends(p,r),Object.defineProperty(p.prototype,"focusTimeInsight",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"focusBlockConflictInsight",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"selectedMoveMeetingFreeBlock",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"movedFocusBlocks",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"selectedScenario",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),o.__decorate([c.doop],p.prototype,"focusTimeInsight",null),o.__decorate([c.doop],p.prototype,"focusBlockConflictInsight",null),o.__decorate([c.doop],p.prototype,"selectedMoveMeetingFreeBlock",null),o.__decorate([c.doop],p.prototype,"movedFocusBlocks",null),o.__decorate([c.doop],p.prototype,"selectedScenario",null),p=o.__decorate([c.doop],p))
function p(){var e=r.call(this)||this
return e.movedFocusBlocks([]),e}t.FocusTimeActionableMessageStoreState=d
var f,g=(f=l.DataStreamStoreBase,o.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"FocusTimeActionableMessageStore"},m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),m.prototype.processFocusTimeFromActionableMessage=function(e,t){return e.focusTimeInsight(t.insight)},m.prototype.processFocusTimeConflictFromActionableMessage=function(e,t){return e.focusBlockConflictInsight(t.insight).selectedScenario(t.insight.focusTimeConflictType)},m.prototype.processUpdateSelectedMoveMeetingBlock=function(e,t){return e.selectedMoveMeetingFreeBlock(t.timeRange)},m.prototype.processMoveFocusBlock=function(e,t){var n=u.default(e.movedFocusBlocks(),t.calendarItems,function(e,t){return e.identifier.id===t.identifier.id})
return e.movedFocusBlocks(n.concat(t.calendarItems))},m.prototype.processSwitchingToMovingFocusBlock=function(e,t){return e.selectedScenario(i.FocusConflict.MoveFocusBlock)},m.prototype.processSwitchingToMovingMeeting=function(e,t){return e.selectedScenario(i.FocusConflict.MoveMeeting)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(s.default.GetFocusTimeFromActionableMessage,e.processFocusTimeFromActionableMessage),e.addActionCallback(s.default.GetFocusTimeConflictFromActionableMessage,e.processFocusTimeConflictFromActionableMessage),e.addActionCallback(s.default.UpdateSelectedMoveMeetingBlock,e.processUpdateSelectedMoveMeetingBlock),e.addActionCallback(s.default.MoveFocusBlock,e.processMoveFocusBlock),e.addActionCallback(s.default.SwitchToMovingFocusBlock,e.processSwitchingToMovingFocusBlock),e.addActionCallback(s.default.SwitchToMovingMeeting,e.processSwitchingToMovingMeeting),e}t.FocusTimeActionableMessageStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FreezableOneStageInsightComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(31)),a=o.__importDefault(n(154)),s=n(107),u=(r=i.default,o.__extends(l,r),l.prototype.getBaseStores=function(){return[a.default]},l.prototype.calculateState=function(e){var t=this.isInDetailPage(),n=this.calculateCurrentState(e)
return t&&this.shouldFreezeDetailPage(e,n)&&(n=this.mergeNewStateWhenFrozen(e,n)),o.__assign(o.__assign({},n),{isInDetailPage:t})},l.prototype.isInDetailPage=function(){return a.default.getState().activeRoute().routeName===s.Routes.Details&&a.default.getState().activeRoute().context.insightName===this.insightName()},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.FreezableOneStageInsightComputeBase=u,t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailInContextStore=t.State=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importStar(n(208)),u=i.__importDefault(n(3)),l=i.__importStar(n(114)),c=n(5),d=(r=l.LoadableDataStreamStateBase,i.__extends(p,r),o=p,Object.defineProperty(p.prototype,"messageStatus",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"analytics",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"documentAnalytics",{get:function(){return c.doop()},enumerable:!1,configurable:!0}),p.prototype.fromJSON=function(e){return(new o).analytics(e.analytics).documentAnalytics(e.documentAnalytics).messageStatus(e.messageStatus)},i.__decorate([c.doop],p.prototype,"messageStatus",null),i.__decorate([c.doop],p.prototype,"analytics",null),i.__decorate([c.doop],p.prototype,"documentAnalytics",null),p=o=i.__decorate([c.doop],p))
function p(){var e=r.call(this)||this
return e.messageStatus(s.InContextStatus.None),e}t.State=d
var f,g=(f=l.default,i.__extends(m,f),m.prototype.getStoreLoggingName=function(){return"SentMailInContextStore"},m.prototype.getInitialState=function(){return new d},m.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},Object.defineProperty(m.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.SentMailStatisticsInContext},enumerable:!1,configurable:!0}),m.prototype.processSentMailStatisticsInContextAction=function(e,t){return e.analytics(t.messageAnalytics).messageStatus(s.InContextStatus.Ok)},m.prototype.processSentMailDocumentStatisticsInContextAction=function(e,t){return e.documentAnalytics(t.documentAnalytics)},m.prototype.processSentMailInContextError=function(e,t){return e.analytics(null).documentAnalytics(null).messageStatus(t.status)},m)
function m(){var e=f.call(this)||this
return e.addActionCallback(u.default.SentMailInContextStatistics,e.processSentMailStatisticsInContextAction),e.addActionCallback(u.default.SentMailDocumentInContextStatistics,e.processSentMailDocumentStatisticsInContextAction),e.addActionCallback(u.default.SentMailInContextStatus,e.processSentMailInContextError),e}t.SentMailInContextStore=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DaysToBookInsightStore=t.DaysToBookInsightStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"focusInsights",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{focusInsights:this.focusInsights()}},d.prototype.fromJSON=function(e){return(new o).focusInsights(e.focusInsights)},i.__decorate([u.doop],d.prototype,"focusInsights",null),d=o=i.__decorate([u.doop],d))
function d(){var e=r.call(this)||this
return e.focusInsights([]),e}t.DaysToBookInsightStoreState=c
var p,f=(p=l.default,i.__extends(g,p),g.prototype.getInitialState=function(){return new c},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.DaysToBookInsights},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"DaysToBookInsightStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processFocusTimeInsight=function(e,t){return e.focusInsights(t.insights)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetDaysToBookInsight,e.processFocusTimeInsight),e}t.DaysToBookInsightStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(7),o=(i.hasNonStandardWorkingHours=function(e,t){return e>this.stdLunchStartMinute||t<this.stdLunchEndMinute},i.buildClickEventProperties=function(e,t,n,r,o){return{CheckboxChecked:e,StartTimeBiasInMinute:t,EndTimeBiasInMinute:n,DaysOfWeek:r,TimeZoneBiasInMinute:o}},i.stdLunchStartMinute=10*r.Constants.oneHourInMinutes,i.stdLunchEndMinute=15*r.Constants.oneHourInMinutes,i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsGroupSuggestionStore=t.TeamsGroupSuggestionStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=n(5),u=i.__importDefault(n(3)),l=i.__importStar(n(42)),c=(r=l.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"teamsGroupSuggestionInsights",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{teamsGroupSuggestionInsights:this.teamsGroupSuggestionInsights()}},d.prototype.fromJSON=function(e){return(new o).teamsGroupSuggestionInsights(e.teamsGroupSuggestionInsights)},i.__decorate([s.doop],d.prototype,"teamsGroupSuggestionInsights",null),d=o=i.__decorate([s.doop],d))
function d(){var e=r.call(this)||this
return e.teamsGroupSuggestionInsights([]),e}t.TeamsGroupSuggestionStoreState=c
var p,f=(p=l.default,i.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.TeamsGroupSuggestionInsight},enumerable:!1,configurable:!0}),g.prototype.getStoreLoggingName=function(){return"TeamsGroupSuggestionStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processTeamsGroupSuggestionInsight=function(e,t){return e.teamsGroupSuggestionInsights(t.insights)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(u.default.TeamsGroupSuggestion,e.processTeamsGroupSuggestionInsight),e}t.TeamsGroupSuggestionStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarInsightsStore=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(203)),s=o.__importDefault(n(3)),u=(r=a.default,o.__extends(l,r),l.prototype.actionValueToAccumulate=function(){return s.default.InfobarInsights},l.prototype.actionValueForNotApplicable=function(){return s.default.NoInfobarInsights},l.prototype.getStoreLoggingName=function(){return"InfobarInsightsStore"},Object.defineProperty(l.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.InfobarInsights},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.InfobarInsightsStore=u,t.default=new u},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.CancelDelayDeliveryActionName=void 0,(r=t.CancelDelayDeliveryActionName||(t.CancelDelayDeliveryActionName={}))[r.CancelAndDelete=0]="CancelAndDelete",r[r.CancelAndSend=1]="CancelAndSend"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importStar(n(20)),i=r.__importDefault(n(2)),a=(s.getDelayDeliveryTimeString=function(e){var t=r.__assign(r.__assign(r.__assign({},o.LocaleDateFormat.shortWeekday),o.LocaleDateFormat.shortMonthTwoDigitDay),o.LocaleTimeFormat.hourTwoDigitMinute)
return o.default.toLocaleStringFixed(e,t)},s.getScheduledDelayDeliveryInfobarMessage=function(e){return i.default.SCHEDULED_DELAY_DELIVERY_INFOBAR_INSIGHT(s.getDelayDeliveryTimeString(e))},s.getDelayDeliveryInfobarProperties=function(e){var t=e.instanceData
return t.insightText&&t.actionText?{message:t.insightText,actionText:t.actionText}:t.insightText||t.actionText?void 0:{message:this.getAutoDelayDeliveryInfobarMessage(t),actionText:i.default.SCHEDULED_DELAY_DELIVERY_INFOBAR_ACTION(),doNotWrapActionText:!0}},s.getAutoDelayDeliveryInfobarMessage=function(e){var t=e.scheduledDateTime.getTime()>Date.now()?e.scheduledDateTime:e.suggestedDateTime
return i.default.SCHEDULED_DELAY_DELIVERY_INFOBAR_INSIGHT(this.getDelayDeliveryTimeString(t))},s)
function s(){}t.default=a},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.CalloutState=void 0,(r=t.CalloutState||(t.CalloutState={}))[r.Error=0]="Error",r[r.Loading=1]="Loading",r[r.NoResult=2]="NoResult",r[r.Success=3]="Success",r[r.None=4]="None"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=n(406),s=n(191),u=n(137),l=r.__importStar(n(4)),c=n(407),d=r.__importDefault(n(235)),p=(f.prototype.initializeTheme=function(){c.ThemeUtils.outlookThemeColor!==a.ThemeTypes.White&&this.setTheme(c.ThemeUtils.outlookThemeColor)},f.prototype.setTheme=function(t){var e=new c.ThemeVariables(t)
u.loadTheme({semanticColors:{link:"black",buttonBackground:e.buttonOrLinkColor,listText:e.textColor,bodyBackground:e.backgroundColor},disableGlobalClassNames:!1}),s.loadTheme(e)
var n=new d.default("Theme",l.LogEventType.Get,"SetTheme",l.LogRequestType.Init)
fetch("css/ThemeStyles.css").then(function(e){return!0===e.ok?(n.success(),e.text()):void n.unexpectedFail("Fail to get theme styles file.",e.statusText)}).then(function(e){s.loadStyles(e),l.default.logInformation(t+".","App","SetTheme")}),i.default.dispatch({actionType:o.default.ChangeTheme,themeColor:t})},f)
function f(){}t.ThemeActionCreator=p,t.default=new p},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeTypes=void 0,(r=t.ThemeTypes||(t.ThemeTypes={})).White="White",r.Black="Black",r.Grey="Grey"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeUtils=t.ThemeVariables=void 0
function r(e){var t="#262626",n="#585858",r="#FFFFFF",o="#4A4A4A"
e===i.ThemeTypes.White?(this.backgroundColor="#FAF9F8",this.textColor=o,this.buttonOrLinkColor="#016677",this.buttonTextColor=r,this.headerColor=r,this.cardColor=r,this.buttonHoverColor="#138FA4",this.secondaryButtonDisabledColor="#F3F2F1",this.secondaryButtonDisabledTextColor="#262626",this.lineColor="#E6E6E6",this.scrollingDivBorderTop="1px solid #E6E6E6",this.dayMonthDateLabelColor="#4A4A4A",this.expandedContentColor=r,this.footerContainerBoxShowadow="0px -6px 8px rgba(0, 0, 0, 0.07)",this.unbookedTimeAwayTimeSlotColor="#F3F2F1",this.unbookedTimeSlotColor="#EEF6F9",this.unbookedTimeSlotHoverColor="#DBECF2",this.bookedTimeSlotColor="#C9E7AA",this.bookedTimeSlotHoverColor="#EAF3E0",this.feedbackIconColor="#0078D4",this.iconBackgroundColor="#EDEBE9",this.calendarColor=r,this.checkBoxBorderColor="#1B1A19",this.checkBoxCheckedBackground=r,this.checkBoxCheckedColor=o,this.actionButtonSecondaryHoverBackground="#EAEAEA",this.actionButtonSecondaryHoverColor="#212121",this.secondaryButtonTextColor=this.textColor,this.secondaryButtonHoverTextColor=this.textColor,this.userSearchResultHoverColor="#e1dfdd",this.searchTextColor="#333333",this.headerIconHoverColor="#FAF9F8",this.extendedReadStatsRecipientLabelBackground="#FDF2CB",this.extendedReadStatsOpenRateChartTooltipBackground="#FDF2CB",this.extendedReadStatsFreEducationalComponentBackground="#F6F6F6",this.extendedReadStatsEngagementEducationalCardBackground="#FCFCFC",this.extendedReadStatsFREOpenRateChartLineColor="#E1E1E1"):(e===i.ThemeTypes.Grey?(this.backgroundColor="#666666",this.cardColor="#444444"):(this.backgroundColor=t,this.cardColor="#363636"),this.headerColor=this.backgroundColor,this.textColor=r,this.buttonOrLinkColor="#64C8D8",this.buttonTextColor="#000000",this.buttonHoverColor="#92D8E3",this.secondaryButtonDisabledColor=n,this.secondaryButtonDisabledTextColor="#9B9B9B",this.lineColor="#666666",this.scrollingDivBorderTop="",this.dayMonthDateLabelColor=this.textColor,this.expandedContentColor=this.backgroundColor,this.footerContainerBoxShowadow="none",this.iconBackgroundColor="#9B9B9B",this.secondaryButtonTextColor=this.textColor,this.secondaryButtonHoverTextColor=o,this.secondaryButtonBorderColor="#B1B1B1",this.bookedTimeSlotHoverColor=t,this.unbookedTimeSlotHoverColor=t,this.unbookedTimeAwayTimeSlotColor=n,this.unbookedTimeSlotColor=n,this.bookedTimeSlotColor=n,this.feedbackIconColor=this.buttonOrLinkColor,this.calendarColor=t,this.checkBoxBorderColor=this.cardColor,this.checkBoxCheckedBackground=this.buttonOrLinkColor,this.checkBoxCheckedColor=this.cardColor,this.actionButtonSecondaryHoverBackground="transparent",this.actionButtonSecondaryHoverColor=this.textColor,this.userSearchResultHoverColor="#515151",this.searchTextColor="#FFFFFF",this.headerIconHoverColor=this.cardColor,this.extendedReadStatsRecipientLabelBackground="#000000",this.extendedReadStatsOpenRateChartTooltipBackground="#212121",this.extendedReadStatsFreEducationalComponentBackground="#3D3D3D",this.extendedReadStatsEngagementEducationalCardBackground="#000000",this.extendedReadStatsFREOpenRateChartLineColor="#000000")}var i=n(406),o=n(7)
t.ThemeVariables=r
var a=(s.getLoadingImg=function(e){var t=n(1042)
switch(e){case i.ThemeTypes.Grey:return n(554)
case i.ThemeTypes.Black:return n(1043)
default:return t}},Object.defineProperty(s,"outlookThemeColor",{get:function(){return Office.context&&Office.context.officeTheme?s.convertToThemeTypes(Office.context.officeTheme.bodyBackgroundColor):i.ThemeTypes.White},enumerable:!1,configurable:!0}),s.convertToThemeTypes=function(e){switch(e){case o.Constants.blackBackground:return i.ThemeTypes.Black
case o.Constants.greyBackground:return i.ThemeTypes.Grey
default:return i.ThemeTypes.White}},s)
function s(){}t.ThemeUtils=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(799),i=r.__importDefault(n(62)),a=(s.parseXML=function(e){if(!i.default.isFlightEnabled(i.default.USE_XML_DOM_PACKAGE))return s.parseXML_Deprecated(e)
var t,n
s._parser||(s._parser=new o.DOMParser)
try{t=s._parser.parseFromString(e,"text/xml")}catch(e){n=e}finally{if(t&&!n)return t
throw null!=n?n:new Error("NullXmlDoc")}},s.parseXML_Deprecated=function(e){if(!s._parseXML){var n=window
if(void 0!==n.DOMParser)s._parseXML=function(e){return(new n.DOMParser).parseFromString(e,"text/xml")}
else{if(void 0===n.ActiveXObject)throw new Error("No XML parser found")
s._parseXML=function(e){var t=new n.ActiveXObject("Microsoft.XMLDOM")
return t.async="false",t.loadXML(e),t}}}return s._parseXML(e)},s)
function s(){}t.default=a},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(235)),a=(o=i.default,r.__extends(s,o),s.prototype.startExecuting=function(){this.startExecuteTime=new Date,this.waitTime=this.startExecuteTime.getTime()-this.createTime},s.prototype.updateRequestId=function(e){this.requestId=e},s.prototype.batchCompleted=function(e,t,n){var r=this.batchCompletedProperties(e,t,n)
this.logApiCall(r)},s.prototype.successProperties=function(e){var t=o.prototype.successProperties.call(this,e)
return t.waitTime=this.waitTime,t},s.prototype.batchCompletedProperties=function(e,t,n){return r.__assign(r.__assign({},this.successProperties(n)),{batchSuccessCount:e,batchFailCount:t})},s.prototype.expectedFailProperties=function(e,t){var n=o.prototype.expectedFailProperties.call(this,e,t)
return n.waitTime=this.waitTime,n},s.prototype.unexpectedFailProperties=function(e,t,n){var r=o.prototype.unexpectedFailProperties.call(this,e,t,n)
return r.waitTime=this.waitTime,r},s)
function s(){var e=null!==o&&o.apply(this,arguments)||this
return e.waitTime=null,e}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BatchRequestBase=void 0
var r,o=n(0),i=n(5),a=n(63),s=(r=a.RESTRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"requests",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"$batch"},enumerable:!1,configurable:!0}),o.__decorate([i.doop],u.prototype,"requests",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.BatchRequestBase=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var u=n(0),o=u.__importDefault(n(3)),r=u.__importDefault(n(11)),i=u.__importDefault(n(282)),s=u.__importDefault(n(54)),a=u.__importStar(n(116)),l=u.__importStar(n(4)),c=u.__importDefault(n(6)),d=n(7),p=(Object.defineProperty(f,"MAX_TOKEN_RETRY_COUNT",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(f,"restTokenPromise",{get:function(){return f._restTokenPromise},set:function(e){f._restTokenPromise=e},enumerable:!1,configurable:!0}),f.RESTTokenString=function(){var t
return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(e){switch(e.label){case 0:return[4,f.getRESTCallbackToken()]
case 1:return[2,null===(t=e.sent())||void 0===t?void 0:t.val]}})})},f.getRESTCallbackToken=function(){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){return t=new i.default(this.LOG_FEATURE_NAME,l.LogEventType.Get,"getRESTCallbackToken",l.LogRequestType.Init),[2,f.getTokenFromAllSource(t,f.getRESTCallbackTokenFromLocalStorage,f.getRESTCallbackTokenFromOutlook,"getRESTCallbackToken")]})})},f.getTokenFromAllSource=function(r,o,i,a){return u.__awaiter(this,void 0,void 0,function(){var t,n
return u.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t=null,s.default.hasFixedTokenCaching?[3,2]:[4,o(r)]
case 1:if(t=e.sent())return[2,Promise.resolve(t)]
e.label=2
case 2:return[4,i(r)]
case 3:if(t=e.sent())return[2,Promise.resolve(t)]
throw new Error("No token is obtained for "+a)
case 4:return n=e.sent(),l.default.logUnhandledPromiseRejection(n,this.LOG_FEATURE_NAME,a),[3,5]
case 5:return[2,Promise.resolve(null)]}})})},f.getRESTCallbackTokenFromOutlook=function(i){var a,s
return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return u.__generator(this,function(e){switch(e.label){case 0:t="unknown error",n=0,e.label=1
case 1:return n<f.MAX_TOKEN_RETRY_COUNT?[4,f.requestRESTTokenFromOutlook(i)]:[3,4]
case 2:if(r=e.sent(),(o=r.result).status===Office.AsyncResultStatus.Succeeded&&o){if(f.validateRESTToken(o.value))return[2,f.mapTokenStringToObject(o.value)]
t="REST token has invalid version"}t=null!==(s=null===(a=o.error)||void 0===a?void 0:a.message)&&void 0!==s?s:"unknown error",n<f.MAX_TOKEN_RETRY_COUNT-1&&i.expectedFail("Retrying with count: "+(n+1)+", errorMessage: "+t),e.label=3
case 3:return n++,[3,1]
case 4:return i.unexpectedFail("Stop retrying:"+t),[2,Promise.resolve(null)]}})})},f.requestRESTTokenFromOutlook=function(r){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){switch(e.label){case 0:return f.restTokenPromise?[4,f.restTokenPromise]:[3,2]
case 1:return[2,e.sent()]
case 2:f.restTokenPromise=new Promise(function(n,e){r.ewsStartExecuting(),Office.context.mailbox.getCallbackTokenAsync({isRest:!0},function(e){var t={error:c.default.buildErrorMessage(e.error),status:e.status,result:e}
f.extractAndLogDiagnosticsObject(e,r),n(t)})}),t=null,e.label=3
case 3:return e.trys.push([3,,5,6]),[4,f.restTokenPromise]
case 4:return t=e.sent(),f.refreshTokenFromOutlook(t.result,r),[3,6]
case 5:return t&&t.status!==Office.AsyncResultStatus.Succeeded?f.restTokenPromise=null:setTimeout(function(){f.restTokenPromise=null},1e3),[7]
case 6:return[2,t]}})})},f.refreshTokenFromOutlook=function(e,t){var n,r
e.status===Office.AsyncResultStatus.Succeeded&&((r=(n=f.mapTokenStringToObject(e.value)).expInSec-Date.now()/d.Constants.oneSecondInMilliseconds)<=0?t.unexpectedFail("Outlook provided a token has expired "+r+" sec"):(t.success("REST"),f.refreshUserSession(n,o.default.RESTCallbackTokenReady),s.default.hasFixedTokenCaching||f.refreshLocalStorage(n,a.PersistedStorageKeys.RESTToken)))},f.mapTokenStringToObject=function(t){try{return{val:t,expInSec:c.default.parseJWTToken(t).exp}}catch(e){return l.default.logAssert("Fail to parse expInSec from token with "+JSON.stringify(e),this.LOG_FEATURE_NAME,"mapTokenStringToObject"),{val:t,expInSec:-1}}},f.refreshUserSession=function(e,t){0<e.expInSec&&r.default.dispatchAsync({actionType:t,token:e})},f.refreshLocalStorage=function(e,t){if(0<e.expInSec){var n=e.expInSec-Date.now()/d.Constants.oneSecondInMilliseconds
if(n<0)return
a.default.trySaveToPersistedStorage(t,e,n)}},f.validateRESTToken=function(e){try{var t=c.default.parseJWTToken(e)
return"Exchange.Callback.V2"===t.ver||(l.default.logWarning("REST Token has the wrong ver: "+t.ver,this.LOG_FEATURE_NAME,"validateRESTToken"),!1)}catch(e){return l.default.logWarning("Parsing failed for token with exception: "+JSON.stringify(e),this.LOG_FEATURE_NAME,"validateRESTToken"),!1}},f.getRESTCallbackTokenFromLocalStorage=function(e){return f.getTokenFromLocalStorage(e,a.PersistedStorageKeys.RESTToken,o.default.RESTCallbackTokenReady)},f.getTokenFromLocalStorage=function(n,r,o){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.tryLoadFromPersistedStorage(r)]
case 1:return(t=e.sent().result)&&t.val&&0<t.expInSec?(n.success("Local"),f.refreshUserSession(t,o),[2,t]):[2,null]}})})},f.extractAndLogDiagnosticsObject=function(e,t){if(e.status===Office.AsyncResultStatus.Failed&&e.diagnostics)try{l.default.logAssert("Failed to request token, diagnostics payload: "+JSON.stringify(e.diagnostics),t.feature,t.source)}catch(e){l.default.logAssert("Failed to log diagnostics object: "+e,this.LOG_FEATURE_NAME,"extractAndLogDiagnosticsObject")}},f.LOG_FEATURE_NAME="TokenService",f._restTokenPromise=null,f)
function f(){}t.default=p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PersistedStorageBase=void 0
var r=(o.prototype.getItem=function(e){return this.storage.getItem(e)},o.prototype.setItem=function(e,t){return this.storage.setItem(e,t)},o.prototype.removeItem=function(e){return this.storage.removeItem(e)},o)
function o(e){this.storage=e}t.PersistedStorageBase=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DependencyRegister=void 0
var r=n(0),o=r.__importDefault(n(379)),i=r.__importDefault(n(147)),a=r.__importDefault(n(819)),s=r.__importDefault(n(500)),u=r.__importDefault(n(527)),l=r.__importDefault(n(92)),c=r.__importDefault(n(64)),d=r.__importDefault(n(528)),p=(f.prototype.triggerLoadAsync=function(){var e=this
setTimeout(function(){e.root.requestData()})},Object.defineProperty(f.prototype,"Application",{get:function(){return new s.default({highPriority:[a.default.getRootDependency()],requestDataCallback:function(){l.default.getUserSettings()}})},enumerable:!1,configurable:!0}),f)
function f(){this.listeningStores=[c.default,o.default,i.default,u.default],this.activeInsights=d.default,this.root=this.Application}t.DependencyRegister=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=(o.prototype.requestData=function(){this.configuration.isEnabledCallback()&&(this.configuration.requestDataCallback(),this.configuration.highPriority.forEach(function(e){return e.requestData()}),this.configuration.lowPriority.forEach(function(e){return e.requestData()}))},o)
function o(e){this.configuration=e,this.configuration.highPriority=e.highPriority||[],this.configuration.lowPriority=e.lowPriority||[],this.configuration.isEnabledCallback=e.isEnabledCallback||function(){return!0},this.configuration.requestDataCallback=e.requestDataCallback||function(){}}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogStorageProvider_V1=void 0
var p=n(0),c=p.__importDefault(n(820)),r=p.__importDefault(n(824)),d=p.__importDefault(n(825)),o=p.__importDefault(n(826)),f=p.__importDefault(n(283)),g=p.__importDefault(n(827)),i=p.__importDefault(n(502)),m=p.__importDefault(n(102)),h=p.__importDefault(n(90)),a=p.__importStar(n(116)),y=p.__importStar(n(4)),s=p.__importDefault(n(35)),u=p.__importStar(n(65)),_=p.__importDefault(n(68)),l=p.__importDefault(n(54)),S=n(7),T=n(34),I=(b.prototype.loadUnexpiredLogItemsFromLocalStorage=function(){return p.__awaiter(this,void 0,void 0,function(){var t,n
return p.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.tryLoadFromPersistedStorage(a.PersistedStorageKeys.ActionLogItems_V1_1)]
case 1:return(t=e.sent()).didCatchException||!t.result?[2,[]]:(n=t.result,[2,this.convertAndFilterActiveActionLogItems(n)])}})})},b.prototype.loadUnexpiredLogItemsFromExchange=function(){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return p.__generator(this,function(e){switch(e.label){case 0:if(!(t=this.getFolderFromRoamingSettings()))return[2,void 0]
e.label=1
case 1:return e.trys.push([1,4,,5]),[4,this.findActiveLogItemIds(t)]
case 2:return 0===(n=e.sent()).length?[2,[]]:[4,this.retrieveAndDeserializeLogItems(n)]
case 3:return r=e.sent(),o=this.convertAndFilterActiveActionLogItems(r),this.overwriteLogItemsInLocalStorage(o),[2,o]
case 4:return i=e.sent(),y.default.logAssert(i,"ActionLog","loadLogItemsFromExchange"),[2,void 0]
case 5:return[2]}})})},b.prototype.saveLogItemsToPermanentStore=function(e,t){this.overwriteLogItemsInLocalStorage(t),this.saveLogItemsToExchange(e)},b.prototype.cleanUpActionLogFolder=function(){return p.__awaiter(this,void 0,void 0,function(){var t,n
return p.__generator(this,function(e){switch(e.label){case 0:return this.overwriteLogItemsInLocalStorage([]),(n=this.getFolderFromRoamingSettings())?[3,2]:[4,this.findActionLogFolder()]
case 1:n=e.sent(),e.label=2
case 2:return(t=n)&&this.resetActionLogFolder(t),[2]}})})},b.prototype.saveLogItemsToExchange=function(o){return p.__awaiter(this,void 0,void 0,function(){var t,n,r
return p.__generator(this,function(e){switch(e.label){case 0:t=o.map(function(e){return c.default.convertToPermanentStoreModel(e)}).filter(function(e){return!!e}),n=this.getFolderFromRoamingSettings(),e.label=1
case 1:return e.trys.push([1,5,,6]),n?[3,3]:[4,this.createActionLogFolder()]
case 2:n=e.sent(),this.saveFolderIdToRoamingSettings(n),e.label=3
case 3:return[4,this.appendActionLogItemsToFolder(t,n)]
case 4:return[2,e.sent()]
case 5:return r=e.sent(),y.default.logAssert(r,"ActionLog","saveLogItemsToExchange"),[2,[]]
case 6:return[2]}})})},b.prototype.overwriteLogItemsInLocalStorage=function(e){var t=e.map(function(e){return c.default.convertToPermanentStoreModel(e)}).filter(function(e){return!!e})
a.default.trySaveToPersistedStorage(a.PersistedStorageKeys.ActionLogItems_V1_1,t)},b.prototype.findActiveLogItemIds=function(d){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c
return p.__generator(this,function(e){switch(e.label){case 0:t=[],r=n=0,o=new g.default("ActionLog",y.LogEventType.Get,"findActiveLogItemIds",y.LogRequestType.Interval).pageSize(b.GET_ITEM_PAGE_SIZE).parentFolderId(d).offset(n),i=0,e.label=1
case 1:return[4,h.default.executeRequest(o,T.RequestPriority.High)]
case 2:return(a=e.sent()).status!==Office.AsyncResultStatus.Failed?[3,6]:a.error!==m.default.ERROR_ITEM_NOT_FOUND?[3,3]:(this.removeFolderFromRoamingSettings(),[3,5])
case 3:return a.error!==m.default.ERROR_EXCEEDED_FIND_COUNT_LIMIT?[3,5]:[4,this.resetActionLogFolder(d)]
case 4:e.sent(),e.label=5
case 5:throw new Error("Unable to find items from ["+b.ACTION_LOG_FOLDER_NAME+"] with error: "+JSON.stringify(a.error)+".")
case 6:if(s=_.default.getXMLExactlyOneElementOrThrow(a.result,S.Constants.EWSMessagesNamespace,"RootFolder"),n=Number(s.attributes.getNamedItem("IndexedPagingOffset").value),r=Number(s.attributes.getNamedItem("TotalItemsInView").value),b.MAX_SUPPORTED_ITEM_COUNT<r)throw this.resetActionLogFolder(d),new Error("Resetting folder. Exceeded max supported item count ["+b.MAX_SUPPORTED_ITEM_COUNT+"] for ActionLogItems. Total active items: ["+r+"].")
for(u=a.result.getElementsByTagNameNS(S.Constants.EWSTypesNamespace,"ItemId"),l=0;l<u.length;l++)c=_.default.parseEWSIdentifierFromIdElement(u[l]),t.push(c)
if(o=o.offset(n),b.FIND_ITEM_SANITY_THRESHOLD<++i)return y.default.logAssert("Exceeded paged requests for ActionLogItem with offset: ["+n+"] of total: ["+r+"].","ActionLogStorageProvider_V1","findActiveLogItemIds"),[3,8]
e.label=7
case 7:if(n<r)return[3,1]
e.label=8
case 8:return[2,t]}})})},b.prototype.retrieveAndDeserializeLogItems=function(l){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u
return p.__generator(this,function(e){switch(e.label){case 0:t=[],n=0,e.label=1
case 1:return n<l.length?(r=l.slice(n,n+b.GET_ITEM_PAGE_SIZE),o=new f.default("ActionLog",y.LogEventType.Get,"retrieveAndDeserializeLogItems",y.LogRequestType.Interval).additionalFieldURIProperties(["item:Body"]).itemIds(r),[4,h.default.executeRequest(o,T.RequestPriority.High)]):[3,4]
case 2:if((i=e.sent()).status===Office.AsyncResultStatus.Failed)throw new Error("Unable to get items from ["+b.ACTION_LOG_FOLDER_NAME+"] with error: "+JSON.stringify(i.error)+".")
for(a=i.result.getElementsByTagNameNS(S.Constants.EWSTypesNamespace,"Message"),s=0;s<a.length;s++)(u=JSON.parse(_.default.getXMLOptionalFirstElementTextContent(a[s],S.Constants.EWSTypesNamespace,"Body"))).itemId=_.default.getExactlyOneEWSIdentifierOrThrow(a[s],"ItemId"),t.push(u)
e.label=3
case 3:return n+=b.GET_ITEM_PAGE_SIZE,[3,1]
case 4:return[2,t]}})})},b.prototype.createActionLogFolder=function(){return p.__awaiter(this,void 0,void 0,function(){var t,n
return p.__generator(this,function(e){switch(e.label){case 0:return t=new r.default("ActionLog",y.LogEventType.Set,"createActionLogFolder",y.LogRequestType.IndirectAction).folderName(b.ACTION_LOG_FOLDER_NAME).parentDistinguishedFolderId("root").nonFatalErrorCodes([m.default.ERROR_FOLDER_EXISTS]),[4,h.default.executeRequest(t,T.RequestPriority.High)]
case 1:return(n=e.sent()).status!==Office.AsyncResultStatus.Succeeded?[3,2]:[2,_.default.getExactlyOneEWSIdentifierOrThrow(n.result,"FolderId")]
case 2:return n.error!==m.default.ERROR_FOLDER_EXISTS?[3,4]:[4,this.findActionLogFolder()]
case 3:return[2,e.sent()]
case 4:throw new Error("Unable to create folder with name: ["+b.ACTION_LOG_FOLDER_NAME+"]. Error: ["+n.error+"].")}})})},b.prototype.findActionLogFolder=function(){return p.__awaiter(this,void 0,void 0,function(){var t,n
return p.__generator(this,function(e){switch(e.label){case 0:return t=new i.default("ActionLog",y.LogEventType.Get,"findActionLogFolder",y.LogRequestType.IndirectAction).displayName(b.ACTION_LOG_FOLDER_NAME),[4,h.default.executeRequest(t,T.RequestPriority.High)]
case 1:if((n=e.sent()).status===Office.AsyncResultStatus.Succeeded)return[2,_.default.getExactlyOneEWSIdentifierOrThrow(n.result,"FolderId")]
throw new Error("Unable to find folder with name: ["+b.ACTION_LOG_FOLDER_NAME+"]. Error: ["+n.error+"].")}})})},b.prototype.appendActionLogItemsToFolder=function(u,l){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s
return p.__generator(this,function(e){switch(e.label){case 0:return t=[],0<(n=u.map(function(e){return c.default.convertToEWSItemModel(e)}).filter(function(e){return!!e})).length?(r=new d.default("ActionLog",y.LogEventType.Set,"appendActionLogItemsToFolder",y.LogRequestType.IndirectAction).saveToFolderId(l).itemsToCreate(n),[4,h.default.executeRequest(r,T.RequestPriority.High)]):[3,5]
case 1:return(o=e.sent()).status!==Office.AsyncResultStatus.Failed?[3,4]:o.error!==m.default.ERROR_MESSAGE_PER_FOLDER_COUNT_RECEIVED_QUOTA_EXCEEDED?[3,3]:[4,this.resetActionLogFolder(l)]
case 2:e.sent(),e.label=3
case 3:throw new Error("Unable to save ActionLogItems to Folder[Id="+l.id+"] with Error: ["+o.error+"]")
case 4:for(i=o.result.getElementsByTagNameNS(S.Constants.EWSTypesNamespace,"Message"),a=0;a<i.length;a++)s=_.default.getExactlyOneEWSIdentifierOrThrow(i[a],"ItemId"),t.push(s)
e.label=5
case 5:return[2,t]}})})},b.prototype.convertAndFilterActiveActionLogItems=function(e){return e.map(function(e){return c.default.convertToRuntimeModel(e)}).filter(function(e){return!!e&&Date.now()<e.expirationTimeInTicks})},b.prototype.resetActionLogFolder=function(t){return p.__awaiter(this,void 0,void 0,function(){return p.__generator(this,function(e){switch(e.label){case 0:return l.default.doesSupportRestToken?[4,this.deleteActionLogFolder(t)]:[3,2]
case 1:e.sent(),this.removeFolderFromRoamingSettings(),e.label=2
case 2:return[2]}})})},b.prototype.deleteActionLogFolder=function(n){return p.__awaiter(this,void 0,void 0,function(){var t
return p.__generator(this,function(e){switch(e.label){case 0:return t=new o.default("ActionLog","deleteActionLogFolder",y.LogRequestType.IndirectAction).actionLogFolderId(s.default.convertToRestId(n.id)),[4,s.default.executeRequest(t)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&y.default.logWarning("Successfully deleted ActionLogFolder as recovery action.","ActionLog","deleteActionLogFolder"),[2]}})})},b.prototype.getFolderFromRoamingSettings=function(){return u.default.tryGetRoamingSettings(u.RoamingSettingsKeys.ActionLogFolder)},b.prototype.removeFolderFromRoamingSettings=function(){this.saveFolderIdToRoamingSettings(null)},b.prototype.saveFolderIdToRoamingSettings=function(e){u.default.trySetRoamingSettings(u.RoamingSettingsTypes.ActionLog,u.RoamingSettingsKeys.ActionLogFolder,e)},b.ACTION_LOG_FOLDER_NAME="MyAnalytics-ActionLog",b.GET_ITEM_PAGE_SIZE=100,b.MAX_SUPPORTED_ITEM_COUNT=(b.FIND_ITEM_SANITY_THRESHOLD=8)*b.GET_ITEM_PAGE_SIZE,b)
function b(){}t.ActionLogStorageProvider_V1=I,t.default=new I},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=n(5),i=n(84),s=(a=i.EWSRequestBase,r.__extends(u,a),Object.defineProperty(u.prototype,"displayName",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"parentDistinguishedFolderId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:FindFolder Traversal="Shallow">\n                <m:FolderShape>\n                    <t:BaseShape>IdOnly</t:BaseShape>\n                </m:FolderShape>\n                <m:IndexedPageFolderView MaxEntriesReturned="1" Offset="0" BasePoint="Beginning" />\n                <m:Restriction>\n                    <t:IsEqualTo>\n                        <t:FieldURI FieldURI="folder:DisplayName" />\n                        <t:FieldURIOrConstant>\n                            <t:Constant Value="'+this.displayName()+'" />\n                        </t:FieldURIOrConstant>\n                    </t:IsEqualTo>\n                </m:Restriction>\n                <m:ParentFolderIds>\n                    <t:DistinguishedFolderId Id="'+this.parentDistinguishedFolderId()+'" />\n                </m:ParentFolderIds>\n            </m:FindFolder>'},u.prototype.toTraceString=function(){return"FindFolderRequest"},r.__decorate([o.doop],u.prototype,"displayName",null),r.__decorate([o.doop],u.prototype,"parentDistinguishedFolderId",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.parentDistinguishedFolderId("root"),i}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WorkingHourConfigsActionCreator=void 0
var s=n(0),u=s.__importDefault(n(3)),a=s.__importDefault(n(24)),i=s.__importDefault(n(382)),l=s.__importDefault(n(11)),c=s.__importDefault(n(4)),d=s.__importDefault(n(504)),p=s.__importDefault(n(6)),f=s.__importDefault(n(287)),r=s.__importDefault(n(68)),g=n(29),o=(m.prototype.getAndDispatchUserWorkingHourConfig=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return(t=f.default.getState().userWorkingHourConfig())?[3,2]:[4,this.getUserWorkingHourConfig(n)]
case 1:t=e.sent(),l.default.dispatch({actionType:u.default.GetWorkingHourConfig,workingHourConfig:t}),e.label=2
case 2:return[2,t]}})})},m.prototype.getAndDispatchRecipientsWorkingHourConfigs=function(i,a){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return s.__generator(this,function(e){switch(e.label){case 0:return t={},n=[],i.forEach(function(e){f.default.getState().recipientsWorkingHourConfig()[e]?t[e]=f.default.getState().recipientsWorkingHourConfig()[e]:n.push(e)}),n.length?[4,this.getWorkingHourConfigs(n,a)]:[3,2]
case 1:return o=e.sent(),[3,3]
case 2:o={},e.label=3
case 3:return r=o,Object.keys(r).forEach(function(e){r[e]&&(t[e]=r[e])}),l.default.dispatch({actionType:u.default.GetRecipientsWorkingHourConfig,recipientsWorkingHourConfig:t}),[2,t]}})})},m.prototype.getUserWorkingHourConfig=function(o){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.getWorkingHourConfigs([p.default.userEmail],o)]
case 1:return[2,(t=e.sent())[p.default.userEmail]?t[p.default.userEmail]:(n=i.default.parseWorkHourWithBuffer(60*g.WorkingHours.DEFAULT_WORKHOUR_START,-this.WORKING_HOUR_BUFFER_IN_MINUTE),r=i.default.parseWorkHourWithBuffer(60*g.WorkingHours.DEFAULT_WORKHOUR_END,this.WORKING_HOUR_BUFFER_IN_MINUTE),{startTimeInMinute:n,endTimeInMinute:r,timeZoneBiasInMinute:a.default.getCurrentTimeZoneOffsetInMinute(),workingDays:{workingDaysSundayStart:g.WorkingHours.DEFAULT_WORKDAY_SCHEDULE}})]}})})},m.prototype.getWorkingHourConfigs=function(o,i){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return t=new Date,[4,d.default.getUserAvailabilityPromise(i,o,a.default.startOfDay(t),a.default.endOfDay(t),this.processWorkingHourConfigFromEWSResponse.bind(this,i))]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&n.error&&(r=o.length-Object.keys(n.result).length)&&c.default.logWarning(r+" of "+o.length+" persons failed to get their working hour configs with the following errors "+n.error+".",i,"getWorkingHourConfigs"),[2,n.result]}})})},m.prototype.processWorkingHourConfigFromEWSResponse=function(e,t){var n=r.default.parseWorkingHourConfigFromXMLElement(t.result,e)
return n&&(n.startTimeInMinute=i.default.parseWorkHourWithBuffer(n.startTimeInMinute,-this.WORKING_HOUR_BUFFER_IN_MINUTE),n.endTimeInMinute=i.default.parseWorkHourWithBuffer(n.endTimeInMinute,this.WORKING_HOUR_BUFFER_IN_MINUTE)),n},m)
function m(){this.WORKING_HOUR_BUFFER_IN_MINUTE=60}t.WorkingHourConfigsActionCreator=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserAvailabilityCommonActionCreator=void 0
var u=n(0),l=u.__importDefault(n(90)),c=n(4),d=u.__importDefault(n(843)),p=n(4),r=(o.prototype.retryGetUserAvailabilityRequestHandler=function(e,n){var r=[]
return e.forEach(function(e,t){e.shouldRetry&&r.push(n.getOrderedKeySelector(t))}),(r=r.filter(function(e){return!!e})).length?n=n.emailAddressList(r):null},o.prototype.getUserAvailabilityPromise=function(n,r,o,i,a,s){return void 0===s&&(s=15),u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){switch(e.label){case 0:return t=new d.default(n,p.LogEventType.Get,"getUserAvailabilityPromise",c.LogRequestType.Interval).emailAddressList(r).mergedGranularityInMinutes(s).startDate(o).endDate(i).maxRetries(0),[4,l.default.executeRequestSupportingPartialSuccess(t,a.bind(this),this.retryGetUserAvailabilityRequestHandler.bind(this))]
case 1:return[2,e.sent()]}})})},o)
function o(){}t.UserAvailabilityCommonActionCreator=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PatchUserSettingsRequestWES=void 0
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"isMyAOptedOut",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isAddInOptedOut",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isDigestEmailOptedOut",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isDashboardOptedOut",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isAutoDelayDeliveryOptedIn",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isProtectedTimeBookingOptedIn",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isManagerInsightsOptedIn",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{ServiceSettings:{IsOptedOut:this.isMyAOptedOut()},FeatureSettings:{IsAddInOptedOut:this.isAddInOptedOut(),IsAutoDelayDeliveryOptedIn:this.isAutoDelayDeliveryOptedIn(),IsProtectedTimeBookingOptedIn:this.isProtectedTimeBookingOptedIn(),IsDigestEmailOptedOut:this.isDigestEmailOptedOut(),IsDashboardOptedOut:this.isDashboardOptedOut(),IsManagerInsightsOptedIn:this.isManagerInsightsOptedIn()}}},r.__decorate([i.doop],l.prototype,"isMyAOptedOut",null),r.__decorate([i.doop],l.prototype,"isAddInOptedOut",null),r.__decorate([i.doop],l.prototype,"isDigestEmailOptedOut",null),r.__decorate([i.doop],l.prototype,"isDashboardOptedOut",null),r.__decorate([i.doop],l.prototype,"isAutoDelayDeliveryOptedIn",null),r.__decorate([i.doop],l.prototype,"isProtectedTimeBookingOptedIn",null),r.__decorate([i.doop],l.prototype,"isManagerInsightsOptedIn",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.PatchUserSettingsRequestWES=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyStateStore=t.EmptyStateStoreState=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(61)),a=n(5),s=(Object.defineProperty(u.prototype,"emptyStateAtLoad",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),r.__decorate([a.doop],u.prototype,"emptyStateAtLoad",null),u=r.__decorate([a.doop],u))
function u(){this.emptyStateAtLoad(!0)}t.EmptyStateStoreState=s
var l,c=(l=i.default,r.__extends(d,l),d.prototype.getStoreLoggingName=function(){return"EmptyStateStore"},d.prototype.setStateForItemChangedEvent=function(e,t){return e},d.prototype.processHaveInsightsToShow=function(e,t){return e.emptyStateAtLoad(!1)},d.prototype.getInitialState=function(){return new s},d)
function d(){var e=l.call(this)||this
return e.addActionCallback(o.default.PreRollupInsights,e.processHaveInsightsToShow),e}t.EmptyStateStore=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpRequestTaskEntityActionCreator=void 0
var r,f=n(0),o=f.__importDefault(n(3)),i=f.__importDefault(n(8)),g=f.__importDefault(n(90)),m=f.__importDefault(n(24)),s=f.__importDefault(n(174)),a=f.__importDefault(n(847)),h=f.__importDefault(n(848)),u=f.__importDefault(n(283)),y=f.__importStar(n(4)),_=f.__importDefault(n(68)),l=n(51),S=n(7),c=n(66),T=n(4),d=f.__importDefault(n(6)),p=(r=a.default,f.__extends(I,r),I.prototype.getFollowUpRequestTasks=function(){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return i.default.areFollowUpRequestTasksEnabled?[4,this.findAndDispatchEntites()]:[2]
case 1:return e.sent(),[2]}})})},I.prototype.findItemsWithEntites=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,d,p
return f.__generator(this,function(e){switch(e.label){case 0:t=[],o=!(r=n=0),i=m.default.startOfDay(m.default.generatePriorDate(this.DAYS_TO_IGNORE-1)),a=m.default.startOfDay(m.default.generatePriorDate(this.DAYS_TO_GO_BACK)),e.label=1
case 1:return s=new h.default(this.LOG_FEATURE_NAME,T.LogEventType.Get,"FindFollowUpRequestTasksRequest",y.LogRequestType.Interval).offset(n),[4,g.default.executeRequest(s)]
case 2:if((u=e.sent()).status===Office.AsyncResultStatus.Succeeded)for(l=_.default.getXMLExactlyOneElementOrThrow(u.result,S.Constants.EWSMessagesNamespace,"RootFolder"),n=Number(l.attributes.getNamedItem("IndexedPagingOffset").value),r=Number(l.attributes.getNamedItem("TotalItemsInView").value),c=_.default.getMessageAndMeetingRequestElements(u.result),d=0;d<c.length;d++)if(p=new Date(_.default.getXMLExactlyOneElementOrThrow(c[d],S.Constants.EWSTypesNamespace,"DateTimeSent").textContent),!(i<p)){if(!(a<=p)){o=!1
break}t.push(_.default.getExactlyOneEWSIdentifierOrThrow(c[d],"ItemId"))}e.label=3
case 3:if(n<r&&o)return[3,1]
e.label=4
case 4:return[2,t]}})})},I.prototype.loadEntitiesForItemRequest=function(e){return new u.default(this.LOG_FEATURE_NAME,T.LogEventType.Get,"loadFindFollowUpRequestTasks",y.LogRequestType.Interval).additionalExtendedFieldURIProperties([s.default.FOLLOWUP_SCHEDULE_REPLY_REQUEST_V1,s.default.FOLLOWUP_SCHEDULE_ACTION_REQUEST_V1,s.default.COMPLETED_FOLLOWUP_REQUESTS_V1]).additionalFieldURIProperties(["item:Subject","item:DateTimeSent","message:ToRecipients","item:ConversationId"]).itemIds(e)},I.prototype.parseAndMapEntities=function(e,t,n,r,o,i){return this.parseEntitiesFromExtendedProperties(e,t).map(function(e){return{sourceItem:r,entity:e,numberOfPeopleOnToLine:o.length,targetPerson:o[0],followUpType:n,duplicateEntityIds:[],conversationId:i}})},I.prototype.buildEntitiesForItem=function(e,t){var n=_.default.parseRecipientsFromMessageElement(t,"ToRecipients",this.LOG_FEATURE_NAME).filter(function(e){return e.smtpAddress.toLowerCase()!==d.default.userEmailLowerCase})
if(!n||0===n.length)return y.default.logWarning("No recipients for a sent item with follow-up request tasks.",this.LOG_FEATURE_NAME,"parseGetItemResponse"),[]
var r=t.getElementsByTagNameNS(S.Constants.EWSTypesNamespace,"ExtendedProperty"),o=_.default.parseConversationIdFromXMLElement(t),i=this.parseAndMapEntities(r,s.default.FOLLOWUP_SCHEDULE_ACTION_REQUEST_V1,c.FollowUpType.ActionFollowUp,e,n,o),a=this.parseAndMapEntities(r,s.default.FOLLOWUP_SCHEDULE_REPLY_REQUEST_V1,c.FollowUpType.ReplyFollowUp,e,n,o)
return i.concat(a)},f.__decorate([l.expirable(l.ExpirationTypes.ByEvery_Minutes,S.Constants.oneDayInMinutes)],I.prototype,"getFollowUpRequestTasks",null),I=f.__decorate([l.expirable()],I))
function I(){var e=null!==r&&r.apply(this,arguments)||this
return e.DAYS_TO_IGNORE=1,e.DAYS_TO_GO_BACK=14,e.LOG_FEATURE_NAME="FollowUpRequestTasks",e.EXTENDED_FIELD_URI_FOR_COMPLETED_ENTITY=s.default.COMPLETED_FOLLOWUP_REQUESTS_V1,e.DISPATCH_ACTION_TYPE=o.default.UpsertExtractedFollowUpRequestTasks,e}t.FollowUpRequestTaskEntityActionCreator=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractedEntitiesStoreBase=t.State=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importStar(n(42)),u=n(5),l=(r=s.CachedDataStreamStateBase,i.__extends(c,r),o=c,Object.defineProperty(c.prototype,"itemIdToLastSeenChangeKey",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"entities",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"completedEntityIds",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),c.prototype.toJSON=function(){return{entities:this.entities(),completedEntityIds:this.completedEntityIds()}},c.prototype.fromJSON=function(e){return(new o).entities(e.entities).completedEntityIds(e.completedEntityIds)},i.__decorate([u.doop],c.prototype,"itemIdToLastSeenChangeKey",null),i.__decorate([u.doop],c.prototype,"entities",null),i.__decorate([u.doop],c.prototype,"completedEntityIds",null),c=o=i.__decorate([u.doop],c))
function c(){var e=r.call(this)||this
return e.itemIdToLastSeenChangeKey({}),e.entities([]),e.completedEntityIds([]),e}t.State=l
var d,p=(d=s.default,i.__extends(f,d),f.prototype.getInitialState=function(){return new l},f.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ExtractedEntities},enumerable:!1,configurable:!0}),f.prototype.processUpsertExtractedEntities=function(e,t){var n=e.entities(),r=t.entities.map(function(e){return e.sourceItem.itemId.id}),n=n.filter(function(e){return-1===r.indexOf(e.sourceItem.itemId.id)}).concat(t.entities)
return e=this.upsertCompletedEntityIds(e,t.completedEntityIds),(e=this.updateLatestChangeKey(e,t.entities)).entities(n)},f.prototype.updateLatestChangeKey=function(e,t){var n=e.itemIdToLastSeenChangeKey()
return t.forEach(function(e){n[e.sourceItem.itemId.id]=e.sourceItem.itemId.changeKey}),e.itemIdToLastSeenChangeKey(n)},f.prototype.processUpsertEntityIdsAsDone=function(e,t){return this.upsertCompletedEntityIds(e,t.completedEntityIds)},f.prototype.upsertCompletedEntityIds=function(e,t){var n=e.completedEntityIds(),r=t.map(function(e){return e.entityId}),n=n.filter(function(e){return-1===r.indexOf(e.entityId)}).concat(t)
return e.completedEntityIds(n)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(e.actionValueToUpsertExtractedEntities(),e.processUpsertExtractedEntities),e.addActionCallback(e.actionValueToUpsertEntityIdsAsDone(),e.processUpsertEntityIdsAsDone),e}t.ExtractedEntitiesStoreBase=p,t.default=p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationInfobarActionCreator=void 0
var a=n(0),s=a.__importDefault(n(3)),u=a.__importDefault(n(11)),l=a.__importDefault(n(4)),c=a.__importDefault(n(2)),d=a.__importDefault(n(853)),p=a.__importDefault(n(89)),f=a.__importDefault(n(37)),r=a.__importDefault(n(105)),o=n(177),g=n(177),m=a.__importDefault(n(93)),h=a.__importDefault(n(8)),y=n(13),i=(_.prototype.extractAndDispatch=function(o,i){return a.__awaiter(this,void 0,void 0,function(){var t,n,r
return a.__generator(this,function(e){switch(e.label){case 0:return f.default.getState().isNewComposeMeeting()||m.default.getState().lockedInsightName()||!h.default.areMeetingInfobarsEnabledForEditMode?[3,2]:(t=f.default.asComposeAppointment(),[4,p.default.getAppointmentComposeCustomProperty(t,g.IS_MEETING_PREPARATION_INFOBAR_SHOWN_DURING_COMPOSE_CUSTOM_PROP,this.LOG_FEATURE_NAME+"_extractAndDispatch")])
case 1:if(e.sent())return n={insightName:y.InsightName.MeetingPreparationInfobar,message:"Infobar has already been shown for the current meeting during the compose time"},l.default.logInformation(JSON.stringify(n),this.LOG_FEATURE_NAME,"extractAndDispatch"),[2,!1]
e.label=2
case 2:return r=d.default.convertToRunTimeInstanceData(o),u.default.dispatch({actionType:s.default.MeetingPreparationInfobar,insight:r,requestTimeInTicks:i}),[2,!0]}})})},_.prototype.bookInfobarPreparationTimeAndDispatch=function(r,o,i){return a.__awaiter(this,void 0,void 0,function(){var t,n
return a.__generator(this,function(e){switch(e.label){case 0:return[4,p.default.getComposingItemSubject()]
case 1:return t=e.sent(),t=c.default.BOOKED_PREPARATION_TIME_SUBJECT(t),o.PreparationTimeSubject=t,[4,this.performPreparationTimeAction(r,o)]
case 2:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(this.stampCustomProperty(n.result.MeetingId),u.default.dispatch({actionType:s.default.BookMeetingPreparationTimeInfobarAction,insightId:r.identifier.primaryId,actionSlotDurationInMinutes:i,bookedMeetingId:n.result.MeetingId})),[2]}})})},_.prototype.cancelInfobarPreparationTimeAndDispatch=function(t,n,r){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,this.performPreparationTimeAction(t,n)]
case 1:return e.sent().status===Office.AsyncResultStatus.Succeeded&&(this.removeCustomProperty(),u.default.dispatch({actionType:s.default.CancelMeetingPreparationTimeInfobarAction,insightId:t.identifier.primaryId,actionSlotDurationInMinutes:r})),[2]}})})},_.prototype.performPreparationTimeAction=function(t,n){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,r.default.executeInsightWESAction(t.identifier.primaryId,t.identifier.secondaryId,n,"performPreparationTimeAction")]
case 1:return[2,e.sent()]}})})},_.prototype.stampCustomProperty=function(t){var n=this
f.default.asComposeAppointment().loadCustomPropertiesAsync(function(e){e.value.set(o.MEETING_PREPARATION_APPOINTMENTID_CUSTOM_PROP,t),e.value.saveAsync(n.saveAddCallback)})},_.prototype.removeCustomProperty=function(){var t=this
f.default.asComposeAppointment().loadCustomPropertiesAsync(function(e){e.value.remove(o.MEETING_PREPARATION_APPOINTMENTID_CUSTOM_PROP),e.value.saveAsync(t.saveRemovedCallback)})},_.prototype.saveAddCallback=function(e){e.status!==Office.AsyncResultStatus.Succeeded&&l.default.logAssert("Failed to add custom properties","MeetingPreparationInfobarActionCreator","bookInfobarPreparationTimeAndDispatch")},_.prototype.saveRemovedCallback=function(e){e.status!==Office.AsyncResultStatus.Succeeded&&l.default.logAssert("Failed to remove custom properties","MeetingPreparationInfobarActionCreator","cancelInfobarPreparationTimeAndDispatch")},_)
function _(){this.LOG_FEATURE_NAME="MeetingPreparationInfobarActionCreator"}t.MeetingPreparationInfobarActionCreator=i,t.default=new i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WESActionRequest=void 0
var i,r=n(0),o=n(5),a=n(511),s=(i=a.WESActionRequestBase,r.__extends(u,i),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/insights('"+this.insightId()+"')/execute"},enumerable:!1,configurable:!0}),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.WESActionRequest=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WESActionRequestBase=void 0
var a,r=n(0),o=n(5),s=n(16),i=n(38),u=(a=i.WESRequestBase,r.__extends(l,a),Object.defineProperty(l.prototype,"insightId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{action:this.action()}},r.__decorate([o.doop],l.prototype,"insightId",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r,o){var i=a.call(this,s.HTTPRequestMethod.POST,t,n,r,o)||this
return i.insightId(e),i}t.WESActionRequestBase=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TasksInsightConverter=void 0
var r,o=n(0),i=o.__importDefault(n(8)),a=o.__importDefault(n(39)),s=n(67),u=o.__importStar(n(52)),l=(r=s.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){a.default.throwIfNullOrEmptyArray("Observations",e.value.Inference.Observations)
var t=e.value.Inference.Observations[0].Value,n={identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},TaskId:t.TaskId,ToDoEntityId:t.ToDoEntityId,ActionType:t.ActionType,Confidence:t.Confidence,Description:t.Description,CreatedDateTime:t.CreatedDateTime,DueDateTime:t.DueDateTime,EntitySource:t.EntitySource,SourceMailId:t.SourceMailId,SourceMailSubject:t.SourceMailSubject,SourceReceivedDateTime:t.SourceReceivedDateTime,SourceConversationId:t.SourceConversationId,Requesters:t.Requesters,NumberOfRecipientsOnToLine:t.NumberOfRecipientsOnToLine,NumberOfRecipientsOnCcLine:t.NumberOfRecipientsOnCcLine,MarkAsNotATaskAction:u.default.convertSuggestedAction(e.value.Suggestion.SuggestedActions,u.MARK_AS_NOT_A_TASK_ACTION),MarkTaskAsDoneAction:u.default.convertSuggestedAction(e.value.Suggestion.SuggestedActions,u.MARK_TASK_AS_DONE_ACTION),PromoteTaskAction:null,IsPromotedTask:!1,PromotedTaskLink:null,OverallRankScore:t.OverallRankScore,EmailImportanceScore:t.EmailImportanceScore,PeopleImportanceScore:t.PeopleImportanceScore,UserMentionedScore:t.UserMentionedScore,DueDateOrCreationTimeScore:t.DueDateOrCreationTimeScore}
return(e.value.Name===c.TASKS_INSIGHT_NAME&&i.default.isToDoTaskPromotionEnabled||e.value.Name===c.FOLLOWUPS_INSIGHT_NAME&&i.default.isFollowUpTaskPromotionEnabled)&&(n.PromoteTaskAction=u.default.convertSuggestedAction(e.value.Suggestion.SuggestedActions,u.PROMOTE_TASK_ACTION)),n},c.TASKS_INSIGHT_NAME="TasksInsight",c.FOLLOWUPS_INSIGHT_NAME="FollowUpsInsight",c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.TasksInsightConverter=l,t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importStar(n(52)),i=r.__importDefault(n(39)),a=(s.extractFreeBlockSuggestionFromContext=function(e){return s.extractFreeBlocksSuggestionFromInsightValue(e.Insight)},s.extractFreeBlocksSuggestionFromInsight=function(e){return s.extractFreeBlocksSuggestionFromInsightValue(e.value)},s.extractFreeBlocksSuggestionFromInsightValue=function(e){var t=e.Suggestion.SuggestedActions,n=o.default.convertSuggestedActions(t,o.BOOK_FOCUS_BLOCK_ACTION_NAME)
return i.default.throwIfNullOrEmptyArray("freeBlocks",n),n.map(function(e){i.default.throwIfUndefinedOrNull("freeBlocks",e),i.default.throwIfUndefinedOrNull("startTime",e.FreeBlockStartTimeInUtc),i.default.throwIfUndefinedOrNull("endTime",e.FreeBlockEndTimeInUtc)
var t=new Date(e.FreeBlockStartTimeInUtc.toString()),n=new Date(e.FreeBlockEndTimeInUtc.toString())
return i.default.throwIfUndefinedOrInvalidDate("startTime",t),i.default.throwIfUndefinedOrInvalidDate("endTime",n),{startDate:t,endDate:n}})},s)
function s(){}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(515),s=(i=a.WESRecordRequest,r.__extends(u,i),Object.defineProperty(u.prototype,"getAction",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.action=function(){return this.getAction()},r.__decorate([o.doop],u.prototype,"getAction",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WESRecordRequest=void 0
var i,r=n(0),o=n(5),a=n(511),s=(i=a.WESActionRequestBase,r.__extends(u,i),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/insights('"+this.insightId()+"')/record"},enumerable:!1,configurable:!0}),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.WESRecordRequest=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailActionCreator=void 0
var i=n(0),r=i.__importDefault(n(3)),o=i.__importDefault(n(11)),a=i.__importDefault(n(35)),s=i.__importDefault(n(886)),u=i.__importStar(n(4)),l=n(517),c=i.__importDefault(n(887)),d=n(7),p=n(34),f=(g.prototype.extractAndDispatch=function(e,t){var n=c.default.convertToRunTimeInstanceData(e)
o.default.dispatchAsync({actionType:r.default.TrackEmailInsightInfobar,insight:n,requestTimeInTicks:t})},g.prototype.markEmailAsTracked=function(t,o){return i.__awaiter(this,void 0,void 0,function(){var n,r=this
return i.__generator(this,function(e){return n=new s.default(t,this.LOG_FEATURE_NAME,"markEmailAsTracked",u.LogRequestType.Action).suggestionAction(o),[2,new Promise(function(t){var e
Office.context.mailbox.item.internetHeaders.setAsync(((e={})[d.Constants.trackEmailHeaderKey]="true",e),function(e){e.status===Office.AsyncResultStatus.Succeeded?(a.default.executeRequest(n,p.RequestPriority.High),t(l.TrackedEmailState.Success)):(u.default.logAssert("Adding MyAnalyticsIsEmailTracked internet header to item failed: "+e.error.message,r.LOG_FEATURE_NAME,"markEmailAsTracked"),t(l.TrackedEmailState.Error))})})]})})},g)
function g(){this.LOG_FEATURE_NAME="TrackEmail"}t.TrackEmailActionCreator=f,t.default=new f},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackedEmailState=void 0,(r=t.TrackedEmailState||(t.TrackedEmailState={}))[r.None=0]="None",r[r.Success=1]="Success",r[r.Error=2]="Error"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FOLLOW_UP_REPLY_REQUEST=t.FOLLOW_UP_ACTION_REQUEST=t.TODO_REQUEST=t.TODO_COMMITMENT=void 0,t.TODO_COMMITMENT="Commitment",t.TODO_REQUEST="Request",t.FOLLOW_UP_ACTION_REQUEST="FollowUpActionRequest",t.FOLLOW_UP_REPLY_REQUEST="FollowUpReplyRequest"},,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UnreadMailActionBase=void 0
var i=n(0),r=i.__importDefault(n(3)),a=i.__importDefault(n(11)),o=i.__importDefault(n(502)),s=i.__importDefault(n(90)),u=n(4),l=i.__importDefault(n(921)),c=(Object.defineProperty(d.prototype,"UnreadMailActionCreatorBase",{get:function(){return l.default},enumerable:!1,configurable:!0}),d.prototype.dispatchEmailItemAsRead=function(e){a.default.dispatch({actionType:r.default.MarkEmailItemAsReadAction,emailItem:e})},d.prototype.openAndMarkEmailItemAsRead=function(e){Office.context.mailbox.displayMessageForm(e.itemId.id),this.UnreadMailActionCreatorBase.requestMarkEmailItemAsRead(e)},d.prototype.findAndDispatchUnreadMail=function(n,r,o){return i.__awaiter(this,void 0,void 0,function(){var t
return i.__generator(this,function(e){switch(e.label){case 0:return r?[4,new Promise(function(e){return setTimeout(e,400)})]:[3,2]
case 1:e.sent(),e.label=2
case 2:return[4,this.UnreadMailActionCreatorBase.executeFindUnreadMailRequest(n,5e3)]
case 3:return t=e.sent(),a.default.dispatch({actionType:o,unreadMail:t}),[2]}})})},d.prototype.findSearchFolderId=function(r){return i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:return t=new o.default(this.LOG_FEATURE_NAME,u.LogEventType.Get,"findExistingUnreadFolderIdAndUpdate",u.LogRequestType.IndirectAction).displayName(r),[4,s.default.executeRequest(t)]
case 1:return n=e.sent(),[2,this.processFindSearchFolderId(n)]}})})},d)
function d(){}t.UnreadMailActionBase=c,t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TasksInsightStoreBase=t.TasksInsightStoreStateBase=void 0
var r,o,i=n(0),a=i.__importStar(n(42)),s=n(5),u=(r=a.CachedDataStreamStateBase,i.__extends(l,r),o=l,Object.defineProperty(l.prototype,"taskInsights",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),l.prototype.toJSON=function(){return{taskInsights:this.taskInsights()}},l.prototype.fromJSON=function(e){return(new o).taskInsights(e.taskInsights)},i.__decorate([s.doop],l.prototype,"taskInsights",null),l=o=i.__decorate([s.doop],l))
function l(){var e=r.call(this)||this
return e.taskInsights([]),e}t.TasksInsightStoreStateBase=u
var c,d=(c=a.default,i.__extends(p,c),p.prototype.getInitialState=function(){return new u},p.prototype.setStateForItemChangedEvent=function(e,t){return e},p.prototype.processTasksInsights=function(e,t){var n=t.insights.map(function(e){return e.ToDoEntityId}),r=e.taskInsights().filter(function(e){return-1===n.indexOf(e.ToDoEntityId)}).concat(t.insights)
return e.taskInsights(r)},p.prototype.processTaskAction=function(e,t){return e.taskInsights(e.taskInsights().filter(function(e){return e.ToDoEntityId!==t.toDoEntityId}))},p.prototype.processTaskPromotion=function(e,t){var n=e.taskInsights().map(function(e){return e.ToDoEntityId===t.toDoEntityId&&(e.IsPromotedTask=!0,e.PromotedTaskLink=t.promotedTaskLink),e})
return e.taskInsights(n)},p)
function p(){var e=c.call(this)||this
return e.addActionCallback(e.insightAction(),e.processTasksInsights),e.addActionCallback(e.markAsDoneAction(),e.processTaskAction),e.addActionCallback(e.markAsNotAnEntityAction(),e.processTaskAction),e.addActionCallback(e.promoteTaskAction(),e.processTaskPromotion),e}t.TasksInsightStoreBase=d,t.default=d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsActionCreator=void 0
var f=n(0),g=f.__importDefault(n(3)),s=f.__importDefault(n(8)),u=f.__importDefault(n(37)),m=f.__importDefault(n(11)),l=f.__importDefault(n(90)),i=f.__importDefault(n(525)),c=f.__importDefault(n(283)),d=f.__importStar(n(4)),o=f.__importDefault(n(35)),r=f.__importDefault(n(929)),a=f.__importDefault(n(930)),p=f.__importDefault(n(931)),h=f.__importDefault(n(6)),y=f.__importDefault(n(68)),_=n(51),S=n(7),T=n(208),I=n(34),b=f.__importDefault(n(932)),E=f.__importDefault(n(243)),v=f.__importDefault(n(933)),A=f.__importDefault(n(289)),D=f.__importDefault(n(62)),O=(C.prototype.getCurrentItemSentStatistics=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.shouldGetCurrentItemSentStats()]
case 1:return e.sent()?(s.default.hideReadStatsForCalendarItems||m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.Loading}),[4,this.requestSingleItemProperties({id:u.default.currentItemId()})]):[2]
case 2:if(!(t=e.sent()))return[3,8]
if(s.default.hideReadStatsForCalendarItems){if(t.mailType===T.SentMailType.MeetingRequest||t.mailType===T.SentMailType.MeetingResponse)return[2]
m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.Loading})}return this.isExpired(t.dateTimeSent)?(m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.Expired}),[2]):this.isPremature(t.dateTimeSent)?(m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.Processing}),[2]):(n=void 0,r=this.getSingleItemAnalytics(t),n=this.getSingleItemDocumentAnalytics(t),r?[4,r]:[3,4])
case 3:return i=e.sent(),[3,6]
case 4:return[4,this.getSingleItemAnalytics(t)]
case 5:i=e.sent(),e.label=6
case 6:return(o=i).isInsufficientData?(m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.InsufficientData}),[2]):o.messageStatistics?(a=this.mergeStatisticsWithItem(o.messageStatistics,t),m.default.dispatch({actionType:g.default.SentMailInContextStatistics,messageAnalytics:a}),[4,this.computeAndDispatchSentMailDocumentStats(n,t)]):[3,8]
case 7:return e.sent(),[2]
case 8:return m.default.dispatch({actionType:g.default.SentMailInContextStatus,status:T.InContextStatus.ServerError}),[2]}})})},C.prototype.sentMailStatsFromActionableMessage=function(i){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return f.__generator(this,function(e){switch(e.label){case 0:return t=this.parseMessageStatistics(i),[4,this.requestSingleItemProperties({id:u.default.currentItemId()})]
case 1:return n=e.sent(),r=this.mergeStatisticsWithItem(t,n),o=f.__assign(f.__assign({},r),{identifier:i.identifier,doesSupportNudgeFeedback:i.doesSupportNudgeFeedback,doesSupportServerSideDislikeInsightAction:i.doesSupportServerSideDislikeInsightAction}),m.default.dispatch({actionType:g.default.GetToSentMailStatsInContextFromActionableMessage,messageAnalyticsInstance:o}),[2]}})})},C.prototype.requestSentMailStatistics=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n
return f.__generator(this,function(e){switch(e.label){case 0:return s.default.areSentMailStatisticsEnabled?[4,this.getQualifiedMessages()]:[2]
case 1:return t=e.sent(),[4,this.getEligibleItemIds()]
case 2:return n=e.sent(),[4,this.requestAllSentMailStatistics(t,n,!0)]
case 3:return e.sent(),[4,this.requestAllSentMailStatistics(t,n,!1)]
case 4:return e.sent(),[2]}})})},C.prototype.shouldGetCurrentItemSentStats=function(){return f.__awaiter(this,void 0,void 0,function(){var t
return f.__generator(this,function(e){switch(e.label){case 0:return Office.context.mailbox.item&&u.default.getState().isMessage()&&s.default.areSentMailStatisticsEnabled?u.default.getState().doesSenderApproximatelyMatchCurrentUser()?[2,!0]:[4,this.isCurrentItemInSentItemsFolder()]:[2,!1]
case 1:return t=e.sent(),m.default.dispatch({actionType:g.default.IsItemInSentItemsFolder,isInSentItemsFolder:t}),[2,t]}})})},C.prototype.isCurrentItemInSentItemsFolder=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return f.__generator(this,function(e){switch(e.label){case 0:return(t=u.default.asReadItem())?(n=new b.default("CurrentItem",d.LogEventType.Get,"isCurrentItemInSentItemsFolder",d.LogRequestType.Interval).itemId({id:t.itemId}).distinguishedParentFolderIds(["sentitems"]),[4,l.default.executeRequest(n,I.RequestPriority.High)]):[2,!1]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded?(o=l.default.processEWSResultWithSafeCallback(r,this.processIsInSentItemsFolderResponse.bind(this)),i=o.isSuccess&&1===o.result.totalItemsInView,d.default.logInformation("Current Item in SentItems folder: ["+i+"].","CurrentItem","isCurrentItemInSentItemsFolder"),[2,i]):[2,!1]}})})},C.prototype.processIsInSentItemsFolderResponse=function(e){var t=y.default.getXMLExactlyOneElementOrThrow(e.result,S.Constants.EWSMessagesNamespace,"RootFolder")
return{totalItemsInView:Number(t.attributes.getNamedItem("TotalItemsInView").value)}},C.prototype.requestSingleItemProperties=function(n){return f.__awaiter(this,void 0,void 0,function(){var t
return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.requestItemProperties([n],!0)]
case 1:return 1===(t=e.sent()).length?[2,t[0]]:[2,null]}})})},C.prototype.computeAndDispatchSentMailDocumentStats=function(n,e){return f.__awaiter(this,void 0,void 0,function(){var t
return f.__generator(this,function(e){switch(e.label){case 0:return[4,n]
case 1:return(t=e.sent())&&m.default.dispatch({actionType:g.default.SentMailDocumentInContextStatistics,documentAnalytics:t.documentAnalytics}),[2]}})})},C.prototype.getSingleItemAnalytics=function(r){return f.__awaiter(this,void 0,void 0,function(){var t,n
return f.__generator(this,function(e){switch(e.label){case 0:return t=new p.default(this.LOG_FEATURE_NAME,"SingleMessageWES",d.LogRequestType.Interval).base64EncodedImid(window.btoa(r.internetMsgId)).bodyWordCount(r.uniqueBodySize),[4,o.default.executeWESRequest(t,I.RequestPriority.High)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?204===n.responseStatusCode?[2,{isInsufficientData:!0}]:[2,{messageStatistics:this.parseMessageStatistics(n.result.value[0])}]:[2,{isServerError:!0}]}})})},C.prototype.getSingleItemDocumentAnalytics=function(r){return f.__awaiter(this,void 0,void 0,function(){var t,n
return f.__generator(this,function(e){switch(e.label){case 0:return t=new v.default(this.LOG_FEATURE_NAME,"DocumentStatsWES",d.LogRequestType.Interval).base64EncodedImid(window.btoa(r.internetMsgId)),[4,o.default.executeWESRequest(t,I.RequestPriority.High)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&200===n.responseStatusCode&&n.result.value&&0<n.result.value.length?[2,{documentAnalytics:this.parseDocumentStatistics(n.result.value[0])}]:[2,null]}})})},C.prototype.getQualifiedMessages=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n
return f.__generator(this,function(e){switch(e.label){case 0:return t=new r.default(this.LOG_FEATURE_NAME,"QualifiedMessagesWES",d.LogRequestType.Interval),[4,o.default.executeWESRequest(t)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Failed?[2,[]]:[2,n.result.value]}})})},C.prototype.requestAllSentMailStatistics=function(c,d,p){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l=this
return f.__generator(this,function(e){switch(e.label){case 0:return t=c.filter(function(e){return e.IsTracked===p}).map(function(e){return e.InternetMessageId}),n=d.filter(function(e){return-1!==t.indexOf(e.internetMsgId)}).map(function(e){return e.itemId}),[4,this.requestItemProperties(n,!1)]
case 1:r=e.sent(),o=r.filter(function(e){return!l.isExpired(e.dateTimeSent)}),e.label=2
case 2:return 0<o.length?(i=o.splice(0,this.SENTMAIL_REQUEST_BATCH_SIZE),[4,this.getItemAnalytics(i)]):[3,5]
case 3:return a=e.sent(),s=this.mergeMessageStatisticsWithSourceItems(a,i),m.default.dispatch({actionType:g.default.SentMailStatistics,messageAnalytics:s,areMessagesTracked:p}),[4,this.getItemDocumentAnalytics(s)]
case 4:return u=e.sent(),m.default.dispatch({actionType:g.default.SentMailDocumentStatistics,documentAnalytics:u}),[3,2]
case 5:return[2]}})})},C.prototype.getEligibleItemIds=function(){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return f.__generator(this,function(e){switch(e.label){case 0:for(t=[],n=0;n<this.BATCH_COUNT;n++)r=new i.default(this.LOG_FEATURE_NAME,d.LogEventType.Get,"GetSentMailIdsEWSBatch ("+(n+1)+"/"+this.BATCH_COUNT+")",d.LogRequestType.Interval).distinguishedParentFolderIds(["sentitems"]).maxEntriesPerPage(this.BATCH_SIZE).offset(this.BATCH_SIZE*n).additionalFieldURIProperties(["message:InternetMessageId"]),t.push(l.default.executeRequest(r))
return[4,Promise.all(t)]
case 1:return o=e.sent(),[2,this.parseSuccessfulSentMailIdsFromEWS(o)]}})})},C.prototype.parseSuccessfulSentMailIdsFromEWS=function(e){var n=this,r=[]
return e.forEach(function(e){if(e.status!==Office.AsyncResultStatus.Succeeded)return[]
var t=l.default.processEWSResultWithSafeCallback(e,n.parseMailIdsFromEWSResponse.bind(n))
t.isSuccess&&(r=r.concat(t.result))}),r},C.prototype.parseMailIdsFromEWSResponse=function(e){for(var t=[],n=e.result.getElementsByTagNameNS(S.Constants.EWSTypesNamespace,T.SentMailType[T.SentMailType.Message]),r=0;r<n.length;r++)t.push(this.extractMailIdFromEWSItem(n[r]))
return t},C.prototype.extractMailIdFromEWSItem=function(e){return{internetMsgId:y.default.parseInternetMessageIdFromXMLElement(e),itemId:y.default.getExactlyOneEWSIdentifierOrThrow(e,"ItemId")}},C.prototype.isPremature=function(e){var t=E.default.getReadStatsPrematureTime()*S.Constants.oneMinuteInMilliSeconds
return Date.now()-e.getTime()<t},C.prototype.isExpired=function(e){return Date.now()-e.getTime()>this.EXPIRED_DURATION},C.prototype.getItemAnalytics=function(r){return f.__awaiter(this,void 0,void 0,function(){var t,n=this
return f.__generator(this,function(e){switch(e.label){case 0:return t=r.map(function(e){return new p.default(n.LOG_FEATURE_NAME,"SingleMessageBatchWES",d.LogRequestType.Interval).base64EncodedImid(window.btoa(e.internetMsgId)).bodyWordCount(e.uniqueBodySize)}),[4,o.default.executeWESBatchRequests(t)]
case 1:return[2,e.sent().filter(function(e){return e.status===Office.AsyncResultStatus.Succeeded&&204!==e.responseStatusCode}).map(function(e){return n.parseMessageStatistics(e.result.value[0])}).filter(function(e){return!!e})]}})})},C.prototype.getItemDocumentAnalytics=function(r){return f.__awaiter(this,void 0,void 0,function(){var t,n=this
return f.__generator(this,function(e){switch(e.label){case 0:return t=r.map(function(e){return new v.default(n.LOG_FEATURE_NAME,"DocumentStatsBatchRequestWES",d.LogRequestType.Interval).base64EncodedImid(window.btoa(e.internetMsgId))}),[4,o.default.executeWESBatchRequests(t)]
case 1:return[2,e.sent().filter(function(e){return e.status===Office.AsyncResultStatus.Succeeded&&200===e.responseStatusCode}).map(function(e){return n.parseDocumentStatistics(e.result.value[0])}).filter(function(e){return!!e})]}})})},C.prototype.requestItemProperties=function(i,a){return f.__awaiter(this,void 0,void 0,function(){var n,t,r,o
return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.loadItemPropertiesFromCache(i)]
case 1:return n=e.sent(),t=i.filter(function(t){return!n.some(function(e){return e.itemId.id===t.id})}),[4,this.loadItemPropertiesFromEWS(t,a)]
case 2:return r=e.sent(),o=n.concat(r),this.mergeAndSaveItemPropertiesToCache(o),[2,o]}})})},C.prototype.loadItemPropertiesFromEWS=function(a,s){return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return f.__generator(this,function(e){switch(e.label){case 0:return 0===a.length?[2,[]]:(t=s?"loadSingleItemPropertiesFromEWS":"loadItemPropertiesFromEWS",n=s?I.RequestPriority.High:I.RequestPriority.Normal,r=new c.default(this.LOG_FEATURE_NAME,d.LogEventType.Get,t,d.LogRequestType.Interval).itemIds(a).additionalFieldURIProperties(["message:InternetMessageId","item:Subject","item:DateTimeSent","item:UniqueBody","item:Culture","message:ToRecipients","message:CcRecipients","message:BccRecipients","message:Sender"]),[4,l.default.executeRequest(r,n)])
case 1:return(o=e.sent()).status!==Office.AsyncResultStatus.Failed&&(i=l.default.processEWSResultWithSafeCallback(o,this.parseItemPropertiesFromEWS.bind(this))).isSuccess?[2,i.result]:[2,[]]}})})},C.prototype.loadItemPropertiesFromCache=function(n){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.loadSentMailPropsFromPermanentStore()]
case 1:return[2,e.sent().filter(function(t){return n.some(function(e){return t.itemId.id===e.id})})]}})})},C.prototype.mergeAndSaveItemPropertiesToCache=function(o){return f.__awaiter(this,void 0,void 0,function(){var t,n,r=this
return f.__generator(this,function(e){switch(e.label){case 0:return[4,a.default.loadSentMailPropsFromPermanentStore()]
case 1:return t=(t=e.sent()).filter(function(t){return!o.some(function(e){return e.itemId.id===t.itemId.id})}),n=t.concat(o).filter(function(e){return!r.isExpired(e.dateTimeSent)}),a.default.saveSentMailPropsToPermanentStore(n),[2]}})})},C.prototype.parseItemPropertiesFromEWS=function(e){for(var t=e.result,n=[T.SentMailType[T.SentMailType.Message],T.SentMailType[T.SentMailType.MeetingRequest],T.SentMailType[T.SentMailType.MeetingResponse]],r=D.default.isFlightEnabled(D.default.USE_XML_DOM_PACKAGE)?y.default.getXMLElementsByTagNamesNS(t,S.Constants.EWSTypesNamespace,n):t.querySelectorAll(n.join(",")),o=[],i=0;i<r.length;i++)o.push(this.parseGetItemProperties(r[i]))
return o.filter(function(e){return!!e})},C.prototype.mergeMessageStatisticsWithSourceItems=function(e,n){var r=this
return e.map(function(t){var e=n.filter(function(e){return e.internetMsgId===t.internetMessageId})[0]
return e?r.mergeStatisticsWithItem(t,e):null}).filter(function(e){return!!e})},C.prototype.mergeStatisticsWithItem=function(e,t){return{analytics:e,senderEmailAddress:t.senderEmailAddress,dateTimeSent:t.dateTimeSent,internetMsgId:t.internetMsgId,itemId:t.itemId,recipients:t.recipients,subject:t.subject,uniqueBodySize:t.uniqueBodySize,mailType:t.mailType}},C.prototype.parseMessageStatistics=function(e){var t,n=this.tryExtractMessageStatisticsBreakdown(e.StatisticBreakdowns,T.StatisticsBreakdownTypes.READ_STATISTICS_BREAKDOWN),r=this.tryExtractMessageStatisticsBreakdown(e.StatisticBreakdowns,T.StatisticsBreakdownTypes.REPLY_AND_FORWARD_STATISTICS_BREAKDOWN),o=this.tryExtractMessageStatisticsBreakdown(e.StatisticBreakdowns,T.StatisticsBreakdownTypes.DWELL_STATISTICS_BREAKDOWN),i=this.tryExtractMessageStatisticsBreakdown(e.StatisticBreakdowns,T.StatisticsBreakdownTypes.EXTENDED_SENT_MAIL_STATISTICS_BREAKDOWN)
return n&&r&&o&&(t={internetMessageId:e.InternetMessageId,isTracked:e.IsTracked,percentOpened:E.default.getPercentOpened(n),readActivityType:A.default.getAccessLevel(n.ReadLevel),forwardCount:r.ForwardCount,replyCount:r.ReplyCount,readingTimeEstimation:o.ReadingTimeEstimation,mostReadByDateTime:o.MostReadByTime&&new Date(o.MostReadByTime)}),i&&s.default.isExtendedSentMailStatsEnabled&&(t.extendedStatistics={extendedReadRateStatistics:this.parseExtendedReadRateStatistics(i.ExtendedReadRateStatistics),extendedOpenRateStatistics:i.ExtendedOpenRateStatistics}),t},C.prototype.parseDocumentStatistics=function(e){return e?{id:e.Id,internetMessageId:e.InternetMessageId,isTracked:e.IsTracked,statisticsBreakdown:this.parseDocumentStatisticsBreakdown(e.StatisticBreakdowns)}:null},C.prototype.tryExtractMessageStatisticsBreakdown=function(e,t){var n=e.filter(function(e){return e["@odata.type"].toUpperCase()===t.toUpperCase()})
if(1===n.length)return n[0]
var r=e.map(function(e){return e["@odata.type"]}).join(" ")
return t!==T.StatisticsBreakdownTypes.EXTENDED_SENT_MAIL_STATISTICS_BREAKDOWN&&d.default.logAssert("Missing message statistics breakdown of type: ["+t+"]. Possible types are: ["+r+"].",this.LOG_FEATURE_NAME,"tryExtractMessageStatisticsBreakdown"),null},C.prototype.parseDocumentStatisticsBreakdown=function(e){return e?e.map(function(e){return{accessLevel:A.default.getAccessLevel(e.AccessLevel),accessPercent:e.AccessPercent,documentName:e.DocumentName,documentUrl:e.DocumentUrl}}):null},C.prototype.parseGetItemProperties=function(e){var t=this.UNIQUE_BODY_SIZE_DEFAULT,n=y.default.getXMLOptionalFirstElementTextContent(e,S.Constants.EWSTypesNamespace,"Culture"),r=y.default.getXMLOptionalFirstElementTextContent(e,S.Constants.EWSTypesNamespace,"UniqueBody")
"en"===n.trim().toLowerCase().substring(0,2)&&(r=(r=r.trim().split(/From:.*\s{1,2}Sent:.*\s{1,2}To:.*\s{1,2}/)[0]).trim().split(/-----*-----/)[0],t=h.default.wordCount(r))
var o=y.default.parseRecipientsFromMessageElement(e,"ToRecipients",this.LOG_FEATURE_NAME),i=y.default.parseRecipientsFromMessageElement(e,"CcRecipients",this.LOG_FEATURE_NAME),a=y.default.parseRecipientsFromMessageElement(e,"BccRecipients",this.LOG_FEATURE_NAME),s=o.concat(i,a),u=y.default.parseEmailItemBaseFromXMLElement(e,this.LOG_FEATURE_NAME),l=y.default.parseSenderFromXMLElement(e,this.LOG_FEATURE_NAME)
if(u.internetMsgId&&u.dateTimeSent)return{dateTimeSent:u.dateTimeSent,internetMsgId:u.internetMsgId,itemId:u.itemId,subject:u.subject,uniqueBodySize:t,recipients:s,senderEmailAddress:l?l.smtpAddress:"",mailType:T.SentMailType[e.localName]}},C.prototype.parseExtendedReadRateStatistics=function(e){return e?{Ignored:this.parseReadEngagementBreakdown(e.Ignored),Skimmed:this.parseReadEngagementBreakdown(e.Skimmed),Engaged:this.parseReadEngagementBreakdown(e.Engaged),Disengaged:this.parseReadEngagementBreakdown(e.Disengaged),Slightly:this.parseReadEngagementBreakdown(e.Slightly),Moderately:this.parseReadEngagementBreakdown(e.Moderately),Highly:this.parseReadEngagementBreakdown(e.Highly)}:null},C.prototype.parseReadEngagementBreakdown=function(e){return e?{Percentage:e.Percentage,ReadLevel:A.default.getAccessLevel(e.ReadLevel)}:null},f.__decorate([_.expirable(_.ExpirationTypes.ByEvery_Minutes,15),_.expirable(_.ExpirationTypes.ByItemChange)],C.prototype,"getCurrentItemSentStatistics",null),f.__decorate([_.expirable(_.ExpirationTypes.ByEvery_Minutes,10)],C.prototype,"requestSentMailStatistics",null),C=f.__decorate([_.expirable()],C))
function C(){this.UNIQUE_BODY_SIZE_DEFAULT=-1,this.BATCH_COUNT=2,this.BATCH_SIZE=40,this.LOG_FEATURE_NAME="SentMail",this.SENTMAIL_REQUEST_BATCH_SIZE=3,this.EXPIRED_DURATION=14*S.Constants.oneDay}t.SentMailStatsActionCreator=O,t.default=new O},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=n(5),i=n(84),s=r.__importDefault(n(24)),u=(a=i.EWSRequestBase,r.__extends(l,a),Object.defineProperty(l.prototype,"traversal",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"distinguishedParentFolderIds",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"parentFolderIds",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"maxEntriesPerPage",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"offset",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"startDateOfQueryRange",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),l.prototype.getSOAPRequest=function(){return'<m:FindItem Traversal = "'+this.traversal()+'">\n                    <m:ItemShape>\n                        <t:BaseShape>IdOnly</t:BaseShape>\n                        <t:AdditionalProperties>\n                            '+this.buildFieldURIPropertiesElements()+'\n                        </t:AdditionalProperties>\n                    </m:ItemShape>\n                    <m:IndexedPageItemView MaxEntriesReturned="'+String(this.maxEntriesPerPage())+'" Offset="'+this.offset()+'" BasePoint="Beginning" />\n                    '+this.buildRestrictionElement()+"\n                    <m:ParentFolderIds>\n                        "+this.buildDistinguishedParentFolderIdElement()+"\n                        "+this.buildParentFolderIdElement()+"\n                    </m:ParentFolderIds>\n                </m:FindItem>"},l.prototype.toTraceString=function(){return"SentMailsRequest"},l.prototype.buildRestrictionElement=function(){return this.startDateOfQueryRange()?"<m:Restriction>\n                        "+this.buildDateTimeRangeRestriction()+"\n                    </m:Restriction>":""},l.prototype.buildDistinguishedParentFolderIdElement=function(){return this.distinguishedParentFolderIds().map(function(e){return'<t:DistinguishedFolderId Id="'+e+'" />'}).join(" ")},l.prototype.buildParentFolderIdElement=function(){return this.parentFolderIds().map(function(e){return'<t:FolderId Id="'+e.id+'" ChangeKey="'+e.changeKey+'" />'}).join(" ")},l.prototype.buildDateTimeRangeRestriction=function(){return'<t:IsGreaterThan>\n                    <t:FieldURI FieldURI="item:DateTimeReceived"/>\n                    <t:FieldURIOrConstant>\n                        <t:Constant Value="'+this.startDateOfQueryRange().toISOString()+'"/>\n                    </t:FieldURIOrConstant>\n                </t:IsGreaterThan>'},r.__decorate([o.doop],l.prototype,"traversal",null),r.__decorate([o.doop],l.prototype,"distinguishedParentFolderIds",null),r.__decorate([o.doop],l.prototype,"parentFolderIds",null),r.__decorate([o.doop],l.prototype,"maxEntriesPerPage",null),r.__decorate([o.doop],l.prototype,"offset",null),r.__decorate([o.doop],l.prototype,"startDateOfQueryRange",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.traversal("Shallow"),i.distinguishedParentFolderIds(["root"]),i.parentFolderIds([]),i.maxEntriesPerPage(100),i.offset(0),i.startDateOfQueryRange(s.default.generatePriorDate(14)),i.additionalFieldURIProperties([]),i}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportUnreadMailActionCreator=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=o.__importStar(n(65)),s=n(7),u=n(51),l=n(522),c=o.__importDefault(n(8)),d=o.__importDefault(n(68)),p=(r=l.UnreadMailActionBase,o.__extends(f,r),f.prototype.processFindSearchFolderId=function(e){if(e.status===Office.AsyncResultStatus.Succeeded)return d.default.getOptionalSingleEWSIdentifier(e.result,"FolderId")
throw new Error("Unable to find Search Folder with error: ["+e.error+"].")},f.prototype.getUnreadMailFromDirectReports=function(){return o.__awaiter(this,void 0,void 0,function(){var t,n,r
return o.__generator(this,function(e){switch(e.label){case 0:return c.default.isManagerEffectivenessEnabled?(t=a.default.tryGetRoamingSettings(a.RoamingSettingsKeys.UnReadFromDirectReportFolder))?(this.findAndDispatchUnreadMail(t,!1,i.default.GetUnreadMailFromDirectReportSearchFolder),[3,3]):[3,1]:[3,3]
case 1:return r={},[4,this.findSearchFolderId(s.Constants.UnreadFromDirectReportFolderName)]
case 2:r.folderId=e.sent(),r.folderName=s.Constants.UnreadFromDirectReportFolderName,(n=r).folderId&&(a.default.trySetRoamingSettings(a.RoamingSettingsTypes.UnReadMails,a.RoamingSettingsKeys.UnReadFromDirectReportFolder,n),this.findAndDispatchUnreadMail(n,!1,i.default.GetUnreadMailFromDirectReportSearchFolder)),e.label=3
case 3:return[2]}})})},o.__decorate([u.expirable(u.ExpirationTypes.ByEvery_Minutes,5)],f.prototype,"getUnreadMailFromDirectReports",null),f=o.__decorate([u.expirable()],f))
function f(){var e=null!==r&&r.apply(this,arguments)||this
return e.LOG_FEATURE_NAME="ManagerEffectiveness",e}t.DirectReportUnreadMailActionCreator=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ReloadAppStore=t.ReloadAppStoreState=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(61)),a=n(5),s=(Object.defineProperty(u.prototype,"lastUserActivityTime",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),r.__decorate([a.doop],u.prototype,"lastUserActivityTime",null),u=r.__decorate([a.doop],u))
function u(){this.lastUserActivityTime(Date.now())}t.ReloadAppStoreState=s
var l,c=(l=i.default,r.__extends(d,l),d.prototype.getStoreLoggingName=function(){return"ReloadAppStore"},d.prototype.setStateForItemChangedEvent=function(e,t){return e.lastUserActivityTime(Date.now())},d.prototype.getInitialState=function(){return new s},d.prototype.timeSinceLastUserActivity=function(){return Date.now()-this.getState().lastUserActivityTime()},d.prototype.processUserActivityAction=function(e,t){return e.lastUserActivityTime(Date.now())},d)
function d(){var e=l.call(this)||this
return e.addActionCallback(o.default.UserActivityAction,e.processUserActivityAction),e}t.ReloadAppStore=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ComputeActivator=void 0
var r=n(0).__importDefault(n(955)),o=(i.prototype.activateInsightsCompute=function(){this.getInsightComputes().forEach(function(e){return e.registerStoreObserversAndActivate()})},i.prototype.deactivateInsightsCompute=function(){this.getInsightComputes().forEach(function(e){return e.disposeStoreObservers()})},i.prototype.getInsightComputes=function(){return r.default.insightComputes},i)
function i(){}t.ComputeActivator=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeActionableMessageComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(369)),a=o.__importDefault(n(8)),s=o.__importDefault(n(91)),u=o.__importDefault(n(153)),l=o.__importDefault(n(31)),c=o.__importDefault(n(26)),d=o.__importDefault(n(202)),p=n(29),f=(r=l.default,o.__extends(g,r),Object.defineProperty(g.prototype,"insightDomain",{get:function(){return c.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[this.insightStore,s.default,u.default]},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(e){return{insight:this.getInsightFromStore,scheduleItems:s.default.getState().scheduleItems(),hasLoadedFocusTimeSettings:u.default.getState().hasLoaded(),shouldEnableCalendarReminder:u.default.getState().shouldEnableCalendarReminder}},g.prototype.computeInsightInstances=function(e){if(e.insight){var t=i.default(e.insight)
if(0===e.insight.freeBlocks.length)return t.doesSupportNudgeFeedback=!1,[t]
if(e.scheduleItems&&(!a.default.isFocusReminderSettingEnabled||e.hasLoadedFocusTimeSettings)){var n=this.filterFreeBlocks(e)
return a.default.isFocusReminderSettingEnabled&&(n=d.default.addReminderSetting(n,e.shouldEnableCalendarReminder)),t.freeBlocks=n,t.doesSupportNudgeFeedback=0!==n.length&&t.doesSupportNudgeFeedback,[t]}}return[]},g.prototype.filterFreeBlocks=function(e){var n=e.scheduleItems.filter(function(e){return e.freeBusyStatus!==p.BusyStatus.Free})
return e.insight.freeBlocks.filter(function(t){return t.startDate>new Date&&!n.some(function(e){return d.default.doesOverlap(t,e)})})},Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"confirmationExpirationInMilliseconds",{get:function(){return 1e3},enumerable:!1,configurable:!0}),g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.FocusTimeActionableMessageComputeBase=f,t.default=f},,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=r.__importDefault(n(4)),a=n(52),s=n(177),u=r.__importDefault(n(2)),l=(c.updateInsightAfterPreparationTimeAction=function(e,t,n,r){if(t===a.BOOK_PREPARATION_TIME_ACTION)return this.updateInsightAfterBookingPreparationTime(e,r,n)
if(t===a.CANCEL_BOOKED_TIME_ACTION)return this.updateInsightAfterCancellingPreparationTime(e,n)
var o="Encountered unexpected action: ",o=t?o.concat(t):o.concat("null or undefined")
return i.default.logAssert(o,"MeetingPreparationCompute","updateInsightAfterPreparationTimeAction"),e},c.updateInsightAfterBookingPreparationTime=function(e,t,n){return(e.preparationTimeDurationBooked=n)===s.SHORT_PREPARATION_TIME_DURATION?e.bookShortPreparationTimeAction=null:e.bookLongPreparationTimeAction=null,e.cancelBookedTimeAction={Name:a.CANCEL_BOOKED_TIME_ACTION,PreparationTimeId:t,Text:"Cancel booked time"},e.preparationTimeDurationAvailable=0,e},c.updateInsightAfterCancellingPreparationTime=function(e,t){return e.preparationTimeDurationBooked=0,e.cancelBookedTimeAction=null,e.preparationTimeDurationAvailable=t,e.bookShortPreparationTimeAction=this.createBookPreparationTimeAction(e,s.SHORT_PREPARATION_TIME_DURATION),t===s.LONG_PREPARATION_TIME_DURATION&&(e.bookLongPreparationTimeAction=this.createBookPreparationTimeAction(e,s.LONG_PREPARATION_TIME_DURATION)),e},c.createBookPreparationTimeAction=function(e,t){return{Name:a.BOOK_PREPARATION_TIME_ACTION,Text:"Set time for preparation",OriginalMeetingId:e.meetingId,PreparationStartTimeInUtc:new Date(e.startTime.getTime()-t*o.Constants.oneMinuteInMilliSeconds).toISOString(),PreparationEndTimeInUtc:e.startTime.toISOString(),PreparationTimeSubject:u.default.BOOKED_PREPARATION_TIME_SUBJECT(e.subject),PreparationTimeDurationInMinutes:t}},c)
function c(){}t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliverySearchContextInsightsComputeBase=void 0
var r,o=n(0),i=n(7),a=o.__importDefault(n(26)),s=o.__importDefault(n(149)),u=o.__importDefault(n(37)),l=o.__importDefault(n(196)),c=o.__importDefault(n(176)),d=o.__importDefault(n(93)),p=o.__importDefault(n(307)),f=o.__importDefault(n(8)),g=(r=p.default,o.__extends(m,r),Object.defineProperty(m.prototype,"storesToObserve",{get:function(){return this.getBaseStores()},enumerable:!1,configurable:!0}),m.prototype.getBaseStores=function(){return f.default.isInfobarUpdatableFromVertical?o.__spreadArrays([u.default,l.default,c.default],r.prototype.getBaseStores.call(this)):o.__spreadArrays([u.default,c.default],r.prototype.getBaseStores.call(this))},m.prototype.calculateCurrentState=function(e){return{isComposeMessage:!!u.default.asComposeMessage(),insightData:this.getInsightDataFromStoreState(d.default.getState()),scheduledDateTime:c.default.getState().scheduledDelayDeliveryDateTime(),isDelayDeliveryCancelled:c.default.getState().isDelayDeliveryCancelled(),shouldDisplayRecipientsTimeZone:c.default.getState().shouldDisplayRecipientsTimeZone(),toRecipients:s.default.getToRecipients(),userAddressToTimeZoneMap:c.default.getState().userAddressToTimeZoneMap(),isEstimatedToRecipients:s.default.shouldEstimateToRecipients(),composeType:s.default.getComposeTypeStringWhenDDTriggered(),hasExternalRecipient:s.default.hasExternalRecipients()}},m.prototype.computeNudgeInstances=function(e){return e.isComposeMessage&&e.scheduledDateTime&&e.insightData&&!e.isDelayDeliveryCancelled?this.buildInstances(e):[]},Object.defineProperty(m.prototype,"insightDomain",{get:function(){return a.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"confirmationExpirationInMilliseconds",{get:function(){return i.Constants.oneDay},enumerable:!1,configurable:!0}),m.prototype.buildInstances=function(e){var t=e.shouldDisplayRecipientsTimeZone?s.default.getSortedTimeZoneSupplementList(e.toRecipients,e.userAddressToTimeZoneMap):[],n={RecipientCount:e.toRecipients.length,isEstimatedToRecipients:e.isEstimatedToRecipients,composeType:e.composeType,hasExternalRecipient:e.hasExternalRecipient}
return[{identifier:e.insightData.identifier,insightText:this.getInsightText(e),actionText:this.getActionText(e),suggestedDateTime:e.insightData.suggestedDateTime,scheduledDateTime:e.scheduledDateTime,sortedTimeZoneSupplementList:t,loggingProperties:n}]},m.prototype.getInsightText=function(e){return 0===e.scheduledDateTime.getTime()?e.insightData.insightText:null},m.prototype.getActionText=function(e){return 0===e.scheduledDateTime.getTime()?e.insightData.actionText:null},m)
function m(){return null!==r&&r.apply(this,arguments)||this}t.DelayDeliverySearchContextInsightsComputeBase=g,t.default=g},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedTimeStore=t.ProtectedTimeStoreState=void 0
var r,o=n(0),i=o.__importStar(n(29)),a=o.__importStar(n(15)),s=o.__importDefault(n(3)),u=o.__importStar(n(83)),l=n(5),c=(r=u.DataStreamStoreStateBase,o.__extends(d,r),Object.defineProperty(d.prototype,"isBookingComplete",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isMinLoadTimeComplete",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"error",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"totalDaysBooked",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),o.__decorate([l.doop],d.prototype,"isBookingComplete",null),o.__decorate([l.doop],d.prototype,"isMinLoadTimeComplete",null),o.__decorate([l.doop],d.prototype,"error",null),o.__decorate([l.doop],d.prototype,"totalDaysBooked",null),d=o.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.isBookingComplete(!1),e.error(i.ProtectedTimeErrorTypes.None),e.isMinLoadTimeComplete(!1),e}t.ProtectedTimeStoreState=c
var p,f=(p=u.default,o.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ProtectedTime},enumerable:!1,configurable:!0}),g.prototype.getInitialState=function(){return new c},g.prototype.getStoreLoggingName=function(){return"ProtectedTimeStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return e},g.prototype.processProtectedTimeMinLoadCompleted=function(e,t){return e.isMinLoadTimeComplete(!0)},g.prototype.processProtectedTimeMaxLoadExceeded=function(e,t){return e.isBookingComplete()?e:e.isBookingComplete(!0).totalDaysBooked(null).error(i.ProtectedTimeErrorTypes.LoadTimeExceeded)},g.prototype.processProtectedTimeBookingSucceeded=function(e,t){return e.error()===i.ProtectedTimeErrorTypes.LoadTimeExceeded?e:e.isBookingComplete(!0).totalDaysBooked(t.totalDaysBooked).error(i.ProtectedTimeErrorTypes.None)},g.prototype.processProtectedTimeBookingFailed=function(e,t){return e.error()===i.ProtectedTimeErrorTypes.LoadTimeExceeded?e:e.isBookingComplete(!0).totalDaysBooked(null).error(t.error)},g.prototype.processResetProtectedTimeBooking=function(e,t){return new c},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.ProtectedTimeMinLoadCompleted,e.processProtectedTimeMinLoadCompleted),e.addActionCallback(s.default.ProtectedTimeMaxLoadExceeded,e.processProtectedTimeMaxLoadExceeded),e.addActionCallback(s.default.BookingProtectedTimeSucceeded,e.processProtectedTimeBookingSucceeded),e.addActionCallback(s.default.BookingProtectedTimeFailed,e.processProtectedTimeBookingFailed),e.addActionCallback(s.default.ResetProtectedTimeBooking,e.processResetProtectedTimeBooking),e}t.ProtectedTimeStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),u=r.__importDefault(n(24)),l=r.__importDefault(n(59)),o=(i.getWeeklySlotsFromActionItems=function(e,t){var n=this.getGroupedCalendarActionItemsByDate(e,t),r=n[0],o=n[1]
return o===Number.MAX_VALUE?{}:this.getWeeklySlotsFromDailySlots([r,o])},i.getGroupedCalendarActionItemsByDate=function(e,o){var i=this,a={},s=Number.MAX_VALUE
return e.forEach(function(e){var t=u.default.startOfDay(new Date(e.StartTimeInUtc)).getTime(),n=a[t]||[],r=i.getCalendarItemFromAction(e)
l.default.isSlotIncluded(o,r)&&n.push(r),a[t]=n,s=Math.min(s,t)}),[a,s]},i.getWeeklySlotsFromDailySlots=function(e){var r=e[0],t=e[1],o=u.default.startOfCurrentWeek(new Date(t)),n=u.default.getStartOfNWeeksAhead(new Date(t),4),i={},a=u.default.startOfCurrentWeek(new Date),s=!1
for(u.default.isSameDay(o,a)&&(s=!0);o<=n;)!function(){var n=u.default.startOfNextWeek(o),e=Object.keys(r).filter(function(e){var t=Number(e)
return o.getTime()<=t&&n.getTime()>t})
e.sort()
var t={}
e.forEach(function(e){t[Number(e)]=r[e]}),0<Object.keys(t).length&&(i[o.getTime()]={dailySlotsInAWeek:t},i[o.getTime()].IsThisWeek=s),o=n,s=!1}()
return i},i.getCalendarItemFromAction=function(e){return{startDate:new Date(e.StartTimeInUtc),endDate:new Date(e.EndTimeInUtc),action:e}},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LunchTimeSettingsContainerStore=t.LunchTimeSettingsContainerStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importStar(n(83)),u=n(5),l=(r=s.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"isAwaitingServerResponse",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"lunchStartMinute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"lunchEndMinute",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isCheckboxChecked",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"isInEditMode",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],c.prototype,"isAwaitingServerResponse",null),o.__decorate([u.doop],c.prototype,"lunchStartMinute",null),o.__decorate([u.doop],c.prototype,"lunchEndMinute",null),o.__decorate([u.doop],c.prototype,"isCheckboxChecked",null),o.__decorate([u.doop],c.prototype,"isInEditMode",null),c=o.__decorate([u.doop],c))
function c(){var e=r.call(this)||this
return e.isAwaitingServerResponse(!1),e.lunchStartMinute(null),e.lunchEndMinute(null),e.isCheckboxChecked(null),e}t.LunchTimeSettingsContainerStoreState=l
var d,p=(d=s.default,o.__extends(f,d),Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.LunchTimeSettings},enumerable:!1,configurable:!0}),f.prototype.getInitialState=function(){return new l},f.prototype.getStoreLoggingName=function(){return"LunchTimeSettingsCardStore"},f.prototype.setStateForItemChangedEvent=function(e,t){return e},f.prototype.processEditLunchTime=function(e,t){return e.lunchStartMinute(t.startMinute).lunchEndMinute(t.endMinute)},f.prototype.processEditCheckboxState=function(e,t){return e.isCheckboxChecked(t.isChecked)},f.prototype.processWaitingForRequest=function(e){return e.isAwaitingServerResponse(!0)},f.prototype.processReceivedResponse=function(e){return e.isAwaitingServerResponse(!1).isInEditMode(!1).isCheckboxChecked(null).lunchStartMinute(null).lunchEndMinute(null)},f.prototype.processEditModeChanged=function(e,t){return e.isInEditMode(t.isEditing)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(a.default.EditLunchTime,e.processEditLunchTime),e.addActionCallback(a.default.EditLunchCheckbox,e.processEditCheckboxState),e.addActionCallback(a.default.WaitingForResponse,e.processWaitingForRequest),e.addActionCallback(a.default.ResponseReceived,e.processReceivedResponse),e.addActionCallback(a.default.LunchTimeEditModeChanged,e.processEditModeChanged),e}t.LunchTimeSettingsContainerStore=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkContactsStore=t.NetworkContactsState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(42)),l=n(5),c=(r=u.CachedDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"activeNetworkContacts",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isGetActiveContactsSuccess",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.toJSON=function(){return{activeNetworkContacts:this.activeNetworkContacts(),isGetActiveContactsSuccess:this.isGetActiveContactsSuccess()}},d.prototype.fromJSON=function(e){return(new o).activeNetworkContacts(e.activeNetworkContacts).isGetActiveContactsSuccess(e.isGetActiveContactsSuccess)},i.__decorate([l.doop],d.prototype,"activeNetworkContacts",null),i.__decorate([l.doop],d.prototype,"isGetActiveContactsSuccess",null),d=o=i.__decorate([l.doop],d))
function d(){var e=r.call(this)||this
return e.activeNetworkContacts([]),e.isGetActiveContactsSuccess(!0),e}t.NetworkContactsState=c
var p,f=(p=u.default,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"NetworkContactsStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.NetworkContacts},enumerable:!1,configurable:!0}),g.prototype.processGetActiveContacts=function(e,t){return e.activeNetworkContacts(t.activeContacts).isGetActiveContactsSuccess(!0)},g.prototype.updateGetActiveContactsStatus=function(e,t){return e.isGetActiveContactsSuccess(t.isSuccess)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetActiveContacts,e.processGetActiveContacts),e.addActionCallback(s.default.UpdateGetActiveContactsStatus,e.updateGetActiveContactsStatus),e}t.NetworkContactsStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(58),o=(i.checkIfTimeAwayAndAutoReplyRangeMatch=function(e,t,n){return!!e&&!!t&&!!n&&n.status===r.AutomaticRepliesSettingStatus.Scheduled&&n.scheduledStartDateTime.getTime()===e.getTime()&&n.scheduledEndDateTime.getTime()===t.getTime()},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryAdvertComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(31)),a=o.__importDefault(n(64)),s=o.__importDefault(n(8)),u=n(7),l=o.__importDefault(n(149)),c=(r=i.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[a.default]},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{isAutoDelayDeliveryOptedIn:a.default.getState().isAutoDelayDeliveryOptedIn(),isOutlookNotificationEnabled:a.default.getState().isOutlookNotificationsEnabled(),hasP1License:a.default.hasP1License()}},d.prototype.computeInsightInstances=function(e){return!1===e.isAutoDelayDeliveryOptedIn&&l.default.qualifyLicensesCheck(e.hasP1License)?[{identifier:{primaryId:this.insightName()+"Identifier"},isOutlookNotificationEnabled:e.isOutlookNotificationEnabled}]:[]},Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return s.default.areFeedInsightsEnabled&&s.default.hasDelayDeliveryPrerequisites},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"dismissExpirationInMilliseconds",{get:function(){return u.Constants.oneSecondInMilliseconds},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.DelayDeliveryAdvertComputeBase=c,t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarRegister=void 0
var r=n(0),o=n(7),i=r.__importDefault(n(25)),a=r.__importDefault(n(305)),s=r.__importDefault(n(8)),u=r.__importDefault(n(4)),l=n(365),c=n(13),d=r.__importDefault(n(401)),p=r.__importDefault(n(64)),f=r.__importStar(n(171)),g=n(276),m=r.__importDefault(n(1014)),h=r.__importDefault(n(196)),y=r.__importDefault(n(548)),_=(Object.defineProperty(S.prototype,"storesToObserve",{get:function(){return[d.default,p.default,h.default]},enumerable:!1,configurable:!0}),S.prototype.registerStoreObserversAndActivate=function(){s.default.shouldRenderInfobars&&!this.storeListener&&(this.storeListener=new a.default(this.onStateChange.bind(this),this.calculateState.bind(this),this.storesToObserve))},S.prototype.disposeStoreObservers=function(){this.storeListener&&(this.storeListener.dispose(),this.storeListener=null)},S.prototype.dismissTrackEmailInsight=function(){var e
Office.context.mailbox.item.internetHeaders.setAsync(((e={})[o.Constants.trackEmailHeaderKey]="false",e))},S.prototype.calculateState=function(t){var e,n=d.default.getState().insights()
t&&void 0!==t.lockedInfobarName&&(e=t.lockedInfobarName,n=n.filter(function(e){return e.insightName===t.lockedInfobarName}))
var r=this.getInfobarWithHighestPriority(n)
r&&(e=r.insightName)
var o=!1
return t&&!t.isInfobarDismissed&&h.default.getState().isInfobarDismissed()&&r.insightName===c.InsightName.TrackEmail&&(o=!0),{insightWithInfobar:r,isOutlookNotificationsEnabled:p.default.getState().isOutlookNotificationsEnabled(),lockedInfobarName:e,isInfobarDismissed:h.default.getState().isInfobarDismissed(),shouldDismissTrackEmailInsight:o}},S.prototype.onStateChange=function(n){return r.__awaiter(this,void 0,void 0,function(){var t
return r.__generator(this,function(e){switch(e.label){case 0:return n.isInfobarDismissed?(n.shouldDismissTrackEmailInsight&&this.dismissTrackEmailInsight(),[2]):!0!==n.isOutlookNotificationsEnabled?[2]:s.default.isInfobarUpdatableFromVertical?[4,f.default.getSessionData(f.SessionDataKeys.IsInfobarControlTakenByVertical)]:[3,2]
case 1:if(t=e.sent(),i.default.isInBackgroundMode){if(!0===t)return[2]}else if(!0!==t)return[2]
e.label=2
case 2:return[4,m.default.updateInfobar(n.insightWithInfobar)]
case 3:return e.sent(),[2]}})})},S.prototype.getInfobarWithHighestPriority=function(e){var t=this
if(0!==e.length){var n=e.map(function(e){return{infobar:e,priority:t.getInfobarPriority(e.insightName)}}).filter(function(e){return void 0!==e.priority}).sort(function(e,t){return e.priority-t.priority}).map(function(e){return e.infobar})
return 0<n.length?n[0]:void 0}},S.prototype.getInfobarPriority=function(e){var t=y.default.getCommandIdByCurrentItem()
switch(t){case l.CommandId.AppointmentOrganizer:return this.getInfobarPriorityForAppointmentOrganizer(e)
case l.CommandId.MessageCompose:return this.getInfobarPriorityForMessageCompose(e)
default:return void u.default.logAssert("Unexpected CommandId "+t,g.InfobarConstants.InfobarFeatureName,"getInfobarPriority")}},S.prototype.getInfobarPriorityForAppointmentOrganizer=function(e){switch(e){case c.InsightName.DetectOOFComposingInfobar:return 0
case c.InsightName.MeetingPreparationInfobar:return 1
case c.InsightName.ShortenMeeting:return 2
case c.InsightName.PeopleCatchUpItems:return 3
default:return void u.default.logAssert("Unexpected insightName "+c.InsightName[e]+" for an infobar",g.InfobarConstants.InfobarFeatureName,"getInfobarPriorityForAppointmentOrganizer")}},S.prototype.getInfobarPriorityForMessageCompose=function(e){switch(e){case c.InsightName.AutoDelayDeliveryInfobar:return 0
case c.InsightName.SuggestedDelayDeliveryInfobar:return 1
case c.InsightName.ScheduledDelayDeliveryInfobar:return 2
case c.InsightName.DetectOOFComposingInfobar:return 3
case c.InsightName.TrackEmail:return 4
case c.InsightName.PeopleCatchUpItems:return 5
default:return void u.default.logAssert("Unexpected insightName "+e+" for an infobar",g.InfobarConstants.InfobarFeatureName,"getInfobarPriorityForMessageCompose")}},S)
function S(){}t.InfobarRegister=_,t.default=new _},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalContextActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(1015)),a=r.__importDefault(n(37)),s=r.__importDefault(n(11)),u=r.__importDefault(n(544)),l=r.__importDefault(n(54)),c=r.__importDefault(n(4)),d=r.__importDefault(n(27)),p=r.__importDefault(n(62)),f=r.__importDefault(n(57)),g=r.__importDefault(n(6)),m=n(13),h=r.__importDefault(n(8)),y=r.__importDefault(n(547)),_=(S.prototype.getInfobarContext=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return a.default.getState().isCompose()&&h.default.areInfobarComputesEnabled?[2,this.getInfobarContextWithSuccessCallback(this.processGetInfobarContext.bind(this))]:[2]})})},S.prototype.updateInfobarIdentifier=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,this.getInfobarContextWithSuccessCallback(this.processUpdateInfobarIdentifier.bind(this))]})})},S.prototype.getActionableMessageContext=function(t){return r.__awaiter(this,void 0,void 0,function(){var o=this
return r.__generator(this,function(e){switch(e.label){case 0:return[4,t]
case 1:return e.sent(),a.default.getState().isReading()&&l.default.doesSupportActionableMessage&&Office.context.mailbox.item.getInitializationContextAsync?[2,new Promise(function(n,r){Office.context.mailbox.item.getInitializationContextAsync(function(e){if(e.status===Office.AsyncResultStatus.Failed)return c.default.logAssert(JSON.stringify(e.error),o.FEATURE_NAME,"getActionableMessageContext"),r(e.error)
try{return e.value&&i.default.processActionableMessageContext(e.value),n()}catch(e){var t="Failed to parse actionable message context with exception: "+JSON.stringify(e)
return c.default.logAssert(t,o.FEATURE_NAME,"getActionableMessageContext"),r(new Error(t))}})})]:[2]}})})},S.prototype.getInfobarContextWithSuccessCallback=function(a){var s=this
return new Promise(function(o,i){Office.context.mailbox.item.notificationMessages.getAllAsync(function(e){if(e.status===Office.AsyncResultStatus.Failed)return c.default.logAssert("Action failed with error: "+e.error.message,s.FEATURE_NAME,"getInfobarContext"),i(e.error)
try{var t,n=e.value
return 0<n.length&&(t=JSON.parse(n[0].action.contextData,g.default.dateReviver),a(t)),o()}catch(e){var r="Parsing infobar fails with exception: "+JSON.stringify(e)
return c.default.logAssert(r,s.FEATURE_NAME,"getInfobarContext"),i(new Error(r))}})})},S.prototype.processGetInfobarContext=function(e){!p.default.isFlightsDataReady()&&e.userFlights&&s.default.dispatch({actionType:o.default.GetUserFlightsFromExternalContext,userFlightsMap:e.userFlights}),s.default.dispatch({actionType:o.default.HasLoadedFromExternalContext}),f.default.sessionGuid=e.sessionGuid,f.default.startTimeFromExternal=e.sessionStartTime,p.default.isFlightsDataReady()&&s.default.dispatch({actionType:o.default.GetInfobarContext,infobarContextData:e})
var t=y.default.infobarToExternalContextLoggingProperties(e.infobarIdentifier.insightName)
u.default.logExternalContextClickEvent("Infobar",e.infobarIdentifier.insightName,void 0,t)
var n=this.getInfobarIdentifierFromContext(e)
f.default.externalInsightIdentifier=n,d.default.goToDetailsContainer(n)},S.prototype.getInfobarIdentifierFromContext=function(e){return e.infobarIdentifier.insightName===m.InsightName.DetectOOFComposingInfobar?{insightName:m.InsightName.TimeAwayRollup,identifier:{primaryId:m.InsightName.TimeAwayRollup}}:e.infobarIdentifier},S.prototype.processUpdateInfobarIdentifier=function(e){s.default.dispatch({actionType:o.default.UpdateInfobar,infobarIdentifier:e.infobarIdentifier})},S)
function S(){this.FEATURE_NAME="ExternalContextActionCreator"}t.ExternalContextActionCreator=_,t.default=new _},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var s=n(0),u=s.__importDefault(n(4)),r=(o.logExternalContextClickEvent=function(e,t,n,r){function o(){var e=s.__assign({insightType:t},r)
return n?s.__assign(s.__assign({},e),{messageType:n}):e}void 0===r&&(r={}),u.default.logClick("LoadTaskPane",{getFeatureNameForLogging:function(){return e},getRegionNameForLogging:function(){return"BootLoader"},getClickEventLoggingProperties:o,getLoadEventLoggingProperties:o})},o.logFeedbackClickEvent=function(e,t,n,r,o){void 0===o&&(o={})
var i="InvalidInsight"
function a(){var e=s.__assign({insightType:i},o)
return r?s.__assign(s.__assign({},e),{messageType:r}):e}null!=e&&(i=e),u.default.logClick("LoadSettingsContainer",{getFeatureNameForLogging:function(){return t},getRegionNameForLogging:function(){return n},getClickEventLoggingProperties:a,getLoadEventLoggingProperties:a})},o.logDigestFeedbackClickEvent=function(e,t,n){function r(){return{id:e.id,source:e.source,templateName:e.templateName}}u.default.logClick("LoadFeedbackContainer",{getFeatureNameForLogging:function(){return t},getRegionNameForLogging:function(){return n},getClickEventLoggingProperties:r,getLoadEventLoggingProperties:r})},o)
function o(){}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeActionableMessageConverterBase=void 0
var r,o=n(0),i=n(155),a=o.__importStar(n(6)),s=o.__importDefault(n(104)),u=n(34),l=(r=i.ActionableMessageConverterBase,o.__extends(c,r),c.prototype.additionalDependency=function(n){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return 0===n.freeBlocks.length?[2,Promise.resolve()]:(t=a.default.sortArrayOnKey(n.freeBlocks,function(e){return e.endDate},a.OrderBy.Descending)[0],[4,s.default.getUserSchedule(new Date,t.endDate,u.RequestPriority.High)])
case 1:return[2,e.sent()]}})})},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.FocusTimeActionableMessageConverterBase=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsInContextActionableMessageConverter_V2=void 0
var r=n(0).__importDefault(n(75)),o=(i.prototype.convertToRuntimeInsight=function(e){return r.default.convertObservation(e.Insight.Inference.Observations,"MessageStatistics")},i)
function i(){}t.SentMailStatsInContextActionableMessageConverter_V2=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(37)),u=r.__importDefault(n(1035)),l=r.__importDefault(n(2)),c=r.__importDefault(n(4)),i=r.__importDefault(n(93)),a=r.__importDefault(n(179)),s=r.__importDefault(n(207)),d=r.__importDefault(n(242)),p=r.__importDefault(n(204)),f=r.__importDefault(n(1036)),g=r.__importDefault(n(154)),m=r.__importDefault(n(196)),h=r.__importDefault(n(176)),y=r.__importDefault(n(403)),_=n(13),S=r.__importDefault(n(294)),T=r.__importDefault(n(8)),I=(b.mapToInfobarProperties=function(e){switch(e.insightName){case _.InsightName.AutoDelayDeliveryInfobar:case _.InsightName.SuggestedDelayDeliveryInfobar:return y.default.getDelayDeliveryInfobarProperties(e)
case _.InsightName.ScheduledDelayDeliveryInfobar:var t=e.instanceData
return{message:y.default.getScheduledDelayDeliveryInfobarMessage(t.scheduledDateTime),actionText:l.default.SCHEDULED_DELAY_DELIVERY_INFOBAR_ACTION(),doNotWrapActionText:!0}
case _.InsightName.DetectOOFComposingInfobar:var n=e.instanceData
return{message:n.insightText,actionText:n.actionText}
case _.InsightName.ShortenMeeting:var r=f.default.getInfobarMessage(e.instanceData)
return r?{message:r,actionText:l.default.SHORTEN_MEETING_ACTION_TEXT()}:void 0
case _.InsightName.TrackEmail:return{message:l.default.TRACK_THIS_EMAIL_INFOBAR_V2(),actionText:l.default.TRACK_THIS_EMAIL_ACTION()}
case _.InsightName.MeetingPreparationInfobar:var o=e.instanceData
return{message:o.insightText,actionText:o.actionText}
case _.InsightName.PeopleCatchUpItems:var i=e.instanceData,a=i.targetPerson,s=u.default.getMessageAndActionText(i.followUpInsights.length,i.taskInsights.length,a.name)
return{message:s[0],actionText:s[1]}
default:return void c.default.logAssert("Not a valid insightName: ["+e.insightName+"] for an infobar",this.LOG_FEATURE_NAME,"registerInfobar")}},b.mapToLoggingProperties=function(e){var t
return e.insightName===_.InsightName.SuggestedDelayDeliveryInfobar||e.insightName===_.InsightName.AutoDelayDeliveryInfobar?(t=e.instanceData).loggingProperties:e.insightName===_.InsightName.TrackEmail&&T.default.isExtendedSentMailStatsEnabled&&(t=e.instanceData).isEligibleForExtendedStatistics?{hasExtendedStatistics:t.isEligibleForExtendedStatistics}:{}},b.mapStoreNameToDataStreamState=function(e){switch(e){case h.default.getStoreLoggingName():return h.default.getState().toJSON()
case i.default.getStoreLoggingName():return i.default.getState().toJSON()
case a.default.getStoreLoggingName():return a.default.getState().toJSON()
case m.default.getStoreLoggingName():return m.default.getState().toJSON()
case o.default.getStoreLoggingName():case S.default.getStoreLoggingName():case s.default.getStoreLoggingName():case d.default.getStoreLoggingName():case p.default.getStoreLoggingName():case g.default.getStoreLoggingName():return
default:return void c.default.logAssert("Failed to map un-registered store name "+e+" to DataStreamState",this.LOG_FEATURE_NAME,"mapStoreNameToDataStreamState")}},b.infobarToExternalContextLoggingProperties=function(e){var t
switch(e){case _.InsightName.TrackEmail:var n=T.default.isExtendedSentMailStatsEnabled&&(null===(t=i.default.getState().trackEmailInsight())||void 0===t?void 0:t.isEligibleForExtendedStatistics)
return n?{hasExtendedSentMailStatistics:n}:{}
default:return{}}},b.LOG_FEATURE_NAME="Infobar",b)
function b(){}t.default=I},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(37)),i=r.__importDefault(n(4)),a=n(365),s=n(276),u=(l.getCommandIdByCurrentItem=function(){var e=o.default.getState().currentItem()
if(e)return e.isReading&&e.isMeetingPane?a.CommandId.AppointmentAttendee:e.isReading&&e.isMessagePane?a.CommandId.MessageRead:e.isComposing&&e.isMeetingPane?a.CommandId.AppointmentOrganizer:a.CommandId.MessageCompose
i.default.logAssert("Not a valid currentItem for an infobar",s.InfobarConstants.InfobarFeatureName,"getCommandIdByCurrentItem")},l)
function l(){}t.default=u},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BootActionCreator=void 0
var o=n(0),r=o.__importDefault(n(3)),i=o.__importDefault(n(8)),a=o.__importDefault(n(11)),s=o.__importDefault(n(282)),u=o.__importDefault(n(543)),l=o.__importDefault(n(1037)),c=o.__importDefault(n(1038)),d=o.__importStar(n(116)),p=o.__importDefault(n(1039)),f=o.__importStar(n(4)),g=o.__importDefault(n(497)),m=o.__importDefault(n(1040)),h=o.__importDefault(n(6)),y=n(51),_=n(7),S=o.__importDefault(n(54)),T=o.__importDefault(n(89)),I=o.__importDefault(n(25)),b=o.__importDefault(n(175)),E=o.__importDefault(n(285)),v=(A.prototype.requestInitializationData=function(){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return S.default.doesSupportRestToken?(this.notifyOfficeJSReady(),i.default.isBackgroundAddinEnabled&&T.default.isNewComposeMeeting(),T.default.getMessageId(),[4,d.default.isPersistedStorageEnabled()]):(this.getLocalizationStrings(),[2])
case 1:return e.sent(),this.getRESTCallbackToken(),t=this.getFlights(),this.getLocalizationStrings(),i.default.isBackgroundAddinEnabled?[3,3]:[4,this.loadExternalContext(t)]
case 2:e.sent(),e.label=3
case 3:return p.default.triggerLoad(),[2]}})})},A.prototype.getRESTCallbackToken=function(){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return[4,g.default.getRESTCallbackToken()]
case 1:return(t=e.sent())?a.default.dispatch({actionType:r.default.RESTCallbackTokenReady,token:t}):(b.default.updateDebugMessage("Failed to get REST token at Boot."),f.default.logAssert("Failed to request rest CallbackToken at Boot","BootActionCreator","getRESTCallbackToken")),[2]}})})},A.prototype.refreshRESTCallbackToken=function(){var e=new s.default("App",f.LogEventType.Get,"refreshRESTCallbackToken",f.LogRequestType.Interval)
g.default.getRESTCallbackTokenFromOutlook(e)},A.prototype.getLocalizationStrings=function(){var e
!h.default.LCID||(e=l.default.getSupportedLanguage(h.default.LCID))!==_.Constants.defaultLocation&&c.default.requestResjsonLocStrings({remoteUrl:c.default.rootPath+"/uKoRx7J4Ot0R_mGaIpULbw/LocV2/LCL/"+e+"/LocStrings.resjson",lcId:e,localStorageKey:d.PersistedStorageKeys.LocalizationStrings,actionToDispatch:r.default.GetLocalizationStrings},"requestLocalizationStrings"),c.default.requestResjsonLocStrings({remoteUrl:c.default.rootPath+"/uKoRx7J4Ot0R_mGaIpULbw/LocV2/LocStrings.resjson",lcId:h.default.LCID,localStorageKey:d.PersistedStorageKeys.DefaultStrings,actionToDispatch:r.default.GetDefaultStrings},"requestDefaultLocalizationStrings")},A.prototype.getFlights=function(){return o.__awaiter(this,void 0,void 0,function(){var t,n
return o.__generator(this,function(e){switch(e.label){case 0:return I.default.isInAutoRunJSMode&&E.default.getState().userFlights()?[2]:I.default.isLocalDebugging&&Date.now()%2==0?[4,d.default.tryLoadFromPersistedStorage(d.PersistedStorageKeys.UserFlights_V1)]:[3,2]
case 1:t=e.sent().result,e.label=2
case 2:return n=m.default.getUserFlights(!!t),t?(a.default.dispatch({actionType:r.default.GetUserFlightsFromControlTower,userFlights:t}),[2]):[2,n]}})})},A.prototype.loadExternalContext=function(r){return o.__awaiter(this,void 0,void 0,function(){var t,n
return o.__generator(this,function(e){switch(e.label){case 0:(t=[]).push(u.default.getInfobarContext()),t.push(u.default.getActionableMessageContext(r)),e.label=1
case 1:return e.trys.push([1,3,,4]),[4,Promise.all(t)]
case 2:return e.sent(),[3,4]
case 3:return n=e.sent(),f.default.logAssert("Failed to load Infobar or ActionableMessage with exception: "+n,"BootActionCreator","requestInitializationData"),[3,4]
case 4:return[2]}})})},A.prototype.notifyOfficeJSReady=function(){a.default.dispatch({actionType:r.default.OfficeJSReady})},o.__decorate([y.expirable(y.ExpirationTypes.ByEvery_Minutes,5)],A.prototype,"refreshRESTCallbackToken",null),o.__decorate([y.expirable(y.ExpirationTypes.ByEvery_Minutes,_.Constants.oneDayInMinutes)],A.prototype,"getLocalizationStrings",null),A=o.__decorate([y.expirable()],A))
function A(){}t.BootActionCreator=v,t.default=new v},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserSearchStore=t.UserSearchStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=n(5),u=i.__importStar(n(42)),l=i.__importDefault(n(3)),c=i.__importDefault(n(134)),d=n(404),p=(r=u.CachedDataStreamStateBase,i.__extends(f,r),o=f,Object.defineProperty(f.prototype,"activeSuggestions",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentSearchText",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"showCallout",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"calloutState",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"showAllResults",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"hasMoreSearchResults",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"searchFilters",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),f.prototype.toJSON=function(){return{activeSuggestions:this.activeSuggestions(),currentSearchText:this.currentSearchText(),showCallout:this.showCallout(),calloutState:this.calloutState(),searchFilters:this.searchFilters(),showAllResults:this.showAllResults(),hasMoreSearchResults:this.hasMoreSearchResults()}},f.prototype.fromJSON=function(e){return(new o).activeSuggestions(e.activeSuggestions).currentSearchText(e.currentSearchText).showCallout(e.showCallout).calloutState(e.calloutState).searchFilters(e.searchFilters).showAllResults(e.showAllResults)},i.__decorate([s.doop],f.prototype,"activeSuggestions",null),i.__decorate([s.doop],f.prototype,"currentSearchText",null),i.__decorate([s.doop],f.prototype,"showCallout",null),i.__decorate([s.doop],f.prototype,"calloutState",null),i.__decorate([s.doop],f.prototype,"showAllResults",null),i.__decorate([s.doop],f.prototype,"hasMoreSearchResults",null),i.__decorate([s.doop],f.prototype,"searchFilters",null),f=o=i.__decorate([s.doop],f))
function f(){var e=r.call(this)||this
return e.activeSuggestions([]),e.currentSearchText(""),e.showCallout(!1),e.calloutState(d.CalloutState.None),e.searchFilters([]),e.showAllResults(!1),e.hasMoreSearchResults(!1),e}t.UserSearchStoreState=p
var g,m=(g=u.default,i.__extends(h,g),Object.defineProperty(h.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.UserSearch},enumerable:!1,configurable:!0}),h.prototype.getStoreLoggingName=function(){return"UserSearchStore"},h.prototype.getInitialState=function(){return new p},h.prototype.setStateForItemChangedEvent=function(e,t){return e},h.prototype.userSearchBackfillSuccess=function(e,t){return t.searchText===e.currentSearchText().trim()&&c.default(t.searchFilters,e.searchFilters())?e.activeSuggestions(t.activeSuggestions).calloutState(t.hasNoResult?d.CalloutState.NoResult:d.CalloutState.Success).showAllResults(!1).hasMoreSearchResults(t.hasMoreResults):e},h.prototype.showAllSearchResults=function(e,t){return t.searchText===e.currentSearchText().trim()&&c.default(t.searchFilters,e.searchFilters())?e.activeSuggestions(t.activeSuggestions).showAllResults(!0).calloutState(t.hasNoResult?d.CalloutState.NoResult:d.CalloutState.Success):e},h.prototype.clearUserSearchStore=function(e,t){return new p},h.prototype.updateCurrentUserSearch=function(e,t){return(new p).searchFilters(t.searchFilters).currentSearchText(t.searchText)},h.prototype.userSearchCalloutStateChange=function(e,t){return e.calloutState(t.calloutState)},h.prototype.updateUserSearchCalloutVisibility=function(e,t){return e.showCallout(t.showCallout)},h)
function h(){var e=g.call(this)||this
return e.addActionCallback(l.default.UserSearchBackfill,e.userSearchBackfillSuccess),e.addActionCallback(l.default.ShowAllSearchResult,e.showAllSearchResults),e.addActionCallback(l.default.CurrentUserSearch,e.updateCurrentUserSearch),e.addActionCallback(l.default.UserSearchCalloutStateChange,e.userSearchCalloutStateChange),e.addActionCallback(l.default.ClearUserSearchStore,e.clearUserSearchStore),e.addActionCallback(l.default.UpdateUserSearchCalloutVisibility,e.updateUserSearchCalloutVisibility),e}t.UserSearchStore=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpRequestEntitiesStore=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=o.__importDefault(n(508)),s=n(5),u=(r=a.default,o.__extends(l,r),l.prototype.getStoreLoggingName=function(){return"FollowUpRequestEntitiesStore"},l.prototype.actionValueToUpsertExtractedEntities=function(){return i.default.UpsertExtractedFollowUpRequests},l.prototype.actionValueToUpsertEntityIdsAsDone=function(){return i.default.UpsertFollowUpRequestIdsAsDone},l=o.__decorate([s.doop],l))
function l(){return null!==r&&r.apply(this,arguments)||this}t.FollowUpRequestEntitiesStore=u,t.default=new u},,function(e,t){e.exports="../../tempimages/ac1ab25e84600c770bd8dcd4f2c1ab2e.gif"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(144),i=r.__importDefault(n(4)),a=(Object.defineProperty(s.prototype,"itemId",{get:function(){return this.officeItem.itemId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"internetMessageId",{get:function(){return this.officeItem.internetMessageId},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"senderEmail",{get:function(){var e=this.getItemCreator()
return e&&e.emailAddress||""},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"senderName",{get:function(){var e=this.getItemCreator()
return e&&e.displayName||""},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isComposing",{get:function(){return this.mode===o.Modes.Compose},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isReading",{get:function(){return this.mode===o.Modes.Read},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMeetingPane",{get:function(){return this.itemType===o.ItemTypes.Meeting},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMessagePane",{get:function(){return this.itemType===o.ItemTypes.Message},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMeetingRequestOrResponse",{get:function(){var e=this.officeItem.itemClass
return!!e&&-1!==e.indexOf("IPM.Schedule.Meeting")},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"doesSenderApproximatelyMatchCurrentUser",{get:function(){return this.mode===o.Modes.Read&&this.doesItemsSenderApproximatelyMatchMe()},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"mode",{get:function(){return this.isItemReadMode()?o.Modes.Read:this.isItemComposeMode()?o.Modes.Compose:(i.default.logAssert("Unknown item mode.","CurrentItem","mode"),o.Modes.Unknown)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"itemType",{get:function(){switch(this.officeItem.itemType){case Office.MailboxEnums.ItemType.Message:return o.ItemTypes.Message
case Office.MailboxEnums.ItemType.Appointment:return o.ItemTypes.Meeting
default:return i.default.logAssert("Unknown item type.","CurrentItem","itemType"),o.ItemTypes.Unknown}},enumerable:!1,configurable:!0}),s.prototype.asReadItem=function(){return Office.cast.item.toItemRead(this.officeItem)},s.prototype.asComposeItem=function(){return Office.cast.item.toItemCompose(this.officeItem)},s.prototype.asComposeMessage=function(){return Office.cast.item.toMessageCompose(this.officeItem)},s.prototype.asComposeAppointment=function(){return Office.cast.item.toAppointmentCompose(this.officeItem)},s.prototype.getItemCreator=function(){if(this.mode===o.Modes.Read)return this.itemType===o.ItemTypes.Message?this.getMessageSender():this.itemType===o.ItemTypes.Meeting?this.getMeetingOrganizer():void i.default.logAssert("Item neither Message nor Meeting in Read Mode. No item creator.","CurrentItem","getItemCreator")},s.prototype.doesItemsSenderApproximatelyMatchMe=function(){var e=this.getItemCreator()
return!(!e||void 0===e.emailAddress)&&((""===e.emailAddress||0<=e.emailAddress.toLowerCase().indexOf("/o="))&&e.displayName.toLowerCase()===Office.context.mailbox.userProfile.displayName.toLowerCase()||Office.context.mailbox.userProfile.emailAddress.toLowerCase()===e.emailAddress.toLowerCase())},s.prototype.getMessageSender=function(){return Office.cast.item.toMessageRead(this.officeItem).sender},s.prototype.getMeetingOrganizer=function(){return Office.cast.item.toAppointmentRead(this.officeItem).organizer},s.prototype.isItemComposeMode=function(){return this.canOfficeCastItem(Office.cast.item.toItemCompose)},s.prototype.isItemReadMode=function(){return this.canOfficeCastItem(Office.cast.item.toItemRead)},s.prototype.canOfficeCastItem=function(e){try{return!!e(this.officeItem)}catch(e){}return!1},s)
function s(e){this.officeItem=e}t.default=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RequestStatusActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=(s.prototype.addUnfulfilledRequestToStore=function(e){i.default.dispatchAsync({actionType:o.default.AddUnfulfilledRequest,requestName:e.toTraceString(),uniqueIdentifier:e.requestId()})},s.prototype.removeFulfilledRequestFromStore=function(e){i.default.dispatchAsync({actionType:o.default.RemoveFulfilledRequest,requestName:e.toTraceString(),uniqueIdentifier:e.requestId()})},s)
function s(){}t.RequestStatusActionCreator=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FlexibleRequestQueueBase=void 0
var r=n(0),o=r.__importStar(n(34)),i=r.__importDefault(n(4)),a=(s.prototype.resetQueue=function(){this.queueHigh=[],this.queueNormal=[],this.queueLow=[]},s.prototype.getQueueSize=function(){return this.queueHigh.length+this.queueLow.length+this.queueNormal.length},s.prototype.isQueueEmpty=function(){return 0===this.queueLow.length&&0===this.queueNormal.length&&0===this.queueHigh.length},s.prototype.getPendingCount=function(){return this.concurrentOperation.pendingCount},s.prototype.execute=function(t,n){var r=this
return this.concurrentOperation.isAvailable()&&this.isQueueEmpty()?this.executeInternal(t):new Promise(function(e){r.enqueue(function(){e(r.executeInternal(t))},n)})},s.prototype.executeInternal=function(n){return r.__awaiter(this,void 0,void 0,function(){var t=this
return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.concurrentOperation.onStart()]
case 1:return e.sent(),[2,n().then(function(e){return t.concurrentOperation.onReturned(e),t.executeNextRequest(),e}).catch(function(e){return t.concurrentOperation.onError(),t.executeNextRequest(),i.default.logAssert("Caught exception from promise "+e,"RequestQueueBase","executeInternal"),{status:Office.AsyncResultStatus.Failed,result:null,error:e}})]}})})},s.prototype.executeNextRequest=function(){return r.__awaiter(this,void 0,void 0,function(){var t
return r.__generator(this,function(e){for(t=this.dequeue();t;)t(),t=this.concurrentOperation.isAvailable()?this.dequeue():null
return this.concurrentOperation.isEmpty()&&this.requestCompleteActionCreatorCallback(),[2]})})},s.prototype.dequeue=function(){var e=null
return 0<this.queueHigh.length?e=this.queueHigh.shift():0<this.queueNormal.length?e=this.queueNormal.shift():0<this.queueLow.length&&(e=this.queueLow.shift()),e},s.prototype.enqueue=function(e,t){switch(t){case o.RequestPriority.High:this.queueHigh.push(e)
break
case o.RequestPriority.Normal:this.queueNormal.push(e)
break
case o.RequestPriority.Low:this.queueLow.push(e)
break
default:i.default.logAssert("Unknown priority of request: "+t,"RequestQueue","RequestQueue.enqueue")}},s)
function s(){this.queueLow=[],this.queueNormal=[],this.queueHigh=[]}t.FlexibleRequestQueueBase=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrentOperation=void 0
var r=n(0),o=n(103),i=r.__importDefault(n(4)),a=(Object.defineProperty(s.prototype,"delayUntil",{get:function(){return this._delayUntil},enumerable:!1,configurable:!0}),s.prototype.isAvailable=function(){return this._pending<this._currentLimit},s.prototype.isEmpty=function(){return 0===this._pending},Object.defineProperty(s.prototype,"pendingCount",{get:function(){return this._pending},enumerable:!1,configurable:!0}),s.prototype.onStart=function(){return r.__awaiter(this,void 0,void 0,function(){var t,n=this
return r.__generator(this,function(e){switch(e.label){case 0:this._pending++,t=0,e.label=1
case 1:return this.delayUntil>Date.now()?[4,new Promise(function(e){return setTimeout(e,n.delayUntil-Date.now())})]:[3,3]
case 2:return e.sent(),++t>s.MAX_LIMIT?(i.default.logAssert("Request delayed "+t+" times more than expected.","RequestQueueBase","executeNextRequest"),[2]):[3,1]
case 3:return[2]}})})},s.prototype.onReturned=function(e){var t
this._pending--,null!==(t=e.throttled)&&void 0!==t&&t.isThrottled&&this.onThrottled(e)},s.prototype.onError=function(){this._pending--},s.prototype.onThrottled=function(e){var t,n;(null===(t=e.throttled)||void 0===t?void 0:t.scope)===o.ThrottledScope.Mailbox&&(this._delayUntil=Date.now()+(null===(n=e.throttled)||void 0===n?void 0:n.retryAfterInMilliseconds)),i.default.logWarning("CurrentLimit: "+this._currentLimit+", Error: "+e.error+", ResponseHeaders: "+JSON.stringify(e.throttled),"ConcurrentOperation","onThrottled"),this.decreaseLimit()},s.prototype.reset=function(e){var t
this.setting=e,this._currentLimit=null!==(t=this.setting.defaultLimit)&&void 0!==t?t:1},s.prototype.increaseLimit=function(){this._currentLimit=Math.min(this.setting.maxConcurrent,this._currentLimit+1)},s.prototype.decreaseLimit=function(){this._currentLimit=Math.max(this.setting.minConcurrent,this._currentLimit-1)},s.prototype.validateSetting=function(){this.setting.defaultLimit=this.setting.defaultLimit&&Math.min(this.setting.defaultLimit,s.MAX_LIMIT),this.setting.minConcurrent=Math.min(this.setting.minConcurrent,s.MAX_LIMIT),this.setting.maxConcurrent=Math.min(this.setting.maxConcurrent,s.MAX_LIMIT)},s.MAX_LIMIT=4,s.DEFAULT_LIMIT=1,s)
function s(e){var t
this.setting=e,this._currentLimit=1,this._pending=0,this._delayUntil=0,this.validateSetting(),this._currentLimit=null!==(t=this.setting.defaultLimit)&&void 0!==t?t:s.DEFAULT_LIMIT}t.ConcurrentOperation=a},,,,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EWSRequestPromiseHandler=void 0
var r=n(0),s=n(103),u=r.__importDefault(n(68)),l=r.__importDefault(n(493)),c=r.__importDefault(n(6)),d=r.__importDefault(n(102)),p=n(7),o=(i.prototype.generateRequestPromise=function(i){var a=this
return i.logCreator().ewsStartExecuting(),new Promise(function(o){Office.context.mailbox.makeEwsRequestAsync(i.getSoapEnvelope(),function(e){var t,n={error:c.default.buildErrorMessage(e.error),status:e.status,result:null,sourceRequest:i}
try{if(n.status!==Office.AsyncResultStatus.Succeeded)return
n.result=l.default.parseXML(e.value),(n=a.checkAndSetEWSErrorResponseCode(n)).status===Office.AsyncResultStatus.Failed&&(n.shouldNotRetry=a.isErrorDeterministic(n),n.error===d.default.ERROR_TOO_MANY_OBJECTS_OPENED?n.throttled={isThrottled:!0,scope:s.ThrottledScope.Mailbox,retryAfterInMilliseconds:p.Constants.oneSecondInMilliseconds}:n.error===d.default.ERROR_SERVER_BUSY&&(n.throttled={isThrottled:!0,scope:s.ThrottledScope.Mailbox,retryAfterInMilliseconds:null!==(t=u.default.extractBackOffMilliseconds(n.result))&&void 0!==t?t:p.Constants.oneSecondInMilliseconds}))}catch(e){n.status=Office.AsyncResultStatus.Failed
var r=c.default.scrubXMLFromException(e)
n.error&&n.error!==c.default.NO_ERROR_NAME_OR_MESSAGE_PROVIDED||(n.error="Parsing failed for "+i.toTraceString()+" with exception: "+r)}finally{o(n)}},a)})},i.prototype.checkAndSetEWSErrorResponseCode=function(e){var t=u.default.extractResponseCode(e.result)
return t!==d.default.NO_ERROR&&(e.status=Office.AsyncResultStatus.Failed,e.error=t),e},i.prototype.isErrorDeterministic=function(e){return e.error===d.default.ERROR_FOLDER_EXISTS||e.error===d.default.ERROR_ITEM_NOT_FOUND||e.error===d.default.ERROR_NAME_RESOLUTION_MULTIPLE_RESULTS||e.error===d.default.ERROR_NAME_RESOLUTION_NO_RESULTS},i)
function i(){}t.EWSRequestPromiseHandler=o,t.default=new o},,,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(84),a=n(5),s=(r=i.EWSRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"conversationIds",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:GetConversationItems>\n                <m:ItemShape>\n                    <t:BaseShape>IdOnly</t:BaseShape>\n                    <t:AdditionalProperties>\n                        <t:FieldURI FieldURI="message:Sender" />\n                        <t:FieldURI FieldURI="item:DateTimeSent" />\n                        <t:FieldURI FieldURI="item:ItemClass" />\n                        <t:FieldURI FieldURI="message:ToRecipients" />\n                    </t:AdditionalProperties>\n                </m:ItemShape>\n                <m:FoldersToIgnore>\n                    <t:DistinguishedFolderId Id="deleteditems" />\n                    <t:DistinguishedFolderId Id="drafts" />\n                    <t:DistinguishedFolderId Id="calendar" />\n                </m:FoldersToIgnore>\n                <m:SortOrder>DateOrderDescending</m:SortOrder>\n                <m:Conversations>\n                    '+this.generateConversationsSOAPElement()+"\n                </m:Conversations>\n            </m:GetConversationItems>"},u.prototype.generateConversationsSOAPElement=function(){return this.conversationIds().map(function(e){return'<t:Conversation>\n                            <t:ConversationId Id="'+e+'" />\n                        </t:Conversation>'}).join("")},u.prototype.toTraceString=function(){return"GetConversationItemsRequest"},o.__decorate([a.doop],u.prototype,"conversationIds",null),u=o.__decorate([a.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(63),u=(o=s.RESTRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/getMailTips"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"emailAddresses",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"mailTipsOptions",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{EmailAddresses:this.emailAddresses(),MailTipsOptions:this.mailTipsOptions()}},r.__decorate([i.doop],l.prototype,"emailAddresses",null),r.__decorate([i.doop],l.prototype,"mailTipsOptions",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=r.__importDefault(n(495)),i=(a=o.default,r.__extends(s,a),s.prototype.restStartExecuting=function(){a.prototype.startExecuting.call(this)},s)
function s(e,t,n,r,o,i){return a.call(this,e,t,n,r,i,o)||this}t.default=i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=r.__importDefault(n(807)),a=(i=o.default,r.__extends(s,i),s)
function s(e,t,n,r){var o=i.call(this,e,t,r)||this
return n&&i.prototype.addQueryParams.call(o,n,function(e){return"$"+e}),o}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(265)),a=(o=i.default,r.__extends(s,o),s.prototype.addQueryParams=function(t,n){var r=this
Object.keys(t).forEach(function(e){return t[e]&&r.addQueryParam(r.getKey(e,n),t[e])})},s.prototype.getKey=function(e,t){return t?t(e):e},s)
function s(e,t,n){var r=o.call(this,e+"/"+t)||this
return n&&r.addQueryParams(n),r}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(496),a=n(5),s=n(16),u=(r=i.BatchRequestBase,o.__extends(l,r),l=o.__decorate([a.doop],l))
function l(e,t,n){return r.call(this,s.HTTPRequestMethod.POST,"BatchRequest",e,t,n)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(498),a=(r=i.PersistedStorageBase,o.__extends(s,r),s.prototype.isEnabled=function(){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t="__storage_test__",[4,OfficeRuntime.storage.setItem(t,t)]
case 1:return e.sent(),[4,OfficeRuntime.storage.removeItem(t)]
case 2:return e.sent(),[2,!0]
case 3:return e.sent(),[2,!1]
case 4:return[2]}})})},s.prototype.clear=function(){return o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return[4,OfficeRuntime.storage.getKeys()]
case 1:return t=e.sent(),[2,OfficeRuntime.storage.removeItems(t)]}})})},s)
function s(){return r.call(this,OfficeRuntime.storage)||this}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(498),a=(r=i.PersistedStorageBase,o.__extends(s,r),s.prototype.isEnabled=function(){try{var e="__storage_test__"
return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&localStorage&&0!==localStorage.length}},s.prototype.clear=function(){return localStorage.clear()},s)
function s(){return r.call(this,localStorage)||this}t.default=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(496),a=n(5),s=n(16),u=r.__importDefault(n(378)),l=r.__importDefault(n(200)),c=(o=i.BatchRequestBase,r.__extends(d,o),Object.defineProperty(d.prototype,"version",{get:function(){return"v1.0"},enumerable:!1,configurable:!0}),d=r.__decorate([a.doop],d))
function d(e,t,n){var r=o.call(this,s.HTTPRequestMethod.POST,"WESBatchRequest",e,t,n)||this
return r.headers(u.default.getInitialWESHeaders(r.headers())),r.baseUrl(l.default.wesBaseUrl),r}t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BatchRequestPromiseHandler=void 0
var r=n(0),i=n(813),o=(a.prototype.generateRequestPromise=function(o,t){var n=this
return new Promise(function(r){var e
o.logCreator().startExecuting(),o.requests().forEach(function(e){return e.logCreator().startExecuting()}),o.hasExpired()?(e=n.defaultResponseForExpiredRequest(o),o.logCreator().unexpectedFail(e.error),r(e)):i.request(n.serialize(t),function(e,t){var n={error:"",status:Office.AsyncResultStatus.Succeeded,result:e,sourceRequest:o,responseStatusCode:t.statusCode}
o.logCreator().success(),r(n)},function(e){var t=e.response,n={error:t.body,status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:o,responseStatusCode:t.statusCode}
o.logCreator().unexpectedFail(t.statusText,String(t.statusCode)),r(n)},i.batchHandler)})},a.prototype.defaultResponseForExpiredRequest=function(e){return{error:"Request expired before execution",status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:e,responseStatusCode:504}},a.prototype.serialize=function(e){return r.__assign(r.__assign({},e),{requestUri:e.requestUri.toString(),method:e.method})},a)
function a(){}t.BatchRequestPromiseHandler=o,t.default=new o},function(ya,_a,Sa){var Ta,Ia
!function(U,x){var B=U.datajs||{},p=U.OData||{};(Ia="function"==typeof(Ta=B)?Ta.call(_a,Sa,_a,ya):Ta)===x||(ya.exports=Ia),(Ia="function"==typeof(Ta=p)?Ta.call(_a,Sa,_a,ya):Ta)===x||(ya.exports=Ia),B.version={major:1,minor:1,build:1}
function t(e){return U.ActiveXObject?new U.ActiveXObject(e):null}function j(e){return null!==e&&e!==x}function c(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0
return!1}function T(e,t){return e!==x?e:t}function G(e){var t
1!==arguments.length?(t=Array.prototype.slice.call(arguments,1),U.setTimeout(function(){e.apply(this,t)},0)):U.setTimeout(e,0)}function H(e,t){for(var n in t)e[n]=t[n]
return e}function b(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return e[n]
return null}function O(e){return"[object Array]"===Object.prototype.toString.call(e)}function u(e){return"[object Date]"===Object.prototype.toString.call(e)}function a(e){return"object"==typeof e}function q(e){return parseInt(e,10)}function I(e,t,n){e.hasOwnProperty(t)&&(e[n]=e[t],delete e[t])}function e(e){throw e}function s(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function W(e,t){return e!==x?e:t}function d(e){var t={isAbsolute:!1}
if(e){var n=i.exec(e)
if(n)for(var r=0,o=M.length;r<o;r++)n[r+1]&&(t[M[r]]=n[r+1])
t.scheme&&(t.isAbsolute=!0)}return t}function f(e){return"".concat(e.scheme||"",e.authority||"",e.path||"",e.query||"",e.fragment||"")}function E(e,t){if(!t)return e
var n=d(e)
if(n.isAbsolute)return e
var r,o=d(t),i={}
return n.authority?(i.authority=n.authority,r=n.path,i.query=n.query):(n.path?(r="/"===n.path.charAt(0)?n.path:k(n.path,o.path),i.query=n.query):(r=o.path,i.query=n.query||o.query),i.authority=o.authority),i.path=w(r),i.scheme=o.scheme,i.fragment=n.fragment,f(i)}function n(e,t,n){try{e.setProperty(t,n)}catch(e){}}function g(){try{var e=t("Msxml2.DOMDocument.6.0")
return e&&(e.async=!0),e}catch(e){return function(){var e=t("Msxml2.DOMDocument.3.0")
return e&&(n(e,"ProhibitDTD",!0),n(e,"MaxElementDepth",256),n(e,"AllowDocumentFunction",!1),n(e,"AllowXsltScript",!1)),e}()}}function m(t){var e,n=U.DOMParser&&new U.DOMParser
if(!n)return(e=function(e){var t=g()
if(!t)return null
t.loadXML(e)
var n=t.parseError
return 0!==n.errorCode&&Q(n.reason,n.srcText,e),t}(t))||Q("XML DOM parser not supported"),e
try{e=n.parseFromString(t,"text/xml")}catch(e){Q(e,"",t)}var r,o,i=e.documentElement,a=i.namespaceURI,s=oe(i)
if("parsererror"===s&&a===z&&(o=(r=ee(i,z,"sourcetext"))?ae(r):"",Q(re(i)||"",o,t)),"h3"===s&&a===J||te(i,J,"h3")){for(var u="",l=[],c=i.firstChild;c;)1===c.nodeType&&(u+=re(c)||""),l.push(c.nextSibling),c=c.firstChild||l.shift()
u+=re(i)||"",Q(u,"",t)}return e}function h(e,t){return e?e+":"+t:t}function y(e,t){for(var n=e.attributes,r=0,o=n.length;r<o;r++)t(n.item(r))}function _(e,t){var n=$(e,"base",X)
return(n?E(n.value,t):t)||null}function S(e,t){se(e,!1,function(e){return 1===e.nodeType&&t(e),!0})}function v(e,t,n){for(var r=n.split("/"),o=0,i=r.length;o<i;o++)e=e&&ee(e,t,r[o])
return e||null}function l(){var e=U.document.implementation
return e&&e.createDocument?e.createDocument(null,null,null):g()}function A(e,t){if(!O(t))return ue(e,t)
for(var n=0,r=t.length;n<r;n++)t[n]&&ue(e,t[n])
return e}function D(e,t,n,r){var o=e.createElementNS&&e.createElementNS(t,n)||e.createNode(1,n,t||x)
return A(o,r||[])}function C(e,t,n){return le(e,Y,h("xmlns",n),t)}function R(e){var t=U.XMLSerializer
if(t)return(new t).serializeToString(e)
if(e.xml)return e.xml
throw{message:"XML serialization unsupported"}}function V(){this._arguments=x,this._done=x,this._fail=x,this._resolved=!1,this._rejected=!1}var i=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,M=["scheme","authority","path","query","fragment"],P=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,N=/%[0-9A-F]{2}/gi,k=function(e,t){var n,r="/"
return t&&(n=t.lastIndexOf("/"),"/"!==(r=t.substring(0,n)).charAt(r.length-1)&&(r+="/")),r+e},w=function(e){for(var t,n="",r="";e;)0===e.indexOf("..")||0===e.indexOf(".")?e=e.replace(/^\.\.?\/?/g,""):0===e.indexOf("/..")?(e=e.replace(/^\/\..\/?/g,"/"),n=-1===(t=n.lastIndexOf("/"))?"":n.substring(0,t)):e=0===e.indexOf("/.")?e.replace(/^\/\.\/?/g,"/"):(-1!==(t=(r=e).indexOf("/",1))&&(r=e.substring(0,t)),n+=r,e.replace(r,""))
return n},F=function(e){for(var t="",n=0;n<e.length;n++){var r=L(e[n]),o=""
null!==r&&(o=r.toString(2),t+=K(o))}for(var i=[],a=parseInt(t.length/8,10),n=0;n<a;n++){var s=parseInt(t.substring(8*n,8*(n+1)),2)
i.push(s)}return i},L=function(e){var t=e.charCodeAt(0)
return 65<=t&&t<=90?t-65:97<=t&&t<=122?t-65-6:48<=t&&t<=57?t+4:"+"==e?62:"/"==e?63:null},K=function(e){for(;e.length<6;)e="0"+e
return e},r="http://",o=r+"www.w3.org/",J=o+"1999/xhtml",Y=o+"2000/xmlns/",X=o+"XML/1998/namespace",z=r+"www.mozilla.org/newlayout/xml/parsererror.xml",Q=function(e,t,n){throw"string"==typeof e&&(e={message:e}),H(e,{srcText:t||"",errorXmlText:n||""})},Z=function(e,t,n){var r=$(e,t,n)
return r?ae(r):null},$=function(e,t,n){var r=e.attributes
return r.getNamedItemNS?r.getNamedItemNS(n||null,t):r.getQualifiedItem(t,n)||null},ee=function(e,t,n){return ne(e,t,n,!1)},te=function(e,t,n){if(e.getElementsByTagNameNS){var r=e.getElementsByTagNameNS(t,n)
return 0<r.length?r[0]:null}return ne(e,t,n,!0)},ne=function(e,r,o,t){var i=null
return se(e,t,function(e){var t,n
return 1===e.nodeType&&(t=!r||ie(e)===r,n=!o||oe(e)===o,t&&n&&(i=e)),null===i}),i},re=function(e){var o,i=null,a=9===e.nodeType&&e.documentElement?e.documentElement:e,s=!1===a.ownerDocument.preserveWhiteSpace
return se(a,!1,function(e){var t,n,r
return 3!==e.nodeType&&4!==e.nodeType||(t=ae(e),(n=s||!(null===(r=t)||/^\s*$/.test(r)))||(o===x&&(o=function(e){for(;null!==e&&1===e.nodeType;){var t=Z(e,"space",X)
if("preserve"===t)return!0
if("default"===t)break
e=e.parentNode}return!1}(a)),n=o),n&&(i?i+=t:i=t)),!0}),i},oe=function(e){return e.localName||e.baseName},ie=function(e){return e.namespaceURI||null},ae=function(e){return 1===e.nodeType?re(e):e.nodeValue},se=function(e,t,n){for(var r=[],o=e.firstChild,i=!0;o&&i;)(i=n(o))&&(t&&o.firstChild&&r.push(o.firstChild),o=o.nextSibling||r.shift())},ue=function(e,t){if(t){if("string"==typeof t)return r=ce((n=e).ownerDocument,t),i=r.data,/(^\s)|(\s$)/.test(i)&&((o=$(n,X,"space"))||(o=le(n.ownerDocument,X,"xml:space"),ue(n,o)),o.value="preserve"),n.appendChild(r),n
2===t.nodeType?e.setAttributeNodeNS?e.setAttributeNodeNS(t):e.setAttributeNode(t):e.appendChild(t)}var n,r,o,i
return e},le=function(e,t,n,r){var o=e.createAttributeNS&&e.createAttributeNS(t,n)||e.createNode(2,n,t||x)
return o.value=r||"",o},ce=function(e,t){return e.createTextNode(t)}
V.prototype={then:function(e,t){return e&&(this._done?this._done.push(e):this._done=[e]),t&&(this._fail?this._fail.push(t):this._fail=[t]),this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments),this},resolve:function(){if(this._done){for(var e=0,t=this._done.length;e<t;e++)this._done[e].apply(null,arguments)
this._done=x,this._resolved=!1,this._arguments=x}else this._resolved=!0,this._arguments=arguments},reject:function(){if(this._fail){for(var e=0,t=this._fail.length;e<t;e++)this._fail[e].apply(null,arguments)
this._fail=x,this._rejected=!1,this._arguments=x}else this._rejected=!0,this._arguments=arguments},promise:function(){var e,t,n,r={}
return r.then=(e=this,t="then",n=r,function(){return e[t].apply(e,arguments),n}),r}}
function de(){return U.jQuery&&U.jQuery.Deferred?new U.jQuery.Deferred:new V}function pe(e,t){return(e&&e.__metadata||{}).type||(t?t.type:null)}function fe(e,t){return e=0===e?"":"."+It(e.toString(),3),0<t&&(""===e&&(e=".000"),e+=It(t.toString(),4)),e}function ge(e){if("string"==typeof e)return e
var t,n,r,o=Dt(e),i=bt(e.__offset)
o&&"Z"!==i?(e=new Date(e.valueOf()),t=wt(i),n=e.getUTCHours()+t.d*t.h,r=e.getUTCMinutes()+t.d*t.m,e.setUTCHours(n,r)):o||(i="")
var a=e.getUTCFullYear(),s=e.getUTCMonth()+1,u=""
a<=0&&(a=-(a-1),u="-")
var l=fe(e.getUTCMilliseconds(),e.__ns)
return u+It(a,4)+"-"+It(s,2)+"-"+It(e.getUTCDate(),2)+"T"+It(e.getUTCHours(),2)+":"+It(e.getUTCMinutes(),2)+":"+It(e.getUTCSeconds(),2)+l+i}function me(e){var t=e.ms,n=""
t<0&&(n="-",t=-t)
var r=Math.floor(t/864e5)
t-=864e5*r
var o=Math.floor(t/36e5)
t-=36e5*o
var i=Math.floor(t/6e4)
t-=6e4*i
var a=Math.floor(t/1e3)
return t-=1e3*a,n+"P"+It(r,2)+"DT"+It(o,2)+"H"+It(i,2)+"M"+It(a,2)+fe(t,e.ns)+"S"}function he(e){if("string"==typeof e){var t=e.indexOf(")",10)
if(0===e.indexOf("Collection(")&&0<t)return e.substring(11,t)}return null}function ye(e,t){var n=e&&e.results||e
return!!n&&vt(t)||!t&&O(n)&&!At(n[0])}function _e(e){if(e||At(e)){var t=e.__metadata||{},n=e.__deferred||{}
return!t.type&&!!n.uri}}function Se(e){return At(e)&&e.__metadata&&"uri"in e.__metadata}function Te(e,t){var n=e&&e.results||e
return O(n)&&!vt(t)&&At(n[0])}function Ie(e){return c(St,e)}function be(e){return c(_t,e)}function Ee(e){if(e||At(e)){var t=e.__metadata,n=e.__mediaresource
return!t&&!!n&&!!n.media_src}}function ve(e){return u(e)||"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function Ae(e){return c(yt,e)}function De(e,t){return _e(e)?"deferred":Se(e)?"entry":Te(e)?"feed":t&&t.relationship?null!==e&&e!==x&&Te(e)?"feed":"entry":null}function Oe(e,t){return b(e,function(e){return e.name===t})}function Ce(t,e,n){return t?Tt(e,function(e){return Ct(t,e,n)}):null}function Re(e,t){return Ce(e,t,"complexType")}function Me(e,t){return Ce(e,t,"entityType")}function Pe(e){return Tt(e,function(e){return b(e.entityContainer,function(e){return Pt(e.isDefaultEntityContainer)})})}function Ne(e,t){return Ce(e,t,"entityContainer")}function ke(e,t){if(e===t)return e
for(var n=e.split("."),r=t.split("."),o=n.length>=r.length?n.length:r.length,i=0;i<o;i++){var a=n[i]&&q(n[i]),s=r[i]&&q(r[i])
if(s<a)return e
if(a<s)return t}}function we(e,t,n){var r=Nt.exec(e),o=r?bt(r[8]):null
if(!r||!t&&"Z"!==o){if(n)return null
throw{message:"Invalid date/time value"}}var i=q(r[1])
i<=0&&i++
var a=r[7],s=0
if(a){if(7<a.length){if(n)return null
throw{message:"Cannot parse date/time value to given precision."}}s=It(a.substring(3),4,!0),a=It(a.substring(0,3),3,!0),a=q(a),s=q(s)}else a=0
var u,l,c=q(r[4]),d=q(r[5]),p=q(r[6])||0
"Z"!==o&&(l=-(u=wt(o)).d,c+=u.h*l,d+=u.m*l)
var f=new Date
if(f.setUTCFullYear(i,q(r[2])-1,q(r[3])),f.setUTCHours(c,d,p,a),isNaN(f.valueOf())){if(n)return null
throw{message:"Invalid date/time value"}}return t&&(f.__edmType="Edm.DateTimeOffset",f.__offset=o),s&&(f.__ns=s),f}function Fe(e,t){return we(e,!1,t)}function Le(e,t){return we(e,!0,t)}function Ue(e){var t=kt.exec(e)
if(null===t)throw{message:"Invalid duration value."}
var n=t[2]||"0",r=t[3]||"0",o=q(t[4]||0),i=q(t[5]||0),a=q(t[6]||0),s=parseFloat(t[7]||0)
if("0"!==n||"0"!==r)throw{message:"Unsupported duration value."}
var u=t[8],l=0
if(u){if(7<u.length)throw{message:"Cannot parse duration value to given precision."}
l=It(u.substring(3),4,!0),u=It(u.substring(0,3),3,!0),u=q(u),l=q(l)}else u=0
u+=1e3*s+6e4*a+36e5*i+864e5*o,"-"===t[1]&&(u=-u)
var c={ms:u,__edmType:"Edm.Time"}
return l&&(c.ns=l),c}function xe(e,t,n){e.method||(e.method="GET"),e.headers?Mt(e.headers):e.headers={},e.headers.Accept===x&&(e.headers.Accept=t.accept),j(e.data)&&e.body===x&&t.write(e,n)}function Be(e){return e&&(Ut(e,""),e.parentNode.removeChild(e)),null}var je="Edm.Binary",Ge="Edm.Boolean",He="Edm.DateTime",qe="Edm.DateTimeOffset",We="Edm.Decimal",Ve="Edm.Double",Ke="Edm.Single",Je="Edm.String",Ye="Edm.Time",Xe="Edm.Geography",ze=Xe+"Point",Qe=Xe+"LineString",Ze=Xe+"Polygon",$e=Xe+"Collection",et=Xe+"MultiPolygon",tt=Xe+"MultiLineString",nt=Xe+"MultiPoint",rt="Edm.Geometry",ot=rt+"Point",it=rt+"LineString",at=rt+"Polygon",st=rt+"Collection",ut=rt+"MultiPolygon",lt=rt+"MultiLineString",ct=rt+"MultiPoint",dt="LineString",pt="Polygon",ft="MultiPoint",gt="MultiLineString",mt="MultiPolygon",ht="GeometryCollection",yt=[Je,"Edm.Int32","Edm.Int64",Ge,Ve,Ke,He,qe,Ye,We,"Edm.Guid","Edm.Byte","Edm.Int16","Edm.SByte",je],_t=[rt,ot,it,at,st,ut,lt,ct],St=[Xe,ze,Qe,Ze,$e,et,tt,nt],Tt=function(e,t){if(!e)return null
if(O(e)){for(var n,r=0,o=e.length;r<o;r++)if(n=Tt(e[r],t))return n
return null}return e.dataServices?Tt(e.dataServices.schema,t):t(e)},It=function(e,t,n){for(var r=e.toString(10);r.length<t;)n?r+="0":r="0"+r
return r},bt=function(e){return e&&"Z"!==e&&"+00:00"!==e&&"-00:00"!==e?e:"Z"},Et=/Collection\((.*)\)/,vt=function(e){return Et.test(e)},At=function(e){return!!e&&a(e)&&!O(e)&&!u(e)},Dt=function(e){return"Edm.DateTimeOffset"===e.__edmType||!e.__edmType&&e.__offset},Ot=function(e,t){return 0===t.indexOf(e)&&"."===t.charAt(e.length)?t.substr(e.length+1):null},Ct=function(e,t,n){if(e&&t){var r=Ot(t.namespace,e)
if(r)return b(t[n],function(e){return e.name===r})}return null},Rt={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},Mt=function(e){for(var t in e){var n,r=t.toLowerCase(),o=Rt[r]
o&&t!==o&&(n=e[t],delete e[t],e[o]=n)}},Pt=function(e){return"boolean"==typeof e?e:"string"==typeof e&&"true"===e.toLowerCase()},Nt=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?(?:\.(\d+))?(.*)$/,kt=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,wt=function(e){return{d:"+"===e.substring(0,1)?1:-1,h:q(e.substring(1)),m:q(e.substring(e.indexOf(":")+1))}},Ft=function(e,t,n){if(e&&"object"==typeof e)for(var r in e){var o=e[r],i=Ft(o,r,n);(i=n(r,i,t))!==o&&(o===x?delete e[r]:e[r]=i)}return e},Lt=0,Ut=function(e,t){var n=e.contentWindow?e.contentWindow.document:e.contentDocument.document
n.open(),n.write(t),n.close()}
p.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:!1,request:function(o,i,a){var n,e={},s=null,u=!1
e.abort=function(){n=Be(n),u||(u=!0,s&&(s.abort(),s=null),a({message:"Request aborted"}))}
function t(){n=Be(n),u||(u=!0,s=null,a({message:"Request timed out"}))}var r,l=o.requestUri,c=T(o.enableJsonpCallback,this.enableJsonpCallback),d=T(o.callbackParameterName,this.callbackParameterName),p=T(o.formatQueryString,this.formatQueryString)
if(!c||function(e){if(0!==(t=e).indexOf("http://")&&0!==t.indexOf("https://")&&0!==t.indexOf("file://"))return!0
var t,n=U.location,r=n.protocol+"//"+n.host+"/"
return 0===e.indexOf(r)}(l)){if((s=function(){if(U.XMLHttpRequest)return new U.XMLHttpRequest
var t
if(U.ActiveXObject)try{return new U.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){try{return new U.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){t=e}}else t={message:"XMLHttpRequest not supported"}
throw t}()).onreadystatechange=function(){var e,t,n,r
u||null===s||4!==s.readyState||(e=s.statusText,1223===(t=s.status)&&(t=204,e="No Content"),function(e,t){for(var n,r=e.getAllResponseHeaders().split(/\r?\n/),o=0,i=r.length;o<i;o++){r[o]&&(t[(n=r[o].split(": "))[0]]=n[1])}}(s,n=[]),r={requestUri:l,statusCode:t,statusText:e,headers:n,body:s.responseText},u=!0,s=null,200<=t&&t<=299?i(r):a({message:"HTTP request failed",request:o,response:r}))},s.open(o.method||"GET",l,!0,o.user,o.password),o.headers)for(g in o.headers)s.setRequestHeader(g,o.headers[g])
o.timeoutMS&&(s.timeout=o.timeoutMS,s.ontimeout=t),s.send(o.body)}else{if((r=o).method&&"GET"!==r.method)throw{message:"Request is not local and cannot be done through JSONP."}
var f=Lt
Lt+=1
var g,m=f.toString()
U[g="handleJSONP_"+m]=function(e){var t
n=Be(n),u||(U.clearTimeout(y),function(t,n){try{delete U[t]}catch(e){U[t]=x,n===Lt-1&&--Lt}}(g,f),U.ActiveXObject&&(e=U.JSON.parse(U.JSON.stringify(e))),t=e.d===x?{"Content-Type":"application/json;odata=minimalmetadata",dataServiceVersion:"3.0"}:{"Content-Type":"application/json"},G(function(){Be(n),i({body:e,statusCode:200,headers:t})}))}
var h=o.timeoutMS?o.timeoutMS:12e4,y=U.setTimeout(t,h),_=d+"=parent."+g
this.formatQueryString&&(_+="&"+p)
var S=l.indexOf("?");-1===S?l=l+"?"+_:S===l.length-1?l+=_:l=l+"&"+_,n=function(e){var t=U.document.createElement("IFRAME")
t.style.display="none"
var n='<html><head><script type="text/javascript" src="'+e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;")+'"><\/script></head><body></body></html>'
return U.document.getElementsByTagName("BODY")[0].appendChild(t),Ut(t,n),t}(l)}return e}}
function xt(e){if(!e)return null
for(var t=e.split(";"),n={},r=1,o=t.length;r<o;r++){var i=t[r].split("=")
n[s(i[0])]=i[1]}return{mediaType:s(t[0]),properties:n}}function Bt(e,t,n,r){var o={}
return H(o,n),H(o,{contentType:e,handler:r}),o}function jt(e,t){var n=e.headers
return n&&n[t]||x}function Gt(e){return xt(jt(e,"Content-Type"))}function Ht(e){var t=jt(e,"DataServiceVersion")
if(t){var n=Kt.exec(t)
if(n&&n.length)return n[1]}}function qt(e,t){return 0<=e.accept.indexOf(t.mediaType)}function Wt(e,t,n,r){if(!n||!n.headers)return!1
var o,i,a,s,u=Gt(n)
if(Ht(n),!u||qt(e,u)){var l=Bt(u,0,r,e)
if((l.request=n).body=t(e,n.data,l),n.body!==x)return o=n,i="Content-Type",a=function(e){if(!e)return x
var t,n=e.mediaType
for(t in e.properties)n+=";"+t+"="+e.properties[t]
return n}(l.contentType),o&&((s=o.headers)[i]||(s[i]=a)),!0}return!1}function Vt(n,r,e,t){return{accept:e,read:function(e,t){return function(e,t,n,r){if(!n||!n.headers)return!1
var o=Gt(n),i=(Ht(n),n.body)
if(!j(i))return!1
if(qt(e,o)){var a=Bt(o,0,r,e)
return(a.response=n).data=t(e,i,a),n.data!==x}return!1}(this,n,e,t)},write:function(e,t){return Wt(this,r,e,t)}}}var Kt=/^\s?(\d+\.\d+);?.*$/
p.textHandler=Vt(function(e,t){return t},function(e,t){return j(t)?t.toString():x},"text/plain")
function Jt(e,t,n){var r={type:e}
return r[t]=n,r}function Yt(e){var t
return O(e)&&2<=e.length&&(t=e[0],e[0]=e[1],e[1]=t),e}function Xt(e,t,n,r,o,i){var a=Mn(e,n,r,o,i)
return Jt(t,"coordinates",a)}function zt(e,t){var n=Mn(e,"geometryMember","geometryMembers",xn,t)
return Jt(ht,"geometries",n)}function Qt(e,t){return Jt(dt,"coordinates",Pn(e,t))}function Zt(e,t){return Xt(e,gt,"curveMember","curveMembers",Pn,t)}function $t(e,t){return Xt(e,ft,"pointMember","pointMembers",Nn,t)}function en(e,t){return Xt(e,mt,"surfaceMember","surfaceMembers",wn,t)}function tn(e,t){return Jt("Point","coordinates",Nn(e,t))}function nn(e,t){return Jt(pt,"coordinates",wn(e,t))}function rn(e,t,n,r){var o
switch(n){case"Point":o=Bn
break
case dt:o=jn
break
case pt:o=Gn
break
case ft:o=Hn
break
case gt:o=qn
break
case mt:o=Wn
break
case ht:o=Vn
break
default:return null}var i,a,s,u,l=o(e,t,r),c=t.crs
return c&&("name"!==c.type||(a=(i=c.properties)&&i.name)&&0===a.indexOf("ESPG:")&&5<a.length&&(s=a.substring(5),u=le(e,null,"srsName","gml"+s),ue(l,u))),l}function on(e,t,n){return D(e,Cn,h("gml",t),n)}function an(e,t,n){var r=O(t)?t:[],r=n?Yt(r):r
return on(e,"pos",r.join(" "))}function sn(e,t,n,r){var o=on(e,t)
if(O(n)){for(var i=0,a=n.length;i<a;i++)ue(o,an(e,n[i],r))
0===a&&ue(o,on(e,"posList"))}return o}function un(e,t,n){return on(e,"Point",an(e,t,n))}function ln(e,t,n){return sn(e,"LineString",t,n)}function cn(e,t,n,r){var o,i=on(e,t)
return O(n)&&0<n.length&&(o=sn(e,"LinearRing",n,r),ue(i,o)),i}function dn(e,t,n){var r,o=t&&t.length,i=on(e,"Polygon")
if(O(t)&&0<o)for(ue(i,cn(e,"exterior",t[0],n)),r=1;r<o;r++)ue(i,cn(e,"interior",t[r],n))
return i}function pn(e,t,n,r,o,i){var a=r&&r.length,s=on(e,t)
if(O(r)&&0<a){for(var u=on(e,n),l=0;l<a;l++)ue(u,o(e,r[l],i))
ue(s,u)}return s}function fn(e,t,n){return rn(e,t,t.type,n)}function gn(e,t){var n={name:oe(e),value:e.value}
return n[t?"namespaceURI":"namespace"]=ie(e),n}function mn(e){return ie(e)===zn&&"element"===oe(e)}function hn(e,t){return{type:e,extensions:t}}function yn(e){if(ee(e,Cn))return rt
var t=ee(e,zn)
if(!t)return Je
if(mn(t)){var n=function(e,t,n){for(var r=e.nextSibling;r;){if(1===r.nodeType){var o=!t||ie(r)===t,i=!n||oe(r)===n
if(o&&i)return r}r=r.nextSibling}return null}(t,zn)
if(n&&mn(n))return"Collection()"}return null}function _n(e){var o=null,i=!1,a=[]
return y(e,function(e){var t=ie(e),n=oe(e),r=ae(e)
if(t===Qn){if("null"===n)return void(i="true"===r.toLowerCase())
if("type"===n)return void(o=r)}t===X||t===Y||a.push(gn(e,!0))}),{type:!o&&i?Je:o,isNull:i,extensions:a}}function Sn(e){if(ie(e)!==zn)return null
var t=oe(e),n=_n(e),r=n.isNull,o=n.type,i=hn(o,n.extensions)
return{name:t,value:r?null:tr(e,o,i),metadata:i}}function Tn(e,t,n){return D(e,Qn,h("m",t),n)}function In(e,t,n){return le(e,Qn,h("m",t),n)}function bn(e,t,n){return D(e,zn,h("d",t),n)}function En(e,t){return{element:e,dsv:t}}function vn(e,t,n,r){var o=n?In(e,"type",n):null,i=bn(e,t,o)
return A(i,r)}function An(e,t,n,r){var o,i,a=(o=n,(i=r)===He||i===qe||u(o)?ge(o):i===Ye?me(o):o.toString()),s=vn(e,t,r,a)
return En(s,"1.0")}function Dn(e,t,n,r,o){var i,a,s=(i=n,(a=r)===rt||a===Xe?i&&i.type:a===ot||a===ze?"Point":a===it||a===Qe?dt:a===at||a===Ze?pt:a===st||a===$e?ht:a===ut||a===et?mt:a===lt||a===tt?gt:a===ct||a===nt?ft:null),u=rn(e,n,s,o),l=vn(e,t,r,u)
return En(l,"3.0")}var On=r+"www.opengis.net",Cn=On+"/gml",Rn=On+"/def/crs/EPSG/0/",Mn=function(e,o,i,a,s){var u=[]
return S(e,function(e){var t,n,r
ie(e)===Cn&&((t=oe(e))!==o?t===i&&S(e,function(e){var t
ie(e)!==Cn||(t=a(e,s))&&u.push(t)}):!(n=ee(e,Cn))||(r=a(n,s))&&u.push(r))}),u},Pn=function(e,n){var r=[]
return S(e,function(e){var t
ie(e)===Cn&&("posList"!==(t=oe(e))?"pointProperty"!==t?"pos"!==t||r.push(Un(e,n)):r.push(kn(e,n)):r=Ln(e,n))}),r},Nn=function(e,t){var n=ee(e,Cn,"pos")
return n?Un(n,t):[]},kn=function(e,t){var n=ee(e,Cn,"Point")
return n?Nn(n,t):[]},wn=function(e,n){var r=[],o=!1
return S(e,function(e){if(ie(e)===Cn){var t=oe(e)
if("exterior"===t)return o=!0,void r.unshift(Fn(e,n))
"interior"!==t||r.push(Fn(e,n))}}),!o&&0<r.length&&r.unshift([[]]),r},Fn=function(e,t){var n=[]
return S(e,function(e){ie(e)===Cn&&"LinearRing"===oe(e)&&(n=Pn(e,t))}),n},Ln=function(e,t){var n=Un(e,!1),r=n.length
if(r%2!=0)throw{message:"GML posList element has an uneven number of numeric values"}
for(var o=[],i=0;i<r;i+=2){var a=n.slice(i,i+2)
o.push(t?Yt(a):a)}return o},Un=function(e,t){var n=[],r=re(e)
if(r)for(var o,i=r.length,a=0,s=0;s<=i;){-1!==" \t\r\n".indexOf(r.charAt(s))&&((o=r.substring(a,s))&&n.push(parseFloat(o)),a=s+1),s++}return t?Yt(n):n},xn=function(e,t){var n,r=oe(e)
switch(r){case"Point":n=tn
break
case"Polygon":n=nn
break
case"LineString":n=Qt
break
case"MultiPoint":n=$t
break
case"MultiCurve":n=Zt
break
case"MultiSurface":n=en
break
case"MultiGeometry":n=zt
break
default:throw{message:"Unsupported element: "+r,element:e}}var o=n(e,t),i=Z(e,"srsName",Cn)||Z(e,"srsName")
if(i){if(0!==i.indexOf(Rn))throw{message:"Unsupported srs name: "+i,element:e}
var a=i.substring(Rn.length)
a&&(o.crs={type:"name",properties:{name:"EPSG:"+a}})}return o},Bn=function(e,t,n){return un(e,t.coordinates,n)},jn=function(e,t,n){return ln(e,t.coordinates,n)},Gn=function(e,t,n){return dn(e,t.coordinates,n)},Hn=function(e,t,n){return pn(e,"MultiPoint","pointMembers",t.coordinates,un,n)},qn=function(e,t,n){return pn(e,"MultiCurve","curveMembers",t.coordinates,ln,n)},Wn=function(e,t,n){return pn(e,"MultiSurface","surfaceMembers",t.coordinates,dn,n)},Vn=function(e,t,n){return pn(e,"MultiGeometry","geometryMembers",t.geometries,fn,n)},Kn="application/xml",Jn=r+"schemas.microsoft.com/ado/",Yn=Jn+"2007/08/dataservices",Xn=Jn+"2007/06/edmx",zn=Yn,Qn=Yn+"/metadata",Zn=Yn+"/related/",$n=Yn+"/scheme",er=function(e,t){for(var n=[],r=[],o=e.attributes,i=0,a=o.length;i<a;i++){var s=o[i]
ie(s)!==Y&&n.push(gn(s,t))}for(var u=e.firstChild;null!=u;)1===u.nodeType&&r.push(er(u,t)),u=u.nextSibling
var l={name:oe(e),value:re(e),attributes:n,children:r}
return l[t?"namespaceURI":"namespace"]=ie(e),l},tr=function(e,t,n){t||(t=yn(e),n.type=t)
var r=Ie(t)
return r||be(t)?nr(e,t,r):Ae(t)?rr(e,t):(vt(t)?ir:or)(e,t,n)},nr=function(e,t,n){var r=ee(e,Cn),o=xn(r,n)
return o.__metadata={type:t},o},rr=function(e,t){var n=ae(e)||""
switch(t){case Ge:return Pt(n)
case je:case We:case"Edm.Guid":case"Edm.Int64":case Je:return n
case"Edm.Byte":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":return q(n)
case Ve:case Ke:return parseFloat(n)
case Ye:return Ue(n)
case He:return Fe(n)
case qe:return Le(n)}return n},or=function(e,t,r){var o={__metadata:{type:t}}
return S(e,function(e){var t=Sn(e),n=t.name
r.properties=r.properties||{},r.properties[n]=t.metadata,o[n]=t.value}),o},ir=function(e,t,n){var a=[],s=n.elements=[],u=he(t)
return S(e,function(e){var t,n,r,o,i
mn(e)&&(n=(t=_n(e)).extensions,r=t.type||u,o=hn(r,n),i=tr(e,r,o),a.push(i),s.push(o))}),{__metadata:{type:"Collection()"===t?null:t},results:a}},ar=function(e,t){var n=[]
return S(e,function(e){"uri"===oe(e)&&ie(e)===zn&&n.push(sr(e,t))}),{results:n}},sr=function(e,t){var n=re(e)||""
return{uri:E(n,t)}},ur=function(e,t,n,r,o,i){var a=pe(n,r)
if(ve(n))return An(e,t,n,a||Je)
var s,u,l,c,d,p,f,g=Ie(a)
return g||be(a)?Dn(e,t,n,a,g):ye(n,a)?function(e,t,n,r,o,i,a){var s=he(r),u=O(n)?n:n.results,l=r?{type:s}:{}
l.properties=o.properties
for(var c=vn(e,t,s?r:null),d=0,p=u.length;d<p;d++){var f=u[d],g=ur(e,"element",f,l,i,a)
ue(c,g.element)}return En(c,"3.0")}(e,t,n,a,r,o,i):Ee(n)||null!==De(n,o)?null:null===n?(u=t,l=a,d=In(s=e,"null","true"),p=vn(s,u,l,d),f=Re(l,c)?"2.0":"1.0",En(p,f)):function(e,t,n,r,o,i){var a,s,u,l=vn(e,t,r),c=o.properties||{},d=Re(r,i)||{},p="1.0"
for(var f in n){"__metadata"!==f&&(a=n[f],s=Oe(d.property,f),u=ur(e,f,a,c[f]||{},s,i),p=ke(p,u.dsv),ue(l,u.element))}return En(l,p)}(e,t,n,a,r,i)}
p.xmlHandler=Vt(function(e,t){if(t){var n=m(t),r=ee(n)
if(r)return function(e,t){if(ie(e)===zn){t=_(e,t)
var n=oe(e)
if("links"===n)return ar(e,t)
if("uri"===n)return sr(e,t)}return x}(r)}},function(e,t,n){var r=n.contentType=n.contentType||xt(Kn)
return r&&r.mediaType===Kn?R(function(e){if(e&&a(e)){var t=l()
return ue(t,bn(t,"uri",e.uri))}}(t)):x},Kn)
function lr(e){return!c(Mr,e)}function cr(e,t,n,r,o){var i=e["FC_TargetPath"+(o=o||"")]
if(!i)return null
var a,s=e["FC_SourcePath"+o],u=Pr[a=i]||a,l=r?r+(s?"/"+s:""):s,c=l&&Fr(n,t,l),d=e["FC_NsUri"+o]||null,p=e["FC_NsPrefix"+o]||null,f=e["FC_KeepInContent"+o]||""
return i!==u&&(d=Er,p="a"),{contentKind:e["FC_ContentKind"+o],keepInContent:"true"===f.toLowerCase(),nsPrefix:p,nsURI:d,propertyPath:l,propertyType:c,entryPath:u}}function dr(e,t,n){for(;e;){e.FC_SourcePath
var r=cr(e,e,t)
r&&n(r)
for(var o=e.property||[],i=0,a=o.length;i<a;i++)for(var s=o[i],u=0,l="";r=cr(s,e,t,s.name,l);)n(r),l="_"+ ++u
e=Me(e.baseType,t)}return 1}function pr(e){var n=[]
return y(e,function(e){var t=ie(e)
lr(t)&&n.push(gn(e,!0))}),n}function fr(e){return er(e,!0)}function gr(e,t,n){var r=ie(e),o=oe(e)
if(r===vr&&"service"===o)return Yr(e,t)
if(r===Er){if("feed"===o)return Nr(e,t,n)
if("entry"===o)return Lr(e,t,n)}}function mr(o,i){var a=[],s={extensions:a}
return y(o,function(e){var t=oe(e),n=ie(e),r=ae(e)
if(null===n){if("title"===t||"metadata"===t)return void(s[t]=r)
if("target"===t)return void(s.target=E(r,_(o,i)))}lr(n)&&a.push(gn(e,!0))}),s}function hr(e,t,n){(n.actions=n.actions||[]).push(mr(e,t))}function yr(e,t,n){(n.functions=n.functions||[]).push(mr(e,t))}function _r(e,t,n){var r,o,i,a,s,u,l,c,d,p=e.propertyPath
e.keepInContent||null===function(e,t){if(-1===e.indexOf("/"))return t[e]
for(var n=e.split("/"),r=0,o=n.length;r<o;r++){if(null===t)return x
if((t=t[n[r]])===x)return t}return t}(p,n)||(o=t,i=e.nsURI,a=e.entryPath,s=a.lastIndexOf("/"),u=a.substring(s+1),l=a.substring(0,s),(r=(c=l?v(o,i,l):o)?"@"===u.charAt(0)?$(c,u.substring(1),i):ee(c,i,u):null)&&(d=e.propertyType,function(e,t,n,r){var o,i,a
if(-1===e.indexOf("/"))t[e]=n,o=e
else{for(var s=e.split("/"),u=0,l=s.length-1;u<l;u++){var c=t[s[u]]
if(c===x)c={},t[s[u]]=c
else if(null===c)return
t=c}t[o=s[u]]=n}r&&(((a=(i=t.__metadata=t.__metadata||{}).properties=i.properties||{})[o]=a[o]||{}).type=r)}(p,n,"xhtml"===e.contentKind?function(e){var t=e.childNodes,n=t.length
if(0===n)return""
var r=e.ownerDocument,o=r.createDocumentFragment(),i=r.createElement("c")
for(o.appendChild(i),s=0;s<n;s++)i.appendChild(t[s])
for(var a=(a=R(o)).substr(3,a.length-7),s=0;s<n;s++)e.appendChild(i.childNodes[s])
return a}(r):rr(r,d||"Edm.String"),d)))}function Sr(e,t,n){return D(e,Er,h("a",t),n)}function Tr(e,t,n){return le(e,null,t,n)}function Ir(e,t,n,r,o,i){if(Ee(n))return null
var a=ur(e,t,n,r,o,i)
return a=a||function(e,t,n,r,o){var i=null,a=null,s=null,u=""
"deferred"!==n?(i=Tr(e,"type","application/atom+xml;type="+n),a=Tn(e,"inline"),r&&(u=r.__metadata&&r.__metadata.uri||"",s=Zr(e,r,o)||Qr(e,r,o),ue(a,s.element))):u=r.__deferred.uri
var l=Sr(e,"link",[Tr(e,"href",u),Tr(e,"rel",E(t,Zn)),i,a])
return En(l,s?s.dsv:"1.0")}(e,t,De(n,o),n,i)}function br(e,t,n,r){var o,i=v(n,zn,r.propertyPath),a=i&&$(i,"null",Qn),s="1.0"
if(a&&"true"===a.value)return s
if(i&&(o=re(i)||"",!r.keepInContent)){s="2.0"
var u=i.parentNode,l=u
for(u.removeChild(i);l!==n&&function(e){if(0<e.childNodes.length)return!1
for(var t,n=!0,r=e.attributes,o=0,i=r.length;o<i&&n;o++)var a=r[o],n=n&&(t=void 0,"xmlns"==(t=a.nodeName)||0===t.indexOf("xmlns:"))||ie(a)==Qn&&"type"===oe(a)
return n}(l);)(u=l.parentNode).removeChild(l),l=u}var c=function(e,t,n,r,o){for(var i="",a=o.split("/"),s=ee,u=D,l=t,c=0,d=a.length;c<d;c++){"@"===(i=a[c]).charAt(0)&&(i=i.substring(1),s=$,u=le)
var p=s(l,n,i)
p||(p=u(e,n,h(r,i)),ue(l,p)),l=p}return l}(e,t,r.nsURI,r.nsPrefix,r.entryPath)
if(2===c.nodeType)return c.value=o,s
var d=r.contentKind
return A(c,[d&&le(e,null,"type",d),"xhtml"===d?function(e,t){for(var n=m("<c>"+t+"</c>").documentElement,r=("importNode"in e?e.importNode(n,!0):n),o=e.createDocumentFragment(),i=r.firstChild;i;)o.appendChild(i),i=i.nextSibling
return o}(e,o):o]),s}var Er=o+"2005/Atom",vr=o+"2007/app",Ar=Yn+"/edit-media/",Dr=Yn+"/mediaresource/",Or=Yn+"/relatedlinks/",Cr=["application/atom+xml","application/atomsvc+xml","application/xml"],Rr=Cr[0],Mr=[Er,vr,X,Y],Pr={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},Nr=function(e,r,o){var i=pr(e),a={feed_extensions:i},s=[],u={__metadata:a,results:s}
return r=_(e,r),S(e,function(e){var t=ie(e),n=oe(e)
if(t===Qn){if("count"===n)return void(u.__count=parseInt(re(e),10))
if("action"===n)return void hr(e,r,a)
if("function"===n)return void yr(e,r,a)}if(lr(t))i.push(er(e))
else if("entry"!==n){if("link"!==n)return"id"===n?(a.uri=E(re(e),r),void(a.uri_extensions=pr(e))):"title"===n&&(a.title=re(e)||"",void(a.title_extensions=pr(e)))
kr(e,u,r)}else s.push(Lr(e,r,o))}),u},kr=function(e,t,n){var r=wr(e,n),o=r.href,i=r.rel,a=r.extensions,s=t.__metadata
return"next"===i?(t.__next=o,void(s.next_extensions=a)):"self"===i?(s.self=o,void(s.self_extensions=a)):void 0},wr=function(e,o){o=_(e,o)
var i=[],a={extensions:i,baseURI:o}
if(y(e,function(e){var t=ie(e),n=oe(e),r=e.value
"href"!==n?"type"!==n&&"rel"!==n?lr(t)&&i.push(gn(e,!0)):a[n]=r:a.href=E(r,o)}),!a.href)throw{error:"href attribute missing on link element",element:e}
return a},Fr=function(e,t,n){for(var r=n.split("/");t;){for(var o=t,i=0,a=r.length;i<a;i++){var s=o.property
if(!s)break
var u=Oe(s,r[i])
if(!u)break
var l=u.type
if(!l||Ae(l))return l||null
if(!(o=Re(l,e)))return null}t=Me(t.baseType,e)}return null},Lr=function(t,r,o){var i={},a={__metadata:i},e=Z(t,"etag",Qn)
e&&(i.etag=e),r=_(t,r),S(t,function(e){var t=ie(e),n=oe(e)
if(t===Er)return"id"===n?void Ur(e,i,r):"category"===n?void xr(e,i):"content"===n?void Br(e,a,i,r):"link"===n&&void jr(e,a,i,r,o)
if(t===Qn){if("properties"===n)return void Jr(e,a,i)
if("action"===n)return void hr(e,r,i)
if("function"===n)return void yr(e,r,i)}})
var n=Me(i.type,o)
return dr(n,o,function(e){_r(e,t,a)}),a},Ur=function(e,t,n){t.uri=E(re(e),_(e,n)),t.uri_extensions=pr(e)},xr=function(e,t){if(Z(e,"scheme")===$n){if(t.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:e}
var r=[]
y(e,function(e){var t=ie(e),n=oe(e)
t?lr(t)&&r.push(gn(e,!0)):"scheme"!==n&&"term"!==n&&r.push(gn(e,!0))}),t.type=Z(e,"term"),t.type_extensions=r}},Br=function(t,n,r,e){var o=Z(t,"src"),i=Z(t,"type")
if(o){if(!i)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:t}
r.media_src=E(o,_(t,e)),r.content_type=i}S(t,function(e){if(o)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:t}
ie(e)===Qn&&"properties"===oe(e)&&Jr(e,n,r)})},jr=function(e,t,n,r,o){var i=wr(e,r),a=i.rel,s=i.href,u=i.extensions
return"self"===a?(n.self=s,void(n.self_link_extensions=u)):"edit"===a?(n.edit=s,void(n.edit_link_extensions=u)):"edit-media"===a?(n.edit_media=i.href,n.edit_media_extensions=u,void Kr(i,n)):void(0!==a.indexOf(Ar)?0!==a.indexOf(Dr)?0!==a.indexOf(Zn)?0!==a.indexOf(Or)||Gr(i,n):Hr(e,i,t,n,o):Wr(i,t,n):qr(i,t,n))},Gr=function(e,t){var n=e.rel.substring(Or.length)
t.properties=t.properties||{}
var r=t.properties[n]=t.properties[n]||{}
r.associationuri=e.href,r.associationuri_extensions=e.extensions},Hr=function(e,t,n,r,o){var i,a,s,u=ee(e,Qn,"inline")
s=u?(i=ee(u),a=_(u,t.baseURI),i?gr(i,a,o):null):{__deferred:{uri:t.href}}
var l=t.rel.substring(Zn.length)
n[l]=s,r.properties=r.properties||{},(r.properties[l]=r.properties[l]||{}).extensions=t.extensions},qr=function(e,t,n){var r=e.rel.substring(Ar.length),o=Vr(r,t,n),i=o.value,a=o.metadata,s=e.href
i.edit_media=s,i.content_type=e.type,a.edit_media_extensions=e.extensions,i.media_src=i.media_src||s,a.media_src_extensions=a.media_src_extensions||[],Kr(e,i)},Wr=function(e,t,n){var r=e.rel.substring(Dr.length),o=Vr(r,t,n),i=o.value,a=o.metadata
i.media_src=e.href,a.media_src_extensions=e.extensions,i.content_type=e.type},Vr=function(e,t,n){n.properties=n.properties||{}
var r=n.properties[e],o=t[e]&&t[e].__mediaresource
return o||(o={},t[e]={__mediaresource:o},n.properties[e]=r={}),{value:o,metadata:r}},Kr=function(e,t){for(var n=e.extensions,r=0,o=n.length;r<o;r++)if(n[r].namespaceURI===Qn&&"etag"===n[r].name)return t.media_etag=n[r].value,void n.splice(r,1)},Jr=function(e,r,o){S(e,function(e){var t,n=Sn(e)
n&&(t=n.name,(o.properties=o.properties||{})[t]=n.metadata,r[t]=n.value)})},Yr=function(e,t){var n=[],r=[]
if(t=_(e,t),S(e,function(e){ie(e)!==vr||"workspace"!==oe(e)?r.push(er(e)):n.push(Xr(e,t))}),0===n.length)throw{message:"Invalid AtomPub service document: No workspace element found.",element:e}
return{workspaces:n,extensions:r}},Xr=function(e,r){var o,i=[],a=[]
return r=_(e,r),S(e,function(e){var t=ie(e),n=oe(e)
if(t!==Er||"title"!==n)t!==vr?a.push(fr(e)):"collection"===n&&i.push(zr(e,r))
else{if(o!==x)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:e}
o=re(e)}}),{title:o||"",collections:i,extensions:a}},zr=function(r,e){var t=Z(r,"href")
if(!t)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:r}
e=_(r,e),t=E(t,_(r,e))
var o,i=[]
if(S(r,function(e){var t=ie(e),n=oe(e)
if(t!==Er)t!==vr&&i.push(fr(r))
else if("title"===n){if(o!==x)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:e}
o=re(e)}}),!o)throw{message:"Invalid AtomPub service document: collection has no title element",element:r}
return{title:o,href:t,extensions:i}},Qr=function(n,e,t){var r,o,i,a,s,u=e.__metadata||{},l=u.properties||{},c=u.etag,d=u.uri,p=u.type,f=Me(p,t),g=Tn(n,"properties"),m=Sr(n,"entry",[Sr(n,"author",Sr(n,"name")),c&&In(n,"etag",c),d&&Sr(n,"id",d),p&&Sr(n,"category",[Tr(n,"term",p),Tr(n,"scheme",$n)]),Sr(n,"content",[Tr(n,"type","application/xml"),g])]),h="1.0"
for(var y in e){"__metadata"!==y&&(r=l[y]||{},o=f&&(Oe(f.property,y)||Oe(f.navigationProperty,y)),(i=Ir(n,y,e[y],r,o,t))&&(a=i.element,s=ie(a)===Er?m:g,ue(s,a),h=ke(h,i.dsv)))}return dr(f,t,function(e){var t=br(n,m,g,e)
h=ke(h,t)}),En(m,h)},Zr=function(e,t,n){var r=O(t)?t:t.results
if(!r)return null
for(var o="1.0",i=Sr(e,"feed"),a=0,s=r.length;a<s;a++){var u=Qr(e,r[a],n)
ue(i,u.element),o=ke(o,u.dsv)}return En(i,o)}
p.atomHandler=Vt(function(e,t,n){if(t){var r=m(t),o=ee(r)
if(o)return gr(o,null,n.metadata)}},function(e,t,n){var r=n.contentType=n.contentType||xt(Rr)
if(r&&r.mediaType===Rr){var o=function(e,t){if(e){var n=Te(e)&&Zr||a(e)&&Qr
if(n){var r=l(),o=n(r,e,t)
if(o){var i=o.element
return A(i,[C(r,Qn,"m"),C(r,zn,"d")]),En(ue(r,i),o.dsv)}}}return null}(t,n.metadata)
if(o)return n.dataServiceVersion=ke(n.dataServiceVersion||"1.0",o.dsv),R(o.element)}},Cr.join(","))
function $r(e,t,n,r){return{attributes:e,elements:t,text:n||!1,ns:r}}var eo={elements:{Annotations:$r(["Target","Qualifier"],["TypeAnnotation*","ValueAnnotation*"]),Association:$r(["Name"],["End*","ReferentialConstraint","TypeAnnotation*","ValueAnnotation*"]),AssociationSet:$r(["Name","Association"],["End*","TypeAnnotation*","ValueAnnotation*"]),Binary:$r(null,null,!0),Bool:$r(null,null,!0),Collection:$r(null,["String*","Int*","Float*","Decimal*","Bool*","DateTime*","DateTimeOffset*","Guid*","Binary*","Time*","Collection*","Record*"]),CollectionType:$r(["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"],["CollectionType","ReferenceType","RowType","TypeRef"]),ComplexType:$r(["Name","BaseType","Abstract"],["Property*","TypeAnnotation*","ValueAnnotation*"]),DateTime:$r(null,null,!0),DateTimeOffset:$r(null,null,!0),Decimal:$r(null,null,!0),DefiningExpression:$r(null,null,!0),Dependent:$r(["Role"],["PropertyRef*"]),Documentation:$r(null,null,!0),End:$r(["Type","Role","Multiplicity","EntitySet"],["OnDelete"]),EntityContainer:$r(["Name","Extends"],["EntitySet*","AssociationSet*","FunctionImport*","TypeAnnotation*","ValueAnnotation*"]),EntitySet:$r(["Name","EntityType"],["TypeAnnotation*","ValueAnnotation*"]),EntityType:$r(["Name","BaseType","Abstract","OpenType"],["Key","Property*","NavigationProperty*","TypeAnnotation*","ValueAnnotation*"]),EnumType:$r(["Name","UnderlyingType","IsFlags"],["Member*"]),Float:$r(null,null,!0),Function:$r(["Name","ReturnType"],["Parameter*","DefiningExpression","ReturnType","TypeAnnotation*","ValueAnnotation*"]),FunctionImport:$r(["Name","ReturnType","EntitySet","IsSideEffecting","IsComposable","IsBindable","EntitySetPath"],["Parameter*","ReturnType","TypeAnnotation*","ValueAnnotation*"]),Guid:$r(null,null,!0),Int:$r(null,null,!0),Key:$r(null,["PropertyRef*"]),LabeledElement:$r(["Name"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),Member:$r(["Name","Value"]),NavigationProperty:$r(["Name","Relationship","ToRole","FromRole","ContainsTarget"],["TypeAnnotation*","ValueAnnotation*"]),Null:$r(null,null),OnDelete:$r(["Action"]),Path:$r(null,null,!0),Parameter:$r(["Name","Type","Mode","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","SRID"],["CollectionType","ReferenceType","RowType","TypeRef","TypeAnnotation*","ValueAnnotation*"]),Principal:$r(["Role"],["PropertyRef*"]),Property:$r(["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","CollectionKind","SRID"],["CollectionType","ReferenceType","RowType","TypeAnnotation*","ValueAnnotation*"]),PropertyRef:$r(["Name"]),PropertyValue:$r(["Property","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ReferenceType:$r(["Type"]),ReferentialConstraint:$r(null,["Principal","Dependent"]),ReturnType:$r(["ReturnType","Type","EntitySet"],["CollectionType","ReferenceType","RowType"]),RowType:$r(["Property*"]),String:$r(null,null,!0),Schema:$r(["Namespace","Alias"],["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*","ValueTerm*","Annotations*"]),Time:$r(null,null,!0),TypeAnnotation:$r(["Term","Qualifier"],["PropertyValue*"]),TypeRef:$r(["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]),Using:$r(["Namespace","Alias"]),ValueAnnotation:$r(["Term","Qualifier","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ValueTerm:$r(["Name","Type"],["TypeAnnotation*","ValueAnnotation*"]),Edmx:$r(["Version"],["DataServices","Reference*","AnnotationsReference*"],!1,Xn),DataServices:$r(null,["Schema*"],!1,Xn)}},to=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"]
eo.elements.Property.attributes=eo.elements.Property.attributes.concat(to),eo.elements.EntityType.attributes=eo.elements.EntityType.attributes.concat(to),eo.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:Xn},eo.elements.DataServices={elements:["Schema*"],ns:Xn},eo.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer"),eo.elements.Property.attributes.push("m:MimeType"),eo.elements.FunctionImport.attributes.push("m:HttpMethod"),eo.elements.FunctionImport.attributes.push("m:IsAlwaysBindable"),eo.elements.EntityType.attributes.push("m:HasStream"),eo.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"]
function no(e){if(!e)return e
if(1<e.length){var t=e.substr(0,2)
return t===t.toUpperCase()?e:e.charAt(0).toLowerCase()+e.substr(1)}return e.charAt(0).toLowerCase()}function ro(e){return"http://schemas.microsoft.com/ado/2006/04/edm"===e||"http://schemas.microsoft.com/ado/2007/05/edm"===e||"http://schemas.microsoft.com/ado/2008/01/edm"===e||"http://schemas.microsoft.com/ado/2008/09/edm"===e||"http://schemas.microsoft.com/ado/2009/08/edm"===e||"http://schemas.microsoft.com/ado/2009/11/edm"===e}function oo(e,t){var n=m(t),r=ee(n)
return ao(r)||x}var io=/^(m:FC_.*)_[0-9]+$/,ao=function(e){var t=oe(e),n=ie(e),o=eo.elements[t]
if(!o)return null
if(o.ns){if(n!==o.ns)return null}else if(!ro(n))return null
var s={},u=[],l=o.attributes||[]
return y(e,function(e){var t,n,r,o=oe(e),i=ie(e),a=e.value
i!==Y&&(t=null,n=!1,ro(i)||null===i?t="":i===Qn&&(t="m:"),null!==t&&(t+=o,(r=io.exec(t))&&(t=r[1]),c(l,t)&&(n=!0,s[no(o)]=a)),n||u.push(gn(e)))}),S(e,function(e){var t,n=oe(e),r=function(e,t){if("Documentation"===t)return{isArray:!0,propertyName:"documentation"}
var n,r,o=e.elements
if(!o)return null
for(n=0,r=o.length;n<r;n++){var i=o[n],a=!1
if("*"===i.charAt(i.length-1)&&(a=!0,i=i.substr(0,i.length-1)),t===i)return{isArray:a,propertyName:no(i)}}return null}(o,n)
r?r.isArray?((t=s[r.propertyName])||(t=[],s[r.propertyName]=t),t.push(ao(e))):s[r.propertyName]=ao(e):u.push(er(e))}),o.text&&(s.text=re(e)),u.length&&(s.extensions=u),s}
p.metadataHandler=Vt(oo,null,Kn)
function so(e,t,n,r,o){return At(t)&&t[Ao]||n&&n[e+"@"+Ao]||r&&r.type||(a=o,c=null,(i=r)&&(s=i.relationship,(u=Tt(a,function(e){var t=Ot(e.namespace,s),n=e.association
if(t&&n)for(var r=0,o=n.length;r<o;r++)if(n[r].name===t)return n[r]
return null}))&&((l=u.end[0]).role!==i.toRole&&(l=u.end[1]),c=l.type)),c)||null
var i,a,s,u,l,c}function uo(e,t){return t?Oe(t.property,e)||Oe(t.navigationProperty,e):null}function lo(e){return At(e)&&bo+"id"in e}function co(e){return Ae(e)||Ie(e)||be(e)}function po(e,t,n,r,o){for(var i in e){var a,s,u,l,c
0<i.indexOf(".")&&"#"!==i.charAt(0)&&((a=function(e){if(0<e.indexOf(".")){var t=e.indexOf("@"),n=-1<t?e.substring(0,t):null,r=e.substring(t+1)
return{target:n,name:r,isOData:0===r.indexOf(bo)}}return null}(i))&&(s=a.name,c=l=null,(u=a.target)&&(l=uo(u,r),c=so(u,e[u],e,l,o)),a.isOData?ko(s,u,c,e[i],e,t,n):t[i]=e[i]))}return t}function fo(e,t,n,r,o,i,a){if("string"==typeof e)return xo(e,t,a)
if(!co(t)){if(O(e))return Bo(e,t,n,r,i,a)
if(At(e))return jo(e,t,n,r,i,a)}return e}function go(e,t){return{kind:e,type:t||null}}function mo(e,t,n){var r=e[Eo]
if(!r||"string"!=typeof r)return null
var o=r.lastIndexOf("#")
if(-1===o)return go("s")
var i=r.indexOf("@Element",o),a=i-1
a<0&&-1===(a=r.indexOf("?",o))&&(a=r.length)
var s=decodeURIComponent(r.substring(o+1,a))
if(0<s.indexOf("/$links/"))return go("l")
var u,l,c=s.split("/")
if(0<=c.length){var d=c[0],p=c[1]
if(co(d))return go("p",d)
if(vt(d))return go("c",d)
var f,g,m,h,y,_,S,T=p
if(p||(h=d.lastIndexOf("."),(_=(y=d.substring(h+1))===d?Pe(t):Ne(d.substring(0,h),t))&&(u=_.entitySet,l=y,f=b(u,function(e){return e.name===l}),g=_.functionImport,m=_.name,T=f?f.entityType:null)),0<i)return(S=go("o",T)).entitySet=f,S.functionImport=g,S.containerName=m,S
if(T)return(S=go("f",T)).entitySet=f,S.functionImport=g,S.containerName=m,S
if(O(e.value)&&!Re(d,t)){var I=e.value[0]
if(!ve(I)&&(lo(I)||!n))return go("f",null)}return go("o",d)}return null}function ho(e,t,n,r,o){if(!At(e))return e
o=o||"minimalmetadata"
var i=e[Eo],a=mo(e,t,r)
j(a)&&(a.contentTypeOdata=o)
var s,u,l,c,d,p,f,g,m,h,y,_,S,T=null
if(a)switch(delete e[Eo],T=a.type,a.kind){case"f":return qo(e,a,i,t,n)
case"c":return g=T,m=i,h=t,y=n,_={},S=Bo((f=e).value,g,_,m,h,y),H(S.__metadata,_),po(f,S,m)
case"p":return l=i,c=n,d={type:u=T},p=fo((s=e).value,u,d,l,0,null,c),po(s,{__metadata:d,value:p},l)
case"s":return function(e,t){var n,r,o=e.value,i=[],a=po(e,{collections:i},t),s=(a.__metadata||{}).properties||{}
for(ei(s.value),I(s,"value","collections"),n=0,r=o.length;n<r;n++){var u=o[n],l={title:u.name,href:E(u.url,t)},s=((l=po(u,l,t)).__metadata||{}).properties||{}
ei(s.name),ei(s.url),I(s,"name","title"),I(s,"url","href"),i.push(l)}return{workspaces:[a]}}(e,i)
case"l":return function(e,t){var n=e.value
if(!O(n))return $o(e,t)
for(var r=[],o=0,i=n.length;o<i;o++)r.push($o(n[o],t))
return po(e,{results:r},t)}(e,i)}return Go(e,a,i,t,n)}function yo(e,t){var n={},r=e.__metadata,o=t&&/\/\$links\//.test(t.request.requestUri)
return ni(e,r&&r.properties,n,o),n}function _o(e){var t=[]
for(var n in e)for(var r=0,o=e[n].length;r<o;r++)t.push(H({metadata:n},e[n][r]))
return t}function So(e){if(e){var t=e.properties.odata
return"nometadata"===t||"minimalmetadata"===t||"fullmetadata"===t}}function To(e){var t=e&&fi.exec(e)
if(t){var n,r,o=new Date(q(t[1]))
if(t[2]&&(n=q(t[3]),"-"===t[2]&&(n=-n),r=o.getUTCMinutes(),o.setUTCMinutes(r-n),o.__edmType="Edm.DateTimeOffset",o.__offset=function(e){var t
e<0?(t="-",e=-e):t="+"
var n=Math.floor(e/60)
return e-=60*n,t+It(n,2)+":"+It(e,2)}(n)),!isNaN(o.valueOf()))return o}}function Io(e){var t,n=Date.prototype.toJSON
try{Date.prototype.toJSON=function(){return ge(this)},t=U.JSON.stringify(e,gi)}finally{Date.prototype.toJSON=n}return t}var bo="odata.",Eo=bo+"metadata",vo=bo+"navigationLinkUrl",Ao=bo+"type",Do={readLink:"self",editLink:"edit",nextLink:"__next",mediaReadLink:"media_src",mediaEditLink:"edit_media",mediaContentType:"content_type",mediaETag:"media_etag",count:"__count",media_src:"mediaReadLink",edit_media:"mediaEditLink",content_type:"mediaContentType",media_etag:"mediaETag",url:"uri"},Oo="odata.id",Co="odata.etag",Ro="odata.readLink",Mo="odata.editLink",Po="odata.mediaReadLink",No="odata.mediaEditLink",ko=function(e,t,n,r,o,i,a){var s=e.substring(bo.length)
switch(s){case"navigationLinkUrl":return void Uo(s,t,n,r,o,i,a)
case"nextLink":case"count":return void Fo(s,t,r,i,a)
case"mediaReadLink":case"mediaEditLink":case"mediaContentType":case"mediaETag":return void Lo(s,t,n,r,i,a)
default:return void wo(s,t,r,i,a)}},wo=function(e,t,n,r,o){var i=r.__metadata=r.__metadata||{},a=Do[e]||e
if("editLink"===e)return i.uri=E(n,o),void(i[a]=i.uri)
if("readLink"!==e&&"associationLinkUrl"!==e||(n=E(n,o)),t){var s=i.properties=i.properties||{},u=s[t]=s[t]||{}
return"type"===e?void(u[a]=u[a]||n):void(u[a]=n)}i[a]=n},Fo=function(e,t,n,r,o){var i=Do[e];(t?r[t]:r)[i]="nextLink"===e?E(n,o):n},Lo=function(e,t,n,r,o,i){var a=o.__metadata=o.__metadata||{},s=Do[e]
if("mediaReadLink"!==e&&"mediaEditLink"!==e||(r=E(r,i)),t){var u=a.properties=a.properties||{},l=u[t]=u[t]||{}
return l.type=l.type||n,o.__metadata=a,o[t]=o[t]||{__mediaresource:{}},void(o[t].__mediaresource[s]=r)}a[s]=r},Uo=function(e,t,n,r,o,i,a){var s=i.__metadata=i.__metadata||{},u=s.properties=s.properties||{},l=u[t]=u[t]||{},c=E(r,a)
o.hasOwnProperty(t)?l.navigationLinkUrl=c:(i[t]={__deferred:{uri:c}},l.type=l.type||n)},xo=function(e,t,n){switch(t){case Ye:return Ue(e)
case He:return Fe(e,!1)
case qe:return Le(e,!1)}return n&&(Fe(e,!0)||Le(e,!0))||e},Bo=function(e,t,n,r,o,i){for(var a=he(t),s=[],u=[],l=0,c=e.length;l<c;l++){var d=so(null,e[l])||a,p={type:d},f=fo(e[l],d,p,r,0,o,i)
co(d)||ve(e[l])||s.push(p),u.push(f)}return 0<s.length&&(n.elements=s),{__metadata:{type:t},results:u}},jo=function(e,t,n,r,o,i){var a=Go(e,{type:t},r,o,i),s=a.__metadata,u=s.properties
return u&&(n.properties=u,delete s.properties),a},Go=function(e,t,n,r,o){t=t||{}
var i=e[Ao]||t.type||null,a=Me(i,r),s=!0
a||(s=!1,a=Re(i,r))
var u,l,c,d,p,f={type:i},g={__metadata:f},m={}
if(s&&a&&t.entitySet&&"minimalmetadata"==t.contentTypeOdata){var h,y,_=n.substring(0,n.lastIndexOf("$metadata")),S=null
for(a.key||(S=a);S&&!S.key&&S.baseType;)S=Me(S.baseType,r)
!(a.key||S&&S.key)||(y=a.key?Wo(e,a):Wo(e,S))&&(h={key:y,entitySet:t.entitySet,functionImport:t.functionImport,containerName:t.containerName},Vo(e,h,i,_,a,S))}for(var T in e)if(0===T.indexOf("#"))Ho(T.substring(1),e[T],g,n,r)
else if(-1===T.indexOf(".")){f.properties||(f.properties=m)
var I=e[T],b=uo(T,a)
for(S=a;a&&null===b&&S.baseType;)S=Me(S.baseType,r),b=uo(T,S)
var E,v=function(e,t,n){if(t[e+"@"+vo]||n&&n.relationship)return!0
var r=O(t[e])?t[e][0]:t[e]
return lo(r)}(T,e,b),A=so(T,I,e,b,r),D=m[T]=m[T]||{type:A}
v?(E={},t.entitySet!==x&&(E=function(i,e){return Tt(e,function(e){for(var t=e.entityContainer,n=0;n<t.length;n++){var r=t[n].entitySet
if(r)for(var o=0;o<r.length;o++)if(r[o].name==i)return{entitySet:r[o],containerName:t[n].name,functionImport:t[n].functionImport}}return null})}(function(e,t,n){if(e){var i=e.relationship,r=Tt(n,function(e){for(var t=e.entityContainer,n=0;n<t.length;n++){var r=t[n].associationSet
if(r)for(var o=0;o<r.length;o++)if(r[o].association==i)return r[o]}return null})
if(r&&r.end[0]&&r.end[1])return r.end[0].entitySet==t?r.end[1].entitySet:r.end[0].entitySet}return null}(b,t.entitySet.name,r),r)),E.contentTypeOdata=t.contentTypeOdata,E.kind=t.kind,E.type=A,g[T]=(l=E,c=n,d=r,p=o,O(u=I)?qo(u,l,c,d,p):At(u)?Go(u,l,c,d,p):null)):g[T]=fo(I,A,D,n,0,r,o)}return po(e,g,n,a,r)},Ho=function(e,t,n,r,o){if(e&&(O(t)||At(t))){var i,a,s,u=!1,l=e.lastIndexOf("."),c=e.substring(l+1),d=-1<l?e.substring(0,l):"",p=c===e||-1===d.indexOf(".")?Pe(o):Ne(d,o)
p&&(a=p.functionImport,s=c,(i=b(a,function(e){return e.name===s}))&&i.isSideEffecting&&(u=!Pt(i.isSideEffecting)))
for(var f=n.__metadata,g=u?"functions":"actions",m=E(e,r),h=O(t)?t:[t],y=0,_=h.length;y<_;y++){var S,T,I=h[y]
I&&(S=f[g]=f[g]||[],T={metadata:m,title:I.title,target:E(I.target,r)},S.push(T))}}},qo=function(e,t,n,r,o){for(var i,a=O(e)?e:e.value,s=[],u=0,l=a.length;u<l;u++)i=Go(a[u],t,n,r,o),s.push(i)
var c={results:s}
if(At(e)){for(var d in e)0===d.indexOf("#")&&(c.__metadata=c.__metadata||{},Ho(d.substring(1),e[d],c,n,r))
c=po(e,c,n)}return c},Wo=function(e,t){var n,r=t.key.propertyRef,o="("
if(1==r.length)n=Oe(t.property,r[0].name).type,o+=Xo(e[r[0].name],n)
else for(var i=!0,a=0;a<r.length;a++)i?i=!1:o+=",",n=Oe(t.property,r[a].name).type,o+=r[a].name+"="+Xo(e[r[a].name],n)
return o+=")"},Vo=function(e,t,n,r,o,i){var a,s=e[Oo]||e[Ro]||e[Mo]||t.entitySet.name+t.key
e[Oo]=r+s,e[Mo]||(e[Mo]=t.entitySet.name+t.key,t.entitySet.entityType!=n&&(e[Mo]+="/"+n)),e[Ro]=e[Ro]||e[Mo],e[Co]||(a=Ko(e,o,i))&&(e[Co]=a),Zo(e,o,i),Yo(e,o,i),Qo(e,t)},Ko=function(e,t,n){for(var r,o="",i=0;t.property&&i<t.property.length;i++)r=t.property[i],o=Jo(e,o,r)
if(n)for(i=0;n.property&&i<n.property.length;i++)r=n.property[i],o=Jo(e,o,r)
return 0<o.length?o+'"':null},Jo=function(e,t,n){return"Fixed"==n.concurrencyMode&&(0<t.length?t+=",":t+='W/"',null!==e[n.name]?t+=Xo(e[n.name],n.type):t+="null"),t},Yo=function(e,t,n){for(var r,o,i,a="@odata.navigationLinkUrl",s="@odata.associationLinkUrl",u=0;t.navigationProperty&&u<t.navigationProperty.length;u++)e[o=(r=t.navigationProperty[u].name)+a]===x&&(e[o]=e[Mo]+"/"+encodeURIComponent(r)),e[i=r+s]===x&&(e[i]=e[Mo]+"/$links/"+encodeURIComponent(r))
if(n&&n.navigationProperty)for(u=0;u<n.navigationProperty.length;u++)e[o=(r=n.navigationProperty[u].name)+a]===x&&(e[o]=e[Mo]+"/"+encodeURIComponent(r)),e[i=r+s]===x&&(e[i]=e[Mo]+"/$links/"+encodeURIComponent(r))},Xo=function(e,t){switch(e=""+zo(e,t),e=encodeURIComponent(e.replace(/'/g,"''")),t){case"Edm.Binary":return"X'"+e+"'"
case"Edm.DateTime":return"datetime'"+e+"'"
case"Edm.DateTimeOffset":return"datetimeoffset'"+e+"'"
case"Edm.Decimal":return e+"M"
case"Edm.Guid":return"guid'"+e+"'"
case"Edm.Int64":return e+"L"
case"Edm.Float":return e+"f"
case"Edm.Double":return e+"D"
case"Edm.Geography":return"geography'"+e+"'"
case"Edm.Geometry":return"geometry'"+e+"'"
case"Edm.Time":return"time'"+e+"'"
case"Edm.String":return"'"+e+"'"
default:return e}},zo=function(e,t){switch(t){case"Edm.Binary":return function(e){var t=[]
if(U.atob===x)t=F(e)
else for(var n=U.atob(e),r=0;r<n.length;r++)t.push(n.charCodeAt(r))
for(var o="",i="0123456789ABCDEF",a=0;a<t.length;a++){var s=t[a]
o+=i[s>>4],o+=i[15&s]}return o}(e)
default:return e}},Qo=function(e,t){for(var n,r=t.functionImport||[],o=0;o<r.length;o++){r[o].isBindable&&r[o].parameter[0]&&r[o].parameter[0].type==t.entitySet.entityType&&(e[n="#"+t.containerName+"."+r[o].name]==x&&(e[n]={title:r[o].name,target:e[Mo]+"/"+r[o].name}))}},Zo=function(e,t,n){(t.hasStream||n&&n.hasStream)&&(e[No]=e[No]||e[No]+"/$value",e[Po]=e[Po]||e[No])},$o=function(e,t){var n={uri:E(e.url,t)},r=((n=po(e,n,t)).__metadata||{}).properties||{}
return ei(r.url),I(r,"url","uri"),n},ei=function(e){e&&delete e.type},ti=["type","etag","media_src","edit_media","content_type","media_etag"],ni=function(e,t,n,r){for(var o in e){var i=e[o]
"__metadata"===o?function(e,t){if(e)for(var n=0,r=ti.length;n<r;n++){var o=ti[n]
ci(bo+(Do[o]||o),null,e[o],t)}}(i,n):-1===o.indexOf(".")?r&&"uri"===o?oi(i,n):ri(o,i,t,n,r):n[o]=i}},ri=function(e,t,n,r){var o=n&&n[e]||{properties:x,type:x},i=pe(t,o)
if(ve(t)||!t)return ci(Ao,e,i,r),void(r[e]=t)
if(Te(t,i)||Se(t))si(e,t,r)
else if(i||!_e(t)){if(ye(t,i))return he(i)&&ci(Ao,e,i,r),void ai(e,t,r)
r[e]={},ci(Ao,null,i,r[e]),ni(t,o.properties,r[e])}else ii(e,t,r)},oi=function(e,t){t.url=e},ii=function(e,t,n){ci(vo,e,t.__deferred.uri,n)},ai=function(e,t,n){n[e]=[]
var r=O(t)?t:t.results
ni(r,null,n[e])},si=function(e,t,n){if(Te(t)){n[e]=[]
for(var r=O(t)?t:t.results,o=0,i=r.length;o<i;o++)ui(e,r[o],!0,n)}else ui(e,t,!1,n)},ui=function(e,t,n,r){var o,i=t.__metadata&&t.__metadata.uri
i?li(e,i,n,r):(o=yo(t),n?r[e].push(o):r[e]=o)},li=function(e,t,n,r){var o=e+"@odata.bind"
if(n)return r[o]=r[o]||[],void r[o].push(t)
r[o]=t},ci=function(e,t,n,r){n!==x&&(t?r[t+"@"+e]=n:r[e]=n)},di="application/json",pi=xt(di),fi=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,gi=function(e,t){return t&&"Edm.Time"===t.__edmType?me(t):t},mi=function(e,t){return At(e)&&!e.__metadata&&O(e.EntitySets)?function(e,t){for(var n={collections:[]},r=0,o=e.EntitySets.length;r<o;r++){var i=e.EntitySets[r],a={title:i,href:E(i,t)}
n.collections.push(a)}return{workspaces:[n]}}(e,t):e},hi=function(e,t){return t&&t.lastIndexOf(";")===t.length-1&&(t=t.substr(0,t.length-1)),t&&"1.0"!==t||O(e)&&(e={results:e}),e},yi=Vt(function(e,t,n){var r,o=T(n.recognizeDates,e.recognizeDates),i=T(n.inferJsonLightFeedAsObject,e.inferJsonLightFeedAsObject),a=n.metadata,s=n.dataServiceVersion||"1.0",u=To,l="string"==typeof t?U.JSON.parse(t):t
if(ke("3.0",s)===s){if(So(n.contentType))return ho(l,a,o,i,n.contentType.properties.odata)
u=Fe}return l=(r=function(e,t){return function(e,t,n,r){if(e&&"object"==typeof e){var o,i=e.__metadata
i&&(i.actions&&(i.actions=_o(i.actions)),i.functions&&(i.functions=_o(i.functions)),o=i&&i.type)
var a=Me(o,t)||Re(o,t)
if(a){var s=a.property
if(s)for(var u=0,l=s.length;u<l;u++){var c=s[u],d=c.name,p=e[d]
if("Edm.DateTime"===c.type||"Edm.DateTimeOffset"===c.type){if(p){if(!(p=n(p)))throw{message:"Invalid date/time value"}
e[d]=p}}else"Edm.Time"===c.type&&(e[d]=Ue(p))}}else if(r)for(var f in e)"string"==typeof(p=e[f])&&(e[f]=n(p)||p)}return e}(t,a,u,o)})("",Ft(l,"",r)),l=hi(l,n.dataServiceVersion||"1.0"),mi(l,n.response.requestUri)},function(e,t,n){var r=n.dataServiceVersion||"1.0",o=T(n.useJsonLight,e.useJsonLight),i=n.contentType=n.contentType||pi
if(i&&i.mediaType===pi.mediaType){var a=t
return o||So(i)?(n.dataServiceVersion=ke(r,"3.0"),a=yo(t,n),Io(a)):(ke("3.0",r)===r&&(i.properties.odata="verbose",n.contentType=i),Io(a))}return x},di)
yi.recognizeDates=!1,yi.useJsonLight=!1,yi.inferJsonLightFeedAsObject=!1,p.jsonHandler=yi
function _i(){return Math.floor(65536*(1+Math.random())).toString(16).substr(1)}function Si(e){return e+_i()+"-"+_i()+"-"+_i()}function Ti(e){return e.handler.partHandler}function Ii(e){var t=e.boundaries
return t[t.length-1]}var bi="multipart/mixed",Ei=/^HTTP\/1\.\d (\d{3}) (.*)$/i,vi=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,Ai=function(t,n){var r="--"+Ii(n)
Ri(t,n,r),Ci(t,n)
for(var e,o=[];"--"!==e&&n.position<t.length;){var i,a=Di(t,n),s=xt(a["Content-Type"])
if(s&&s.mediaType===bi){n.boundaries.push(s.properties.boundary)
try{i=Ai(t,n)}catch(e){e.response=Oi(t,n,r),i=[e]}o.push({__changeResponses:i}),n.boundaries.pop(),Ri(t,n,"--"+Ii(n))}else{if(!s||"application/http"!==s.mediaType)throw{message:"invalid MIME part type "}
Ci(t,n)
var u=Oi(t,n,r)
try{200<=u.statusCode&&u.statusCode<=299?Ti(n.handlerContext).read(u,n.handlerContext):u={message:"HTTP request failed",response:u}}catch(e){u=e}o.push(u)}e=t.substr(n.position,2),Ci(t,n)}return o},Di=function(e,t){for(var n,r,o,i={};o=t.position,r=Ci(e,t),null!==(n=vi.exec(r))?i[n[1]]=n[2]:t.position=o,r&&n;);return Mt(i),i},Oi=function(e,t,n){var r,o,i,a=t.position,s=Ei.exec(Ci(e,t))
return s?(r=s[1],o=s[2],i=Di(e,t),Ci(e,t)):t.position=a,{statusCode:r,statusText:o,headers:i,body:Ri(e,t,"\r\n"+n)}},Ci=function(e,t){return Ri(e,t,"\r\n")},Ri=function(e,t,n){var r=t.position||0,o=e.length
if(n){if(-1===(o=e.indexOf(n,r)))return null
t.position=o+n.length}else t.position=o
return e.substring(r,o)},Mi=function(e,t){if(!At(n=e)||!O(n.__batchRequests))throw{message:"Data is not a batch object."}
for(var n,r=Si("batch_"),o=e.__batchRequests,i="",a=0,s=o.length;a<s;a++)i+=Pi(r,!1)+Ni(o[a],t)
return i+=Pi(r,!0),t.contentType.properties.boundary=r,i},Pi=function(e,t){var n="\r\n--"+e
return t&&(n+="--"),n+"\r\n"},Ni=function(e,t,n){var r=e.__changeRequests
if(O(r)){if(n)throw{message:"Not Supported: change set nested in other change set"}
for(var o=Si("changeset_"),i="Content-Type: "+bi+"; boundary="+o+"\r\n",a=0,s=r.length;a<s;a++)i+=Pi(o,!1)+Ni(r[a],t,!0)
i+=Pi(o,!0)}else{i="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n"
var u=H({},t)
u.handler=Vt,u.request=e,u.contentType=null,xe(e,Ti(t),u),i+=ki(e)}return i},ki=function(e){var t=(e.method?e.method:"GET")+" "+e.requestUri+" HTTP/1.1\r\n"
for(var n in e.headers)e.headers[n]&&(t=t+n+": "+e.headers[n]+"\r\n")
return t+="\r\n",e.body&&(t+=e.body),t}
p.batchHandler=Vt(function(e,t,n){var r=n.contentType.properties.boundary
return{__batchResponses:Ai(t,{boundaries:[r],handlerContext:n})}},function(e,t,n){if((n.contentType=n.contentType||xt(bi)).mediaType===bi)return Mi(t,n)},bi)
function wi(e,t,n){for(var r=0,o=Fi.length;r<o&&!Fi[r][e](t,n);r++);if(r===o)throw{message:"no handler for data"}}var Fi=[p.jsonHandler,p.atomHandler,p.xmlHandler,p.textHandler]
p.defaultSuccess=function(e){U.alert(U.JSON.stringify(e))},p.defaultError=e,p.defaultHandler={read:function(e,t){e&&j(e.body)&&e.headers["Content-Type"]&&wi("read",e,t)},write:function(e,t){wi("write",e,t)},accept:"application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1"},p.defaultMetadata=[],p.read=function(e,t,n,r,o,i){var a=e instanceof String||"string"==typeof e?{requestUri:e}:e
return p.request(a,t,n,r,o,i)},p.request=function(e,t,n,r,o,i){t=t||p.defaultSuccess,n=n||p.defaultError,r=r||p.defaultHandler,o=o||p.defaultHttpClient,i=i||p.defaultMetadata,e.recognizeDates=T(e.recognizeDates,p.jsonHandler.recognizeDates),e.callbackParameterName=T(e.callbackParameterName,p.defaultHttpClient.callbackParameterName),e.formatQueryString=T(e.formatQueryString,p.defaultHttpClient.formatQueryString),e.enableJsonpCallback=T(e.enableJsonpCallback,p.defaultHttpClient.enableJsonpCallback),e.useJsonLight=T(e.useJsonLight,p.jsonHandler.enableJsonpCallback),e.inferJsonLightFeedAsObject=T(e.inferJsonLightFeedAsObject,p.jsonHandler.inferJsonLightFeedAsObject)
var a,s,u,l,c,d={metadata:i,recognizeDates:e.recognizeDates,callbackParameterName:e.callbackParameterName,formatQueryString:e.formatQueryString,enableJsonpCallback:e.enableJsonpCallback,useJsonLight:e.useJsonLight,inferJsonLightFeedAsObject:e.inferJsonLightFeedAsObject}
try{return xe(e,r,d),a=e,s=t,u=n,l=r,c=d,o.request(a,function(t){try{t.headers&&Mt(t.headers),t.data===x&&204!==t.statusCode&&l.read(t,c)}catch(e){return e.request===x&&(e.request=a),e.response===x&&(e.response=t),void u(e)}s(t.data,t)},u)}catch(e){n(e)}},p.parseMetadata=function(e){return oo(0,e)},p.batchHandler.partHandler=p.defaultHandler
function Li(){var e={v:this.valueOf(),t:"[object Date]"}
for(var t in this)e[t]=this[t]
return e}function Ui(e,t){if(t&&"[object Date]"===t.t){var n=new Date(t.v)
for(var r in t)"t"!==r&&"v"!==r&&(n[r]=t[r])
t=n}return t}function xi(e,t){return e.name+"#!#"+t}function Bi(e,t){return t.replace(e.name+"#!#","")}function ji(e){this.name=e}var Gi=null
ji.create=function(e){if(ji.isSupported())return Gi=Gi||U.localStorage,new ji(e)
throw{message:"Web Storage not supported by the browser"}},ji.isSupported=function(){return!!U.localStorage},ji.prototype.add=function(t,n,r,o){o=o||this.defaultError
var i=this
this.contains(t,function(e){e?G(o,{message:"key already exists",key:t}):i.addOrUpdate(t,n,r,o)},o)},ji.prototype.addOrUpdate=function(e,t,n,r){if(r=r||this.defaultError,e instanceof Array)r({message:"Array of keys not supported"})
else{var o=xi(this,e),i=Date.prototype.toJSON
try{var a=t
a!==x&&(Date.prototype.toJSON=Li,a=U.JSON.stringify(t)),Gi.setItem(o,a),G(n,e,t)}catch(e){22===e.code||2147942414===e.number?G(r,{name:"QUOTA_EXCEEDED_ERR",error:e}):G(r,e)}finally{Date.prototype.toJSON=i}}},ji.prototype.clear=function(e,t){t=t||this.defaultError
try{for(var n=0,r=Gi.length;0<r&&n<r;){var o=Gi.key(n)
o!==Bi(this,o)?(Gi.removeItem(o),r=Gi.length):n++}G(e)}catch(e){G(t,e)}},ji.prototype.close=function(){},ji.prototype.contains=function(e,t,n){n=n||this.defaultError
try{var r=xi(this,e),o=Gi.getItem(r)
G(t,null!==o)}catch(e){G(n,e)}},ji.prototype.defaultError=e,ji.prototype.getAllKeys=function(e,t){t=t||this.defaultError
var n,r,o=[]
try{for(n=0,r=Gi.length;n<r;n++){var i=Gi.key(n),a=Bi(this,i)
i!==a&&o.push(a)}G(e,o)}catch(e){G(t,e)}},ji.prototype.mechanism="dom",ji.prototype.read=function(e,t,n){if(n=n||this.defaultError,e instanceof Array)n({message:"Array of keys not supported"})
else try{var r=xi(this,e),o=null!==(o=Gi.getItem(r))&&"undefined"!==o?U.JSON.parse(o,Ui):x
G(t,e,o)}catch(e){G(n,e)}},ji.prototype.remove=function(e,t,n){if(n=n||this.defaultError,e instanceof Array)n({message:"Batches not supported"})
else try{var r=xi(this,e)
Gi.removeItem(r),G(t)}catch(e){G(n,e)}},ji.prototype.update=function(t,n,r,o){o=o||this.defaultError
var i=this
this.contains(t,function(e){e?i.addOrUpdate(t,n,r,o):G(o,{message:"key not found",key:t})},o)}
function Hi(r,o){return function(t){var e=r||o
if(e){if("[object IDBDatabaseException]"===Object.prototype.toString.call(t))return 11===t.code?void e({name:"QuotaExceededError",error:t}):void e(t)
try{var n=(t.target.error||t).name}catch(e){n="blocked"===t.type?"IndexedDBBlocked":"UnknownError"}e({name:n,error:t})}}}function qi(t,n,r,e){var o,i,a,s,u,l=t.name,c=t.db,d=Hi(e,t.defaultError)
c?r(c.transaction(l,n)):(o=function(e){t.db=e,r(e.transaction(l,n))},i=d,a=t.name,s="_datajs_"+a,(u=Vi.open(s)).onblocked=i,u.onerror=i,u.onupgradeneeded=function(){var e=u.result
e.objectStoreNames.contains(a)||e.createObjectStore(a)},u.onsuccess=function(e){var t=u.result
if(!t.objectStoreNames.contains(a)){if("setVersion"in t){var n=t.setVersion("1.0")
return n.onsuccess=function(){n.transaction.oncomplete=function(){o(t)},t.createObjectStore(a,null,!1)},n.onerror=i,void(n.onblocked=i)}return e.target.error={name:"DBSchemaMismatch"},void i(e)}t.onversionchange=function(e){e.target.close()},o(t)})}function Wi(e){this.name=e}var Vi=U.mozIndexedDB||U.webkitIndexedDB||U.msIndexedDB||U.indexedDB,Ki=U.IDBKeyRange||U.webkitIDBKeyRange,Ji=U.IDBTransaction||U.webkitIDBTransaction||{},Yi=Ji.READ_ONLY||"readonly",Xi=Ji.READ_WRITE||"readwrite"
Wi.create=function(e){if(Wi.isSupported())return new Wi(e)
throw{message:"IndexedDB is not supported on this browser"}},Wi.isSupported=function(){return!!Vi},Wi.prototype.add=function(n,r,o,i){var a=this.name,s=this.defaultError,u=[],l=[],l=n instanceof Array?(u=n,r):(u=[n],[r])
qi(this,Xi,function(e){e.onabort=Hi(i,s),e.oncomplete=function(){n instanceof Array?o(u,l):o(n,r)}
for(var t=0;t<u.length&&t<l.length;t++)e.objectStore(a).add({v:l[t]},u[t])},i)},Wi.prototype.addOrUpdate=function(r,o,i,a){var s=this.name,u=this.defaultError,l=[],c=[],c=r instanceof Array?(l=r,o):(l=[r],[o])
qi(this,Xi,function(e){e.onabort=Hi(a,u),e.oncomplete=function(){r instanceof Array?i(l,c):i(r,o)}
for(var t=0;t<l.length&&t<c.length;t++){var n={v:c[t]}
e.objectStore(s).put(n,l[t])}},a)},Wi.prototype.clear=function(t,n){var r=this.name,o=this.defaultError
qi(this,Xi,function(e){e.onerror=Hi(n,o),e.oncomplete=function(){t()},e.objectStore(r).clear()},n)},Wi.prototype.close=function(){this.db&&(this.db.close(),this.db=null)},Wi.prototype.contains=function(n,r,o){var i=this.name,a=this.defaultError
qi(this,Yi,function(e){var t=e.objectStore(i).get(n)
e.oncomplete=function(){r(!!t.result)},e.onerror=Hi(o,a)},o)},Wi.prototype.defaultError=e,Wi.prototype.getAllKeys=function(r,o){var i=this.name,a=this.defaultError
qi(this,Xi,function(e){var n=[]
e.oncomplete=function(){r(n)}
var t=e.objectStore(i).openCursor()
t.onerror=Hi(o,a),t.onsuccess=function(e){var t=e.target.result
t&&(n.push(t.key),t.continue.call(t))}},o)},Wi.prototype.mechanism="indexeddb",Wi.prototype.read=function(o,i,a){var s=this.name,u=this.defaultError,l=o instanceof Array?o:[o]
qi(this,Yi,function(e){var n=[]
e.onerror=Hi(a,u),e.oncomplete=function(){o instanceof Array?i(l,n):i(l[0],n[0])}
for(var t=0;t<l.length;t++){var r=e.objectStore(s)
r.get.call(r,l[t]).onsuccess=function(e){var t=e.target.result
n.push(t?t.v:x)}}},a)},Wi.prototype.remove=function(e,r,o){var i=this.name,a=this.defaultError,s=e instanceof Array?e:[e]
qi(this,Xi,function(e){e.onerror=Hi(o,a),e.oncomplete=function(){r()}
for(var t=0;t<s.length;t++){var n=e.objectStore(i)
n.delete.call(n,s[t])}},o)},Wi.prototype.update=function(o,i,a,s){var u=this.name,l=this.defaultError,c=[],d=[],d=o instanceof Array?(c=o,i):(c=[o],[i])
qi(this,Xi,function(n){n.onabort=Hi(s,l),n.oncomplete=function(){o instanceof Array?a(c,d):a(o,i)}
for(var e=0;e<c.length&&e<d.length;e++){var t=n.objectStore(u).openCursor(Ki.only(c[e])),r={v:d[e]}
t.pair={key:c[e],value:r},t.onsuccess=function(e){var t=e.target.result
t?t.update(e.target.pair.value):n.abort()}}},s)}
function zi(e){var i=[],a=[],s={}
function u(e){return e||this.defaultError}function l(e,t){var n
return e instanceof Array&&(n="Array of keys not supported"),e!==x&&null!==e||(n="Invalid key"),!n||(G(t,{message:n}),!1)}this.name=e,this.add=function(e,t,n,r){r=u(r),l(e,r)&&(s.hasOwnProperty(e)?r({message:"key already exists",key:e}):this.addOrUpdate(e,t,n,r))},this.addOrUpdate=function(e,t,n,r){var o
r=u(r),l(e,r)&&((o=s[e])===x&&(o=0<i.length?i.splice(0,1):a.length),a[o]=t,s[e]=o,G(n,e,t))},this.clear=function(e){a=[],s={},i=[],G(e)},this.contains=function(e,t){var n=s.hasOwnProperty(e)
G(t,n)},this.getAllKeys=function(e){var t=[]
for(var n in s)t.push(n)
G(e,t)},this.read=function(e,t,n){var r
n=u(n),l(e,n)&&(r=s[e],G(t,e,a[r]))},this.remove=function(e,t,n){var r
n=u(n),l(e,n)&&((r=s[e])!==x&&(r===a.length-1?a.pop():(a[r]=x,i.push(r)),delete s[e],0===a.length&&(i=[])),G(t))},this.update=function(e,t,n,r){r=u(r),l(e,r)&&(s.hasOwnProperty(e)?this.addOrUpdate(e,t,n,r):r({message:"key not found",key:e}))}}zi.create=function(e){return new zi(e)},zi.isSupported=function(){return!0},zi.prototype.close=function(){},zi.prototype.defaultError=e,zi.prototype.mechanism="memory"
var Qi={indexeddb:Wi,dom:ji,memory:zi}
B.defaultStoreMechanism="best",B.createStore=function(e,t){"best"===(t=t||B.defaultStoreMechanism)&&(t=ji.isSupported()?"dom":"memory")
var n=Qi[t]
if(n)return n.create(e)
throw{message:"Failed to create store",name:e,mechanism:t}}
function Zi(e,t){return{method:"GET",requestUri:e,user:t.user,password:t.password,enableJsonpCallback:t.enableJsonpCallback,callbackParameterName:t.callbackParameterName,formatQueryString:t.formatQueryString}}function $i(e){var t,n,r,o,i,l=this,c=e.source
return l.identifier=(t=encodeURI(decodeURI(c)),r=d(t),o=r.scheme,i=r.authority,o&&(r.scheme=o.toLowerCase(),!i||(n=P.exec(i))&&(r.authority="//"+(n[1]?n[1]+"@":"")+n[2].toLowerCase()+(n[3]?":"+n[3]:""))),(t=f(r)).replace(N,function(e){return e.toLowerCase()})),l.options=e,l.count=function(n,r){var e,t,o,i,a=l.options
return p.request(Zi((t="$count",o=(e=c).indexOf("?"),i="",0<=o&&(i=e.substr(o),e=e.substr(0,o)),"/"!==e[e.length-1]&&(e+="/"),e+t+i),a),function(e){var t=q(e.toString())
isNaN(t)?r({message:"Count is NaN",count:t}):n(t)},r,x,a.httpClient,a.metadata)},l.read=function(e,t,n,r){var o,i,a,s,u
return s="$skip="+e+"&$top="+t,u=0<=(a=c).indexOf("?")?"&":"?",o=a+u+s,i=l.options,ia(o,i,[],n,r)},l}function ea(e,t){if(e===x||"number"!=typeof e)throw{message:"'"+t+"' must be a number."}
if(isNaN(e)||e<0||!isFinite(e))throw{message:"'"+t+"' must be greater than or equal to zero."}}function ta(e,t){if(e!==x&&("number"!=typeof e||isNaN(e)||!isFinite(e)))throw{message:"'"+t+"' must be a number."}}function na(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.splice(n,1),!0
return!1}function ra(e,t,n){return{i:e=Math.floor(e/n)*n,c:(t=Math.ceil((t+1)/n)*n)-e}}function oa(r,e,t,n,o,i,a){var s,u,l=this
l.p=e,l.i=n,l.c=o,l.d=i,l.s=fa,l.canceled=!1,l.pending=a,l.oncomplete=null,l.cancel=function(){var e
!t||"error"!==(e=l.s)&&e!==pa&&e!==da&&(l.canceled=!0,c(da,s))},l.complete=function(){c(pa,s)},l.error=function(e){l.canceled||c("error",e)},l.run=function(e){u=e,l.transition(l.s,s)},l.wait=function(e){c("wait",e)}
var c=function(e,t){!function(e,t,n){switch(e){case fa:"init"!==t&&r(l,e,t,n)
break
case"wait":r(l,e,t,n)
break
case da:r(l,e,t,n),l.fireCanceled(),c(pa)
break
case"error":r(l,e,t,n),l.canceled=!0,l.fireRejected(n),c(pa)
break
case pa:l.oncomplete&&l.oncomplete(l),l.canceled||l.fireResolved(),r(l,e,t,n)
break
default:r(l,e,t,n)}}(l.s=e,u,s=t)}
return l.transition=c,l}var ia=function(e,r,o,i,a){var t=Zi(e,r),s=p.request(t,function(e){var t=e.__next,n=e.results
o=o.concat(n),t?s=ia(t,r,o,i,a):i(o)},a,x,r.httpClient,r.metadata)
return{abort:function(){s.abort()}}},aa=function(e,t){var n,r=e.i+e.c,o=t.i+t.c,i=e.i>t.i?e.i:t.i,a=r<o?r:o
return i<=a&&(n={i:i,c:a-i}),n},sa=function(e){var t=0,n=typeof e
if("object"==n&&e)for(var r in e)t+=2*r.length+sa(e[r])
else t="string"==n?2*e.length:8
return t},ua="destroy",la="idle",ca="prefetch",da="cancel",pa="end",fa="start",ga="done",ma="local"
oa.prototype.fireResolved=function(){var e=this.p
e&&(this.p=null,e.resolve(this.d))},oa.prototype.fireRejected=function(e){var t=this.p
t&&(this.p=null,t.reject(e))},oa.prototype.fireCanceled=function(){this.fireRejected({canceled:!0,message:"Operation canceled"})}
function ha(e){var a,o="init",b={counts:0,netReads:0,prefetches:0,cacheReads:0},i=[],s=[],g=[],E=0,m=!1,v=W(e.cacheSize,1048576),u=0,l=0,c=0,A=0===v,D=W(e.pageSize,50),h=W(e.prefetchSize,D),r="1.0",n=0,O=e.source
"string"==typeof O&&(O=new $i(e)),O.options=e
var C=B.createStore(e.name,e.mechanism),y=this
function d(r){return function(e){var t,n
for(a={message:r,error:e},t=0,n=s.length;t<n;t++)s[t].fireRejected(a)
for(t=0,n=i.length;t<n;t++)i[t].fireRejected(a)
s=i=null}}function R(e){if(e!==o){o=e
for(var t=i.concat(s,g),n=0,r=t.length;n<r;n++)t[n].run(o)}}function p(){var t=new V
return C.clear(function(){m=!1,A=(c=l=u=E=0)===v,b={counts:0,netReads:0,prefetches:0,cacheReads:0},y.stats=b,C.close(),t.resolve()},function(e){t.reject(e)}),t}function f(e){var t=na(i,e);(t=t||na(s,e))||na(g,e),n--,R(la)}function M(){y.onidle&&0===n&&y.onidle()}function _(e,t,n,r){var o=e.canceled&&t!==pa
return o&&t===da&&r&&r.cancel&&r.cancel(),o}y.onidle=e.idle,y.stats=b,y.count=function(){if(a)throw a
var t=de(),n=!1
if(m)return G(function(){t.resolve(u)}),t.promise()
var r=O.count(function(e){r=null,b.counts++,t.resolve(e)},function(e){r=null,t.reject(H(e,{canceled:n}))})
return H(t.promise(),{cancel:function(){r&&(n=!0,r.abort(),r=null)}})},y.clear=function(){if(a)throw a
if(0!==i.length)return i[0].p
var e=de(),t=new oa(I,e,!1)
return T(t,i),e.promise()},y.filterForward=function(e,t,n){return S(e,t,n,!1)},y.filterBack=function(e,t,n){return S(e,t,n,!0)},y.readRange=function(e,t){if(ea(e,"index"),ea(t,"count"),a)throw a
var n=de(),r=new oa(F,n,!0,e,t,[],0)
return T(r,s),H(n.promise(),{cancel:function(){r.cancel()}})},y.ToObservable=y.toObservable=function(){if(!U.Rx||!U.Rx.Observable)throw{message:"Rx library not available - include rx.js"}
if(a)throw a
return U.Rx.Observable.CreateWithDisposable(function(r){function o(e){i||r.OnError(e)}var i=!1,a=0,s=function(e){if(!i){for(var t=0,n=e.length;t<n;t++)r.OnNext(e[t])
e.length<D?r.OnCompleted():(a+=D,y.readRange(a,D).then(s,o))}}
return y.readRange(a,D).then(s,o),{Dispose:function(){i=!0}}})}
var S=function(e,l,c,d){if(e=q(e),l=q(l),isNaN(e))throw{message:"'index' must be a valid number.",index:e}
if(isNaN(l))throw{message:"'count' must be a valid number.",count:l}
if(a)throw a
e=Math.max(e,0)
var p=de(),f=[],t=!1,n=null,g=function(s,u){t||(0<=l&&f.length>=l?p.resolve(f):n=y.readRange(s,u).then(function(e){for(var t,n=0,r=e.length;n<r&&(l<0||f.length<l);n++){var o,i=d?r-n-1:n,a=e[i]
c(a)&&(o={index:s+i,item:a},d?f.unshift(o):f.push(o))}!d&&e.length<u||d&&s<=0?p.resolve(f):(t=d?Math.max(s-D,0):s+u,g(t,D))},function(e){p.reject(e)}))},r=ra(e,e,D),o=d?r.i:e,i=d?e-r.i+1:r.i+r.c-e
return g(o,i),H(p.promise(),{cancel:function(){n&&n.cancel(),t=!0}})},T=function(e,t){e.oncomplete=f,t.push(e),n++,e.run(o)},P=function(e,t){var n={actualCacheSize:E,allDataLocal:m,cacheSize:v,collectionCount:u,highestSavedPage:l,highestSavedPageSize:c,pageSize:D,sourceId:O.identifier,version:r}
C.addOrUpdate("__settings",n,e,t)},N=function(e){return function(){e.resolve(!1)}},k=function(e,t){var n=e.c,r=e.i
0===n?l===r-D&&(u=l+c):((l=Math.max(l,r))===r&&(c=n),E+=t,n<D&&!u&&(u=r+n)),m||u!==l+c||(m=!0)},I=function(e,t,n){var r=e.transition
if(n!==ua)return R(ua),!0
switch(t){case fa:r("clear")
break
case pa:M()
break
case"clear":p().then(function(){e.complete()}),e.wait()
break
default:return!1}return!0},w=function(e,t,n,r){if(!_(e,t,0,r)){var o=e.transition
if(n!==ca)return n===ua?t!==da&&e.cancel():n===la&&R(ca),!0
switch(t){case fa:g[0]===e&&o(ma,e.i)
break
case ga:var i=e.pending
0<i&&(i-=Math.min(i,r.c)),m||0===i||r.c<D||A?e.complete():(e.pending=i,o(ma,r.i+D))
break
default:return L(e,t,n,r,!0)}}return!0},F=function(e,t,n,r){if(!_(e,t,0,r)){var o,i=e.transition
if("read"!==n&&t!==fa)return n===ua?t!==fa&&e.cancel():"write"!==n&&R("read"),!0
switch(t){case fa:n!==la&&n!==ca||(R("read"),0<e.c?(o=ra(e.i,e.c,D),i(ma,o.i)):i(ga,e))
break
case ga:(f=aa(l=e,c=r))&&(p=(d=f.i-c.i)+(l.c-l.d.length),l.d=l.d.concat(c.d.slice(d,p)))
var a=e.d.length
e.c===a||r.c<D?(b.cacheReads++,s=r.i+r.c,m||0===h||A||(0===g.length||g[0]&&-1!==g[0].c)&&(u=new oa(w,null,!0,s,h,null,h),T(u,g)),e.complete()):i(ma,r.i+D)
break
default:return L(e,t,n,r,!1)}}var s,u,l,c,d,p,f
return!0},L=function(n,e,t,r,o){var i,a,s,u,l,c,d,p,f,g,m,h,y,_=n.error,S=n.transition,T=n.wait
switch(e){case pa:M()
break
case ma:g=r,m=!1,h=H(new V,{cancel:function(){m=!0}}),y=N(h,"Read page from store failure"),C.contains(g,function(e){m||(e?C.read(g,function(e,t){m||h.resolve(t!==x,t)},y):h.resolve(!1))},y),i=h.then(function(e,t){n.canceled||(e?S(ga,t):S("source",r))})
break
case"source":d=r,p=new V,f=O.read(d,D,function(e){var t={i:d,c:e.length,d:e}
p.resolve(t)},function(e){p.reject(e)}),i=H(p,{cancel:function(){f&&(f.abort(),f=null)}}).then(function(e){n.canceled||(o?b.prefetches++:b.netReads++,S("save",e))},_)
break
case"save":"write"!==t&&(R("write"),a=r.i,s=r,l=H(new V,{cancel:function(){0}}),c=N(l,"Save page to store failure"),0<s.c?(u=sa(s),(A=0<=v&&v<E+u)?I():C.addOrUpdate(a,s,function(){k(s,u),P(I,c)},c)):(k(s,0),P(I,c)),i=l.then(function(e){n.canceled||(!e&&o&&(n.pending=0),S(ga,r)),R(la)}))
break
default:return!1}function I(){l.resolve(!0)}return i&&(n.canceled?i.cancel():n.s===e&&T(i)),!0}
return C.read("__settings",function(e,t){if(j(t)){var n=t.version
if(!n||0!==n.indexOf("1."))return void d("Unsupported cache store version "+n)()
D!==t.pageSize||O.identifier!==t.sourceId?p().then(function(){R(la)},d("Unable to clear store during initialization")):(E=t.actualCacheSize,m=t.allDataLocal,v=t.cacheSize,u=t.collectionCount,l=t.highestSavedPage,c=t.highestSavedPageSize,r=n,R(la))}else P(function(){R(la)},d("Unable to write settings during initialization."))},d("Unable to read settings from store.")),y}B.createDataCache=function(e){if(!function(e,t){if(e!==x){if("number"!=typeof e)throw{message:"'"+t+"' must be a number."}
if(isNaN(e)||e<=0||!isFinite(e))throw{message:"'"+t+"' must be greater than zero."}}}(e.pageSize,"pageSize"),ta(e.cacheSize,"cacheSize"),ta(e.prefetchSize,"prefetchSize"),!j(e.name))throw{message:"Undefined or null name",options:e}
if(!j(e.source))throw{message:"Undefined source",options:e}
return new ha(e)}}(window)},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ODataRequestPromiseHandler=void 0
var f=n(0),g=n(103),m=n(7),a=f.__importDefault(n(6)),r=(o.prototype.generateRequestPromise=function(t,e,n,r){var o=this
return t.logCreator().restStartExecuting(),t.hasExpired()?new Promise(function(e){return e(o.defaultResponseForExpiredRequest(t))}):fetch(e.toString(),n).then(function(e){return o.handleDataOrError(t,r,e,null)}).catch(function(e){return o.handleDataOrError(t,r,null,e)})},o.prototype.handleDataOrError=function(a,s,u,l){var c,d,p
return f.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return f.__generator(this,function(e){switch(e.label){case 0:if(t={error:"",status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:a,responseStatusCode:u?u.status:0},u&&(u.ok||a.isNonFatalErrorCode(u.status.toString()))||l||(l=new Error("statusCode: "+u.status+", statusText: "+u.statusText+" ")),u&&(n=null===(c=u.headers)||void 0===c?void 0:c.get("request-id"),a.getlogCreator().setResponseRequestId(n)),l)return 403!==(null==u?void 0:u.status)&&401!==(null==u?void 0:u.status)||(this.logAndVerifyToken(s,a.getlogCreator()),this.logAuthFailedReasonHeader(null==u?void 0:u.headers,a.getlogCreator())),429===(null==u?void 0:u.status)&&(t.throttled={isThrottled:!0,scope:null!==(d=g.ThrottledScope[u.headers.get("RateLimit-Scope")])&&void 0!==d?d:g.ThrottledScope.Mailbox,retryAfterInMilliseconds:Number(null!==(p=u.headers.get("Retry-After"))&&void 0!==p?p:1)*m.Constants.oneSecondInMilliseconds}),a.logCreator().unexpectedFail(l.message),t.status=Office.AsyncResultStatus.Failed,t.error=l.message,[2,t]
if(!u.headers.get("content-type")&&204!==u.status&&202!==u.status)return t.error="Content-type is missing in the header.",a.logCreator().unexpectedFail(t.error),t.status=Office.AsyncResultStatus.Failed,[2,t]
e.label=1
case 1:return e.trys.push([1,3,,4]),[4,u.text()]
case 2:return r=e.sent(),o=r?JSON.parse(r):{},a.requiresCount()&&null==o["@odata.count"]?(t.error="@odata.count is missing in the body",a.logCreator().unexpectedFail(t.error),t.status=Office.AsyncResultStatus.Failed):(a.logCreator().success(),t.status=Office.AsyncResultStatus.Succeeded,t.result=o),[2,t]
case 3:return i=e.sent(),a.logCreator().unexpectedFail("fails: "+JSON.stringify(i)),t.status=Office.AsyncResultStatus.Failed,t.error="Fail to convert to JSON",[2,t]
case 4:return[2]}})})},o.prototype.logAndVerifyToken=function(t,n){try{var e,r,o,i=a.default.parseJWTToken(t).exp-(new Date).getTime()/m.Constants.oneSecondInMilliseconds
i<=0?n.expectedFail("token expires"+i):(e=a.default.parseJWTToken(t).scp,r=a.default.parseJWTToken(t).ver,o=a.default.parseJWTToken(t).aud,n.expectedFail("token has the following scp "+e+", ver is "+r+", aud is "+o+", restUrl is "+Office.context.mailbox.restUrl))}catch(e){n.expectedFail("token parse fails:"+JSON.stringify(e)+", with token header"+t.substring(0,10))}},o.prototype.logAuthFailedReasonHeader=function(e,t){var n
e&&(n=e.get("x-ms-diagnostics"),t.expectedFail(n))},o.prototype.defaultResponseForExpiredRequest=function(e){return{error:"Request expired before execution",status:Office.AsyncResultStatus.Failed,result:null,sourceRequest:e,responseStatusCode:504}},o)
function o(){}t.ODataRequestPromiseHandler=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o=n(0),i=o.__importStar(n(34)),a=o.__importDefault(n(199)),s=o.__importDefault(n(375)),u=o.__importStar(n(65)),l=o.__importDefault(n(6)),r=(c.executeRequest=function(n,r){return void 0===r&&(r=i.RequestPriority.Low),o.__awaiter(this,void 0,void 0,function(){var t
return o.__generator(this,function(e){switch(e.label){case 0:return[4,s.default.executePromiseWithRetry(n,this.executeRequestPromise,r)]
case 1:return(t=e.sent()).status!==Office.AsyncResultStatus.Succeeded?n.logCreator().unexpectedFail(JSON.stringify(t),"","RoamingSettingsType:"+u.RoamingSettingsUtils.getRoamingSettingsTypeString(n.context.rsType)):n.logCreator().success("RoamingSettingsType:"+u.RoamingSettingsUtils.getRoamingSettingsTypeString(n.context.rsType)),[2,t]}})})},c.executeRequestPromise=function(r,e){return a.default.execute(function(){return new Promise(function(n){r.logCreator().ewsStartExecuting(),u.default.executeSaveAsyncCallbackInQueue(function(e){var t={error:l.default.buildErrorMessage(e.error),status:e.status,result:e.value,sourceRequest:r}
n(t)})})},e)},c)
function c(){}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingsRequest=void 0
var s,r=n(0),u=r.__importDefault(n(282)),o=n(5),i=n(377),a=(s=i.RequestBase,r.__extends(l,s),Object.defineProperty(l.prototype,"logCreator",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),l.prototype.getlogCreator=function(){return this.logCreator()},l.prototype.toTraceString=function(){return"RoamingSettingsRequest"},r.__decorate([o.doop],l.prototype,"logCreator",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r,o,i){var a=s.call(this)||this
return a.context=null,a.logCreator(new u.default(t,n,r,o,i)),a.context=e,a}t.RoamingSettingsRequest=a},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.VivaLicenseType=void 0,(r=t.VivaLicenseType||(t.VivaLicenseType={})).None="None",r.VivaP1License="VivaP1License",r.E3E5License="E3E5License"},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightsDependencies=void 0
var r=n(0),o=r.__importDefault(n(25)),i=r.__importDefault(n(8)),a=r.__importDefault(n(6)),s=r.__importDefault(n(500)),u=r.__importDefault(n(117)),l=r.__importDefault(n(380)),c=r.__importDefault(n(173)),d=r.__importDefault(n(104)),p=r.__importDefault(n(236)),f=r.__importDefault(n(91)),g=r.__importDefault(n(286)),m=r.__importDefault(n(842)),h=r.__importDefault(n(89)),y=r.__importDefault(n(37)),_=r.__importDefault(n(132)),S=r.__importDefault(n(506)),T=r.__importDefault(n(383)),I=r.__importDefault(n(384)),b=r.__importDefault(n(507)),E=r.__importDefault(n(204)),v=r.__importDefault(n(118)),A=r.__importDefault(n(849)),D=r.__importDefault(n(293)),O=r.__importDefault(n(294)),C=r.__importDefault(n(295)),R=r.__importDefault(n(914)),M=r.__importDefault(n(241)),P=r.__importDefault(n(207)),N=r.__importDefault(n(242)),k=r.__importDefault(n(93)),w=r.__importDefault(n(524)),F=r.__importDefault(n(297)),L=r.__importDefault(n(237)),U=r.__importDefault(n(296)),x=r.__importDefault(n(526)),B=r.__importDefault(n(298)),j=r.__importDefault(n(299)),G=r.__importDefault(n(178)),H=r.__importDefault(n(934)),q=r.__importDefault(n(64)),W=r.__importDefault(n(105)),V=r.__importDefault(n(300)),K=r.__importDefault(n(392)),J=r.__importDefault(n(120)),Y=r.__importDefault(n(301)),X=r.__importDefault(n(302)),z=r.__importDefault(n(303)),Q=r.__importDefault(n(938)),Z=r.__importDefault(n(304)),$=r.__importDefault(n(393)),ee=r.__importDefault(n(179)),te=r.__importDefault(n(152)),ne=r.__importDefault(n(951)),re=r.__importDefault(n(153)),oe=r.__importDefault(n(952)),ie=(ae.prototype.getRootDependency=function(){return this.InsightsScenario},Object.defineProperty(ae.prototype,"InsightsScenario",{get:function(){return new s.default({highPriority:[this.ActionLogItems,this.FirstRun,this.TeachingMoment,this.OutcomeDataStream,this.CurrentSentMailStatsDataStream,this.DocumentsToCatchupDataStream,this.TaskDataStream,this.UnreadMailDataStream,this.CatchUpImportantMailDataStream,this.FollowUpRequestTaskEntityDataStream,this.FollowUpsDataStream,this.DirectReportsDataStream,this.MailFoldersDataStream,this.SmartRulesSuggestionDataStream,this.PeopleSuggestionsDataStream,this.TimeAwayDataStream,this.MeetingPreparationDataStream,this.MeetingRelatedDocumentsDataStream,this.CalendarDataStream,this.UserAvailabilityDataStream,this.FocusGoalDaysToBookDataStream,this.ProtectedTimeSettingsDataStream,this.DirectReportBookOneOnOneDataStream,this.DirectReportConflictingOneOnOneDataStream,this.CurrentItemDataStream,this.DelayDeliveryDataStream,this.AutoDelayDeliveryAdvertisementDataStream,this.SearchContextInsightsDataStream,this.TeamsGroupSuggestionDataStream,this.LunchTimeSettingsDataStream],lowPriority:[this.MeetingSuggestionDataStream,this.ImportantPeopleAvailabilityDataStream,this.QualifiedSentMailStatsDataStream,this.LogRoamingSettings,this.CleanupDataStream],isEnabledCallback:function(){return!a.default.isInMockMode&&!q.default.getState().isMyAOptedOut()&&!q.default.getState().isAddInOptedOut()}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"ActionLogItems",{get:function(){return new s.default({requestDataCallback:function(){u.default.loadActionLogItemsState()}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"OutcomeDataStream",{get:function(){return new s.default({requestDataCallback:function(){l.default.getAllOutcomes()},isEnabledCallback:function(){return i.default.isOutcomeEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"FirstRun",{get:function(){return new s.default({requestDataCallback:function(){I.default.getRoamingSettings()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"TeachingMoment",{get:function(){return new s.default({requestDataCallback:function(){L.default.initializeTeachingMomentStatusFromRoamingSettings()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"CurrentSentMailStatsDataStream",{get:function(){return new s.default({requestDataCallback:function(){w.default.getCurrentItemSentStatistics()},isEnabledCallback:function(){return i.default.areSentMailStatisticsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"QualifiedSentMailStatsDataStream",{get:function(){return new s.default({requestDataCallback:function(){w.default.requestSentMailStatistics()},isEnabledCallback:function(){return i.default.areSentMailStatisticsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"TaskDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getTaskInsight()},isEnabledCallback:function(){return i.default.isTaskInsightEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"FollowUpsDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getFollowUpsInsight()},isEnabledCallback:function(){return i.default.isFollowUpsTaskSuggestionMigrationEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DirectReportBookOneOnOneDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getDirectReportBookOneOnOneInsight()},isEnabledCallback:function(){return i.default.isBookOneOnOneEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DirectReportConflictingOneOnOneDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getDirectReportConflictingOneOnOneInsight()},isEnabledCallback:function(){return i.default.isManagerEffectivenessEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DirectReportsDataStream",{get:function(){return new s.default({requestDataCallback:function(){K.default.getAllDirectReports()},isEnabledCallback:function(){return i.default.isManagerEffectivenessEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"MeetingPreparationDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getMeetingPreparationCardInsight()},isEnabledCallback:function(){return i.default.isMeetingPreparationCardEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"MeetingRelatedDocumentsDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getMeetingRelatedDocumentsInsight()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"SmartRulesSuggestionDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getSmartRulesSuggestionInsight()},isEnabledCallback:function(){return i.default.isSmartRulesSuggestionEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"MailFoldersDataStream",{get:function(){return new s.default({requestDataCallback:function(){Q.default.getMailFolders()},isEnabledCallback:function(){return i.default.isSmartRulesSuggestionEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DocumentsToCatchupDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getDocumentsToCatchupInsight()},isEnabledCallback:function(){return i.default.isDocumentsToCatchupEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"FocusGoalDaysToBookDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getFocusGoalDaysToBookInsight()},isEnabledCallback:function(){return i.default.isOutcomeEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"UnreadMailDataStream",{get:function(){return new s.default({requestDataCallback:function(){U.default.getUnreadMailFromIRanker()},isEnabledCallback:function(){return i.default.isIRankerInAgaveEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DirectReportUnreadMailDataStream",{get:function(){return new s.default({requestDataCallback:function(){x.default.getUnreadMailFromDirectReports()},isEnabledCallback:function(){return i.default.isManagerEffectivenessEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"MeetingSuggestionDataStream",{get:function(){return new s.default({requestDataCallback:function(){p.default.getMeetingSuggestionCalendarItemsAndDispatch()},isEnabledCallback:function(){return i.default.isMeetingSuggestionEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"UserAvailabilityDataStream",{get:function(){return new s.default({requestDataCallback:function(){H.default.getFreeTime()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"ImportantPeopleAvailabilityDataStream",{get:function(){return new s.default({requestDataCallback:function(){H.default.getImportantPeopleAvailability()},isEnabledCallback:function(){return i.default.isMeetingSuggestionEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"CalendarDataStream",{get:function(){return new s.default({requestDataCallback:function(){d.default.getWorkingHours(),p.default.getCalendarItemsAndDispatch()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"PeopleSuggestionsDataStream",{get:function(){return new s.default({requestDataCallback:function(){R.default.getRelevantPeople()},isEnabledCallback:function(){return i.default.isPinUserEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"FollowUpRequestTaskEntityDataStream",{get:function(){return new s.default({requestDataCallback:function(){b.default.getFollowUpRequestTasks()},isEnabledCallback:function(){return i.default.areFollowUpRequestTasksEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"DelayDeliveryDataStream",{get:function(){return new s.default({requestDataCallback:function(){_.default.getDelayDeliveryTimeAndCustomProperties(),_.default.getToRecipientsWorkingHourConfigs()},isEnabledCallback:function(){return y.default.getState().isMessage()&&y.default.getState().isCompose()&&i.default.hasDelayDeliveryPrerequisites}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"AutoDelayDeliveryAdvertisementDataStream",{get:function(){return new s.default({requestDataCallback:function(){_.default.getAndDispatchAutoDelayDeliveryAdvertisementCount()},isEnabledCallback:function(){return y.default.getState().isMessage()&&y.default.getState().isCompose()&&i.default.hasDelayDeliveryPrerequisites}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"CurrentItemDataStream",{get:function(){return new s.default({requestDataCallback:function(){h.default.getCurrentComposeItemProperties()},isEnabledCallback:function(){return y.default.getState().isCompose()}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"CleanupDataStream",{get:function(){return new s.default({requestDataCallback:function(){m.default.cleanUpOldRoamingSettings()},isEnabledCallback:function(){return i.default.isCleanupDataEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"SearchContextInsightsDataStream",{get:function(){return new s.default({requestDataCallback:function(){A.default.requestComposeInsights()}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"TeamsGroupSuggestionDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getTeamsGroupSuggestionInsight()},isEnabledCallback:function(){return i.default.isTeamsGroupSuggestionInsightEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"CatchUpImportantMailDataStream",{get:function(){return new s.default({requestDataCallback:function(){W.default.getCatchUpImportantMailInsight()},isEnabledCallback:function(){return i.default.isIRankerInOneEngineEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"LunchTimeSettingsDataStream",{get:function(){return new s.default({requestDataCallback:function(){$.default.getLunchTimeSettings()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"ProtectedTimeSettingsDataStream",{get:function(){return new s.default({requestDataCallback:function(){oe.default.getProtectedTimeSettings()},isEnabledCallback:function(){return i.default.areFeedInsightsEnabled&&i.default.isFocusReminderSettingEnabled}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"LogRoamingSettings",{get:function(){return new s.default({requestDataCallback:function(){ne.default.logRoamingSettings()},isEnabledCallback:function(){return!o.default.isInAutoRunJSMode||a.default.isInitializedByOnComposeEvent}})},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"TimeAwayDataStream",{get:function(){return new s.default({requestDataCallback:function(){te.default.getTimeAwayRecordWESAndDispatch()},isEnabledCallback:function(){return i.default.isTimeAwayPreparationEnabled}})},enumerable:!1,configurable:!0}),ae)
function ae(){this.listeningStores=[c.default,M.default,B.default,j.default,v.default,f.default,F.default,D.default,O.default,C.default,S.default,P.default,N.default,E.default,y.default,k.default,T.default,g.default,G.default,V.default,J.default,X.default,Y.default,ee.default,Z.default,z.default,re.default]}t.InsightsDependencies=ie,t.default=new ie},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogItemConverter_V1=void 0
var r=n(0),o=r.__importStar(n(284)),i=r.__importStar(n(13)),a=r.__importDefault(n(821)),s=r.__importDefault(n(4)),u=r.__importDefault(n(822)),l=r.__importDefault(n(823)),c=(d.prototype.convertToPermanentStoreModel=function(e){var t=u.default.convertFromEnum(e.insightName),n=a.default.convertFromEnum(e.logItemType)
return t&&n?this.isInsightActionType(e.logItemType)?l.default.convertToPermanentStoreModel(n,t,e):null:(s.default.logAssert("Unable to convert actionLog RUNTIME model to PROVIDER model: [insightName: "+e.insightName+", logItemType: "+e.logItemType+"].","ActionLogItemConverter_V1","convertToPermanentStoreModel"),null)},d.prototype.convertToRuntimeModel=function(e){var t=u.default.convertToEnum(e.insightType),n=a.default.convertToEnum(e.logItemType)
return t===i.InsightName.LegacyInsightType||n===o.ActionLogTypes.LegacyType?null:null==t||null==n?(s.default.logAssert("Unable to convert actionLog PROVIDER model to RUNTIME model: [insightType: "+e.insightType+", logItemType: "+e.logItemType+"].","ActionLogStorageProvider_V1","convertToRuntimeModel"),null):this.isInsightActionType(n)?l.default.convertToRuntimeModel(n,t,e):null},d.prototype.convertToEWSItemModel=function(e){var t=a.default.convertToEnum(e.logItemType)
return null==t?this.returnAndLogItemTypeError(e,"CREATE_EWS_ITEM","convertToRuntimeModel"):this.isInsightActionType(t)?l.default.convertToEWSItemModel(e):null},d.prototype.returnAndLogItemTypeError=function(e,t,n){return s.default.logAssert("Unable to convert actionLog PROVIDER model to "+t+" model: [logItemType: "+e.logItemType+"].","ActionLogStorageProvider_V1",n),null},d.prototype.isInsightActionType=function(e){return e===o.ActionLogTypes.ActedUpon||e===o.ActionLogTypes.Dismiss},d)
function d(){}t.ActionLogItemConverter_V1=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionLogTypeMap_V1=void 0
var r=n(0),o=r.__importStar(n(284)),i=r.__importDefault(n(6)),a=(s.prototype.convertFromEnum=function(e){switch(e){case o.ActionLogTypes.Dismiss:return s.DISMISS
case o.ActionLogTypes.ActedUpon:return s.ACTED_UPON
case o.ActionLogTypes.LegacyType:return s.LEGACY_TYPE
default:i.default.assertUnreachableError(e,o.ActionLogTypes)}},s.prototype.convertToEnum=function(e){switch(e){case s.DISMISS:return o.ActionLogTypes.Dismiss
case s.ACTED_UPON:return o.ActionLogTypes.ActedUpon
case s.FEEDBACK_DISMISS:case s.FEEDBACK_SUBMIT:case s.FEEDBACK_SUPPRESS:case s.INSIGHT_FEEDBACK_SUBMIT:case s.INSIGHT_FEEDBACK_SUPPRESS:return o.ActionLogTypes.LegacyType
default:return null}},s.DISMISS="DISMISS",s.ACTED_UPON="ACTED_UPON",s.LEGACY_TYPE="LEGACY_TYPE",s.FEEDBACK_SUBMIT="FEEDBACK_SUBMIT",s.FEEDBACK_SUPPRESS="FEEDBACK_SUPPRESS",s.FEEDBACK_DISMISS="FEEDBACK_DISMISS",s.INSIGHT_FEEDBACK_SUBMIT="INSIGHT_FEEDBACK_SUBMIT",s.INSIGHT_FEEDBACK_SUPPRESS="INSIGHT_FEEDBACK_SUPPRESS",s)
function s(){}t.ActionLogTypeMap_V1=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightNameMap_V1=void 0
var r=n(0),o=n(13),i=r.__importDefault(n(6)),a=(s.prototype.convertFromEnum=function(e){switch(e){case o.InsightName.AfterHoursMeetingAttendeeActionableMessage:return s.AFTER_HOURS_MEETING_ATTENDEE_ACTIONABLE_MESSAGE
case o.InsightName.FocusTimeBusyThisWeek:return s.FOCUS_TIME_BUSY_THIS_WEEK
case o.InsightName.FocusTimeNotBusyThisWeek:return s.FOCUS_TIME_NOT_BUSY_THIS_WEEK
case o.InsightName.FocusTimeBusyNextWeek:return s.FOCUS_TIME_BUSY_NEXT_WEEK
case o.InsightName.FocusTimeNotBusyNextWeek:return s.FOCUS_TIME_NOT_BUSY_NEXT_WEEK
case o.InsightName.PeopleFirstRun:return s.PEOPLE_SUGGESTIONS_FIRST_RUN
case o.InsightName.PeopleAdd:return s.PEOPLE_SUGGESTIONS_ADD
case o.InsightName.PeopleFirstRunRollup:return s.PEOPLE_SUGGESTIONS_FIRST_RUN_ROLLUP
case o.InsightName.ImportantUnreadMail:return s.IMPORTANT_UNREAD_MAIL
case o.InsightName.ImportantUnreadMailRollup:return s.IMPORTANT_UNREAD_MAIL_ROLLUP
case o.InsightName.MeetingSuggestion:return s.MEETING_SUGGESTION
case o.InsightName.MeetingSuggestionRollup:return s.MEETING_SUGGESTION_ROLLUP
case o.InsightName.SentMailStats:return s.SENT_MAIL_STATS
case o.InsightName.SentMailStatsInContext:return s.SENT_MAIL_STATS_IN_CONTEXT
case o.InsightName.SentMailStatsRollup:return s.SENT_MAIL_STATS_ROLLUP
case o.InsightName.DashboardTeaser:return s.DASHBOARD_TEASER
case o.InsightName.UpcomingMeeting:return s.UPCOMING_MEETING
case o.InsightName.ToDos:return s.TODOS
case o.InsightName.MeetingOverload:return s.MEETING_OVERLOAD
case o.InsightName.MeetingPreparationCard:return s.MEETING_PREPARATION_CARD
case o.InsightName.MeetingPreparationCardRollup:return s.MEETING_PREPARATION_CARD_ROLLUP
case o.InsightName.MeetingRelatedDocuments:return s.MEETING_RELATED_DOCUMENTS
case o.InsightName.SuggestedTasksActionableMessage:return s.SUGGESTED_TASKS_ACTIONABLE_MESSAGE
case o.InsightName.BookFocusTimeActionableMessage:return s.FOCUSTIME_PRECOMPUTED
case o.InsightName.PeopleRollup:return s.PEOPLE_ROLLUP
case o.InsightName.ToDosRollup:return s.TODOS_ROLLUP
case o.InsightName.ShortenMeeting:return s.SHORTEN_MEETING
case o.InsightName.TrackEmail:return s.TRACK_THIS_EMAIL
case o.InsightName.DetectOOFComposingInfobar:return s.DETECT_OOF_COMPOSING_INFOBAR
case o.InsightName.MeetingOverloadActionableMessage:return s.MEETING_OVERLOAD_ACTIONABLE_MESSAGE
case o.InsightName.ShortenMeetingActionableMessage:return s.SHORTEN_MEETING_ACTIONABLE_MESSAGE
case o.InsightName.AutoDelayDeliveryInfobar:return s.AUTO_DELAY_DELIVERY_INFOBAR
case o.InsightName.SuggestedDelayDeliveryInfobar:return s.SUGGESTED_DELAY_DELIVERY_INFOBAR
case o.InsightName.ScheduledDelayDeliveryInfobar:return s.SCHEDULED_DELAY_DELIVERY_INFOBAR
case o.InsightName.PostDelayDeliveryActionableMessage:return s.POST_DELAY_DELIVERY_ACTIONABLE_MESSAGE
case o.InsightName.AutoDelayDeliveryAdvertisement:return s.AUTO_DELAY_DELIVERY_ADVERTISEMENT
case o.InsightName.DelayDeliveryAdvertFeed:return s.DELAY_DELIVERY_ADVERT_FEED
case o.InsightName.FocusTimeConflictActionableMessage:return s.FOCUS_TIME_CONFLICT_ACTIONABLE_MESSAGE
case o.InsightName.CatchUpImportantMail:return s.CATCH_UP_IMPORTANT_MAIL
case o.InsightName.CatchUpImportantMailRollup:return s.CATCH_UP_IMPORTANT_MAIL_ROLLUP
case o.InsightName.ProtectedTimeBookingHeader:return s.PROTECTED_TIME_HEADER_CARD
case o.InsightName.Tasks:return s.TASKS
case o.InsightName.TasksRollup:return s.TASKS_ROLLUP
case o.InsightName.FollowUpRequestTasks:return s.FOLLOWUP_REQUEST_TASKS
case o.InsightName.FollowUpRequestTasksRollup:return s.FOLLOWUP_REQUEST_TASKS_ROLLUP
case o.InsightName.DirectReportUnreadMail:return s.DIRECT_REPORT_UNREAD_MAIL
case o.InsightName.FocusTime:return s.FOCUS_TIME
case o.InsightName.SentMailRollup:return s.SENT_MAIL_ROLLUP
case o.InsightName.SentMailStatsInContextActionableMessage:return s.SENT_MAIL_STATS_IN_CONTEXT_ACTIONABLE_MESSAGE
case o.InsightName.LegacyInsightType:return s.LEGACY_TYPE
case o.InsightName.SuggestedFreeBlocks:return s.SUGGESTED_FREE_BLOCKS
case o.InsightName.DocumentsToCatchup:return s.DOCUMENTS_TO_CATCH_UP
case o.InsightName.DocumentsToCatchupRollup:return s.DOCUMENTS_TO_CATCH_UP_ROLLUP
case o.InsightName.FocusOutcome:return s.FOCUS_OUTCOME
case o.InsightName.DaysToBook:return s.DAYS_TO_BOOK
case o.InsightName.PeopleCatchUpItems:return s.PEOPLE_CATCH_UP_ITEMS
case o.InsightName.DirectReportBookOneOnOne:return s.DIRECT_REPORT_BOOK_ONE_ON_ONE
case o.InsightName.DirectReportConflictingOneOnOne:return s.DIRECT_REPORT_CONFLICTING_ONE_ON_ONE
case o.InsightName.DirectReportTasksRollup:return s.DIRECT_REPORT_TASKS_ROLLUP
case o.InsightName.DirectReportUnreadMailAndDocsPerPerson:return s.UNREAD_MAIL_DOC_PER_PERSON
case o.InsightName.DirectReportCatchupRollup:return s.DIRECT_REPORT_CATCHUP_ROLLUP
case o.InsightName.TeamCatchupRollup:return s.TEAM_CATCHUP_ROLLUP
case o.InsightName.SmartRulesSuggestion:return s.SMART_RULES_SUGGESTION
case o.InsightName.SmartRulesSuggestionRollup:return s.SMART_RULES_SUGGESTION_ROLLUP
case o.InsightName.LunchSettingsAdvert:return s.LUNCH_SETTINGS_ADVERT
case o.InsightName.TeamsGroupSuggestion:return s.TEAMS_GROUP_SUGGESTION
case o.InsightName.TeamsGroupSuggestionRollup:return s.TEAMS_GROUP_SUGGESTION_ROLLUP
case o.InsightName.MeetingPreparationInfobar:return s.MEETING_PREPARATION_TIME_INFOBAR
case o.InsightName.TimeAway:return s.TIME_AWAY
case o.InsightName.TimeAwayRollup:return s.TIME_AWAY_ROLLUP
default:i.default.assertUnreachableError(e,o.InsightName)}},s.prototype.convertToEnum=function(e){switch(e){case s.AFTER_HOURS_MEETING_ATTENDEE_ACTIONABLE_MESSAGE:return o.InsightName.AfterHoursMeetingAttendeeActionableMessage
case s.FOCUS_TIME_BUSY_THIS_WEEK:return o.InsightName.FocusTimeBusyThisWeek
case s.FOCUS_TIME_NOT_BUSY_THIS_WEEK:return o.InsightName.FocusTimeNotBusyThisWeek
case s.FOCUS_TIME_BUSY_NEXT_WEEK:return o.InsightName.FocusTimeBusyNextWeek
case s.FOCUS_TIME_NOT_BUSY_NEXT_WEEK:return o.InsightName.FocusTimeNotBusyNextWeek
case s.PEOPLE_SUGGESTIONS_FIRST_RUN:return o.InsightName.PeopleFirstRun
case s.PEOPLE_SUGGESTIONS_ADD:return o.InsightName.PeopleAdd
case s.PEOPLE_SUGGESTIONS_FIRST_RUN_ROLLUP:return o.InsightName.PeopleFirstRunRollup
case s.IMPORTANT_UNREAD_MAIL:return o.InsightName.ImportantUnreadMail
case s.IMPORTANT_UNREAD_MAIL_ROLLUP:return o.InsightName.ImportantUnreadMailRollup
case s.MEETING_SUGGESTION:return o.InsightName.MeetingSuggestion
case s.MEETING_SUGGESTION_ROLLUP:return o.InsightName.MeetingSuggestionRollup
case s.SENT_MAIL_STATS:return o.InsightName.SentMailStats
case s.SENT_MAIL_STATS_IN_CONTEXT:return o.InsightName.SentMailStatsInContext
case s.SENT_MAIL_STATS_ROLLUP:return o.InsightName.SentMailStatsRollup
case s.DASHBOARD_TEASER:return o.InsightName.DashboardTeaser
case s.UPCOMING_MEETING:return o.InsightName.UpcomingMeeting
case s.TODOS:return o.InsightName.ToDos
case s.MEETING_OVERLOAD:return o.InsightName.MeetingOverload
case s.MEETING_PREPARATION_CARD:return o.InsightName.MeetingPreparationCard
case s.MEETING_PREPARATION_CARD_ROLLUP:return o.InsightName.MeetingPreparationCardRollup
case s.MEETING_RELATED_DOCUMENTS:return o.InsightName.MeetingRelatedDocuments
case s.SUGGESTED_TASKS_ACTIONABLE_MESSAGE:return o.InsightName.SuggestedTasksActionableMessage
case s.FOCUSTIME_PRECOMPUTED:return o.InsightName.BookFocusTimeActionableMessage
case s.PEOPLE_ROLLUP:return o.InsightName.PeopleRollup
case s.TODOS_ROLLUP:return o.InsightName.ToDosRollup
case s.TRACK_THIS_EMAIL:return o.InsightName.TrackEmail
case s.DETECT_OOF_COMPOSING_INFOBAR:return o.InsightName.DetectOOFComposingInfobar
case s.SHORTEN_MEETING_ACTIONABLE_MESSAGE:return o.InsightName.ShortenMeetingActionableMessage
case s.SHORTEN_MEETING:return o.InsightName.ShortenMeeting
case s.MEETING_OVERLOAD_ACTIONABLE_MESSAGE:return o.InsightName.MeetingOverloadActionableMessage
case s.AUTO_DELAY_DELIVERY_INFOBAR:return o.InsightName.AutoDelayDeliveryInfobar
case s.SUGGESTED_DELAY_DELIVERY_INFOBAR:return o.InsightName.SuggestedDelayDeliveryInfobar
case s.SCHEDULED_DELAY_DELIVERY_INFOBAR:return o.InsightName.ScheduledDelayDeliveryInfobar
case s.POST_DELAY_DELIVERY_ACTIONABLE_MESSAGE:return o.InsightName.PostDelayDeliveryActionableMessage
case s.AUTO_DELAY_DELIVERY_ADVERTISEMENT:return o.InsightName.AutoDelayDeliveryAdvertisement
case s.DELAY_DELIVERY_ADVERT_FEED:return o.InsightName.DelayDeliveryAdvertFeed
case s.FOCUS_TIME_CONFLICT_ACTIONABLE_MESSAGE:return o.InsightName.FocusTimeConflictActionableMessage
case s.CATCH_UP_IMPORTANT_MAIL:return o.InsightName.CatchUpImportantMail
case s.CATCH_UP_IMPORTANT_MAIL_ROLLUP:return o.InsightName.CatchUpImportantMailRollup
case s.TASKS:return o.InsightName.Tasks
case s.TASKS_ROLLUP:return o.InsightName.TasksRollup
case s.FOLLOWUP_REQUEST_TASKS:return o.InsightName.FollowUpRequestTasks
case s.FOLLOWUP_REQUEST_TASKS_ROLLUP:return o.InsightName.FollowUpRequestTasksRollup
case s.DIRECT_REPORT_UNREAD_MAIL:return o.InsightName.DirectReportUnreadMail
case s.FOCUS_TIME:return o.InsightName.FocusTime
case s.SENT_MAIL_ROLLUP:return o.InsightName.SentMailRollup
case s.PROTECTED_TIME_HEADER_CARD:return o.InsightName.ProtectedTimeBookingHeader
case s.SENT_MAIL_STATS_IN_CONTEXT_ACTIONABLE_MESSAGE:return o.InsightName.SentMailStatsInContextActionableMessage
case s.SUGGESTED_FREE_BLOCKS:return o.InsightName.SuggestedFreeBlocks
case s.DOCUMENTS_TO_CATCH_UP:return o.InsightName.DocumentsToCatchup
case s.DOCUMENTS_TO_CATCH_UP_ROLLUP:return o.InsightName.DocumentsToCatchupRollup
case s.DAYS_TO_BOOK:return o.InsightName.DaysToBook
case s.FOCUS_OUTCOME:return o.InsightName.FocusOutcome
case s.PEOPLE_CATCH_UP_ITEMS:return o.InsightName.PeopleCatchUpItems
case s.DIRECT_REPORT_BOOK_ONE_ON_ONE:return o.InsightName.DirectReportBookOneOnOne
case s.DIRECT_REPORT_CONFLICTING_ONE_ON_ONE:return o.InsightName.DirectReportConflictingOneOnOne
case s.UNREAD_MAIL_DOC_PER_PERSON:return o.InsightName.DirectReportUnreadMailAndDocsPerPerson
case s.DIRECT_REPORT_TASKS_ROLLUP:return o.InsightName.DirectReportTasksRollup
case s.DIRECT_REPORT_CATCHUP_ROLLUP:return o.InsightName.DirectReportCatchupRollup
case s.TEAM_CATCHUP_ROLLUP:return o.InsightName.TeamCatchupRollup
case s.SMART_RULES_SUGGESTION:return o.InsightName.SmartRulesSuggestion
case s.SMART_RULES_SUGGESTION_ROLLUP:return o.InsightName.SmartRulesSuggestionRollup
case s.LUNCH_SETTINGS_ADVERT:return o.InsightName.LunchSettingsAdvert
case s.TEAMS_GROUP_SUGGESTION:return o.InsightName.TeamsGroupSuggestion
case s.TEAMS_GROUP_SUGGESTION_ROLLUP:return o.InsightName.TeamsGroupSuggestionRollup
case s.MEETING_PREPARATION_TIME_INFOBAR:return o.InsightName.MeetingPreparationInfobar
case s.TIME_AWAY:return o.InsightName.TimeAway
case s.TIME_AWAY_ROLLUP:return o.InsightName.TimeAwayRollup
case s.AFTER_HOURS_IMPACT:case s.AFTER_HOURS_EMAILS:case s.AFTER_HOURS_EMAILS_ROLLUP:case s.AFTER_HOURS_MEETING_SUGGESTION:case s.AFTER_HOURS_IMPACT_INFOBAR:case s.REDUCE_MEETING_LOAD_INFOBAR:case s.ENGINEERING_PRODUCTIVITY:case s.PULL_REQUESTS:case s.PULL_REQUESTS_ROLLUP:case s.COMMITMENTS:case s.REQUESTS:case s.PEOPLE_SUGGESTIONS_REMOVE:case s.WELCOME_CARD:case s.UNREAD_MAIL_ACTIONABLE_MESSAGE:case s.LEGACY_TYPE:case s.LONG_THREAD:case s.FOCUS_TIME_ADAPTIVE_CARD:case s.MEETING_READINESS:case s.MEETING_READINESS_ROLLUP:case s.SUGGESTED_FOCUS_BLOCKS:case s.REDUCE_AFTER_HOURS_LOAD_INFOBAR:case s.FOCUS_GOAL_BOOK_AHEAD_ACTIONABLE_MESSAGE:case s.TODOS_PRECOMPUTED:case s.UNREAD_MAIL:case s.UNREAD_MAIL_ROLLUP:case s.UP_NEXT_ORGANIZER_RSVP:case s.UP_NEXT_ORGANIZER_ATTEND:case s.UP_NEXT_ATTENDEE_RSVP:case s.UP_NEXT_ATTENDEE_TEAMS:case s.PROTECTED_TIME_CARD:case s.TOP_COLLABORATOR_MEETING_TIME:return o.InsightName.LegacyInsightType
default:return null}},s.AFTER_HOURS_MEETING_ATTENDEE_ACTIONABLE_MESSAGE="AFTER_HOURS_MEETING_ATTENDEE_ACTIONABLE_MESSAGE",s.FOCUS_TIME_BUSY_THIS_WEEK="FOCUS_TIME_BUSY_THIS_WEEK",s.FOCUS_TIME_NOT_BUSY_THIS_WEEK="FOCUS_TIME_NOT_BUSY_THIS_WEEK",s.FOCUS_TIME_BUSY_NEXT_WEEK="FOCUS_TIME_BUSY_NEXT_WEEK",s.FOCUS_TIME_NOT_BUSY_NEXT_WEEK="FOCUS_TIME_NOT_BUSY_NEXT_WEEK",s.PEOPLE_SUGGESTIONS_FIRST_RUN="PEOPLE_SUGGESTIONS_FIRST_RUN",s.PEOPLE_SUGGESTIONS_ADD="PEOPLE_SUGGESTIONS_ADD",s.PEOPLE_SUGGESTIONS_FIRST_RUN_ROLLUP="PEOPLE_SUGGESTIONS_FIRST_RUN_ROLLUP",s.IMPORTANT_UNREAD_MAIL="IMPORTANT_UNREAD_MAIL",s.IMPORTANT_UNREAD_MAIL_ROLLUP="IMPORTANT_UNREAD_MAIL_ROLLUP",s.MEETING_SUGGESTION="MEETING_SUGGESTION",s.MEETING_SUGGESTION_ROLLUP="MEETING_SUGGESTION_ROLLUP",s.SENT_MAIL_STATS="SENT_MAIL_STATS",s.SENT_MAIL_STATS_IN_CONTEXT="SENT_MAIL_STATS_IN_CONTEXT",s.SENT_MAIL_STATS_ROLLUP="SENT_MAIL_STATS_ROLLUP",s.DASHBOARD_TEASER="DASHBOARD_TEASER",s.UPCOMING_MEETING="UPCOMING_MEETING",s.TOP_COLLABORATOR_MEETING_TIME="TOP_COLLABORATOR_MEETING_TIME",s.TODOS="TODOS",s.MEETING_OVERLOAD="MEETING_OVERLOAD",s.MEETING_READINESS="MEETING_READINESS",s.MEETING_READINESS_ROLLUP="MEETING_READINESS_ROLLUP",s.MEETING_PREPARATION_CARD="MEETING_PREPARATION",s.MEETING_PREPARATION_CARD_ROLLUP="MEETING_PREPARATION_ROLLUP",s.MEETING_RELATED_DOCUMENTS="MEETING_RELATED_DOCUMENTS",s.FOCUSTIME_PRECOMPUTED="FOCUSTIME_PRECOMPUTED",s.SUGGESTED_TASKS_ACTIONABLE_MESSAGE="SUGGESTED_TASKS_ACTIONABLE_MESSAGE",s.ENGINEERING_PRODUCTIVITY="ENGINEERING_PRODUCTIVITY",s.PULL_REQUESTS="PULL_REQUESTS",s.PEOPLE_ROLLUP="PEOPLE_ROLLUP",s.TODOS_ROLLUP="TODOS_ROLLUP",s.PULL_REQUESTS_ROLLUP="PULL_REQUESTS_ROLLUP",s.FOCUS_TIME_CONFLICT_ACTIONABLE_MESSAGE="FOCUS_TIME_CONFLICT_ACTIONABLE_MESSAGE",s.SHORTEN_MEETING="SHORTEN_MEETING",s.TRACK_THIS_EMAIL="TRACK_THIS_EMAIL",s.MEETING_OVERLOAD_ACTIONABLE_MESSAGE="MEETING_OVERLOAD_ACTIONABLE_MESSAGE",s.SHORTEN_MEETING_ACTIONABLE_MESSAGE="SHORTEN_MEETING_ACTIONABLE_MESSAGE",s.AUTO_DELAY_DELIVERY_INFOBAR="AUTO_DELAY_DELIVERY_INFOBAR",s.SUGGESTED_DELAY_DELIVERY_INFOBAR="SUGGESTED_DELAY_DELIVERY_INFOBAR",s.SCHEDULED_DELAY_DELIVERY_INFOBAR="SCHEDULED_DELAY_DELIVERY_INFOBAR",s.POST_DELAY_DELIVERY_ACTIONABLE_MESSAGE="POST_DELAY_DELIVERY_ACTIONABLE_MESSAGE",s.AUTO_DELAY_DELIVERY_ADVERTISEMENT="AUTO_DELAY_DELIVERY_ADVERTISEMENT",s.DELAY_DELIVERY_ADVERT_FEED="DELAY_DELIVERY_ADVERT_FEED",s.UNREAD_MAIL_ACTIONABLE_MESSAGE="UNREAD_MAIL_ACTIONABLE_MESSAGE",s.FOCUS_GOAL_BOOK_AHEAD_ACTIONABLE_MESSAGE="FOCUS_GOAL_BOOK_AHEAD_ACTIONABLE_MESSAGE",s.CATCH_UP_IMPORTANT_MAIL="CATCH_UP_IMPORTANT_MAIL",s.CATCH_UP_IMPORTANT_MAIL_ROLLUP="CATCH_UP_IMPORTANT_MAIL_ROLLUP",s.FOCUS_TIME_ADAPTIVE_CARD="FOCUS_TIME_ADAPTIVE_CARD",s.PROTECTED_TIME_CARD="PROTECTED_TIME_CARD",s.PROTECTED_TIME_HEADER_CARD="PROTECTED_TIME_HEADER_CARD",s.TASKS="TASKS",s.TASKS_ROLLUP="TASKS_ROLLUP",s.FOLLOWUP_REQUEST_TASKS="FOLLOWUP_REQUEST_TASKS",s.FOLLOWUP_REQUEST_TASKS_ROLLUP="FOLLOWUP_REQUEST_TASKS_ROLLUP",s.UNREAD_MAIL="UNREAD_MAIL",s.UNREAD_MAIL_ROLLUP="UNREAD_MAIL_ROLLUP",s.DIRECT_REPORT_UNREAD_MAIL="DIRECT_REPORT_UNREAD_MAIL",s.UNREAD_MAIL_DOC_PER_PERSON="UNREAD_MAIL_DOC_PER_PERSON",s.FOCUS_TIME="FOCUS_TIME",s.DETECT_OOF_COMPOSING_INFOBAR="DETECT_OOF_COMPOSING_INFOBAR",s.SENT_MAIL_ROLLUP="SENT_MAIL_ROLLUP",s.SENT_MAIL_STATS_IN_CONTEXT_ACTIONABLE_MESSAGE="SENT_MAIL_STATS_IN_CONTEXT_ACTIONABLE_MESSAGE",s.SUGGESTED_FREE_BLOCKS="SUGGESTED_FREE_BLOCKS",s.SUGGESTED_FOCUS_BLOCKS="SUGGESTED_FOCUS_BLOCKS",s.DOCUMENTS_TO_CATCH_UP="DOCUMENTS_TO_CATCH_UP",s.DOCUMENTS_TO_CATCH_UP_ROLLUP="DOCUMENTS_TO_CATCH_UP_ROLLUP",s.FOCUS_OUTCOME="FOCUS_OUTCOME",s.DAYS_TO_BOOK="DAYS_TO_BOOK",s.PEOPLE_CATCH_UP_ITEMS="PEOPLE_CATCH_UP_ITEMS",s.LUNCH_SETTINGS_ADVERT="LUNCH_SETTINGS_ADVERT",s.DIRECT_REPORT_BOOK_ONE_ON_ONE="DIRECT_REPORT_BOOK_ONE_ON_ONE",s.DIRECT_REPORT_CONFLICTING_ONE_ON_ONE="DIRECT_REPORT_CONFLICTING_ONE_ON_ONE",s.DIRECT_REPORT_TASKS_ROLLUP="DIRECT_REPORT_TASKS_ROLLUP",s.DIRECT_REPORT_CATCHUP_ROLLUP="DIRECT_REPORT_CATCHUP_ROLLUP",s.TEAM_CATCHUP_ROLLUP="TEAM_CATCHUP_ROLLUP",s.SMART_RULES_SUGGESTION="SMART_RULES_SUGGESTION",s.SMART_RULES_SUGGESTION_ROLLUP="SMART_RULES_SUGGESTION_ROLLUP",s.TEAMS_GROUP_SUGGESTION="TEAMS_GROUP_SUGGESTION",s.TEAMS_GROUP_SUGGESTION_ROLLUP="TEAMS_GROUP_SUGGESTION_ROLLUP",s.MEETING_PREPARATION_TIME_INFOBAR="MEETING_PREPARATION_TIME_INFOBAR",s.TIME_AWAY="TIME_AWAY",s.TIME_AWAY_ROLLUP="TIME_AWAY_ROLLUP",s.AFTER_HOURS_IMPACT="AFTER_HOURS_IMPACT",s.AFTER_HOURS_EMAILS="AFTER_HOURS_EMAILS",s.AFTER_HOURS_EMAILS_ROLLUP="AFTER_HOURS_EMAILS_ROLLUP",s.AFTER_HOURS_MEETING_SUGGESTION="AFTER_HOURS_MEETING_SUGGESTION",s.AFTER_HOURS_IMPACT_INFOBAR="AFTER_HOURS_IMPACT_INFOBAR",s.REDUCE_MEETING_LOAD_INFOBAR="REDUCE_MEETING_LOAD_INFOBAR",s.LONG_THREAD="LONG_THREAD",s.PEOPLE_SUGGESTIONS_REMOVE="PEOPLE_SUGGESTIONS_REMOVE",s.WELCOME_CARD="WELCOME_CARD",s.COMMITMENTS="COMMITMENTS",s.REQUESTS="REQUESTS",s.LEGACY_TYPE="LEGACY_TYPE",s.REDUCE_AFTER_HOURS_LOAD_INFOBAR="REDUCE_AFTER_HOURS_LOAD_INFOBAR",s.TODOS_PRECOMPUTED="TODOS_PRECOMPUTED",s.UP_NEXT_ORGANIZER_RSVP="UP_NEXT_ORGANIZER_RSVP",s.UP_NEXT_ORGANIZER_ATTEND="UP_NEXT_ORGANIZER_ATTEND",s.UP_NEXT_ATTENDEE_RSVP="UP_NEXT_ATTENDEE_RSVP",s.UP_NEXT_ATTENDEE_TEAMS="UP_NEXT_ATTENDEE_RSVP",s)
function s(){}t.InsightNameMap_V1=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightActionLogItemConverter_V1=void 0
var r=(o.prototype.convertToPermanentStoreModel=function(e,t,n){return{creationDate:n.creationDate.getTime(),expirationTimeInTicks:n.expirationTimeInTicks,identifierPrimary:n.insightIdentifer.primaryId,identifierSecondary:n.insightIdentifer.secondaryId,insightType:t,logItemType:e}},o.prototype.convertToRuntimeModel=function(e,t,n){return{creationDate:new Date(n.creationDate),expirationTimeInTicks:n.expirationTimeInTicks,insightIdentifer:this.buildIdentifierFromComponents(n.identifierPrimary,n.identifierSecondary),insightName:t,logItemType:e}},o.prototype.convertToEWSItemModel=function(e){return{subject:String(e.expirationTimeInTicks),body:JSON.stringify(e)}},o.prototype.buildIdentifierFromComponents=function(e,t){return{primaryId:e,secondaryId:t}},o)
function o(){}t.InsightActionLogItemConverter_V1=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(84),s=(r=a.EWSRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"folderName",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"parentDistinguishedFolderId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:CreateFolder>\n                <m:ParentFolderId>\n                    <t:DistinguishedFolderId Id="'+this.parentDistinguishedFolderId()+'"/>\n                </m:ParentFolderId>\n                <m:Folders>\n                    <t:Folder>\n                        <t:DisplayName>'+this.folderName()+"</t:DisplayName>\n                    </t:Folder>\n                </m:Folders>\n            </m:CreateFolder>"},u.prototype.toTraceString=function(){return"CreateFolderRequest"},o.__decorate([i.doop],u.prototype,"folderName",null),o.__decorate([i.doop],u.prototype,"parentDistinguishedFolderId",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(84),s=(r=a.EWSRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"saveToFolderId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"itemsToCreate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:CreateItem MessageDisposition="SaveOnly">\n                <m:SavedItemFolderId>\n                    <t:FolderId Id="'+this.saveToFolderId().id+'" ChangeKey="'+this.saveToFolderId().changeKey+'" />\n                </m:SavedItemFolderId>\n                <m:Items>\n                    '+this.buildMessages()+"\n                </m:Items>\n            </m:CreateItem>"},u.prototype.buildMessages=function(){return this.itemsToCreate().map(function(e){return"<t:Message>\n                            <t:ItemClass>IPM.Note</t:ItemClass>\n                            <t:Subject>"+e.subject+'</t:Subject>\n                            <t:Body BodyType="Text">'+e.body+"</t:Body>\n                        </t:Message>"}).join(" ")},u.prototype.toTraceString=function(){return"CreateItemRequest"},o.__decorate([i.doop],u.prototype,"saveToFolderId",null),o.__decorate([i.doop],u.prototype,"itemsToCreate",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(63),s=n(16),u=(i=a.RESTRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/mailfolders/"+this.actionLogFolderId()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"actionLogFolderId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),r.__decorate([o.doop],l.prototype,"actionLogFolderId",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,s.HTTPRequestMethod.DELETE,e,t,n,r)||this
return o.maxRetries(0),o}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=n(5),i=n(84),s=(a=i.EWSRequestBase,r.__extends(u,a),Object.defineProperty(u.prototype,"pageSize",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"parentFolderId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"offset",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:FindItem Traversal="Shallow">\n                <m:ItemShape>\n                    <t:BaseShape>IdOnly</t:BaseShape>\n                </m:ItemShape>\n                <m:IndexedPageItemView MaxEntriesReturned="'+this.pageSize()+'" Offset="'+this.offset()+'" BasePoint="End" />\n                <m:ParentFolderIds>\n                    <t:FolderId Id="'+this.parentFolderId().id+'" ChangeKey="'+this.parentFolderId().changeKey+'"/>\n                </m:ParentFolderIds>\n                <m:Restriction>\n                    <t:IsGreaterThan>\n                        <t:FieldURI FieldURI="item:Subject" />\n                        <t:FieldURIOrConstant>\n                            <t:Constant Value="'+Date.now()+'" />\n                        </t:FieldURIOrConstant>\n                    </t:IsGreaterThan>\n                </m:Restriction>\n            </m:FindItem>'},u.prototype.toTraceString=function(){return"FindActiveActionLogRequest"},r.__decorate([o.doop],u.prototype,"pageSize",null),r.__decorate([o.doop],u.prototype,"parentFolderId",null),r.__decorate([o.doop],u.prototype,"offset",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.offset(0),i.pageSize(100),i}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightActionLogItemProcessor=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(501)),a=r.__importDefault(n(11)),s=(u.prototype.filterAndProcessCachedActionLogs=function(e){e&&this.processActionLogs(e)},u.prototype.filterAndProcessEWSActionLogs=function(e,t){var n
t&&(e?(n=this.mergeActionLogs(e,t),this.processActionLogs(n)):this.processActionLogs(t))},u.prototype.processActionLogs=function(e){a.default.dispatch({actionType:o.default.HistoricalInsightActionLogItems,logItems:e})},u.prototype.mergeActionLogs=function(e,t){var n=this.findMaxCreationTime(t),r=e.filter(function(e){return e.creationDate.getTime()>n}).slice(0,this.MAX_RECOVERED_CACHE_ITEMS)
return 0<r.length&&i.default.saveLogItemsToExchange(r),t.concat(r)},u.prototype.findMaxCreationTime=function(e){var t=e.map(function(e){return e.creationDate.getTime()})
return Math.max.apply(Math,t)},u)
function u(){this.MAX_RECOVERED_CACHE_ITEMS=100}t.InsightActionLogItemProcessor=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/outcomes"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(831),s=n(16),u=(o=a.SingleOutcomeRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"isEnroll",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{IsEnrolled:this.isEnroll()}},r.__decorate([i.doop],l.prototype,"isEnroll",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,s.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SingleOutcomeRequestBase=void 0
var r,o=n(0),i=n(5),a=n(38),s=(r=a.WESRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"outcomeName",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/outcomes('"+this.outcomeName()+"')"},enumerable:!1,configurable:!0}),o.__decorate([i.doop],u.prototype,"outcomeName",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.SingleOutcomeRequestBase=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(174)),a=r.__importDefault(n(6)),s=r.__importDefault(n(24)),u=r.__importDefault(n(8)),l=n(5),c=n(29),d=n(63),p=n(16),f=(o=d.RESTRequestBase,r.__extends(g,o),Object.defineProperty(g.prototype,"urlPath",{get:function(){return"me/events"},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"subject",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"calendarItemType",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"start",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"end",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"category",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"body",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"recurrence",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"showAs",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isReminderOn",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"reminderMinutesBeforeStart",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),g.prototype.postData=function(){return r.__assign(r.__assign({Subject:this.subject(),Body:{ContentType:"HTML",Content:this.body()},Start:{DateTime:s.default.toString(this.start()),TimeZone:a.default.Timezone},End:{DateTime:s.default.toString(this.end()),TimeZone:a.default.Timezone},ShowAs:this.showAs(),IsReminderOn:this.isReminderOn(),ReminderMinutesBeforeStart:this.reminderMinutesBeforeStart(),Categories:[this.category()],Recurrence:this.recurrence()?c.CalendarTypeUtils.recurrenceToJson(this.recurrence()):null},this.buildSingleValueExtendedProperties()),this.buildCalendarEventClassifications())},g.prototype.buildSingleValueExtendedProperties=function(){switch(this.calendarItemType()){case c.CalendarItemType.FocusTime:return{SingleValueExtendedProperties:[{PropertyId:i.default.IS_BOOKED_FREE_BLOCKS.buildJSONString(),Value:"true"},{PropertyId:i.default.IS_DO_NOT_DISTURB_TIME.buildJSONString(),Value:"true"}]}
case c.CalendarItemType.LunchTime:return{SingleValueExtendedProperties:[{PropertyId:i.default.IS_BOOKED_LUNCH_TIME.buildJSONString(),Value:"true"}]}
case c.CalendarItemType.OOFTime:return{SingleValueExtendedProperties:[{PropertyId:i.default.IS_BOOKED_OOF_TIME.buildJSONString(),Value:"true"}]}
default:return{}}},g.prototype.buildCalendarEventClassifications=function(){if(!u.default.isStampCalendarEventClassificationsEnabled)return{}
var e=[]
switch(this.calendarItemType()){case c.CalendarItemType.FocusTime:e.push("Focus")
break
case c.CalendarItemType.OOFTime:e.push("TimeAway")
break
case c.CalendarItemType.LunchTime:e.push("Lunch")}return 0<e.length?{CalendarEventClassifications:e}:{}},r.__decorate([l.doop],g.prototype,"subject",null),r.__decorate([l.doop],g.prototype,"calendarItemType",null),r.__decorate([l.doop],g.prototype,"start",null),r.__decorate([l.doop],g.prototype,"end",null),r.__decorate([l.doop],g.prototype,"category",null),r.__decorate([l.doop],g.prototype,"body",null),r.__decorate([l.doop],g.prototype,"recurrence",null),r.__decorate([l.doop],g.prototype,"showAs",null),r.__decorate([l.doop],g.prototype,"isReminderOn",null),r.__decorate([l.doop],g.prototype,"reminderMinutesBeforeStart",null),g=r.__decorate([l.doop],g))
function g(e,t,n,r){return o.call(this,p.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(63),s=n(16),u=(i=a.RESTRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/events/"+this.eventId()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"eventId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),r.__decorate([o.doop],l.prototype,"eventId",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,s.HTTPRequestMethod.DELETE,e,t,n,r)||this
return o.maxRetries(0),o}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(63),s=n(16),u=(o=a.RESTRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"itemId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"nonFatalErrorCodes",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.isNonFatalErrorCode=function(e){return 0<=this.nonFatalErrorCodes().indexOf(e)},Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/events/"+this.itemId()},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"itemId",null),r.__decorate([i.doop],l.prototype,"nonFatalErrorCodes",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,s.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(6)),a=n(5),s=n(63),u=n(16),l=(o=s.RESTRequestBase,r.__extends(c,o),Object.defineProperty(c.prototype,"urlPath",{get:function(){return"me/calendar/getSchedule"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"subject",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"start",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"end",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),c.prototype.postData=function(){return{Schedules:[i.default.userEmailLowerCase],StartTime:{DateTime:this.start().toISOString(),TimeZone:i.default.Timezone},EndTime:{DateTime:this.end().toISOString(),TimeZone:i.default.Timezone}}},r.__decorate([a.doop],c.prototype,"subject",null),r.__decorate([a.doop],c.prototype,"start",null),r.__decorate([a.doop],c.prototype,"end",null),c=r.__decorate([a.doop],c))
function c(e,t,n,r){return o.call(this,u.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(84),s=(r=a.EWSRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"userConfigurationName",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"userConfigurationProperties",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:GetUserConfiguration>\n                <m:UserConfigurationName Name="'+this.userConfigurationName()+'">\n                    <t:DistinguishedFolderId Id="'+this.userConfigurationProperties()+'"/>\n                </m:UserConfigurationName>\n                <m:UserConfigurationProperties>XmlData</m:UserConfigurationProperties>\n            </m:GetUserConfiguration>'},u.prototype.toTraceString=function(){return"GetUserConfiguration"},o.__decorate([i.doop],u.prototype,"userConfigurationName",null),o.__decorate([i.doop],u.prototype,"userConfigurationProperties",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(6)),a=n(5),s=n(29),u=n(63),l=n(16),c=(o=u.RESTRequestBase,r.__extends(d,o),Object.defineProperty(d.prototype,"urlPath",{get:function(){return"me/events/"+this.eventId()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"eventId",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"subject",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"start",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"end",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"bodyContentType",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"bodyContent",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"calendarItemType",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"recurrence",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),d.prototype.postData=function(){var e={}
return this.start()&&this.end()&&(e.Start=this.generateDateTimeTimeZone(this.start()),e.End=this.generateDateTimeTimeZone(this.end())),this.subject()&&(e.Subject=this.subject()),this.bodyContent()&&(e.Body={ContentType:this.bodyContentType()?this.bodyContentType():"HTML",Content:this.bodyContent()}),this.recurrence()&&(e.Recurrence=s.CalendarTypeUtils.recurrenceToJson(this.recurrence())),e},d.prototype.generateDateTimeTimeZone=function(e){return{DateTime:e.toISOString(),TimeZone:i.default.Timezone}},r.__decorate([a.doop],d.prototype,"eventId",null),r.__decorate([a.doop],d.prototype,"subject",null),r.__decorate([a.doop],d.prototype,"start",null),r.__decorate([a.doop],d.prototype,"end",null),r.__decorate([a.doop],d.prototype,"bodyContentType",null),r.__decorate([a.doop],d.prototype,"bodyContent",null),r.__decorate([a.doop],d.prototype,"calendarItemType",null),r.__decorate([a.doop],d.prototype,"recurrence",null),d=r.__decorate([a.doop],d))
function d(e,t,n,r){return o.call(this,l.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(63),s=n(16),u=(i=a.RESTRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/events/"+this.eventId()+"/cancel"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"eventId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"comment",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{Comment:this.comment()}},r.__decorate([o.doop],l.prototype,"eventId",null),r.__decorate([o.doop],l.prototype,"comment",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,s.HTTPRequestMethod.POST,e,t,n,r)||this
return o.maxRetries(0),o}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(63),s=n(16),u=(i=a.RESTRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/events/"+this.eventId()+"/decline"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"eventId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"comment",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"sendResponse",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{Comment:this.comment(),SendResponse:this.sendResponse()}},r.__decorate([o.doop],l.prototype,"eventId",null),r.__decorate([o.doop],l.prototype,"comment",null),r.__decorate([o.doop],l.prototype,"sendResponse",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,s.HTTPRequestMethod.POST,e,t,n,r)||this
return o.maxRetries(0),o}t.default=u},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CleanupOldRoamingSettingActionCreator=void 0
var o=n(0).__importStar(n(65)),r=(i.prototype.cleanUpOldRoamingSettings=function(){this.removeRoamingSettings(o.RoamingSettingsKeys.HasDismissWelcomeCard),this.removeRoamingSettings(o.RoamingSettingsKeys.IsFirstRunAgave),this.removeRoamingSettings(o.RoamingSettingsKeys.LastTimeShowPinTutorial),this.removeRoamingSettings(o.RoamingSettingsKeys.LastTimeFeedbackTutorialDismissed),this.removeRoamingSettings(o.RoamingSettingsKeys.HasUserPinnedAgave),this.removeRoamingSettings(o.RoamingSettingsKeys.HasDismissedLongThreadWorkingHourTip),this.removeRoamingSettings(o.RoamingSettingsKeys.ShouldShowTaskOverflowTeachingMoment),this.removeRoamingSettings(o.RoamingSettingsKeys.ShouldShowReduceMeetingLoadInfobarTeachingMoment_V1),this.updateRoamingSettings(o.RoamingSettingsKeys.LastTimeDismissFeedback,o.RoamingSettingsKeys.LastTimeFeedbackTutorialDismissed),this.updateRoamingSettings(o.RoamingSettingsKeys.LastTimeClickFeedback,o.RoamingSettingsKeys.LastTimeFeedbackSubmitted)},i.prototype.removeRoamingSettings=function(e){o.default.tryGetRoamingSettings(e)&&o.default.tryRemoveRoamingSettings(o.RoamingSettingsTypes.FirstRun,e)},i.prototype.updateRoamingSettings=function(e,t){var n=o.default.tryGetRoamingSettings(e),r=o.default.tryGetRoamingSettings(t)
n&&(r||o.default.trySetRoamingSettings(o.RoamingSettingsTypes.FirstRun,t,n),o.default.tryRemoveRoamingSettings(o.RoamingSettingsTypes.FirstRun,e))},i)
function i(){}t.CleanupOldRoamingSettingActionCreator=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),s=r.__importDefault(n(24)),o=r.__importDefault(n(102)),i=n(5),u=n(844),l=n(7),c=(a=u.EWSRequestSupportPartialSuccessBase,r.__extends(d,a),Object.defineProperty(d.prototype,"timeZoneOffsetInMinutes",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"startDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"endDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"emailAddressList",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"mergedGranularityInMinutes",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),d.prototype.getSOAPRequest=function(){return'<GetUserAvailabilityRequest xmlns="'+l.Constants.EWSMessagesNamespace+'"\n                    xmlns:t="'+l.Constants.EWSTypesNamespace+'">\n                <TimeZone xmlns="'+l.Constants.EWSTypesNamespace+'">\n                    <Bias>'+String(this.timeZoneOffsetInMinutes())+"</Bias>\n                </TimeZone>\n                <MailboxDataArray>\n                    "+this.generateEmailAddressElements()+"\n                </MailboxDataArray>\n                <t:FreeBusyViewOptions>\n                    <t:TimeWindow>\n                        <t:StartTime>"+this.startDate().toISOString()+"</t:StartTime>\n                        <t:EndTime>"+this.endDate().toISOString()+"</t:EndTime>\n                    </t:TimeWindow>\n                    <t:MergedFreeBusyIntervalInMinutes>"+this.mergedGranularityInMinutes()+"</t:MergedFreeBusyIntervalInMinutes>\n                    <t:RequestedView>FreeBusyMerged</t:RequestedView>\n                </t:FreeBusyViewOptions>\n            </GetUserAvailabilityRequest>"},d.prototype.generateEmailAddressElements=function(){return this.emailAddressList().map(function(e){return"<t:MailboxData>\n                    <t:Email>\n                        <t:Address>"+e+"</t:Address>\n                    </t:Email>\n                </t:MailboxData>"}).join("")},d.prototype.toTraceString=function(){return"GetUserAvailability"},d.prototype.getOrderedKeySelector=function(e){var t=this.emailAddressList()
return e<t.length?t[e]:""},d.prototype.getParseXMLTag=function(){return"FreeBusyResponse"},d.prototype.getIgnoredRetryErrorCodes=function(){return[o.default.ERROR_MAIL_RECIPIENT_NOT_FOUND,o.default.ERROR_FREE_BUSY_DL_LIMIT_REACHED,o.default.ERROR_RESULT_SET_TOO_BIG]},d.prototype.getTotalItemCountInside=function(){return this.emailAddressList().length},r.__decorate([i.doop],d.prototype,"timeZoneOffsetInMinutes",null),r.__decorate([i.doop],d.prototype,"startDate",null),r.__decorate([i.doop],d.prototype,"endDate",null),r.__decorate([i.doop],d.prototype,"emailAddressList",null),r.__decorate([i.doop],d.prototype,"mergedGranularityInMinutes",null),d=r.__decorate([i.doop],d))
function d(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.mergedGranularityInMinutes(15),i.timeZoneOffsetInMinutes(s.default.getCurrentTimeZoneOffsetInMinute()),i.maxRetries(3),i}t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EWSRequestSupportPartialSuccessBase=void 0
var r,o=n(0),i=n(84),a=(r=i.EWSRequestBase,o.__extends(s,r),s)
function s(){return null!==r&&r.apply(this,arguments)||this}t.EWSRequestSupportPartialSuccessBase=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(16),s=n(38),u=(i=s.WESRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this
return o.expand(["ActionsServiceSettings"]),o}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PatchActionsServiceSettingsRequestWES=t.ActionsServiceSettingNames=void 0
var r=n(0),o=n(5),i=n(16),a=n(38);(t.ActionsServiceSettingNames||(t.ActionsServiceSettingNames={})).OutlookNotificationsEnabled="OutlookNotificationsEnabled"
var s,u=(s=a.WESRequestBase,r.__extends(l,s),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"settingName",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"settingValue",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l.prototype.postData=function(){var e={}
e[this.settingName()]=this.settingValue()
var t={}
return t.ActionsServiceSettings=e,t},r.__decorate([o.doop],l.prototype,"settingName",null),r.__decorate([o.doop],l.prototype,"settingValue",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=s.call(this,i.HTTPRequestMethod.PATCH,e,t,n,r)||this
return o.expand(["ActionsServiceSettings"]),o}t.PatchActionsServiceSettingsRequestWES=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractedEntityActionCreatorBase=void 0
var s=n(0),r=s.__importDefault(n(11)),u=s.__importDefault(n(90)),a=s.__importDefault(n(4)),l=s.__importDefault(n(68)),i=n(7),o=(c.prototype.updateEntitiesForItemIds=function(a){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return s.__generator(this,function(e){switch(e.label){case 0:return t=[],n=[],0===a.length?[3,2]:(r=this.loadEntitiesForItemRequest(a),[4,u.default.executeRequest(r)])
case 1:(o=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(i=this.parseGetItemResponse(o.result),t=i.entities,n=i.completedEntityIds),e.label=2
case 2:return this.dispatchEntities(t,n),[2]}})})},c.prototype.findAndDispatchEntites=function(){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return[4,this.findItemsWithEntites()]
case 1:return t=e.sent(),[4,this.updateEntitiesForItemIds(t)]
case 2:return e.sent(),[2]}})})},c.prototype.parseGetItemResponse=function(e){for(var t=[],n=[],r=l.default.getMessageAndMeetingRequestElements(e),o=0;o<r.length;o++){var i,a,s=l.default.parseEmailItemBaseFromXMLElement(r[o],this.LOG_FEATURE_NAME)
s.dateTimeSent&&(i=this.buildEntitiesForItem(s,r[o]).filter(function(e){return!!e}),t=t.concat(i),a=this.parseCompletedEntityIdsFromExtendedProperties(s,r[o]),n=n.concat(a))}return{entities:t,completedEntityIds:n}},c.prototype.parseEntitiesFromExtendedProperties=function(e,t){var n=this.getFirstMatchingExtendedPropertyValue(e,t)
return n?this.parseEntitiesFromJSON(n):[]},c.prototype.parseEntitiesFromJSON=function(e){var i=this
return e.map(function(e){var t=e["@sourceConfidenceScore"]||0,n=e.description,r=e["@EntityId"]
if(!r)return a.default.logWarning("EntityId is missing.",i.LOG_FEATURE_NAME,"parseEntitiesFromJSON"),null
if(!n)return a.default.logWarning("Description is missing.",i.LOG_FEATURE_NAME,"parseEntitiesFromJSON"),null
var o=e.scheduledTime
return{confidenceScore:t,description:n,entityId:r,scheduledTime:o?new Date(o):null}}).filter(function(e){return!!e})},c.prototype.getFirstMatchingExtendedPropertyValue=function(e,t){for(var n=0;n<e.length;n++)if(t.doesMatchExtendedPropertyElement(e[n])){var r=l.default.getXMLExactlyOneElementOrThrow(e[n],i.Constants.EWSTypesNamespace,"Value"),o=l.default.getXMLElementTextContentOrEmpty(r)
return o?JSON.parse(o):(a.default.logWarning("Empty value of ExtendedProperty["+t.propertyName+"].",this.LOG_FEATURE_NAME,"getFirstMatchingExtendedPropertyValue"),null)}return null},c.prototype.dispatchEntities=function(e,t){r.default.dispatch({actionType:this.DISPATCH_ACTION_TYPE,entities:e,completedEntityIds:t})},c.prototype.parseCompletedEntityIdsFromExtendedProperties=function(t,e){var n=e.getElementsByTagNameNS(i.Constants.EWSTypesNamespace,"ExtendedProperty"),r=this.getFirstMatchingExtendedPropertyValue(n,this.EXTENDED_FIELD_URI_FOR_COMPLETED_ENTITY)
return r?(r.entityIds||r.commitmentIds||[]).map(function(e){return{itemIdentifier:t.itemId,entityId:e}}):[]},c)
function c(){}t.ExtractedEntityActionCreatorBase=o,t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=r.__importDefault(n(174)),i=n(5),s=n(84),u=(a=s.EWSRequestBase,r.__extends(l,a),Object.defineProperty(l.prototype,"traversal",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"offset",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.getSOAPRequest=function(){return'<m:FindItem Traversal="'+this.traversal()+'">\n                    <m:ItemShape>\n                       <t:BaseShape>IdOnly</t:BaseShape>\n                    <t:AdditionalProperties>\n                         <t:FieldURI FieldURI="item:DateTimeSent"/>\n                    </t:AdditionalProperties>\n                    </m:ItemShape>\n                    <m:IndexedPageItemView MaxEntriesReturned="50"  Offset="'+this.offset()+'" BasePoint="Beginning" />\n                    <m:Restriction>\n                        <t:Or>\n                            <t:Contains ContainmentMode="Substring" ContainmentComparison="IgnoreCase">\n                                '+o.default.FOLLOWUP_SCHEDULE_REPLY_REQUEST_V1.buildXMLString()+'\n                                <t:Constant Value="FollowUp" />\n                            </t:Contains>\n                            <t:Contains ContainmentMode="Substring" ContainmentComparison="IgnoreCase">\n                                '+o.default.FOLLOWUP_SCHEDULE_ACTION_REQUEST_V1.buildXMLString()+'\n                                <t:Constant Value="FollowUp" />\n                            </t:Contains>\n                        </t:Or>\n                    </m:Restriction>\n                    <m:SortOrder>\n                        <t:FieldOrder Order="Descending">\n                            <t:FieldURI FieldURI="item:DateTimeSent" />\n                        </t:FieldOrder>\n                    </m:SortOrder>\n                    <m:ParentFolderIds>\n                        <t:DistinguishedFolderId Id="sentitems" />\n                    </m:ParentFolderIds>\n                </m:FindItem>'},l.prototype.toTraceString=function(){return"FindFollowUpRequestTasksRequest"},r.__decorate([i.doop],l.prototype,"traversal",null),r.__decorate([i.doop],l.prototype,"offset",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.traversal("Shallow"),i.offset(0),i}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SearchContextInsightsActionCreator=void 0
var i=n(0),r=i.__importDefault(n(3)),o=i.__importDefault(n(8)),a=i.__importDefault(n(37)),s=i.__importDefault(n(11)),u=i.__importDefault(n(850)),l=i.__importDefault(n(852)),c=i.__importStar(n(4)),d=i.__importDefault(n(35)),p=i.__importDefault(n(509)),f=i.__importDefault(n(880)),g=i.__importDefault(n(883)),m=i.__importDefault(n(93)),h=i.__importDefault(n(516)),y=i.__importDefault(n(889)),_=i.__importDefault(n(897)),S=n(898),T=n(899),I=n(905),b=n(907),E=n(908),v=n(909),A=n(910),D=n(911),O=n(912),C=n(913),R=n(51),M=n(238),P=n(67),N=(k.prototype.requestComposeInsights=function(){return i.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return i.__generator(this,function(e){switch(e.label){case 0:return this.shouldRequestComposeInsights()?[4,this.buildComposeRequestContext()]:[2]
case 1:return(t=e.sent())&&t.hasMeaningfullyChanged?t.contextProvider?[4,this.getComposeInsights(t.contextProvider)]:(this.cleanUpInsight(Date.now()),[2]):[2]
case 2:return(n=e.sent()).status===Office.AsyncResultStatus.Failed?[2]:(r=n.sourceRequest.requestTimeInTicks(),(o=this.extractInsight(n.result.value))?[4,this.dispatchComposeInsight(o,r)]:(this.cleanUpInsight(r),[2]))
case 3:return e.sent(),[2]}})})},k.prototype.shouldRequestComposeInsights=function(){return o.default.areInfobarComputesEnabled&&a.default.getState().isCompose()&&!m.default.getState().isAwaitingRequest()&&m.default.getState().insightRequestsCount()<this.MAX_INSIGHT_REQUEST_PER_SESSION&&(a.default.getState().isMessage()||a.default.getState().isNewComposeMeeting()||a.default.getState().isAppointmentOrMeeting()&&o.default.areMeetingInfobarsEnabledForEditMode)&&!this.shouldPreemptivelySkipRequest()},k.prototype.shouldPreemptivelySkipRequest=function(){switch(m.default.getState().lockedExternalInsightType()){case M.ExternalInsightType.AutoDelayDeliveryInsight:case M.ExternalInsightType.SuggestedDelayDeliveryInsight:return _.default.shouldSkipRequest()
default:return!1}},k.prototype.buildComposeRequestContext=function(){if(a.default.getState().isAppointmentOrMeeting()){var e=this.selectMeetingContextPropertiesComparer()
return S.MeetingComposeContextBuilder.buildContextAndChanges(e)}return a.default.getState().isMessage()?(e=this.selectEmailContextPropertiesComparer(),T.EmailComposeContextBuilder.buildContextAndChange(e)):null},k.prototype.selectMeetingContextPropertiesComparer=function(){switch(m.default.getState().lockedExternalInsightType()){case M.ExternalInsightType.DetectOOFComposingInfobar:return new O.DetectOOFMeetingContextComparer
case M.ExternalInsightType.ComposePeopleCatchUpItemsInsightInfobar:return new C.PeopleCatchUpMeetingContextComparer
default:return new I.DefaultMeetingContextComparer}},k.prototype.selectEmailContextPropertiesComparer=function(){switch(m.default.getState().lockedExternalInsightType()){case M.ExternalInsightType.SuggestedDelayDeliveryInsight:case M.ExternalInsightType.AutoDelayDeliveryInsight:return new E.DelayDeliveryEmailContextComparer
case M.ExternalInsightType.DetectOOFComposingInfobar:return new v.DetectOOFEmailContextComparer
case M.ExternalInsightType.ComposePeopleCatchUpItemsInsightInfobar:return new A.PeopleCatchUpEmailContextComparer
case M.ExternalInsightType.TrackEmailInsightInfobar:return new D.TrackEmailContextComparer
default:return new b.DefaultEmailContextComparer}},k.prototype.getComposeInsights=function(o){return i.__awaiter(this,void 0,void 0,function(){var t,n,r
return i.__generator(this,function(e){switch(e.label){case 0:return t=new u.default(this.LOG_FEATURE_NAME,"findComposeInsights",c.LogRequestType.Interval).contextProvider(o),(n=m.default.getState().lockedInsightName())&&(t=new l.default(this.LOG_FEATURE_NAME,"getComposeInsight",c.LogRequestType.Interval).contextProvider(o).insightName(n)),this.dispatchRequestStatus(!0),[4,d.default.executeWESRequest(t)]
case 1:return r=e.sent(),this.dispatchRequestStatus(!1),[2,r]}})})},k.prototype.extractInsight=function(e){if(0<e.length){1<e.length&&c.default.logWarning(e+" insights are returned",this.LOG_FEATURE_NAME,"extractInsight")
try{return P.ExternalInsightConverter.convertToInsight(e[0])}catch(e){c.default.logAssert("Exception + "+JSON.stringify(e),this.LOG_FEATURE_NAME,"extractInsight")}}},k.prototype.cleanUpInsight=function(e){s.default.dispatch({actionType:r.default.CleanUpInfobarInsight,requestTimeInTicks:e})},k.prototype.dispatchComposeInsight=function(r,o){return i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:switch(e.trys.push([0,9,,10]),t=!0,r.insightType){case M.ExternalInsightType.DetectOOFComposingInfobar:return[3,1]
case M.ExternalInsightType.AutoDelayDeliveryInsight:case M.ExternalInsightType.SuggestedDelayDeliveryInsight:return[3,2]
case M.ExternalInsightType.TrackEmailInsightInfobar:return[3,3]
case M.ExternalInsightType.ComposePeopleCatchUpItemsInsightInfobar:return[3,4]
case M.ExternalInsightType.MeetingPreparationInfobar:return[3,5]}return[3,7]
case 1:return g.default.extractAndDispatch(r,o),[3,8]
case 2:return f.default.extractAndDispatch(r,o),[3,8]
case 3:return h.default.extractAndDispatch(r,o),[3,8]
case 4:return y.default.extractAndDispatch(r,o),[3,8]
case 5:return[4,p.default.extractAndDispatch(r,o)]
case 6:return t=e.sent(),[3,8]
case 7:throw new Error("Unknown insightType "+r.insightType+" with version "+r.version)
case 8:return t&&this.dispatchLockedInsight(r),[3,10]
case 9:return n=e.sent(),c.default.logAssert("Exception + "+JSON.stringify(n),this.LOG_FEATURE_NAME,"dispatchComposeInsight"),[3,10]
case 10:return[2]}})})},k.prototype.dispatchLockedInsight=function(e){s.default.dispatch({actionType:r.default.UpsertLockedInsightNameAndType,insightName:null==e?void 0:e.value.Name,externalInsightType:null==e?void 0:e.insightType})},k.prototype.dispatchRequestStatus=function(e){s.default.dispatch({actionType:r.default.UpdateSearchContextInsightsRequestStatus,isAwaitingRequest:e})},i.__decorate([R.expirable(R.ExpirationTypes.ByItemChange),R.expirable(R.ExpirationTypes.ByEvery_Minutes,.1,R.ExpirableInBackground.Allowed)],k.prototype,"requestComposeInsights",null),k=i.__decorate([R.expirable()],k))
function k(){this.LOG_FEATURE_NAME="SearchContextInsightsActionCreator",this.MAX_INSIGHT_REQUEST_PER_SESSION=50}t.SearchContextInsightsActionCreator=N,t.default=new N},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=r.__importDefault(n(288)),s=(o=a.default,r.__extends(u,o),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/insights/FindRelevantInsights"},enumerable:!1,configurable:!0}),u.prototype.postData=function(){return{context:this.contextProvider().getContext()}},u=r.__decorate([i.doop],u))
function u(e,t,n,r){return o.call(this,e,t,n,r)||this}t.default=s},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.SubjectValue=t.SubjectKind=void 0,(r=t.SubjectKind||(t.SubjectKind={})).MeetingRequest="MeetingRequest",r.Email="Email",(t.SubjectValue||(t.SubjectValue={})).Me="Me"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=r.__importDefault(n(288)),s=(o=a.default,r.__extends(u,o),Object.defineProperty(u.prototype,"insightName",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/insights/GetByContext"},enumerable:!1,configurable:!0}),u.prototype.postData=function(){return{insightname:this.insightName(),context:this.contextProvider().getContext()}},r.__decorate([i.doop],u.prototype,"insightName",null),u=r.__decorate([i.doop],u))
function u(e,t,n,r){return o.call(this,e,t,n,r)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationInfobarInsightConverter=void 0
var r,o=n(0),i=n(205),a=o.__importDefault(n(854)),s=n(67),u=(r=s.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){switch(e.version){case i.InsightVersion.v2:return a.default.convertToRuntimeInsight(e.value)
default:throw new Error("Invalid MeetingPreparationTime insight version: ["+e.version+"]")}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.MeetingPreparationInfobarInsightConverter=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationInfobarConverter_V2=void 0
var r=n(0),o=n(119),i=r.__importStar(n(52)),a=(s.prototype.convertToRuntimeInsight=function(e){var t=i.default.convertSuggestedActions(e.Suggestion.SuggestedActions,i.BOOK_PREPARATION_TIME_ACTION),n=i.default.convertSuggestedActions(e.Suggestion.SuggestedActions,i.BOOK_REHEARSAL_TIME)
return{insightText:e.Inference.Text,actionText:e.Suggestion.Text,bookPreparationTimeActions:t,bookRehearsalTimeActions:n,identifier:o.ExternalContextUtils_V2.getInsightIdentifier(e)}},s)
function s(){}t.MeetingPreparationInfobarConverter_V2=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalInsightConverter_V2=void 0
var r=n(0).__importDefault(n(4)),o=n(205),i=n(238),a=n(177),s=(u.convertToInsight=function(e){var t=e
if(!t)return null
var n=this.getInsightType(t.Name)
return n?{version:o.InsightVersion.v2,insightType:n,value:t}:(r.default.logAssert("Unknown insight type with name "+t.Name,"InsightConverter_V2","convertToInsight"),null)},u.getInsightType=function(e){switch(e){case u.TRACK_EMAIL_INSIGHT_NAME:return i.ExternalInsightType.TrackEmailInsightInfobar
case u.MEETING_PREPARATION_CARD_INSIGHT_NAME:return i.ExternalInsightType.MeetingReadinessInsight
case u.MEETING_RELATED_DOCUMENTS_INSIGHT_NAME:return i.ExternalInsightType.MeetingRelatedDocumentsInsight
case u.DOCUMENTS_TO_CATCHUP_INSIGHT_NAME:return i.ExternalInsightType.DocumentsToCatchupInsight
case u.TASKS_INSIGHT_NAME:return i.ExternalInsightType.TasksInsight
case u.CATCH_UP_IMPORTANT_MAIL_INSIGHT_NAME:return i.ExternalInsightType.CatchUpImportantMailInsight
case u.FOLLOWUPS_INSIGHT_NAME:return i.ExternalInsightType.FollowUpsInsight
case u.FOCUS_GOAL_DAYS_TO_BOOK_INSIGHT_NAME:return i.ExternalInsightType.FocusGoalDaysToBookInsight
case u.DIRECT_REPORT_BOOK_ONE_ON_ONE_INSIGHT_NAME:return i.ExternalInsightType.DirectReportsBookOneOnOneInsight
case u.DETECT_OOF_COMPOSING_INSIGHT_NAME:return i.ExternalInsightType.DetectOOFComposingInfobar
case u.DIRECT_REPORT_CONFLICTING_ONE_ON_ONE_INSIGHT_NAME:return i.ExternalInsightType.DirectReportsConflictingOneOnOneInsight
case u.SMART_RULES_SUGGESTION_INSIGHT_NAME:return i.ExternalInsightType.SmartRulesSuggestionInsight
case u.TEAMS_GROUP_SUGGESTION_INSIGHT_NAME:return i.ExternalInsightType.TeamsGroupSuggestionInsight
case u.AUTO_DELAY_DELIVERY_INSIGHT_NAME:return i.ExternalInsightType.AutoDelayDeliveryInsight
case u.SUGGESTED_DELAY_DELIVERY_INSIGHT_NAME:return i.ExternalInsightType.SuggestedDelayDeliveryInsight
case u.COMPOSE_PEOPLE_CATCH_UP_ITEMS_INSIGHT_NAME:return i.ExternalInsightType.ComposePeopleCatchUpItemsInsightInfobar
case u.MEETING_PREPARATION_INFOBAR_INSIGHT_NAME:return i.ExternalInsightType.MeetingPreparationInfobar
default:return null}},u.AUTO_DELAY_DELIVERY_INSIGHT_NAME="AutoDelayDeliveryInsight",u.SUGGESTED_DELAY_DELIVERY_INSIGHT_NAME="SuggestedDelayDeliveryInsight",u.TRACK_EMAIL_INSIGHT_NAME="TrackEmailInsight",u.MEETING_PREPARATION_CARD_INSIGHT_NAME="MeetingReadinessInsight",u.MEETING_RELATED_DOCUMENTS_INSIGHT_NAME="MeetingRelatedDocumentsInsight",u.DOCUMENTS_TO_CATCHUP_INSIGHT_NAME="DocumentsToCatchupInsight",u.DETECT_OOF_COMPOSING_INSIGHT_NAME="PlanTimeAwayInsight",u.TASKS_INSIGHT_NAME="TasksInsight",u.CATCH_UP_IMPORTANT_MAIL_INSIGHT_NAME="CatchUpImportantMailInsight",u.FOLLOWUPS_INSIGHT_NAME="FollowUpsInsight",u.FOCUS_GOAL_DAYS_TO_BOOK_INSIGHT_NAME="FocusGoalDaysToBookInsight",u.COMPOSE_PEOPLE_CATCH_UP_ITEMS_INSIGHT_NAME="ComposePeopleCatchUpItemsInsight",u.DIRECT_REPORT_BOOK_ONE_ON_ONE_INSIGHT_NAME="DirectReportsBookOneOnOneInsight",u.DIRECT_REPORT_CONFLICTING_ONE_ON_ONE_INSIGHT_NAME="DirectReportsConflictingOneOnOneInsight",u.SMART_RULES_SUGGESTION_INSIGHT_NAME="SmartRulesSuggestionInsight",u.TEAMS_GROUP_SUGGESTION_INSIGHT_NAME="TeamsGroupSuggestionInsight",u.MEETING_PREPARATION_INFOBAR_INSIGHT_NAME=a.MEETING_PREPARATION_INFOBAR_INSIGHT_NAME,u)
function u(){}t.ExternalInsightConverter_V2=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(38),s=n(16),u=(i=a.WESRequestBase,r.__extends(l,i),Object.defineProperty(l.prototype,"insightNames",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/insights"},enumerable:!1,configurable:!0}),l.prototype.getFilterCriteria=function(){return""+this.insightNames().map(function(e){return"Name eq '"+e+"'"}).join(" or ")},r.__decorate([o.doop],l.prototype,"insightNames",null),l=r.__decorate([o.doop],l))
function l(e,t,n,r){var o=i.call(this,s.HTTPRequestMethod.GET,e,t,n,r)||this
return o.shouldIncludeMetadata(!0),o}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(510),s=(i=a.WESActionRequest,r.__extends(u,i),Object.defineProperty(u.prototype,"getAction",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.action=function(){return this.getAction()},r.__decorate([o.doop],u.prototype,"getAction",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CatchUpImportantMailInsightProcessor=void 0
var r,o=n(0),i=o.__importDefault(n(3)),a=n(859),s=n(106),u=(r=s.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return i.default.GetIRankerUnreadMail},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new a.CatchUpImportantMailInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.CatchUpImportantMailInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CatchUpImportantMailInsightConverter=void 0
var r,o=n(0),c=o.__importDefault(n(39)),d=o.__importDefault(n(75)),p=o.__importStar(n(52)),f=n(119),i=n(67),a=(r=i.ExternalInsightConverter,o.__extends(s,r),s.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
c.default.throwIfNullOrEmptyArray("Observations",t)
var n=d.default.convertAndValidateStringObservation(t,"EmailItemId"),r=d.default.convertAndValidateStringObservation(t,"ConversationId"),o=d.default.convertAndValidateStringObservation(t,"EmailBodyPreview"),i=d.default.convertAndValidateStringObservation(t,"EmailSenderAddress"),a=d.default.convertAndValidateStringObservation(t,"EmailSenderName"),s=d.default.convertAndValidateStringObservation(t,"EmailSubject"),u=new Date(d.default.convertObservation(t,"EmailSentDateTime")),l=p.default.convertSuggestedAction(e.value.Suggestion.SuggestedActions,p.MARK_MAIL_AS_NOT_IMPORTANT_ACTION)
return{identifier:f.ExternalContextUtils_V2.getInsightIdentifier(e.value),unreadEmailItem:{fromEmailAddress:i,conversationId:r,senderName:a,bodyPreview:o,itemId:{id:n},dateTimeSent:u,subject:s},markMailAsNotImportantAction:l}},s)
function s(){return null!==r&&r.apply(this,arguments)||this}t.CatchUpImportantMailInsightConverter=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationCardInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(861),u=o.__importDefault(n(862)),l=o.__importDefault(n(8)),c=(r=i.FeedWESInsightProcessor,o.__extends(d,r),Object.defineProperty(d.prototype,"dispatchAction",{get:function(){return a.default.MeetingPreparationCardInsightAction},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"feedInsightConverter",{get:function(){return new s.MeetingPreparationCardInsightConverter},enumerable:!1,configurable:!0}),d.prototype.requestAdditionalData=function(e){l.default.isMeetingPreparationDocumentStatsEnabled&&e.attendeeCount>=this.MIN_ATTENDEES_REQUIRED_TO_TRIGGER_DOC_STATS_COMPUTE&&e.isOrganizer&&u.default.getMeetingDocumentStatistics(e.identifier.primaryId,e.meetingId)},d)
function d(){var e=null!==r&&r.apply(this,arguments)||this
return e.MIN_ATTENDEES_REQUIRED_TO_TRIGGER_DOC_STATS_COMPUTE=5,e}t.MeetingPreparationCardInsightProcessor=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationCardInsightConverter=void 0
var r,o=n(0),N=n(29),i=n(206),k=o.__importDefault(n(75)),a=o.__importDefault(n(6)),s=n(67),w=o.__importStar(n(52)),F=o.__importDefault(n(39)),L=o.__importDefault(n(8)),u=(r=s.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){var t=this,n=e.value.Inference.Observations
F.default.throwIfNullOrEmptyArray("Observations",n)
var r=k.default.convertObservation(n,"MeetingId"),o=k.default.convertObservation(n,"MeetingSubject"),i=k.default.convertObservation(n,"MeetingStartTimeDateTimeOffset"),a=k.default.convertObservation(n,"MeetingCreatedDateTimeInUtc"),s=k.default.convertObservation(n,"MeetingHasAgenda"),u=k.default.convertObservation(n,"PreviousMeetingSubject"),l=k.default.convertObservation(n,"MeetingPreparationTimeDurationAvailableInMinutes"),c=k.default.convertObservation(n,"MeetingPreparationTimeDurationBookedInMinutes"),d=k.default.convertObservation(n,"OnlineMeetingUrl"),p=this.getAttendeeGroup(n,"MeetingAcceptedAttendees"),f=this.getAttendeeGroup(n,"MeetingDeclinedAttendees"),g=this.getAttendeeGroup(n,"MeetingTentativeAttendees"),m=this.getAttendeeGroup(n,"MeetingNoResponseAttendees"),h=k.default.convertObservation(n,"MeetingAcceptancePercent"),y=k.default.convertObservation(n,"MeetingAttendeeCount"),_=k.default.convertObservation(n,"MeetingAttachments").map(function(e){return t.parseAttachmentJson(e,r)}),S=w.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,w.BOOK_PREPARATION_TIME_ACTION),T=w.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,w.CANCEL_BOOKED_TIME_ACTION),I=N.ResponseType.None,b=this.getDefaultOrganizerValue(),E=k.default.convertObservation(n,"MeetingDurationInMinutes"),v=k.default.convertObservation(n,"MeetingLocation"),b=this.parseOrganizerJson(k.default.convertObservation(n,"MeetingOrganizer")),I=N.ResponseType[k.default.convertObservation(n,"MeetingResponseType")],A=this.parseConflictingMeetingsJson(k.default.convertObservation(n,"ConflictingMeetings")),D=I===N.ResponseType.Organizer,O=this.parseRelatedTasksJson(k.default.convertObservation(n,"RelatedTasks")),C=w.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,w.ACCEPT_MEETING_ACTION),R=w.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,w.DECLINE_MEETING_ACTION),M=!1
L.default.isMeetingPreparationOutOfRoutineEnabled&&(M=this.parseOutOfRoutineJson(k.default.convertObservation(n,"OutOfRoutine")))
var P=!0
return L.default.isNoResponseRequestedEnabled&&(P=k.default.convertObservation(n,"ResponseRequested")),{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},meetingId:r,subject:o,startTime:new Date(i),createdDateTimeInUtcString:a,hasAgenda:s,duration:E,response:I,location:v,organizer:b,conflictingMeetings:A,relatedTaskIds:O,relatedTasks:[],relatedDocuments:[],isOrganizer:D,previousMeetingSubject:u,preparationTimeDurationBooked:c,preparationTimeDurationAvailable:l,onlineMeetingUrl:d,attachments:_,acceptList:p,declineList:f,tentativeList:g,noResponseList:m,attendancePercent:h,attendeeCount:y,isOutOfRoutine:M,bookShortPreparationTimeAction:0<S.length?S[0]:null,bookLongPreparationTimeAction:1<S.length?S[1]:null,cancelBookedTimeAction:0<T.length?T[0]:null,acceptMeetingAction:0<C.length?C[0]:null,declineMeetingAction:0<R.length?R[0]:null,isMock:!1,responseRequested:P}},l.prototype.getDefaultOrganizerValue=function(){return{isPinnedByUser:!1,user:{displayName:a.default.userDisplayName,mailAddress:a.default.userEmailLowerCase}}},l.prototype.getAttendeeGroup=function(e,t){var n=k.default.convertObservation(e,t)
return this.parseAttendeeGroupJson(n)},l.prototype.parseAttendeeGroupJson=function(e){var t=this
return{importantList:e.filter(function(e){return e.IsPinnedByUser}).map(function(e){return t.parseAttendeeJson(e)}),remainderList:e.filter(function(e){return!e.IsPinnedByUser}).map(function(e){return t.parseAttendeeJson(e)})}},l.prototype.parseOrganizerJson=function(e){return{isPinnedByUser:e.IsPinnedByUser,user:{displayName:e.EmailAddress.DisplayName,mailAddress:e.EmailAddress.MailAddress}}},l.prototype.parseConflictingMeetingsJson=function(e){var t=this
return e.map(function(e){return t.parseConflictingMeetingJson(e)})},l.prototype.parseConflictingMeetingJson=function(e){return{id:e.Id,subject:e.Subject,startTime:new Date(e.StartTimeOffset),endTime:new Date(e.EndTimeOffset)}},l.prototype.parseRelatedTasksJson=function(e){return e.map(function(e){return e.Id})},l.prototype.parseAttendeeJson=function(e){var t=""
return e.EmailAddress.MailAddress&&(t=e.EmailAddress.MailAddress.toLowerCase()),{isRequired:"Required"===e.Type,name:e.EmailAddress.DisplayName,smtpAddress:t,responseType:N.CalendarTypeUtils.strToResponseType(e.Response)}},l.prototype.parseAttachmentJson=function(e,t){var n=null,r=i.DocumentProviderType.NativeAttachment
return e.SourceUrl&&(n=e.SourceUrl,r=i.DocumentProviderType.OneDrivePro),{messageId:t,documentURL:n,providerType:r,attachmentId:e.Id,attachmentName:e.Name,fileType:this.getFileType(e.Name)}},l.prototype.getFileType=function(e){var t=e.split(".").pop().toUpperCase(),n=i.DocumentFileType[t]
return void 0===n&&(n=i.DocumentFileType.UnknownFileType),n},l.prototype.parseOutOfRoutineJson=function(e){return e.IsOutOfRoutine},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.MeetingPreparationCardInsightConverter=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingDocumentStatsActionCreator=void 0
var i=n(0),a=n(4),s=i.__importDefault(n(35)),u=n(34),l=i.__importDefault(n(863)),r=i.__importDefault(n(289)),c=i.__importDefault(n(11)),d=i.__importDefault(n(3)),o=(p.prototype.getMeetingDocumentStatistics=function(r,o){return i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:return t=new l.default(this.LOG_FEATURE_NAME,"MeetingDocumentStatsWES",a.LogRequestType.Interval).meetingId(o),[4,s.default.executeWESRequest(t,u.RequestPriority.Low)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&n.result.value&&0<n.result.value.length&&c.default.dispatch({actionType:d.default.MeetingDocumentStatsCardAction,insightId:r,documentAnalytics:this.parseDocumentStatistics(n.result.value[0])}),[2]}})})},p.prototype.parseDocumentStatistics=function(e){return{id:e.Id,internetMessageId:e.InternetMessageId,isTracked:e.IsTracked,statisticsBreakdown:this.parseDocumentStatisticsBreakdown(e.StatisticBreakdowns)}},p.prototype.parseDocumentStatisticsBreakdown=function(e){return e.map(function(e){return{accessLevel:r.default.getAccessLevel(e.AccessLevel),accessPercent:e.AccessPercent,documentName:e.DocumentName,documentUrl:e.DocumentUrl}})},p)
function p(){this.LOG_FEATURE_NAME="MeetingDocumentStats"}t.MeetingDocumentStatsActionCreator=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"meetingId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/messages('"+this.meetingId()+"')/ComputeMeetingDocumentStatistics"},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"meetingId",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingRelatedDocumentsInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(865),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.MeetingRelatedDocumentsAction},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.MeetingRelatedDocumentsInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.MeetingRelatedDocumentsInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingRelatedDocumentsInsightConverter=void 0
var r,o=n(0),i=o.__importDefault(n(75)),a=n(67),s=n(206),u=o.__importDefault(n(39)),l=(r=a.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
u.default.throwIfNullOrEmptyArray("Observations",t)
var n=i.default.convertObservation(t,"MeetingId"),r=i.default.convertObservation(t,"MeetingDocumentSuggestion"),o=this.parseRelatedDocumentJson(r,n)
return{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},meetingId:n,meetingRelatedDocument:o}},c.prototype.parseRelatedDocumentJson=function(e,t){var n=null,r=s.DocumentProviderType.NativeAttachment
return e.SourceUrl&&(n=e.SourceUrl,r=s.DocumentProviderType.OneDrivePro),{messageId:t,documentURL:n,providerType:r,attachmentId:e.Id,attachmentName:e.Name,fileType:this.getFileType(e.Name)}},c.prototype.getFileType=function(e){var t=e.split(".").pop().toUpperCase(),n=s.DocumentFileType[t]
return void 0===n&&(n=s.DocumentFileType.UnknownFileType),n},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.MeetingRelatedDocumentsInsightConverter=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentsToCatchupInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(867),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.DocumentsToCatchupInsightAction},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.DocumentsToCatchupInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DocumentsToCatchupInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentsToCatchupInsightConverter=void 0
var r,o=n(0),i=o.__importStar(n(115)),a=o.__importStar(n(206)),s=o.__importDefault(n(75)),u=o.__importDefault(n(39)),l=n(67),c=(r=l.ExternalInsightConverter,o.__extends(d,r),d.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations,n=s.default.convertObservation(t,"DocumentsToCatchupSenderDisplayName"),r=s.default.convertObservation(t,"DocumentsToCatchupSenderSmtpAddress"),o=s.default.convertObservation(t,"DocumentsToCatchupSentMessageSubject")
u.default.throwIfUndefinedOrEmptyString("UserName",n),u.default.throwIfUndefinedOrEmptyString("UserSmtpAddress",r)
var i=this.getDocumentsList(t,"DocumentsToCatchup"),a=this.getSharedByUser(n,r)
return{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},itemId:i[0].messageId,subject:o,sharedByUser:a,attachedDocuments:i}},d.prototype.getSharedByUser=function(e,t){return{name:e,smtpAddress:t,mailboxType:i.MailboxType.Mailbox}},d.prototype.getDocumentsList=function(e,t){var n=this
return s.default.convertObservation(e,t).map(function(e){return n.parseDocument(e)})},d.prototype.parseDocument=function(e){var t=e.Extension?a.DocumentFileType[e.Extension.toUpperCase()]:a.DocumentFileType.UnknownFileType
void 0===t&&(t=a.DocumentFileType.UnknownFileType)
var n=a.SharingReferenceType[e.SharingReferenceType]
void 0===n&&(n=a.SharingReferenceType.Unknown)
var r=new Date(e.LastSharedTime)
u.default.throwIfUndefinedOrInvalidDate("LastSharedDate",r)
var o=new Date(e.LastModifiedTime)
return u.default.throwIfUndefinedOrInvalidDate("LastModifiedDate",o),{messageId:e.SharedByMessageId,documentURL:e.AccessUrl,providerType:a.DocumentProviderType.OneDrivePro,attachmentId:e.Id,attachmentName:e.Name,fileType:t,lastSharedTime:r,lastModifiedTime:o,relevancyScore:e.RelevancyScore,sharingReferenceType:n}},d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.DocumentsToCatchupInsightConverter=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TasksInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(512),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.TasksInsightAction},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.TasksInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.TasksInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpsInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(512),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.FollowUpsInsight},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.TasksInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.FollowUpsInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DaysToBookInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(871),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.GetDaysToBookInsight},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.DaysToBookInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DaysToBookInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DaysToBookInsightConverter=void 0
var r,o=n(0),i=n(67),a=n(119),s=o.__importDefault(n(75)),u=o.__importDefault(n(513)),l=o.__importDefault(n(39)),c=(r=i.ExternalInsightConverter,o.__extends(d,r),d.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
l.default.throwIfNullOrEmptyArray("Observations",t)
var n=s.default.convertObservation(t,"DaysWithSuggestedFocusBlocks"),r=u.default.extractFreeBlocksSuggestionFromInsight(e)
return{identifier:a.ExternalContextUtils_V2.getInsightIdentifier(e.value),freeBlocks:r,daysWithSuggestedBlocks:n}},d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.DaysToBookInsightConverter=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportBookOneOnOneInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(873),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.BookOneOnOneInsight},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.DirectReportBookOneOnOneInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportBookOneOnOneInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportBookOneOnOneInsightConverter=void 0
var r,o=n(0),i=n(67),a=o.__importStar(n(52)),s=o.__importDefault(n(75)),u=o.__importDefault(n(39)),l=(r=i.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
u.default.throwIfNullOrEmptyArray("Observations",t)
var n=s.default.convertAndValidateStringObservation(t,"DisplayName"),r=e.value.Inference.Subject.Value
return{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},smtpAddress:r,displayName:n,bookOneOnOneActions:this.getBookOneOnOneActions(e)}},c.prototype.getBookOneOnOneActions=function(e){return a.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,a.BOOK_ONE_ON_ONE_ACTION)},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportBookOneOnOneInsightConverter=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportConflictingOneOnOneInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(875),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.ConflictingOneOnOneInsight},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.DirectReportConflictingOneOnOneInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportConflictingOneOnOneInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportConflictingOneOnOneInsightConverter=void 0
var r,o=n(0),i=n(67),a=o.__importStar(n(52)),s=o.__importDefault(n(75)),u=o.__importDefault(n(39)),l=(r=i.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
u.default.throwIfNullOrEmptyArray("Observations",t)
var n=s.default.convertAndValidateStringObservation(t,"MeetingId"),r=s.default.convertAndValidateStringObservation(t,"DisplayName"),o=s.default.convertAndValidateStringObservation(t,"PrimarySmtpAddress"),i=s.default.convertAndValidateStringObservation(t,"MeetingStartTime"),a=s.default.convertAndValidateStringObservation(t,"MeetingEndTime")
return{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},meetingId:n,displayName:r,smtpAddress:o,meetingStartTime:i,meetingEndTime:a,conflictingActions:this.getRescheduleActions(e)}},c.prototype.getRescheduleActions=function(e){return a.default.convertSuggestedActions(e.value.Suggestion.SuggestedActions,a.RESCHEDULE_APPOINTMENT_ACTION)},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportConflictingOneOnOneInsightConverter=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SmartRulesSuggestionInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(877),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.SmartRulesSuggestionInsightAction},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.SmartRulesSuggestionInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.SmartRulesSuggestionInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SmartRulesSuggestionInsightConverter=void 0
var r,o=n(0),i=o.__importDefault(n(75)),a=n(67),s=o.__importDefault(n(52)),u=o.__importDefault(n(39)),l=(r=a.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
u.default.throwIfNullOrEmptyArray("Observations",t)
var n=s.default.convertSuggestedAction(e.value.Suggestion.SuggestedActions,"CreateSmartRule"),r=i.default.convertObservation(t,"NumberOfEmails")
return{identifier:{primaryId:e.value.Id,secondaryId:e.value.Name},messageRulePredicates:this.getMessageRulePredicates(t),emails:this.getPreviewMessages(t),totalMailCount:r,createRuleAction:n}},c.prototype.getMessageRulePredicates=function(e){var t=this,n=i.default.convertObservation(e,"MessageRulePredicates")
return{fromAddresses:n.FromAddresses.map(function(e){return t.parseEmailAddressJson(e,!1)}),sentToAddresses:n.SentToAddresses.map(function(e){return t.parseEmailAddressJson(e,!1)})}},c.prototype.getPreviewMessages=function(e){var r=this
return i.default.convertObservation(e,"PreviewMessages").map(function(e){var t=new Date(e.ReceivedDateTime)
u.default.throwIfUndefinedOrInvalidDate("PreviewMessageReceivedDateTime",t)
var n=e.ToRecipients.map(function(e){return r.parseEmailAddressJson(e,!0)}).concat(e.CcRecipients.map(function(e){return r.parseEmailAddressJson(e,!0)}))
return{id:e.Id,subject:e.Subject,receivedDateTime:t,fromAddress:r.parseEmailAddressJson(e.Sender,!0),sentToAddresses:n}})},c.prototype.parseEmailAddressJson=function(e,t){var n=e.EmailAddress.MailAddress
return t&&(n=n.toLowerCase()),{name:e.EmailAddress.DisplayName,smtpAddress:n}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.SmartRulesSuggestionInsightConverter=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsGroupSuggestionInsightProcessor=void 0
var r,o=n(0),i=n(106),a=o.__importDefault(n(3)),s=n(879),u=(r=i.FeedWESInsightProcessor,o.__extends(l,r),Object.defineProperty(l.prototype,"dispatchAction",{get:function(){return a.default.TeamsGroupSuggestion},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"feedInsightConverter",{get:function(){return new s.TeamsGroupSuggestionInsightConverter},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.TeamsGroupSuggestionInsightProcessor=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsGroupSuggestionInsightConverter=void 0
var r,o=n(0),i=n(67),a=n(119),s=o.__importDefault(n(39)),u=o.__importDefault(n(75)),l=(r=i.ExternalInsightConverter,o.__extends(c,r),c.prototype.convertToRuntimeType=function(e){var t=e.value.Inference.Observations
s.default.throwIfNullOrEmptyArray("Observations",t)
var n=u.default.convertObservation(t,"MeetingAttendees")
return{identifier:a.ExternalContextUtils_V2.getInsightIdentifier(e.value),meetingSubject:e.value.Inference.Text,groupMembers:this.getGroupMembers(n)}},c.prototype.getGroupMembers=function(e){var t=[]
return e.forEach(function(e){t.push({name:e.DisplayName,smtpAddress:e.MailAddress})}),t},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.TeamsGroupSuggestionInsightConverter=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedDelayDeliveryInfobarActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importDefault(n(4)),s=r.__importDefault(n(881)),u=n(238),l=(c.prototype.extractAndDispatch=function(e,t){var n=s.default.convertToRunTimeInstanceData(e)
n.suggestedDateTime<new Date&&a.default.logWarning("Argument [suggestedDateTime] is in the past.","SuggestedDelayDeliveryInfobar","SuggestedDelayDeliveryInfobarActionCreator"),e.insightType===u.ExternalInsightType.AutoDelayDeliveryInsight?i.default.dispatch({actionType:o.default.GetAutoDelayDeliveryInfobar,autoDelayDeliveryInfobar:n,requestTimeInTicks:t}):i.default.dispatch({actionType:o.default.GetSuggestedDelayDeliveryInfobar,suggestedDelayDeliveryInsight:n,requestTimeInTicks:t})},c)
function c(){}t.SuggestedDelayDeliveryInfobarActionCreator=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedDelayDeliveryInfobarConverter=void 0
var r,o=n(0),i=n(205),a=o.__importDefault(n(882)),s=n(67),u=(r=s.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){switch(e.version){case i.InsightVersion.v2:return a.default.convertToRuntimeInsight(e.value)
default:throw new Error("Invalid SuggestedDelayDelivery insight version: ["+e.version+"]")}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.SuggestedDelayDeliveryInfobarConverter=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedDelayDeliveryInfobarConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importDefault(n(75)),a=r.__importDefault(n(3)),s=r.__importDefault(n(11)),u=n(119),l=n(7),c=(d.prototype.convertToRuntimeInsight=function(e){o.default.throwIfUndefinedOrNull("insight",e),o.default.throwIfUndefinedOrNull("insight Inference",e.Inference),o.default.throwIfUndefinedOrNull("insight Inference observations",e.Inference.Observations),o.default.throwIfUndefinedOrNull("insight Suggestion",e.Suggestion),o.default.throwIfUndefinedOrEmptyString("insight Inference Text",e.Inference.Text),o.default.throwIfUndefinedOrEmptyString("insight Suggestion Text",e.Suggestion.Text)
var t=i.default.convertObservation(e.Inference.Observations,"SuggestedDelayDeliveryTime"),n=new Date(t)
return o.default.throwIfUndefinedOrInvalidDate("SuggestedDelayDeliveryTime",n),this.parseAndDispatchAddressToTimeZoneMap(e.Inference.Observations),{insightText:e.Inference.Text,actionText:e.Suggestion.Text,suggestedDateTime:n,identifier:u.ExternalContextUtils_V2.getInsightIdentifier(e)}},d.prototype.parseAndDispatchAddressToTimeZoneMap=function(e){var t,n=e.filter(function(e){return"RecipientsTimeZoneUtcOffset"===e.Name})
0<n.length&&(t=n[0].Value.reduce(function(e,t){return e[t.Key.toLowerCase()]=t.Value*-l.Constants.oneHourInMinutes,e},{}),s.default.dispatch({actionType:a.default.GetUserAddressToTimeZoneMap,userAddressToTimeZoneMap:t,shouldDisplayRecipientsTimeZone:!0}))},d)
function d(){}t.SuggestedDelayDeliveryInfobarConverter_V2=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFComposingInfobarActionCreator=void 0
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importDefault(n(884)),s=(u.prototype.extractAndDispatch=function(e,t){var n=a.default.convertToRunTimeInstanceData(e)
i.default.dispatch({actionType:o.default.GetDetectOOFComposingInfobar,detectOOFComposingInfobar:n,requestTimeInTicks:t})},u)
function u(){}t.DetectOOFComposingInfobarActionCreator=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFComposingInfobarConverter=void 0
var r,o=n(0),i=n(205),a=o.__importDefault(n(885)),s=n(67),u=(r=s.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){switch(e.version){case i.InsightVersion.v2:return a.default.convertToRuntimeInsight(e.value)
default:throw new Error("Invalid DetectOOFComposing insight version: ["+e.version+"]")}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DetectOOFComposingInfobarConverter=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFComposingInfobarConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importDefault(n(75)),a=n(119),s=(u.prototype.convertToRuntimeInsight=function(e){o.default.throwIfUndefinedOrNull("insight",e),o.default.throwIfUndefinedOrNull("insight Inference",e.Inference),o.default.throwIfUndefinedOrNull("insight Inference observations",e.Inference.Observations),o.default.throwIfUndefinedOrNull("insight Suggestion",e.Suggestion),o.default.throwIfUndefinedOrEmptyString("insight Inference Text",e.Inference.Text),o.default.throwIfUndefinedOrEmptyString("insight Suggestion Text",e.Suggestion.Text)
var t,n=null,r=null
return i.default.checkObservationExists(e.Inference.Observations,"OutOfOfficeTimeRange")&&(n=(t=i.default.convertObservation(e.Inference.Observations,"OutOfOfficeTimeRange")).StartDateTime?new Date(t.StartDateTime):null,r=t.EndDateTime?new Date(t.EndDateTime):null),{insightText:e.Inference.Text,actionText:e.Suggestion.Text,startTime:n,endTime:r,identifier:a.ExternalContextUtils_V2.getInsightIdentifier(e)}},u)
function u(){}t.DetectOOFComposingInfobarConverter_V2=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(515),s=(i=a.WESRecordRequest,r.__extends(u,i),Object.defineProperty(u.prototype,"suggestionAction",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.action=function(){return{Name:this.suggestionAction().Name}},r.__decorate([o.doop],u.prototype,"suggestionAction",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailInfobarInsightConverter=void 0
var r,o=n(0),i=n(205),a=o.__importDefault(n(888)),s=n(67),u=(r=s.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){switch(e.version){case i.InsightVersion.v2:return a.default.convertToRuntimeInsight(e.value)
default:throw new Error("Invalid TrackEmail insight version: ["+e.version+"]")}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.TrackEmailInfobarInsightConverter=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailConverter_V2=void 0
var r=n(0),a=r.__importDefault(n(39)),s=r.__importStar(n(52)),u=n(119),o=(i.prototype.convertToRuntimeInsight=function(e){var t=this
a.default.throwIfUndefinedOrNull("insight",e),a.default.throwIfUndefinedOrNull("insight inference",e.Inference),a.default.throwIfUndefinedOrNull("insight suggestion",e.Suggestion),a.default.throwIfUndefinedOrNull("insight suggestionAction",e.Suggestion.SuggestedActions),a.default.throwIfUndefinedOrNull("insight inference observations",e.Inference.Observations)
var n=s.default.convertSuggestedActions(e.Suggestion.SuggestedActions,s.TRACK_EMAIL_ACTION_NAME)
a.default.throwIfNotExactlyOneElement("suggestedActions",n)
var r,o={Name:n[0].Name},i=!1
return 0<e.Inference.Observations.length&&(r=e.Inference.Observations.filter(function(e){return e.Name===t.EXTENDED_STATS_ELIGIBILITY_OBSERVATION_NAME}),a.default.throwIfNotExactlyOneElement("extendedStatsEligibilityObservation",r),i=r[0].Value),{insightId:e.Id,insightText:e.Inference.Text,actionText:e.Suggestion.Text,suggestionText:e.Suggestion.ReasonText,suggestionAction:o,identifier:u.ExternalContextUtils_V2.getInsightIdentifier(e),isEligibleForExtendedStatistics:i}},i)
function i(){this.EXTENDED_STATS_ELIGIBILITY_OBSERVATION_NAME="IsEligibleForExtendedStatistics"}t.TrackEmailConverter_V2=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importDefault(n(890)),s=r.__importDefault(n(893)),u=(l.prototype.extractAndDispatch=function(e,t){var n=a.default.convertToRunTimeInstanceData(e)
s.default.dispatchToDoInsights(n.commitments,n.requests,n.identifier),s.default.dispatchFollowUpInsights(n.followUps,n.identifier),i.default.dispatch({actionType:o.default.PeopleCatchUpItemsInsightInfobar,insight:n,requestTimeInTicks:t})},l)
function l(){}t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleCatchUpItemsInfobarConverter=void 0
var r,o=n(0),i=n(205),a=n(67),s=o.__importDefault(n(891)),u=(r=a.ExternalInsightConverter,o.__extends(l,r),l.prototype.convertToRuntimeType=function(e){switch(e.version){case i.InsightVersion.v2:return s.default.convertToRuntimeInsight(e.value)
default:throw new Error("Invalid people catch up items insight version: ["+e.version+"]")}},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.PeopleCatchUpItemsInfobarConverter=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleCatchUpItemsInfobarConverter_V2=void 0
var a=n(0),s=a.__importDefault(n(39)),u=n(119),l=a.__importDefault(n(892)),r=(o.prototype.convertToRuntimeInsight=function(e){var t=e.Inference.Observations[0].Value.ToDos,n=e.Inference.Observations[0].Value.FollowUps,r=a.__spreadArrays(t||[],n||[])
s.default.throwIfNullOrEmptyArray("tasks",r),s.default.throwIfNullOrEmptyArray("requester",r[0].Requesters)
var o={name:r[0].Requesters[0].DisplayName,smtpAddress:r[0].Requesters[0].MailAddress},i=l.default.convertToInsight(r,o)
return i.identifier=u.ExternalContextUtils_V2.getInsightIdentifier(e),i.insightId=e.Id,i.insightText=e.Inference.Text,i},o)
function o(){}t.PeopleCatchUpItemsInfobarConverter_V2=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(39)),i=r.__importDefault(n(35)),a=n(66),s=n(518),u=(l.convertToInsight=function(e,t){var n=this
return o.default.throwIfNullOrEmptyArray("tasks",e),{commitments:e.filter(function(e){return e.ActionType===s.TODO_COMMITMENT}).map(function(e){return n.convertToCoreToDoType(e)}),requests:e.filter(function(e){return e.ActionType===s.TODO_REQUEST}).map(function(e){return n.convertToCoreToDoType(e)}),followUps:e.filter(function(e){return e.ActionType===s.FOLLOW_UP_ACTION_REQUEST||e.ActionType===s.FOLLOW_UP_REPLY_REQUEST}).map(function(e){return n.convertToCoreFollowUpType(e)}),targetPerson:t}},l.validateTasks=function(e){o.default.throwIfUndefinedOrEmptyString("ActionType",e.ActionType),o.default.throwIfUndefinedOrNull("Confidence",e.Confidence),o.default.throwIfUndefinedOrEmptyString("Description",e.Description),o.default.throwIfUndefinedOrNull("NumberOfRecipientsOnToLine",e.NumberOfRecipientsOnToLine),o.default.throwIfUndefinedOrEmptyString("SourceMailId",e.SourceMailId),o.default.throwIfUndefinedOrInvalidDate("SourceReceivedDateTime",new Date(e.SourceReceivedDateTime)),o.default.throwIfUndefinedOrEmptyString("ToDoEntityId",e.ToDoEntityId),o.default.throwIfNullOrEmptyArray("Requester",e.Requesters)},l.convertToCoreToDoType=function(e){return this.validateTasks(e),{toDoType:this.convertToTaskType(e.ActionType),entity:this.convertToEntity(e),sourceItem:this.convertToSourceItem(e),numberOfPeopleOnToLine:e.NumberOfRecipientsOnToLine,targetPerson:this.convertToTargetPerson(e.Requesters),taskId:e.TaskId}},l.convertToCoreFollowUpType=function(e){return this.validateTasks(e),{followUpType:this.convertToTaskType(e.ActionType),entity:this.convertToEntity(e),sourceItem:this.convertToSourceItem(e),numberOfPeopleOnToLine:e.NumberOfRecipientsOnToLine,targetPerson:this.convertToTargetPerson(e.Requesters),duplicateEntityIds:[],conversationId:e.SourceConversationId,taskId:e.TaskId}},l.convertToSourceItem=function(e){return{itemId:{id:i.default.convertToEwsId(e.SourceMailId)},dateTimeSent:new Date(e.SourceReceivedDateTime),subject:e.SourceMailSubject}},l.convertToEntity=function(e){return{entityId:e.ToDoEntityId,description:e.Description,confidenceScore:e.Confidence}},l.convertToTargetPerson=function(e){return{name:e[0].DisplayName,smtpAddress:e[0].MailAddress.toLowerCase()}},l.convertToTaskType=function(e){switch(e){case s.TODO_COMMITMENT:return a.ToDoType.Commitment
case s.TODO_REQUEST:return a.ToDoType.Request
case s.FOLLOW_UP_ACTION_REQUEST:return a.FollowUpType.ActionFollowUp
case s.FOLLOW_UP_REPLY_REQUEST:return a.FollowUpType.ReplyFollowUp
default:throw Error("Invalid task actionType: "+e)}},l)
function l(){}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(3)),i=r.__importDefault(n(11)),a=r.__importDefault(n(8)),s=r.__importDefault(n(290)),u=r.__importDefault(n(291)),l=(c.dispatchToDoInsights=function(e,t,n){var r=e.concat(t).map(function(e){return e.identifier=n,s.default.convertToDoToTaskInstance(e)})
i.default.dispatch({actionType:o.default.TasksInsightAction,insights:r,requestTimeInTicks:Date.now()})},c.dispatchFollowUpInsights=function(e,t){var n
a.default.isFollowUpsTaskSuggestionMigrationEnabled?(n=e.map(function(e){return e.identifier=t,u.default.convertFollowUpToTaskInstance(e)}),i.default.dispatch({actionType:o.default.FollowUpsInsight,insights:n,requestTimeInTicks:Date.now()})):i.default.dispatch({actionType:o.default.UpsertExtractedFollowUpRequestTasks,entities:e.map(function(e){return e}),completedEntityIds:[]})},c)
function c(){}t.default=l},,,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryRequestSkipper=void 0
var r=n(0),o=r.__importDefault(n(25)),i=r.__importDefault(n(176)),a=(s.prototype.shouldSkipRequest=function(){if(!o.default.isInBackgroundMode)return!0
var e=i.default.getState().scheduledDelayDeliveryDateTime()
return e&&e.getTime()>Date.now()},s)
function s(){}t.DelayDeliveryRequestSkipper=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingComposeContextBuilder=void 0
var a=n(0),i=a.__importDefault(n(3)),s=a.__importDefault(n(11)),u=a.__importDefault(n(8)),l=n(288),c=a.__importDefault(n(37)),d=a.__importDefault(n(93)),p=a.__importDefault(n(89)),r=(f.buildContextAndChanges=function(o){return a.__awaiter(this,void 0,void 0,function(){var t,n,r
return a.__generator(this,function(e){switch(e.label){case 0:return[4,f.retrieveProperties()]
case 1:return t=e.sent(),n=d.default.getState().lastKnownMeetingProperties(),(r=o.hasMeaningfulChange(t,n))&&s.default.dispatch({actionType:i.default.UpdateLastKnownMeetingProperties,properties:t}),[2,{contextProvider:t?new l.MeetingComposeContext(t):null,hasMeaningfullyChanged:r}]}})})},f.retrieveProperties=function(){return a.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return a.__generator(this,function(e){switch(e.label){case 0:return t=null!==c.default.getState().meetingStartTime()&&null!==c.default.getState().meetingEndTime(),r=!(n=!0),o=[],u.default.isMeetingPreparationInfobarEnabled&&(n=c.default.getState().isNewComposeMeeting(),r=!!c.default.getState().recurrence(),o=c.default.getState().attachments()),u.default.areMeetingInfobarsEnabledForEditMode&&(n=c.default.getState().isNewComposeMeeting()),t?[4,p.default.getComposingItemSubject()]:[3,2]
case 1:return i=e.sent(),[2,{start:c.default.getState().meetingStartTime(),end:c.default.getState().meetingEndTime(),meetingSubject:i,requiredAttendees:c.default.getState().requiredAttendees(),optionalAttendees:c.default.getState().optionalAttendees(),isNewComposeMeeting:n,isRecurring:r,attachments:o}]
case 2:return[2]}})})},f)
function f(){}t.MeetingComposeContextBuilder=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.EmailComposeContextBuilder=void 0
var u=n(0),r=u.__importDefault(n(389)),l=u.__importDefault(n(4)),c=u.__importDefault(n(3)),d=u.__importDefault(n(25)),o=n(7),p=u.__importDefault(n(24)),f=u.__importDefault(n(11)),i=u.__importDefault(n(8)),a=u.__importDefault(n(57)),s=u.__importDefault(n(6)),g=n(288),m=u.__importDefault(n(37)),h=u.__importDefault(n(176)),y=u.__importDefault(n(93)),_=u.__importDefault(n(149)),S=n(902),T=u.__importDefault(n(903)),I=u.__importDefault(n(904)),b=u.__importDefault(n(89)),E=u.__importDefault(n(62)),v=(A.buildContextAndChange=function(o){return u.__awaiter(this,void 0,void 0,function(){var t,n,r
return u.__generator(this,function(e){switch(e.label){case 0:return[4,A.retrieveProperties()]
case 1:return t=e.sent(),n=y.default.getState().lastKnownEmailProperties(),(r=o.hasMeaningfulChange(t,n))&&f.default.dispatch({actionType:c.default.UpdateLastKnownEmailProperties,properties:t}),[2,{contextProvider:t?new g.EmailComposeContext(t):null,hasMeaningfullyChanged:r}]}})})},A.retrieveProperties=function(){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a,s
return u.__generator(this,function(e){switch(e.label){case 0:return null!=m.default.getState().isInConversation()?[3,2]:[4,b.default.updateEmailPropertiesFromConversation()]
case 1:e.sent(),e.label=2
case 2:return m.default.getState().messageComposeType()?[3,4]:[4,b.default.getMessageComposeType()]
case 3:e.sent(),e.label=4
case 4:return E.default.isFlightEnabled(E.default.EMAIL_COMPOSE_TYPE_LOGGING)&&!y.default.getState().hasLoggedMessageComposeType()&&(l.default.logInformation("Session compose type fetched: "+m.default.getState().messageComposeType(),this.LOG_FEATURE_NAME,"retrieveProperties"),f.default.dispatch({actionType:c.default.SetHasLoggedComposeMessageType,logged:!0})),[4,b.default.getComposingItemSubject()]
case 5:return t=e.sent(),n=m.default.getState().toRecipientsInUserType(),r=A.getRecipientCount(),o=A.getToRecipientCount(),i=_.default.shouldEstimateToRecipients(),[4,A.isCandidateForInsightCompute(t,r,o,n,i)]
case 6:return e.sent()?(a=m.default.getState().internetMessageId(),s=h.default.getState().scheduledDelayDeliveryDateTime(),[2,{encodedImid:a?window.btoa(a):null,toRecipients:n,estimatedToRecipients:i?m.default.getState().estimatedToRecipients():[],recipientCount:r,toRecipientCount:o,subject:t,isMessageReply:m.default.getState().isInConversation(),checkMinimumEligibility:!d.default.isInBackgroundMode,composeTimeSpan:p.default.getTimeSpanStringFromMilliSeconds(A.getComposeTimeSpanInMilliSecs()),scheduledDelayDeliveryDateTime:null!=s?s:new Date(0)}]):[2]}})})},A.getComposeTimeSpanInMilliSecs=function(){var e=Date.now()-a.default.sessionStartTime,t=e-e%(30*o.Constants.oneSecondInMilliseconds)
return t>I.default.MINIMUM_SECONDS_TO_TRACK*o.Constants.oneSecondInMilliseconds&&(t=I.default.MINIMUM_SECONDS_TO_TRACK*o.Constants.oneSecondInMilliseconds),t},A.isCandidateForInsightCompute=function(r,o,i,a,s){return u.__awaiter(this,void 0,void 0,function(){var t,n
return u.__generator(this,function(e){switch(e.label){case 0:return t=s?m.default.getState().estimatedToRecipients():a,(n=A.isDelayDeliveryInfobarEligible(t,i)||A.isPeopleCatchUpItemsInsightEligible(o,a))?[3,2]:[4,A.isTrackEmailInsightEligible(o)]
case 1:n=e.sent(),e.label=2
case 2:return[2,n||A.isDetectOOFComposingInfobarEligible(r)]}})})},A.isDelayDeliveryInfobarEligible=function(e,t){var n=e.length
return!(15<n||0===n&&0===t||!e.some(function(e){return e.emailAddress!==s.default.userEmailLowerCase}))&&i.default.hasDelayDeliveryPrerequisites},A.isDetectOOFComposingInfobarEligible=function(e){if(i.default.isDetectOOFComposingInfobarEnabled&&!m.default.getState().isInConversation()){var t=e.toLowerCase()
if(i.default.isMultilingualOOFComposingInfobarEnabled)try{return S.OOF_MULTILINGUAL_TRIE.search(t)}catch(e){l.default.logAssert("TrieSearchError",this.LOG_FEATURE_NAME,"NgramUtilsSearchError")}else if(s.default.isDisplayLanguageEnglish)return S.EN_OOF_PHRASES.some(function(e){return-1!==t.indexOf(e)})}return!1},A.isTrackEmailInsightEligible=function(t){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(e){switch(e.label){case 0:return[4,I.default.isTrackEmailInsightEligible(t,a.default.sessionStartTime,m.default.getState().isInConversation())]
case 1:return[2,e.sent()]}})})},A.isPeopleCatchUpItemsInsightEligible=function(e,t){return T.default.isPeopleCatchUpItemsInsightEligible(t,e,a.default.sessionStartTime)},A.getRecipientCount=function(){var e=u.__spreadArrays(m.default.getState().toRecipients(),m.default.getState().ccRecipients(),m.default.getState().bccRecipients()),t=r.default(e,"emailAddress")
return s.default.sumElementsInArray(t,function(e){return e.totalMemberCount})},A.getToRecipientCount=function(){return s.default.sumElementsInArray(m.default.getState().toRecipients(),function(e){return e.totalMemberCount})},A.LOG_FEATURE_NAME="EmailComposeContextBuilder",A)
function A(){}t.EmailComposeContextBuilder=v},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.OOF_MULTILINGUAL_TRIE=t.EN_OOF_PHRASES=void 0
t.EN_OOF_PHRASES=["will be","be back","ooo","oof","off","leav","out","office","trip","travel","delay","back to","back on","vacation","until","away","return","doctor","dentist","sick","personal","family","appt","home","rest","absen"]
var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
if(2===e.length)return this.key=e[0],this.parent=e[1],this.isEnd=!1,void(this.children={});((this.parent=this).fail=this).isEnd=!1,this.children={}},a=(r.prototype.insert=function(e){for(var t=this.root,n=0,r=e;n<r.length;n++){var o=r[n]
" "!==o&&(t.children[o]||(t.children[o]=new i(o,t)),t=t.children[o])}t.isEnd=!0},r.prototype.search=function(e){for(var t,n,r,o=this.root,i=0,a=e;i<a.length;i++){var s=a[i]
if(-1==="!\"@#$^%&'()*+,-./:;<=>?[\\]_`{|}~ 。，、！·——；：‘’“”？（）……￥".indexOf(s)){for(;!o.children[s]&&o!==this.root;)o=null!==(t=o.fail)&&void 0!==t?t:this.root
for(var u=o=null!==(n=o.children[s])&&void 0!==n?n:this.root;u!==this.root;u=null!==(r=u.fail)&&void 0!==r?r:this.root)if(u.isEnd)return!0}}return o.isEnd},r.prototype.build=function(){var e,t,n,r,o=this.root,i=[]
for(Object.keys(o.children).forEach(function(e){i.push(o.children[e])});0<i.length;){o=null!==(e=i.shift())&&void 0!==e?e:i[0],Object.keys(o.children).forEach(function(e){i.push(o.children[e])})
for(var a=null!==(t=o.parent.fail)&&void 0!==t?t:this.root;!a.children[o.key]&&a!==this.root;)a=null!==(n=a.fail)&&void 0!==n?n:this.root
o.fail=null!==(r=a.children[o.key])&&void 0!==r?r:this.root,o.fail===o&&(o.fail=this.root)}},r)
function r(){this.root=new i}t.OOF_MULTILINGUAL_TRIE=function(e){var t=new a
try{for(var n=0,r=e;n<r.length;n++){var o=r[n]
t.insert(o)}t.build()}catch(e){}return t}([].concat(t.EN_OOF_PHRASES,["forado","sairdo","férias","contato","estareifora","estiverfora","sairei","viaja","vousair","saio","compromisso","viaj","salir","laoficina","deja","devacaciones","decontacto","ausencia","horario","saldré","iré","volver","voy","fuera","bureau","fériés","partez","départ","congé","voyage","déplacer","quitter","programmés","prévois","serai","revien","être","fuori","vacanz","contatto","parti","viagg","tornerò","sarò","menevado","lasc","appuntamento","vado","休","離","退","出","不在です","オフィスにいない","ります","にいなかったので","buitenkantoor","uithetkantoor","vakantie","afspraak","komtterug","afwezigheid","thuis","reisnaar","ikzal","ikga","urlaub","ferien","reise","verlasse","büro","amt","nichtim","tagfrei","ausserhaus","ausderstadt","draußen","wirdnehmen","abwesenheit","zurück","офис","извън","напочивка","ваканци","контакт","празници","вън","среща","почивка","извън","пътува","вънот","върнав","изляза","बाहर","अवकाश","छुट्टी","संपर्कजानकारी","आउट","छोड़ना","यात्रा","जाएगा","नियुक्ति","मैंकल","जारहाहूं","कार्यालयसेबाहर","внеофиса","каникулы","отпуск","ясобираюсь","вернусь","праздник","город","назначен","будет","буду","путешествовать","выход","дома","вернуться","покинуть","уезжаю","остави","前往","办公室","离开","休","假","出差","预约","旅行","联系","生病","医院","个人","私事"]))},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=r.__importDefault(n(382)),i=r.__importDefault(n(8)),a=r.__importDefault(n(6)),s=(u.isPeopleCatchUpItemsInsightEligible=function(e,t,n){if(!i.default.isPeopleCatchUpItemsInfobarEnabled)return!1
var r=o.default.getTimeElapsedInSeconds(n)
return 1===e.length&&e.every(function(e){return e.emailAddress!==a.default.userEmailLowerCase})&&1===t&&r>=this.MINIMUM_SECONDS_THRESHOLD},u.MINIMUM_SECONDS_THRESHOLD=10,u)
function u(){}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailUtils=void 0
var a=n(0),s=a.__importDefault(n(25)),u=a.__importDefault(n(54)),l=n(7),c=a.__importDefault(n(382)),r=(o.prototype.isTrackEmailInsightEligible=function(r,o,i){return a.__awaiter(this,void 0,void 0,function(){var n=this
return a.__generator(this,function(e){return u.default.doesSupportInternetHeaders?[2,new Promise(function(t){Office.context.mailbox.item.internetHeaders.getAsync([l.Constants.trackEmailHeaderKey],function(e){null===e.value?t(!0):t(!1)})}).then(function(e){if(e){if(s.default.isInBackgroundMode){var t=c.default.getTimeElapsedInSeconds(o)
return r>=n.MINIMUM_RECIPIENT_COUNT&&!i&&t>=n.MINIMUM_SECONDS_TO_TRACK}return r>=n.MINIMUM_ELIGIBILITY_RECIPIENT_COUNT}return!1})]:[2,!1]})})},o)
function o(){this.MINIMUM_SECONDS_TO_TRACK=60,this.MINIMUM_RECIPIENT_COUNT=10,this.MINIMUM_ELIGIBILITY_RECIPIENT_COUNT=5}t.TrackEmailUtils=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMeetingContextComparer=void 0
var r,o=n(0),i=o.__importDefault(n(239)),a=o.__importDefault(n(150)),s=n(151),u=(r=s.SearchContextComparerBase,o.__extends(l,r),Object.defineProperty(l.prototype,"logSourceName",{get:function(){return"DefaultMeetingContextComparer"},enumerable:!1,configurable:!0}),l.prototype.hasInterestingChange=function(e,t){return e.isRecurring!==t.isRecurring||e.meetingSubject!==t.meetingSubject||e.start.getTime()!==t.start.getTime()||e.end.getTime()!==t.end.getTime()||!a.default(i.default(e.requiredAttendees.map(function(e){return e.emailAddress}),t.requiredAttendees.map(function(e){return e.emailAddress})))||!a.default(i.default(e.optionalAttendees.map(function(e){return e.emailAddress}),t.optionalAttendees.map(function(e){return e.emailAddress})))||!a.default(i.default(e.attachments.map(function(e){return e.id}),t.attachments.map(function(e){return e.id})))},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DefaultMeetingContextComparer=u},,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEmailContextComparer=void 0
var r,o=n(0),i=o.__importDefault(n(239)),a=o.__importDefault(n(150)),s=n(151),u=(r=s.SearchContextComparerBase,o.__extends(l,r),Object.defineProperty(l.prototype,"logSourceName",{get:function(){return"DefaultEmailContextComparer"},enumerable:!1,configurable:!0}),l.prototype.hasInterestingChange=function(e,t){return e.encodedImid!==t.encodedImid||e.subject!==t.subject||e.toRecipientCount!==t.toRecipientCount||e.recipientCount!==t.recipientCount||e.isMessageReply!==t.isMessageReply||e.composeTimeSpan!==t.composeTimeSpan||e.scheduledDelayDeliveryDateTime.getTime()!==t.scheduledDelayDeliveryDateTime.getTime()||!a.default(i.default(e.toRecipients.map(function(e){return e.emailAddress}),t.toRecipients.map(function(e){return e.emailAddress})))},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DefaultEmailContextComparer=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryEmailContextComparer=void 0
var r,o=n(0),i=o.__importDefault(n(239)),a=o.__importDefault(n(150)),s=n(151),u=(r=s.SearchContextComparerBase,o.__extends(l,r),Object.defineProperty(l.prototype,"logSourceName",{get:function(){return"DelayDeliveryEmailContextComparer"},enumerable:!1,configurable:!0}),l.prototype.hasInterestingChange=function(e,t){return e.scheduledDelayDeliveryDateTime.getTime()!==t.scheduledDelayDeliveryDateTime.getTime()||e.isMessageReply!==t.isMessageReply||e.toRecipientCount!==t.toRecipientCount||!a.default(i.default(e.toRecipients.map(function(e){return e.emailAddress}),t.toRecipients.map(function(e){return e.emailAddress})))},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DelayDeliveryEmailContextComparer=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFEmailContextComparer=void 0
var r,o=n(0),i=n(151),a=(r=i.SearchContextComparerBase,o.__extends(s,r),Object.defineProperty(s.prototype,"logSourceName",{get:function(){return"DetectOOFEmailComparer"},enumerable:!1,configurable:!0}),s.prototype.hasInterestingChange=function(e,t){return e.subject!==t.subject},s)
function s(){return null!==r&&r.apply(this,arguments)||this}t.DetectOOFEmailContextComparer=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleCatchUpEmailContextComparer=void 0
var r,o=n(0),i=o.__importDefault(n(239)),a=o.__importDefault(n(150)),s=n(151),u=(r=s.SearchContextComparerBase,o.__extends(l,r),Object.defineProperty(l.prototype,"logSourceName",{get:function(){return"PeopleCatchUpEmailComparer"},enumerable:!1,configurable:!0}),l.prototype.hasInterestingChange=function(e,t){return e.recipientCount!==t.recipientCount||!a.default(i.default(e.toRecipients.map(function(e){return e.emailAddress}),t.toRecipients.map(function(e){return e.emailAddress})))},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.PeopleCatchUpEmailContextComparer=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailContextComparer=void 0
var r,o=n(0),i=n(151),a=(r=i.SearchContextComparerBase,o.__extends(s,r),Object.defineProperty(s.prototype,"logSourceName",{get:function(){return"TrackEmailSearchContextComparer"},enumerable:!1,configurable:!0}),s.prototype.hasInterestingChange=function(e,t){return e.recipientCount!==t.recipientCount},s)
function s(){return null!==r&&r.apply(this,arguments)||this}t.TrackEmailContextComparer=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFMeetingContextComparer=void 0
var r,o=n(0),i=n(151),a=(r=i.SearchContextComparerBase,o.__extends(s,r),Object.defineProperty(s.prototype,"logSourceName",{get:function(){return"DetectOOFMeetingComparer"},enumerable:!1,configurable:!0}),s.prototype.hasInterestingChange=function(e,t){return e.meetingSubject!==t.meetingSubject||e.start.getTime()!==t.start.getTime()||e.end.getTime()!==t.end.getTime()},s)
function s(){return null!==r&&r.apply(this,arguments)||this}t.DetectOOFMeetingContextComparer=a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleCatchUpMeetingContextComparer=void 0
var r,o=n(0),i=o.__importDefault(n(239)),a=o.__importDefault(n(150)),s=n(151),u=(r=s.SearchContextComparerBase,o.__extends(l,r),Object.defineProperty(l.prototype,"logSourceName",{get:function(){return"PeopleCatchUpMeetingComparer"},enumerable:!1,configurable:!0}),l.prototype.hasInterestingChange=function(e,t){return!a.default(i.default(e.requiredAttendees.map(function(e){return e.emailAddress}),t.requiredAttendees.map(function(e){return e.emailAddress})))||!a.default(i.default(e.optionalAttendees.map(function(e){return e.emailAddress}),t.optionalAttendees.map(function(e){return e.emailAddress})))},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.PeopleCatchUpMeetingContextComparer=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleSuggestionsActionCreator=void 0
var u=n(0),i=u.__importStar(n(115)),o=u.__importDefault(n(3)),r=u.__importDefault(n(8)),a=u.__importDefault(n(11)),s=u.__importDefault(n(35)),l=u.__importDefault(n(915)),c=u.__importDefault(n(240)),d=u.__importDefault(n(118)),p=u.__importStar(n(4)),f=n(51),g=n(7),m=n(16),h=(Object.defineProperty(y.prototype,"MAX_PEOPLE_FOR_DEFAULT_SEARCHFOLDER",{get:function(){return 5},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"FeatureName",{get:function(){return"ImportantPeople"},enumerable:!1,configurable:!0}),y.prototype.getRelevantPeople=function(){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(e){switch(e.label){case 0:return r.default.isPinUserEnabled?[4,this.getPeopleSuggestionsFromWES()]:[2]
case 1:return e.sent(),[2]}})})},y.prototype.getPeopleSuggestionsFromWES=function(){return u.__awaiter(this,void 0,void 0,function(){var t
return u.__generator(this,function(e){return t=new l.default(m.HTTPRequestMethod.GET,this.FeatureName,"getRelevantPeopleWES",p.LogRequestType.Interval),[2,this.getAndDispatchPeopleSuggestions(s.default.executeWESRequest(t),this.processFindPeopleWESResponse.bind(this))]})})},y.prototype.getAndDispatchPeopleSuggestions=function(a,s){return u.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i
return u.__generator(this,function(e){switch(e.label){case 0:return t=c.default.getImportantPeople(!1),[4,Promise.all([t,a])]
case 1:return n=e.sent(),r=n[0],o=n[1],r.status===Office.AsyncResultStatus.Succeeded&&o.status===Office.AsyncResultStatus.Succeeded?(i=s(o),this.createAndDispatchImportantPeople(i,r)):p.default.logAssert("Failed to get people suggestions, check PinUser and GetRelevantPeople requests log",this.FeatureName,"getAndDispatchRelevantPeople"),[2]}})})},y.prototype.processFindPeopleWESResponse=function(e){return s.default.processODataResultWithSafeCallback(e,this.parseWESFindRelevantPeopleResponse.bind(this))},y.prototype.getRelevantPeopleForDefaultSearchFolder=function(e,t){var n,r,o=[]
return 0<e.length&&t.useRelevantPeopleForSearchFolder&&(n=d.default.getState().sortedVIPs(),r=this.getUsersToPin(e,n),c.default.pinUsers(r),o=n.concat(r).sort(i.comparePeopleByEmailAddress),p.default.logInformation("Pre-pin default relevant people for users and create default search folder",this.FeatureName,"getRelevantPeople")),o},y.prototype.markUserPinned=function(e){a.default.dispatch({actionType:o.default.MarkUserPinned,user:e})},y.prototype.markUserUnpinned=function(e){a.default.dispatch({actionType:o.default.MarkUserUnpinned,user:e})},y.prototype.createAndDispatchImportantPeople=function(e,t){var n,r
e.isSuccess&&((n=e.result.filter(function(e){return!!e.smtpAddress}).sort(i.comparePeopleByRelevanceRank)).forEach(function(e){return e.smtpAddress=e.smtpAddress.toLowerCase()}),0===n.length&&p.default.logInformation("Got 0 relevant people for the user",this.FeatureName,"createAndDispatchImportantPeople"),r=this.getRelevantPeopleForDefaultSearchFolder(n,t),a.default.dispatch({actionType:o.default.PeopleSuggestions,relevantPeople:n,relevantPeopleForDefaultSearchFolder:r}))},y.prototype.getUsersToPin=function(e,n){var t=e.slice(0,this.MAX_PEOPLE_FOR_DEFAULT_SEARCHFOLDER)
return 0<n.length&&(t=t.filter(function(t){return!n.some(function(e){return e.smtpAddress.toLowerCase()===t.smtpAddress.toLowerCase()})}).slice(0,this.MAX_PEOPLE_FOR_DEFAULT_SEARCHFOLDER-n.length)),t},u.__decorate([f.expirable(f.ExpirationTypes.ByEvery_Minutes,g.Constants.oneDayInMinutes)],y.prototype,"getRelevantPeople",null),y=u.__decorate([f.expirable()],y))
function y(){this.parseWESFindRelevantPeopleResponse=function(e){var t=1
return e.result.value.map(function(e){return{name:e.Contact.DisplayName||e.Contact.PrimarySmtpAddress,relevanceRank:t++,smtpAddress:e.Contact.PrimarySmtpAddress.toLowerCase()}})}}t.PeopleSuggestionsActionCreator=h,t.default=new h},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(38),s=(i=a.WESRequestBase,r.__extends(u,i),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/importantcontacts"},enumerable:!1,configurable:!0}),u.prototype.getFilterCriteria=function(){return"OfType('Person')"},u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(38),s=(i=a.WESRequestBase,r.__extends(u,i),Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/pinnedcontacts"},enumerable:!1,configurable:!0}),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(391),s=(r=a.UnreadSearchFolderRequestBase,o.__extends(u,r),u.prototype.getSOAPRequest=function(){return'<m:CreateFolder>\n                <m:ParentFolderId>\n                    <t:DistinguishedFolderId Id="'+this.parentDistinguishedFolderId()+'"/>\n                </m:ParentFolderId>\n                <m:Folders>\n                    <t:SearchFolder>\n                        <t:DisplayName>'+this.displayFolderName()+"</t:DisplayName>\n                        "+this.buildSearchParameters()+"\n                    </t:SearchFolder>\n                </m:Folders>\n            </m:CreateFolder>"},u.prototype.buildRestriction=function(){return"<t:Or>\n                "+this.buildVIPListRestriction()+"\n            </t:Or>"},u.prototype.buildVIPListRestriction=function(){return this.vipEmailAddressList().map(function(e){return'<t:IsEqualTo>\n                            <t:FieldURI FieldURI="message:From"></t:FieldURI>\n                            <t:FieldURIOrConstant>\n                                    <t:Constant Value="'+e+'"></t:Constant>\n                            </t:FieldURIOrConstant>\n                        </t:IsEqualTo>'}).join(" ")},u.prototype.toTraceString=function(){return"CreateUnreadFromVIPSearchFolderRequest"},u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=o.__importDefault(n(174)),a=n(5),s=n(391),u=(r=s.UnreadSearchFolderRequestBase,o.__extends(l,r),l.prototype.getSOAPRequest=function(){return'<m:CreateFolder>\n                <m:ParentFolderId>\n                    <t:DistinguishedFolderId Id="'+this.parentDistinguishedFolderId()+'"/>\n                </m:ParentFolderId>\n                <m:Folders>\n                    <t:SearchFolder>\n                        <t:DisplayName>'+this.displayFolderName()+"</t:DisplayName>\n                        "+this.buildSearchParameters()+"\n                    </t:SearchFolder>\n                </m:Folders>\n            </m:CreateFolder>"},l.prototype.buildRestriction=function(){return'<t:Contains ContainmentMode="Substring" ContainmentComparison="IgnoreCase">\n                    '+i.default.IRANKER_SCORE.buildXMLString()+'\n                    <t:Constant Value="&quot;IsImportantByIRanker&quot;: &quot;True&quot;"></t:Constant>\n                </t:Contains>'},l.prototype.toTraceString=function(){return"CreateUnreadFromIRankerSearchFolderRequest"},l=o.__decorate([a.doop],l))
function l(){return null!==r&&r.apply(this,arguments)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(84),s=(r=a.EWSRequestBase,o.__extends(u,r),u.prototype.getSOAPRequest=function(){return'<m:GetFolder>\n                <m:FolderShape>\n                    <t:BaseShape>IdOnly</t:BaseShape>\n                </m:FolderShape>\n                <m:FolderIds>\n                    <t:DistinguishedFolderId Id="deleteditems" />\n                </m:FolderIds>\n            </m:GetFolder>'},u.prototype.toTraceString=function(){return"GetDeletedItemsFolderIdRequest"},u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=n(5),a=n(391),s=(r=a.UnreadSearchFolderRequestBase,o.__extends(u,r),Object.defineProperty(u.prototype,"folderId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),u.prototype.getSOAPRequest=function(){return'<m:UpdateFolder>\n              <m:FolderChanges>\n                <t:FolderChange>\n                <t:FolderId Id="'+this.folderId().id+'" ChangeKey="'+this.folderId().changeKey+'"/>\n                  <t:Updates>\n                    <t:SetFolderField>\n                      <t:FieldURI FieldURI="folder:SearchParameters" />\n                      <t:SearchFolder>\n                        '+this.buildSearchParameters()+"\n                      </t:SearchFolder>\n                    </t:SetFolderField>\n                  </t:Updates>\n               </t:FolderChange>\n             </m:FolderChanges>\n           </m:UpdateFolder>"},u.prototype.buildRestriction=function(){return"<t:Or>\n                "+this.buildVIPListRestriction()+"\n            </t:Or>"},u.prototype.buildVIPListRestriction=function(){return this.vipEmailAddressList().map(function(e){return'<t:IsEqualTo>\n                            <t:FieldURI FieldURI="message:From"></t:FieldURI>\n                            <t:FieldURIOrConstant>\n                                    <t:Constant Value="'+e+'"></t:Constant>\n                            </t:FieldURIOrConstant>\n                        </t:IsEqualTo>'}).join(" ")},u.prototype.toTraceString=function(){return"UpdateUnreadFromVIPSearchFolderRequest"},o.__decorate([i.doop],u.prototype,"folderId",null),u=o.__decorate([i.doop],u))
function u(){return null!==r&&r.apply(this,arguments)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UnreadMailActionCreatorREST=void 0
var r,s=n(0),u=s.__importDefault(n(35)),o=s.__importStar(n(6)),l=s.__importDefault(n(922)),i=s.__importDefault(n(923)),c=n(4),a=n(924),d=n(34),p=(r=a.UnreadMailActionCreatorBase,s.__extends(f,r),f.processUnreadMailResult=function(e){var t=e.result.value
return o.default.sortArrayOnKey(t,function(e){return new Date(e.SentDateTime).getTime()},o.OrderBy.Descending).map(function(e){return{conversationId:e.ConversationId,dateTimeSent:new Date(e.SentDateTime),fromEmailAddress:e.Sender.EmailAddress.Address.toLowerCase(),senderName:e.Sender.EmailAddress.Name||e.Sender.EmailAddress.Address.toLowerCase(),itemId:{changeKey:e.ChangeKey,id:e.Id},subject:e.Subject,bodyPreview:e.BodyPreview}})},f.prototype.requestMarkEmailItemAsRead=function(n){return s.__awaiter(this,void 0,void 0,function(){var t
return s.__generator(this,function(e){switch(e.label){case 0:return t=new i.default(this.LOG_FEATURE_NAME,"MarkItemAsReadREST",c.LogRequestType.Action).itemId(n.itemId.id).isRead(!0),[4,u.default.executeRequest(t,d.RequestPriority.High)]
case 1:return e.sent(),[2]}})})},f.prototype.requestMarkAllEmailItemsFromSenderAsRead=function(r){return s.__awaiter(this,void 0,void 0,function(){var t,n
return s.__generator(this,function(e){switch(e.label){case 0:return t=[],n=new i.default(this.LOG_FEATURE_NAME,"MarkAllItemsAsReadREST",c.LogRequestType.Action).isRead(!0),r.forEach(function(e){t.push(n.itemId(e.itemId.id))}),[4,u.default.executeBatchRequests(t)]
case 1:return e.sent(),[2]}})})},f.prototype.executeFindUnreadMailRequest=function(i,a){return void 0===a&&(a=0),s.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return s.__generator(this,function(e){switch(e.label){case 0:return t="executeFindUnreadMailRequestRESTFor"+i.folderName,n=u.default.convertToRestId(i.folderId.id),r=new l.default(this.LOG_FEATURE_NAME,t,c.LogRequestType.Interval).retryDelayInMilliseconds(a).folderId(n).top(this.MAX_ITEMS_PER_PAGE),[4,u.default.executeRequestWithPaging(r)]
case 1:return(o=e.sent()).status===Office.AsyncResultStatus.Succeeded?[2,f.processUnreadMailResult(o)]:[2,[]]}})})},f)
function f(){var e=null!==r&&r.apply(this,arguments)||this
return e.MAX_ITEMS_PER_PAGE=50,e}t.UnreadMailActionCreatorREST=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=r.__importDefault(n(24)),a=r.__importDefault(n(6)),s=n(5),u=n(16),l=n(63),c=(i=l.RESTRequestBase,r.__extends(d,i),Object.defineProperty(d.prototype,"urlPath",{get:function(){return"me/mailfolders/"+this.folderId()+"/messages"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"folderId",{get:function(){return s.doop()},enumerable:!1,configurable:!0}),d.prototype.getFilterCriteria=function(){return"ReceivedDateTime ge "+o.default.generatePriorDate(7).toISOString()+" AND From/EmailAddress/Address ne '"+a.default.userEmail+"'"},r.__decorate([s.doop],d.prototype,"folderId",null),d=r.__decorate([s.doop],d))
function d(e,t,n,r){var o=i.call(this,u.HTTPRequestMethod.GET,e,t,n,r)||this
return o.selectField(["ReceivedDateTime","ConversationId","Sender","Id","Subject","ChangeKey","SentDateTime","ToRecipients","CcRecipients","BodyPreview"]),o}t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(63),u=(o=s.RESTRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/messages/"+this.itemId()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"itemId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isRead",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{IsRead:this.isRead()}},r.__decorate([i.doop],l.prototype,"itemId",null),r.__decorate([i.doop],l.prototype,"isRead",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UnreadMailActionCreatorBase=void 0
function r(){this.LOG_FEATURE_NAME="UnreadMail"}t.UnreadMailActionCreatorBase=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0)
r.__exportStar(n(275),t),r.__exportStar(n(266),t),r.__exportStar(n(926),t)},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.cache=void 0
var d=n(0)
t.cache=function(l,c){var o=this
return function(e,i,t){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r]
var a=t.value,s=e.constructor.name,u=n
return t.value=function(){return d.__awaiter(o,void 0,void 0,function(){var t,n,r,o
return d.__generator(this,function(e){switch(e.label){case 0:return t=s+":"+i+":"+JSON.stringify(u),[4,l.getItem(t)]
case 1:return(n=e.sent())?[2,n]:(r=a.apply(this,u))&&r.then?[4,r]:[3,3]
case 2:return o=e.sent(),[3,4]
case 3:o=r,e.label=4
case 4:return[4,l.setItem(t,o,c)]
case 5:return e.sent(),[2,o]}})})},t}}},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/pinnedcontacts/unpin"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"unpinContactEmailAddress",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{SmtpAddress:this.unpinContactEmailAddress()}},r.__decorate([i.doop],l.prototype,"unpinContactEmailAddress",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/pinnedcontacts/bulkpin"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"pinContactsEmailAddresses",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{SmtpAddresses:this.pinContactsEmailAddresses()}},r.__decorate([i.doop],l.prototype,"pinContactsEmailAddresses",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/Messages/QualifiedMessages"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailPropsStorageProvider_V1=void 0
var r=n(0),o=r.__importStar(n(116)),i=n(7),a=(s.prototype.loadSentMailPropsFromPermanentStore=function(){return r.__awaiter(this,void 0,void 0,function(){var t,n=this
return r.__generator(this,function(e){switch(e.label){case 0:return[4,o.default.tryLoadFromPersistedStorage(this.SENT_MAIL_PROPS_STORAGE_KEY)]
case 1:return(t=e.sent()).didCatchException||!t.result?[2,[]]:[2,t.result.map(function(e){return n.convertToRuntimeModel(e)}).filter(function(e){return!!e})]}})})},s.prototype.saveSentMailPropsToPermanentStore=function(e){var t=this,n=e.map(function(e){return t.convertToStorageModel(e)}).filter(function(e){return!!e})
o.default.trySaveToPersistedStorage(this.SENT_MAIL_PROPS_STORAGE_KEY,n,i.Constants.oneHourInSeconds)},s.prototype.convertToStorageModel=function(e){return{datetimeSent:e.dateTimeSent.getTime(),internetMsgId:e.internetMsgId,itemId:e.itemId,subject:e.subject,uniqueBodySize:e.uniqueBodySize,senderEmailAddress:e.senderEmailAddress,mailType:e.mailType}},s.prototype.convertToRuntimeModel=function(e){return{dateTimeSent:new Date(e.datetimeSent),internetMsgId:e.internetMsgId,itemId:e.itemId,subject:e.subject,uniqueBodySize:e.uniqueBodySize,recipients:[],senderEmailAddress:e.senderEmailAddress,mailType:e.mailType}},s)
function s(){this.SENT_MAIL_PROPS_STORAGE_KEY=o.PersistedStorageKeys.SentMailsProps_V1_2}t.SentMailPropsStorageProvider_V1=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"base64EncodedImid",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"bodyWordCount",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/messages('"+this.base64EncodedImid()+"')/ComputeMessageStatistics(bodyWordCount="+this.bodyWordCount()+")"},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"base64EncodedImid",null),r.__decorate([i.doop],l.prototype,"bodyWordCount",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=r.__importDefault(n(525)),s=(i=a.default,r.__extends(u,i),Object.defineProperty(u.prototype,"itemId",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.toTraceString=function(){return"FindItemByItemIdRequest"},u.prototype.buildRestrictionElement=function(){return'<m:Restriction> \n                    <t:IsEqualTo>\n                        <t:FieldURI FieldURI="item:ItemId" />\n                        <t:FieldURIOrConstant>\n                            <t:Constant Value="'+this.itemId().id+'"></t:Constant>\n                        </t:FieldURIOrConstant>\n                    </t:IsEqualTo>\n                </m:Restriction> '},r.__decorate([o.doop],u.prototype,"itemId",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"base64EncodedImid",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/messages('"+this.base64EncodedImid()+"')/ComputeDocumentStatistics"},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"base64EncodedImid",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserAvailabilityActionCreator=void 0
var s=n(0),d=s.__importStar(n(29)),u=s.__importDefault(n(3)),l=s.__importDefault(n(8)),c=s.__importDefault(n(24)),p=s.__importDefault(n(11)),f=s.__importDefault(n(240)),g=s.__importDefault(n(4)),m=s.__importDefault(n(504)),o=s.__importDefault(n(6)),h=s.__importDefault(n(68)),y=s.__importDefault(n(202)),_=s.__importDefault(n(201)),S=n(7),r=n(51),i=(a.prototype.getFreeTime=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return t=new Date(Date.now()-2*S.Constants.oneWeek),n=new Date(Date.now()+4*S.Constants.oneWeek),[4,m.default.getUserAvailabilityPromise("FocusTime",[o.default.userEmail],c.default.startOfDay(t),c.default.startOfDay(n),this.getUserAvailabilityFromPromiseResult.bind(this))]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&r.result&&r.result[o.default.userEmail]&&p.default.dispatch({actionType:u.default.GetUserAvailability,userAvailability:r.result[o.default.userEmail]}),[2]}})})},a.prototype.getImportantPeopleAvailability=function(){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i,a
return s.__generator(this,function(e){switch(e.label){case 0:return t=new Date(Date.now()-2*S.Constants.oneWeek),n=new Date(Date.now()+2*S.Constants.oneWeek),l.default.isMeetingSuggestionEnabled?[4,f.default.getImportantPeople()]:[2]
case 1:return(r=e.sent()).status!==Office.AsyncResultStatus.Succeeded?[3,3]:(o=f.default.parseGetPinnedUsersResponse(r),[4,m.default.getUserAvailabilityPromise("MeetingSuggestion",o.map(function(e){return e.smtpAddress}),c.default.startOfDay(t),c.default.startOfDay(n),this.getUserAvailabilityFromPromiseResult.bind(this))])
case 2:i=e.sent(),a={},r.status===Office.AsyncResultStatus.Succeeded&&(Object.keys(i.result).forEach(function(e){i.result[e]&&(a[e]=i.result[e].oofStatus)}),p.default.dispatch({actionType:u.default.GetImportantPeopleAvailability,oofStatusMap:a})),e.label=3
case 3:return[2]}})})},a.prototype.getUserAvailabilityFromPromiseResult=function(e){var t=new Date(Date.now()-2*S.Constants.oneWeek),n=new Date(Date.now()+2*S.Constants.oneWeek),r=e.result,o=h.default.parseMergedFreeBusyArrayFromElement(r),i=e.sourceRequest
if(!o)return g.default.logAssert("GetUserAvailabilityRequest has failed to retrieve availability.","UserAvailabilityActionCreator","GetUserAvailability"),null
var a=y.default.parseFreeBusyIntoTimeSlots(i.startDate(),o,i.mergedGranularityInMinutes()),s=a.filter(function(e){return e.freeBusyStatus===d.BusyStatus.Oof}),u=h.default.parseWorkingHourConfigFromXMLElement(r,i.logCreator().feature),l=d.WorkingHours.DEFAULT_WORKDAY_SCHEDULE
u&&(l=u.workingDays.workingDaysSundayStart)
var c={wasOofLastTwoWeeks:_.default.isOofDuringPeriod(s,t,new Date,l),isOofNextTwoWeeks:_.default.isOofDuringPeriod(s,new Date,n,l)}
return{freeTime:a.filter(function(e){return e.freeBusyStatus===d.BusyStatus.Free}),oofStatus:c}},s.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,5)],a.prototype,"getFreeTime",null),s.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,S.Constants.oneHourInMinutes)],a.prototype,"getImportantPeopleAvailability",null),a=s.__decorate([r.expirable()],a))
function a(){}t.UserAvailabilityActionCreator=i,t.default=new i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/DirectReports"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"externalDirectoryObjectId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/directreports(Id='"+this.externalDirectoryObjectId()+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),r.__decorate([i.doop],l.prototype,"externalDirectoryObjectId",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.DELETE,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"externalDirectoryObjectId",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/directreports(Id='"+this.externalDirectoryObjectId()+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.PUT,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var s=n(0),u=s.__importDefault(n(3)),l=s.__importDefault(n(11)),c=n(4),d=s.__importDefault(n(35)),p=s.__importDefault(n(939)),r=n(51),o=n(7),i=(a.prototype.getMailFolders=function(){var o,i,a
return s.__awaiter(this,void 0,void 0,function(){var t,n,r
return s.__generator(this,function(e){switch(e.label){case 0:return t=new p.default("MailFoldersActionCreator","GetMailFolders",c.LogRequestType.Interval).folder("Inbox").selectField(["DisplayName"]).top(50),[4,d.default.executeRequest(t)]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded&&(r=null!==(a=null===(i=null===(o=n.result)||void 0===o?void 0:o.value)||void 0===i?void 0:i.map(function(e){return e.DisplayName}))&&void 0!==a?a:[],l.default.dispatch({actionType:u.default.GetMailFolders,mailFolders:r})),[2]}})})},s.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,o.Constants.oneDayInMinutes)],a.prototype,"getMailFolders",null),a=s.__decorate([r.expirable()],a))
function a(){}t.default=new i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=r.__importDefault(n(200)),a=n(5),s=n(63),u=n(16),l=(o=s.RESTRequestBase,r.__extends(c,o),Object.defineProperty(c.prototype,"urlPath",{get:function(){return"me/mailfolders/"+this.folder()+"/childfolders"},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"version",{get:function(){return i.default.restVersion2_0},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"folder",{get:function(){return a.doop()},enumerable:!1,configurable:!0}),r.__decorate([a.doop],c.prototype,"folder",null),c=r.__decorate([a.doop],c))
function c(e,t,n,r){return o.call(this,u.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings/LunchTimeSettings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PatchUserLunchTimeSettingsRequestWES=void 0
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings/LunchTimeSettings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"startMinute",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"endMinute",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"shouldBookRecurringAppointment",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"recurringAppointmentIdentifier",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return this.startMinute()&&this.endMinute()?{LunchTime:{StartMinute:this.startMinute(),EndMinute:this.endMinute()},ShouldBookRecurringAppointment:this.shouldBookRecurringAppointment(),RecurringAppointmentId:this.recurringAppointmentIdentifier()}:{ShouldBookRecurringAppointment:this.shouldBookRecurringAppointment(),RecurringAppointmentId:this.recurringAppointmentIdentifier()}},r.__decorate([i.doop],l.prototype,"startMinute",null),r.__decorate([i.doop],l.prototype,"endMinute",null),r.__decorate([i.doop],l.prototype,"shouldBookRecurringAppointment",null),r.__decorate([i.doop],l.prototype,"recurringAppointmentIdentifier",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.PatchUserLunchTimeSettingsRequestWES=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/automaticrepliessetting"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/automaticrepliessetting"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"AutomaticRepliesSetting",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{value:this.AutomaticRepliesSetting()}},r.__decorate([i.doop],l.prototype,"AutomaticRepliesSetting",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.PATCH,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkContactsActionCreator=void 0
var i=n(0),a=i.__importDefault(n(35)),s=i.__importDefault(n(945)),u=i.__importDefault(n(11)),l=i.__importDefault(n(8)),c=n(4),d=n(16),p=n(3),r=(o.prototype.getActiveNetworkContactsWESAndDispatch=function(r,o){return i.__awaiter(this,void 0,void 0,function(){var t,n
return i.__generator(this,function(e){switch(e.label){case 0:return l.default.isTimeAwayPreparationEnabled?(t=new s.default(d.HTTPRequestMethod.GET,r,"getActiveNetworkContactsWES",c.LogRequestType.Interval).orderByField(["NetworkStatus/ImportantScore desc"]).top(15),[4,a.default.executeWESRequest(t,o)]):[2]
case 1:return(n=e.sent()).status===Office.AsyncResultStatus.Succeeded?u.default.dispatch({actionType:p.Action.GetActiveContacts,activeContacts:n.result.value}):u.default.dispatch({actionType:p.Action.UpdateGetActiveContactsStatus,isSuccess:!1}),[2]}})})},o)
function o(){}t.NetworkContactsActionCreator=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var i,r=n(0),o=n(5),a=n(38),s=(i=a.WESRequestBase,r.__extends(u,i),u.prototype.getFilterCriteria=function(){return"NetworkStatus/IsActive eq true and NetworkStatus/IsBotAccount eq false"},Object.defineProperty(u.prototype,"urlPath",{get:function(){return"me/networkcontacts"},enumerable:!1,configurable:!0}),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){return i.call(this,e,t,n,r,o)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"startDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"endDate",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/protectedtimeblocks/book"},enumerable:!1,configurable:!0}),l.prototype.postData=function(){return{StartDateTime:this.startDate().toISOString(),EndDateTime:this.endDate().toISOString()}},r.__decorate([i.doop],l.prototype,"startDate",null),r.__decorate([i.doop],l.prototype,"endDate",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.POST,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"startTime",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"endTime",{get:function(){return i.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"me/protectedtimeblocks"},enumerable:!1,configurable:!0}),l.prototype.getFilterCriteria=function(){return this.startTime()&&this.endTime()?"StartTime ge "+this.startTime().toISOString()+" and EndTime lt "+this.endTime().toISOString():""},r.__decorate([i.doop],l.prototype,"startTime",null),r.__decorate([i.doop],l.prototype,"endTime",null),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedTimeBookingResponseCodes=void 0
var r=(o.ERROR_NO_TIME_ZONE_AND_WORKING_HOURS="UnavailableTimeZoneAndWorkingHours",o.ERROR_NO_PROTECTED_TIME_BOOKED="NoneBooked",o.ERROR_PARTIAL_PROTECTED_TIME_BOOKED="PartialBooked",o)
function o(){}t.ProtectedTimeBookingResponseCodes=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var a,r=n(0),o=n(5),i=n(950),s=(a=i.WESOdataRequestBase,r.__extends(u,a),Object.defineProperty(u.prototype,"StartTime",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"EndTime",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),u.prototype.getFilterCriteria=function(){return this.StartTime()&&this.EndTime()?this.startTimeFilter+" and "+this.endTimeFilter:this.EndTime()?this.startTimeFilter:this.StartTime()?this.endTimeFilter:""},Object.defineProperty(u.prototype,"startTimeFilter",{get:function(){return"StartTime lt "+this.EndTime().toISOString()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"endTimeFilter",{get:function(){return"EndTime ge "+this.StartTime().toISOString()},enumerable:!1,configurable:!0}),r.__decorate([o.doop],u.prototype,"StartTime",null),r.__decorate([o.doop],u.prototype,"EndTime",null),u=r.__decorate([o.doop],u))
function u(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.resourceAddress("me/timeaways"),i}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.WESOdataRequestBase=void 0
var a,r=n(0),s=r.__importDefault(n(378)),u=r.__importDefault(n(200)),o=n(5),i=n(38),l=n(16),c=(a=i.WESRequestBase,r.__extends(d,a),Object.defineProperty(d.prototype,"version",{get:function(){return"v1.0"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"resourceAddress",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"targetEntity",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"targetEntityKey",{get:function(){return o.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"urlPath",{get:function(){switch(this.method()){case l.HTTPRequestMethod.GET:case l.HTTPRequestMethod.POST:return this.resourceAddress()
case l.HTTPRequestMethod.PUT:case l.HTTPRequestMethod.DELETE:case l.HTTPRequestMethod.PATCH:return this.resourceAddress()+"('"+this.targetEntityKey()+"')"
default:throw new Error("No mapping from HttpRequestMethod type "+this.method()+" to log type")}},enumerable:!1,configurable:!0}),d.prototype.postData=function(){return r.__assign({},this.targetEntity())},r.__decorate([o.doop],d.prototype,"resourceAddress",null),r.__decorate([o.doop],d.prototype,"targetEntity",null),r.__decorate([o.doop],d.prototype,"targetEntityKey",null),d=r.__decorate([o.doop],d))
function d(e,t,n,r,o){var i=a.call(this,e,t,n,r,o)||this
return i.headers(s.default.getInitialWESHeaders(i.headers())),i.baseUrl(u.default.wesBaseUrl),i.requestTimeInTicks((new Date).getTime()),i}t.WESOdataRequestBase=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LogRoamingSettingsActionCreator=void 0
var i=n(0),a=i.__importDefault(n(4)),s=i.__importStar(n(65)),u=n(131),r=(o.prototype.logRoamingSettings=function(){return i.__awaiter(this,void 0,void 0,function(){var r,t,o=this
return i.__generator(this,function(e){return r={},Object.keys(s.RoamingSettingsKeys).forEach(function(e){var t,n=Number(e)
isNaN(n)||!o.shouldLogKey(n)||void 0!==(t=s.default.tryGetRoamingSettings(n))&&(r[s.RoamingSettingsKeys[e]]=t)}),0===Object.keys(r).length||(t=function(){return r},a.default.logRoamingSettings("AddinRoamingSettings",{getFeatureNameForLogging:function(){return u.FeatureName.RoamingSettings},getRegionNameForLogging:function(){return"Log"},getClickEventLoggingProperties:t,getLoadEventLoggingProperties:t})),[2]})})},o.prototype.shouldLogKey=function(e){switch(e){case s.RoamingSettingsKeys.ActionLogFolder:case s.RoamingSettingsKeys.DeletedItemsFolder:case s.RoamingSettingsKeys.EmptyStateDate:case s.RoamingSettingsKeys.EmptyStateId:case s.RoamingSettingsKeys.EngagedCardsNum:case s.RoamingSettingsKeys.FirstAccessTime:case s.RoamingSettingsKeys.HasCompletedPeopleFirstRun:case s.RoamingSettingsKeys.HasDismissedGuideCard:case s.RoamingSettingsKeys.HasDismissFocusTitleEditTutorial:case s.RoamingSettingsKeys.HasDismissWelcomeCard:case s.RoamingSettingsKeys.HasDismissedLongThreadWorkingHourTip:case s.RoamingSettingsKeys.HasUserPinnedAgave:case s.RoamingSettingsKeys.HasUserVisitedDashboard:case s.RoamingSettingsKeys.InclusionExclusionApplicationNames:case s.RoamingSettingsKeys.IsFirstRunAgave:case s.RoamingSettingsKeys.JunkEmailFolder:case s.RoamingSettingsKeys.LastTimeClickFeedback:case s.RoamingSettingsKeys.LastTimeDismissFeedback:case s.RoamingSettingsKeys.LastTimeFeedbackSubmitted:case s.RoamingSettingsKeys.LastTimeFeedbackTutorialDismissed:case s.RoamingSettingsKeys.LastTimeShowPinTutorial:case s.RoamingSettingsKeys.RequestsFolder:case s.RoamingSettingsKeys.SessionsNumFromFirstAccess:case s.RoamingSettingsKeys.ShouldIgnorePeopleFirstRun:case s.RoamingSettingsKeys.ShouldShowBookSuggestedTimeTeachingMoment:case s.RoamingSettingsKeys.ShouldShowDoNotDisturbFocusTeachingMoment:case s.RoamingSettingsKeys.ShouldShowReduceMeetingLoadInfobarTeachingMoment_V1:case s.RoamingSettingsKeys.ShouldShowTaskOverflowTeachingMoment:case s.RoamingSettingsKeys.ShouldShowTrackEmailTeachingMoment_V1:case s.RoamingSettingsKeys.ShouldShowPinInsightsTimeTeachingMoment:case s.RoamingSettingsKeys.ShouldShowAutoDelayDeliveryTeachingMoment:case s.RoamingSettingsKeys.ShouldShowInlineSuggestionsTeachingMoment:case s.RoamingSettingsKeys.TutorialsShown:case s.RoamingSettingsKeys.HasDismissedAfterHourWorkingHourTip:case s.RoamingSettingsKeys.HasDismissedFocusTimeWorkingHourTip:case s.RoamingSettingsKeys.DeletedMeetingsDuringTimeAway:case s.RoamingSettingsKeys.AutoDelayDeliveryAdvertisementCount:return!0
case s.RoamingSettingsKeys.UnReadFromVIPFolder:case s.RoamingSettingsKeys.UnReadFromDirectReportFolder:case s.RoamingSettingsKeys.UnReadFromIRankerFolder:case s.RoamingSettingsKeys.InComingWebhookUrl:case s.RoamingSettingsKeys.UserSettings:return!1
default:this.logUnhandledKey(e)}return!1},o.prototype.logUnhandledKey=function(e){a.default.logAssert("Unhandled key: "+e,"shouldLogKey","LogRoamingSettingsActionCreator")},o)
function o(){}t.LogRoamingSettingsActionCreator=r,t.default=new r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedTimeSettingsActionCreator=void 0
var o=n(0),r=n(51),i=o.__importDefault(n(35)),a=o.__importDefault(n(3)),s=n(7),u=o.__importDefault(n(11)),l=n(4),c=o.__importDefault(n(953)),d=o.__importDefault(n(4)),p=o.__importDefault(n(39)),f=n(954),g="ProtectedTimeSettingsActionCreator",m=(h.prototype.getProtectedTimeSettings=function(){return o.__awaiter(this,void 0,void 0,function(){var t,n,r
return o.__generator(this,function(e){switch(e.label){case 0:return t="getProtectedTimeSettings",n=new c.default(g,t,l.LogRequestType.Interval),[4,i.default.executeWESRequest(n)]
case 1:return(r=e.sent()).status===Office.AsyncResultStatus.Succeeded&&this.dispatchProtectedTimeSettings(r.result,t),[2]}})})},h.prototype.dispatchProtectedTimeSettings=function(e,t){try{this.validateProtectedTimeSettings(e,t)}catch(e){var n="Failed to parse ProtectedTimeSettings with exception: "+JSON.stringify(e)
return void d.default.logAssert(n,g,t)}var r=e.FocusTimeSettings
u.default.dispatch({actionType:a.default.FocusTimeSettings,hoursPerDay:r.HoursPerDay,isDoNotDisturbEnabled:r.IsDoNotDisturbEnabled,isTeamsReminderEnabled:r.IsTeamsReminderEnabled,preferredTimeOfDay:f.PreferredTimeOfDay[r.PreferredTimeOfDay],preferredStartMinute:r.PreferredStartMinute,lastModifiedTime:new Date(r.LastModifiedTime)})},h.prototype.validateProtectedTimeSettings=function(e,t){p.default.throwIfUndefinedOrNull("ProtectedTimeSettings",e),this.validateFocusTimeSettings(e.FocusTimeSettings,t)},h.prototype.validateFocusTimeSettings=function(e,t){p.default.throwIfUndefinedOrNull("FocusTimeSettings",e),p.default.throwIfUndefinedOrNull("HoursPerDay",e.HoursPerDay),p.default.throwIfUndefinedOrNull("IsDoNotDisturbEnabled",e.IsDoNotDisturbEnabled),p.default.throwIfUndefinedOrNull("IsTeamsReminderEnabled",e.IsTeamsReminderEnabled),p.default.throwIfUnknownEnumValue("PreferredTimeOfDay",e.PreferredTimeOfDay,f.PreferredTimeOfDay),p.default.throwIfUndefinedOrInvalidDate("LastModifiedTime",e.LastModifiedTime)},o.__decorate([r.expirable(r.ExpirationTypes.ByEvery_Minutes,s.Constants.oneDayInMinutes)],h.prototype,"getProtectedTimeSettings",null),h=o.__decorate([r.expirable()],h))
function h(){}t.ProtectedTimeSettingsActionCreator=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Settings/ProtectedTimeSettings"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"version",{get:function(){return"v1.1"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t,n){"use strict"
var r
Object.defineProperty(t,"__esModule",{value:!0}),t.PreferredTimeOfDay=void 0,(r=t.PreferredTimeOfDay||(t.PreferredTimeOfDay={})).Morning="Morning",r.Afternoon="Afternoon"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightRegistry_V2=void 0
var r=n(0),o=r.__importDefault(n(956)),i=r.__importDefault(n(961)),a=r.__importDefault(n(962)),s=r.__importDefault(n(963)),u=r.__importDefault(n(966)),l=r.__importDefault(n(967)),c=r.__importDefault(n(969)),d=r.__importDefault(n(970)),p=r.__importDefault(n(971)),f=r.__importDefault(n(973)),g=r.__importDefault(n(974)),m=r.__importDefault(n(975)),h=r.__importDefault(n(976)),y=r.__importDefault(n(978)),_=r.__importDefault(n(980)),S=r.__importDefault(n(981)),T=r.__importDefault(n(982)),I=r.__importDefault(n(984)),b=r.__importDefault(n(985)),E=r.__importDefault(n(987)),v=r.__importDefault(n(989)),A=r.__importDefault(n(990)),D=r.__importDefault(n(992)),O=r.__importDefault(n(993)),C=r.__importDefault(n(994)),R=r.__importDefault(n(995)),M=r.__importDefault(n(996)),P=r.__importDefault(n(997)),N=r.__importDefault(n(999)),k=r.__importDefault(n(1001)),w=r.__importDefault(n(1002)),F=r.__importDefault(n(1003)),L=r.__importDefault(n(1004)),U=r.__importDefault(n(1005)),x=r.__importDefault(n(1006)),B=r.__importDefault(n(1007)),j=r.__importDefault(n(1008)),G=r.__importDefault(n(1009)),H=r.__importDefault(n(1010)),q=r.__importDefault(n(1012)),W=r.__importDefault(n(1013)),V=function(){this.insightComputes=[h.default,p.default,T.default,I.default,N.default,c.default,d.default,a.default,o.default,f.default,m.default,g.default,y.default,q.default,W.default,i.default,u.default,O.default,C.default,E.default,l.default,S.default,b.default,_.default,A.default,R.default,M.default,P.default,s.default,D.default,H.default,k.default,v.default,w.default,F.default,L.default,U.default,x.default,B.default,j.default,G.default]}
t.InsightRegistry_V2=V,t.default=new V},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AfterHoursMeetingAttendeeActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(957)),s=o.__importDefault(n(31)),u=o.__importDefault(n(8)),l=o.__importDefault(n(26)),c=(r=s.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[a.default]},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{afterHoursMeetingAttendeeInsight:a.default.getState().afterHoursMeetingAttendeeInsight()}},d.prototype.computeInsightInstances=function(e){return e.afterHoursMeetingAttendeeInsight?[e.afterHoursMeetingAttendeeInsight]:[]},d.prototype.insightName=function(){return i.InsightName.AfterHoursMeetingAttendeeActionableMessage},Object.defineProperty(d.prototype,"insightDomain",{get:function(){return l.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return u.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.AfterHoursMeetingAttendeeActionableMessageCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AfterHoursMeetingAttendeeActionableMessageStore=t.AfterHoursMeetingAttendeeActionableMessageStoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=i.__importStar(n(114)),l=n(5),c=(r=u.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"afterHoursMeetingAttendeeInsight",{get:function(){return l.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).afterHoursMeetingAttendeeInsight(e.afterHoursMeetingAttendeeInsight)},d.prototype.toJSON=function(){return{afterHoursMeetingAttendeeInsight:this.afterHoursMeetingAttendeeInsight()}},i.__decorate([l.doop],d.prototype,"afterHoursMeetingAttendeeInsight",null),d=o=i.__decorate([l.doop],d))
function d(){return r.call(this)||this}t.AfterHoursMeetingAttendeeActionableMessageStoreState=c
var p,f=(p=u.default,i.__extends(g,p),Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),g.prototype.getInitialState=function(){return new c},g.prototype.getStoreLoggingName=function(){return"AfterHoursMeetingAttendeeActionableMessageStore"},g.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},g.prototype.processGetAfterHoursMeetingAttendeeActionableMessage=function(e,t){return e.afterHoursMeetingAttendeeInsight(t.insight)},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetAfterHoursMeetingAttendeeActionableMessage,e.processGetAfterHoursMeetingAttendeeActionableMessage),e}t.AfterHoursMeetingAttendeeActionableMessageStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=o.__importDefault(n(394)),a=o.__importDefault(n(4)),s=(r=i.default,o.__extends(u,r),u.prototype.shouldInstanceBeFilteredOut=function(e,t){var n=t.insightIdentifer
return n?!n.primaryId&&!n.secondaryId||e.identifier.primaryId===n.primaryId&&e.identifier.secondaryId===n.secondaryId:(a.default.logAssert("Missing insightIdentifier in actionLog item:["+JSON.stringify(t)+"].","IdentifiersAreEqualFilter","shouldInstanceBeFilteredOut"),!1)},u)
function u(e){return r.call(this,e)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultOffComputeBase=void 0
var r=n(0).__importDefault(n(26)),o=n(7),i=(Object.defineProperty(a.prototype,"filteredOutDomain",{get:function(){return r.default.FilteredOut},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"needTransitionLeavePage",{get:function(){return this.insightDomain===r.default.ActionableMessage||this.insightDomain===r.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"dismissExpirationInMilliseconds",{get:function(){return o.Constants.fourteenDays},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"confirmationExpirationInMilliseconds",{get:function(){return o.Constants.fourteenDays},enumerable:!1,configurable:!0}),a.prototype.registerStoreObserversAndActivate=function(){this.isInsightComputeEnabled&&this.registerStoreObservers()},a.prototype.wrapInstancesAsInsights=function(e,t){var n=this,r=[]
return e&&0<e.length&&(r=e.map(function(e){return n.wrapInstanceAsInsight(e,t)})),r},a.prototype.getDataSources=function(e){return e.map(function(e){return e.dataSource()})},a.prototype.wrapInstanceAsInsight=function(e,t){return{insightName:this.insightName(),dismissExpirationInMilliseconds:this.dismissExpirationInMilliseconds,confirmationExpirationInMilliseconds:this.confirmationExpirationInMilliseconds,computedFrom:t,lastComputedTimeInTicks:Date.now(),instanceData:e,needTransitionLeavePage:this.needTransitionLeavePage}},a)
function a(){}t.DefaultOffComputeBase=i,t.default=i},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InsightDispatcher=void 0
var r=n(0).__importDefault(n(11)),o=(i.prototype.dispatchInsights=function(e,t){var n=this.noInsightsActionType
t&&0<t.length&&(n=this.hasInsightsActionType),r.default.dispatchAsync({actionType:n,insightName:e,insights:t})},i)
function i(e,t){this.hasInsightsActionType=e,this.noInsightsActionType=t}t.InsightDispatcher=o,t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BookFocusTimeActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(529)),s=o.__importDefault(n(395)),u=(r=a.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.BookFocusTimeActionableMessage},Object.defineProperty(l.prototype,"insightStore",{get:function(){return s.default},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"getInsightFromStore",{get:function(){return s.default.getState().focusTimeInsight()},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.BookFocusTimeActionableMessageCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardTeaserCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(147)),u=o.__importDefault(n(31)),l=n(7),c=o.__importDefault(n(26)),d=(r=u.default,o.__extends(p,r),Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[s.default]},enumerable:!1,configurable:!0}),p.prototype.insightName=function(){return i.InsightName.DashboardTeaser},Object.defineProperty(p.prototype,"insightDomain",{get:function(){return c.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isDashboardEnabled},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{numberOfSessionsSinceFirstVisit:s.default.getState().sessionsNumFromFirstAccess(),hasUserVisitedDashboard:s.default.getState().hasUserVisitedDashboard()}},p.prototype.computeInsightInstances=function(e){return 3<=e.numberOfSessionsSinceFirstVisit&&!1===e.hasUserVisitedDashboard?[{identifier:{primaryId:"DASHBOARD_TEASER"}}]:[]},Object.defineProperty(p.prototype,"dismissExpirationInMilliseconds",{get:function(){return l.Constants.oneMonth},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"confirmationExpirationInMilliseconds",{get:function(){return l.Constants.oneMonth},enumerable:!1,configurable:!0}),p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.DashboardTeaserCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeCompute=void 0
var l,r,o=n(0),i=o.__importStar(n(13)),c=o.__importDefault(n(531)),a=o.__importDefault(n(8)),s=o.__importDefault(n(91)),u=o.__importDefault(n(178)),d=o.__importDefault(n(306)),p=o.__importDefault(n(153)),f=o.__importDefault(n(24)),g=o.__importDefault(n(396)),m=o.__importDefault(n(26)),h=o.__importDefault(n(202)),y=o.__importDefault(n(6)),_=o.__importDefault(n(201)),S=n(7),T=n(29);(r=l=l||{})[r.Default=0]="Default",r[r.B2BWithAnother=-1]="B2BWithAnother",r[r.EdgeOfWorkHour=-2]="EdgeOfWorkHour",r[r.B2BWithMeeting=-3]="B2BWithMeeting",r[r.LunchTime=-4]="LunchTime"
var I,b=(I=g.default,o.__extends(E,I),E.prototype.insightName=function(){return i.InsightName.FocusTime},Object.defineProperty(E.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([s.default,u.default,d.default,p.default],this.getBaseStores())},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"insightDomain",{get:function(){return m.default.Feed},enumerable:!1,configurable:!0}),E.prototype.calculateCurrentState=function(e){return{freeBlocksWithinWorkingHours:s.default.getState().freeBlocksWithinWorkingHours(),calendarItems:s.default.getState().calendarItems(),workHours:s.default.getState().workingHours(),hasLoadedCalendarItems:s.default.getState().hasLoadedCalendarItems(),isFocusOutcomeEnrolled:u.default.getState().isFocusOutcomeEnrolled(),lunchStartMinute:d.default.getState().startMinute(),lunchEndMinute:d.default.getState().endMinute(),hasLoadedFocusTimeSettings:p.default.getState().hasLoaded(),shouldEnableCalendarReminder:p.default.getState().shouldEnableCalendarReminder}},E.prototype.mergeNewStateWhenFrozen=function(e,t){return o.__assign({},e)},E.prototype.shouldFreezeDetailPage=function(e,t){return!!e},E.prototype.readyToCompute=function(e){return null!=e&&(!1===a.default.isOutcomeEnabled||!1===e.isFocusOutcomeEnrolled)&&e.hasLoadedCalendarItems&&e.workHours&&0<e.freeBlocksWithinWorkingHours.length&&void 0!==e.lunchStartMinute&&void 0!==e.lunchEndMinute&&(!a.default.isFocusReminderSettingEnabled||e.hasLoadedFocusTimeSettings)},E.prototype.computeFreeBlocksWithinQueryDateRange=function(e,t,n){var r=h.default.filterByLength(e,S.Constants.twoHoursInMilliSeconds),r=h.default.segmentToMultipleBlocks(r,S.Constants.twoHoursInMilliSeconds)
return a.default.isFocusReminderSettingEnabled&&(r=h.default.addReminderSetting(r,n)),h.default.getTimeBlocksBetween(r,t)},E.prototype.computeInsightInstances=function(e){if(this.readyToCompute(e)){var t=this.getQueryTimeRange(e.workHours.workingDays),n=this.computeFreeBlocksWithinQueryDateRange(e.freeBlocksWithinWorkingHours,t,e.shouldEnableCalendarReminder)
if(0===n.length)return[]
var r=this.getBookedFocusTimeBlocks(e.calendarItems,t),o=this.pickFreeBlocksForAllDays(n,e),i=Object.keys(this.groupFreeBlocksByDay(o)).map(function(e){return new Date(e)})
return[{identifier:{primaryId:"FOCUS_TIME"},bookedBlocks:r,freeBlocks:o,totalFreeBlockNum:o.length,busyType:this.getBusyType(n.length),daysWithFreeBlocks:i}]}return[]},E.prototype.getQueryTimeRange=function(e){var t=new Date
return{startDate:t,endDate:_.default.getNextKWorkingDay(this.NUMBER_OF_LOOK_FORWARD_WORKDAYS,t,e.workingDaysSundayStart)}},E.prototype.getBusyType=function(e){return e<=this.MAXIMUM_FREE_SLOTS_FOR_BUSY?T.BusyType.Busy:T.BusyType.NotBusy},E.prototype.getBookedFocusTimeBlocks=function(e,t){return h.default.getTimeBlocksBetween(e,t).filter(function(e){return T.CalendarTypeUtils.isFocusTime(e)})},E.prototype.groupFreeBlocksByDay=function(e){return y.default.aggregateObjectArrayByKey(e,function(e){return e.startDate.toDateString()})},E.prototype.pickFreeBlocksForAllDays=function(e,r){var o=this,i=this.groupFreeBlocksByDay(e)
return Object.keys(i).reduce(function(e,t){var n=o.pickFreeBlocksForOneDay(i[t],r.calendarItems.filter(function(e){return e.startDate.toDateString()===t}),r)
return e.concat(n)},[])},E.prototype.pickFreeBlocksForOneDay=function(e,t,n){function r(e){o.isLunchTime(e,n),o.isB2BWithMeeting(e,t),o.isEdgeOfWorkHour(e,n.workHours),o.isB2BWithAnother(e,u),e.score||(e.score=l.Default)}var o=this,i=c.default(e,function(e){return e.startDate.getHours()<12}),a=i[0],s=i[1],u=a.slice()
return a.forEach(r),s.forEach(r),a.sort(function(e,t){return t.score-e.score}),s.sort(function(e,t){return t.score-e.score}),0<a.length&&0<s.length?[a[0],s[0]]:0<a.length?a.slice(0,2):s.slice(0,2)},E.prototype.isLunchTime=function(e,t){var n,r
e.score||(n=f.default.setMinutesSinceStartOfDay(e.startDate,t.lunchStartMinute),r=f.default.setMinutesSinceStartOfDay(e.startDate,t.lunchEndMinute),e.startDate<r&&n<e.endDate&&(e.score=l.LunchTime))},E.prototype.isB2BWithMeeting=function(e,t){if(!e.score)for(var n=0;n<t.length;n++)(e.startDate.getTime()-t[n].endDate.getTime()<=15*S.Constants.oneMinuteInMilliSeconds&&0<=e.startDate.getTime()-t[n].endDate.getTime()||t[n].startDate.getTime()-e.endDate.getTime()<=15*S.Constants.oneMinuteInMilliSeconds&&0<=t[n].startDate.getTime()-e.endDate.getTime())&&(e.score=l.B2BWithMeeting)},E.prototype.isEdgeOfWorkHour=function(e,t){var n=new Date(t.workingHoursTimeBlock.startDate.getTime())
n.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate())
var r=new Date(t.workingHoursTimeBlock.endDate.getTime())
r.setFullYear(e.startDate.getFullYear(),e.startDate.getMonth(),e.startDate.getDate()),e.score||(e.startDate.getTime()-n.getTime()<=S.Constants.oneMinuteInMilliSeconds||r.getTime()-e.endDate.getTime()<=S.Constants.oneMinuteInMilliSeconds)&&(e.score=l.EdgeOfWorkHour)},E.prototype.isB2BWithAnother=function(e,t){if(!e.score)for(var n=0;n<t.length;n++)(e.startDate.getTime()-t[n].endDate.getTime()<=S.Constants.oneMinuteInMilliSeconds&&0<=e.startDate.getTime()-t[n].endDate.getTime()||t[n].startDate.getTime()-e.endDate.getTime()<=S.Constants.oneMinuteInMilliSeconds&&0<=t[n].startDate.getTime()-e.endDate.getTime())&&(e.score=l.B2BWithAnother)},Object.defineProperty(E.prototype,"dismissExpirationInMilliseconds",{get:function(){var e=new Date
return _.default.getFirstWorkDayNextWeek(e).getTime()-e.getTime()},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"confirmationExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),E)
function E(){var e=null!==I&&I.apply(this,arguments)||this
return e.NUMBER_OF_LOOK_FORWARD_WORKDAYS=5,e.MAXIMUM_FREE_SLOTS_FOR_BUSY=5,e}t.FocusTimeCompute=b,t.default=new b},,,function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeConflictActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(529)),s=o.__importDefault(n(395)),u=(r=a.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.FocusTimeConflictActionableMessage},Object.defineProperty(l.prototype,"insightStore",{get:function(){return s.default},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"getInsightFromStore",{get:function(){return s.default.getState().focusBlockConflictInsight()},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.FocusTimeConflictActionableMessageCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingOverloadActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(968)),s=o.__importDefault(n(31)),u=n(29),l=o.__importDefault(n(8)),c=o.__importDefault(n(26)),d=(r=s.default,o.__extends(p,r),Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[a.default]},enumerable:!1,configurable:!0}),p.prototype.insightName=function(){return i.InsightName.MeetingOverloadActionableMessage},Object.defineProperty(p.prototype,"insightDomain",{get:function(){return c.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return l.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{meetingOverloadInsight:a.default.getState().delegateAttendeesFromActionableMessage()}},p.prototype.computeInsightInstances=function(e){return e.meetingOverloadInsight&&e.meetingOverloadInsight.delegateAttendees?this.convertToMeetingOverloadInstance(e):[]},p.prototype.convertToMeetingOverloadInstance=function(e){var n=[],r=[]
return e.meetingOverloadInsight.delegateAttendees.map(function(e){var t={name:e.name?e.name:e.smtpAddress,smtpAddress:e.smtpAddress,responseType:u.CalendarTypeUtils.strToResponseType(e.meetingResponse)}
e.isInvitedInMeeting?(t.responseType===u.ResponseType.None&&(t.responseType=u.ResponseType.NotResponded),r.push(t)):n.push(t)}),[{peers:n,attendees:r,identifier:e.meetingOverloadInsight.identifier,doesSupportNudgeFeedback:e.meetingOverloadInsight.doesSupportNudgeFeedback}]},Object.defineProperty(p.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.MeetingOverloadActionableMessageCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingOverloadActionableMessageStore=t.MeetingOverloadActionableMessageStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=n(83),u=n(5),l=(r=s.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"delegateAttendeesFromActionableMessage",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],c.prototype,"delegateAttendeesFromActionableMessage",null),c=o.__decorate([u.doop],c))
function c(){return null!==r&&r.apply(this,arguments)||this}t.MeetingOverloadActionableMessageStoreState=l
var d,p=(d=s.DataStreamStoreBase,o.__extends(f,d),f.prototype.getStoreLoggingName=function(){return"MeetingOverloadActionableMessageStore"},f.prototype.getInitialState=function(){return new l},f.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),f.prototype.processMeetingOverloadFromActionableMessage=function(e,t){return e.delegateAttendeesFromActionableMessage(t.insight)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(a.default.GetMeetingOverloadFromActionableMessage,e.processMeetingOverloadFromActionableMessage),e}t.MeetingOverloadActionableMessageStore=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationCardInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(293)),l=o.__importDefault(n(26)),c=o.__importDefault(n(533)),d=(r=s.default,o.__extends(p,r),Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[u.default]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isMeetingPreparationCardEnabled},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{meetingInsights:u.default.getState().meetingInsights(),actedUponInsightId:u.default.getState().actedUponInsightId(),performedActionName:u.default.getState().performedActionName(),actionSlotDurationInMinutes:u.default.getState().actionSlotDurationInMinutes(),bookedMeetingId:u.default.getState().bookedMeetingId(),documentStats:u.default.getState().documentStats()}},p.prototype.computeInsightInstances=function(t){var n=this
return t.meetingInsights.map(function(e){return n.computeIndividualMeetingInsight(t,e)})},p.prototype.computeIndividualMeetingInsight=function(e,n){var t
return n.identifier.primaryId===e.actedUponInsightId&&(n=c.default.updateInsightAfterPreparationTimeAction(n,e.performedActionName,e.actionSlotDurationInMinutes,e.bookedMeetingId)),0<e.documentStats.length&&(t=e.documentStats.filter(function(e){return n.identifier.primaryId===e.insightId})[0])&&(n.documentAnalytics=t.documentStats,t.documentStats.statisticsBreakdown.forEach(function(t){n.attachments=n.attachments.filter(function(e){return e.attachmentName!==t.documentName||!e.documentURL})})),n.doesSupportNudgeFeedback=!1,n},p.prototype.insightName=function(){return i.InsightName.MeetingPreparationCard},Object.defineProperty(p.prototype,"insightDomain",{get:function(){return l.default.Feed},enumerable:!1,configurable:!0}),p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.MeetingPreparationCardInsightCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingRelatedDocumentsInsightCompute=void 0
var r,o=n(0),i=n(13),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(295)),l=o.__importDefault(n(26)),c=(r=s.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[u.default]},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{meetingRelatedDocumentsInsights:u.default.getState().meetingRelatedDocumentsInsights()}},d.prototype.computeInsightInstances=function(t){var n=this
return t.meetingRelatedDocumentsInsights.map(function(e){return n.computeIndividualMeetingRelatedDocumentsInsight(t,e)})},d.prototype.computeIndividualMeetingRelatedDocumentsInsight=function(e,t){return t.doesSupportNudgeFeedback=!1,t},d.prototype.insightName=function(){return i.InsightName.MeetingRelatedDocuments},Object.defineProperty(d.prototype,"insightDomain",{get:function(){return l.default.Feed},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.MeetingRelatedDocumentsInsightCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSuggestionCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(91)),s=o.__importDefault(n(37)),u=o.__importDefault(n(8)),l=o.__importDefault(n(118)),c=o.__importDefault(n(972)),d=o.__importDefault(n(299)),p=o.__importDefault(n(6)),f=o.__importDefault(n(31)),g=n(7),m=o.__importDefault(n(26)),h=(r=f.default,o.__extends(y,r),Object.defineProperty(y.prototype,"storesToObserve",{get:function(){return[a.default,l.default,d.default,s.default]},enumerable:!1,configurable:!0}),y.prototype.insightName=function(){return i.InsightName.MeetingSuggestion},Object.defineProperty(y.prototype,"insightDomain",{get:function(){return m.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isInsightComputeEnabled",{get:function(){return u.default.isMeetingSuggestionEnabled},enumerable:!1,configurable:!0}),y.prototype.calculateState=function(e){return{sortedVIPs:l.default.getState().sortedVIPs(),calendarItems:a.default.getState().meetingSuggestionCalendarItems(),userOofStatus:d.default.getState().userOofStatus(),importantPeopleOofStatusMap:d.default.getState().importantPeopleOofStatusMap(),isCompose:s.default.getState().isCompose()}},Object.defineProperty(y.prototype,"dismissExpirationInMilliseconds",{get:function(){return 2*g.Constants.oneWeek},enumerable:!1,configurable:!0}),y.prototype.computeInsightInstances=function(e){var t=this
if(!this.isDataComplete(e)||!e.calendarItems[0].attendees||e.isCompose)return[]
var n=this.findQualifiedImportantPeopleForMeetingSuggestion(e),r=e.calendarItems.filter(function(e){return e.attendees.length<=2&&c.default.hasPersonAttendedMeeting(p.default.userEmail,e,"MeetingSuggestionCompute.computeInsightInstances()")}),o=[],i=e.userOofStatus
return i.wasOofLastTwoWeeks||i.isOofNextTwoWeeks||(o=n.filter(function(e){return t.shouldShowInsightForPerson(r,e.smtpAddress)})),this.mapSuggestedImportantPeopleToInsightInstances(o)},y.prototype.shouldShowInsightForPerson=function(e,t){var n={startDate:new Date(Date.now()-g.Constants.oneMonth),endDate:new Date(Date.now()-2*g.Constants.oneWeek)},r={startDate:new Date(Date.now()-2*g.Constants.oneWeek),endDate:new Date(Date.now()+2*g.Constants.oneWeek)}
return!!e.some(function(e){return!!c.default.isMeetingInPeriod(e,n.startDate,n.endDate)&&c.default.hasPersonAttendedMeeting(t,e,"MeetingSuggestionCompute.shouldShowInsightForPerson()")})&&!e.some(function(e){return!!c.default.isMeetingInPeriod(e,r.startDate,r.endDate)&&c.default.hasPersonAttendedMeeting(t,e,"MeetingSuggestionCompute.shouldShowInsightForPerson()")})},y.prototype.isDataComplete=function(e){return e.sortedVIPs&&0<e.sortedVIPs.length&&e.calendarItems&&0<e.calendarItems.length&&!!e.userOofStatus&&e.importantPeopleOofStatusMap&&0<Object.keys(e.importantPeopleOofStatusMap).length},y.prototype.findQualifiedImportantPeopleForMeetingSuggestion=function(n){return n.sortedVIPs.filter(function(t){return Object.keys(n.importantPeopleOofStatusMap).some(function(e){return e===t.smtpAddress})}).filter(function(e){var t=n.importantPeopleOofStatusMap[e.smtpAddress]
return!t.wasOofLastTwoWeeks&&!t.isOofNextTwoWeeks})},y.prototype.mapSuggestedImportantPeopleToInsightInstances=function(e){return e.map(function(e){return{identifier:{primaryId:e.smtpAddress},importantPerson:e}})},y)
function y(){return null!==r&&r.apply(this,arguments)||this}t.MeetingSuggestionCompute=h,t.default=new h},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=n(29),a=r.__importDefault(n(4)),s=(u.isMeetingInPeriod=function(e,t,n){return e.startDate>t&&e.endDate<n},u.hasPersonAttendedMeeting=function(e,n,r){var t=n.attendees,o=e.toLowerCase()
if(n.organizerMailAddress){if(o===n.organizerMailAddress.toLowerCase())return!0}else{var i=n.identifier?n.identifier.id:""
a.default.logWarning("The meeting with ID '"+i+"' has no organizer.",r,"hasPersonAttendedMeeting")}return t.some(function(e){if(e.smtpAddress)return e.smtpAddress.toLowerCase()===o&&u.hasProbablyAttendedMeeting(e.responseType)
var t=n.identifier?n.identifier.id:""
return a.default.logWarning("The meeting with ID '"+t+"' encountered an attendee with no SMTP address.",r,"hasPersonAttendedMeeting"),!1})},u.isMeetingShorterThanHalfAnHour=function(e){return e.endDate.getTime()-e.startDate.getTime()<=30*o.Constants.oneMinuteInMilliSeconds},u.hasProbablyAttendedMeeting=function(e){return e!==i.ResponseType.Declined},u.attendeeNumberThrehold=20,u)
function u(){}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AutoDelayDeliveryInfobarCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(534)),u=o.__importDefault(n(64)),l=o.__importDefault(n(149)),c=(r=s.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([u.default],this.getBaseStores())},enumerable:!1,configurable:!0}),d.prototype.computeNudgeInstances=function(e){return l.default.qualifyLicensesCheck(e.hasP1License)&&e.isComposeMessage&&e.scheduledDateTime&&e.insightData&&!e.isDelayDeliveryCancelled?this.buildInstances(e):[]},d.prototype.calculateCurrentState=function(e){var t=r.prototype.calculateCurrentState.call(this,e)
return o.__assign(o.__assign({},t),{hasP1License:u.default.hasP1License()})},d.prototype.insightName=function(){return i.InsightName.AutoDelayDeliveryInfobar},Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return a.default.hasDelayDeliveryPrerequisites},enumerable:!1,configurable:!0}),d.prototype.getInsightDataFromStoreState=function(e){return e.autoDelayDeliveryInfobarInsight()},d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.AutoDelayDeliveryInfobarCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ScheduledDelayDeliveryInfobarCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(37)),u=o.__importDefault(n(176)),l=n(7),c=o.__importDefault(n(26)),d=o.__importDefault(n(149)),p=o.__importDefault(n(31)),f=o.__importDefault(n(196)),g=(r=p.default,o.__extends(m,r),Object.defineProperty(m.prototype,"storesToObserve",{get:function(){return a.default.isInfobarUpdatableFromVertical?[s.default,f.default,u.default]:[s.default,u.default]},enumerable:!1,configurable:!0}),m.prototype.calculateState=function(e){return{isComposeMessage:!!s.default.asComposeMessage(),scheduledDateTime:u.default.getState().scheduledDelayDeliveryDateTime(),isScheduledByMyAnalytics:u.default.getState().isScheduledByMyAnalytics(),isDelayDeliveryCancelled:u.default.getState().isDelayDeliveryCancelled(),shouldDisplayRecipientsTimeZone:u.default.getState().shouldDisplayRecipientsTimeZone(),toRecipients:d.default.getToRecipients(),userAddressToTimeZoneMap:u.default.getState().userAddressToTimeZoneMap()}},m.prototype.computeInsightInstances=function(e){return!e.isComposeMessage||!e.scheduledDateTime||e.scheduledDateTime.getTime()<Date.now()||!e.isScheduledByMyAnalytics||e.isDelayDeliveryCancelled?[]:this.buildInstances(e)},m.prototype.insightName=function(){return i.InsightName.ScheduledDelayDeliveryInfobar},Object.defineProperty(m.prototype,"insightDomain",{get:function(){return c.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isInsightComputeEnabled",{get:function(){return a.default.hasDelayDeliveryPrerequisites},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"confirmationExpirationInMilliseconds",{get:function(){return l.Constants.oneDay},enumerable:!1,configurable:!0}),m.prototype.buildInstances=function(e){var t=e.shouldDisplayRecipientsTimeZone?d.default.getSortedTimeZoneSupplementList(e.toRecipients,e.userAddressToTimeZoneMap):[],n={RecipientsScenario:e.shouldDisplayRecipientsTimeZone?"Remote":"Similar"}
return[{identifier:{primaryId:"SCHEDULED_DELAY_DELIVERY_INFOBAR_COMPUTE"},insightText:null,actionText:null,suggestedDateTime:e.scheduledDateTime,scheduledDateTime:e.scheduledDateTime,sortedTimeZoneSupplementList:t,loggingProperties:n}]},m)
function m(){return null!==r&&r.apply(this,arguments)||this}t.ScheduledDelayDeliveryInfobarCompute=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedDelayDeliveryInfobarCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(534)),u=(r=s.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.SuggestedDelayDeliveryInfobar},Object.defineProperty(l.prototype,"isInsightComputeEnabled",{get:function(){return a.default.hasDelayDeliveryPrerequisites},enumerable:!1,configurable:!0}),l.prototype.getInsightDataFromStoreState=function(e){return e.suggestedDelayDeliveryInfobarInsight()},l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.SuggestedDelayDeliveryInfobarCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleAddCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(977)),s=n(7),u=(r=a.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.PeopleAdd},Object.defineProperty(l.prototype,"dismissExpirationInMilliseconds",{get:function(){return s.Constants.oneMonth},enumerable:!1,configurable:!0}),l.prototype.getSuggestions=function(t){var n=this
return t.relevantPeople.filter(function(e){return!n.isUserPinned(e,t.pinnedPeople)&&e.relevanceRank<=l.MAX_SUGGESTIONS})},l.prototype.isUserPinned=function(t,e){return e.some(function(e){return e.smtpAddress===t.smtpAddress})},l.MAX_SUGGESTIONS=10,l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.PeopleAddCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleComputeBase=void 0
var r,o=n(0),i=o.__importDefault(n(8)),a=o.__importDefault(n(118)),s=o.__importDefault(n(241)),u=o.__importDefault(n(31)),l=o.__importDefault(n(26)),c=(r=u.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[a.default,s.default]},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"insightDomain",{get:function(){return l.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return i.default.isPinUserEnabled},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{isDataReady:s.default.getState().isDataReady(),pinnedPeople:a.default.getState().sortedVIPs(),relevantPeople:s.default.getState().relevantPeople()}},d.prototype.computeInsightInstances=function(e){return e.isDataReady?this.getSuggestions(e).map(function(e){return{identifier:{primaryId:e.smtpAddress},user:e}}):[]},d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.PeopleComputeBase=c,t.default=c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PostDelayDeliveryActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(31)),s=o.__importDefault(n(8)),u=o.__importDefault(n(26)),l=o.__importDefault(n(979)),c=(r=a.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[l.default]},enumerable:!1,configurable:!0}),d.prototype.insightName=function(){return i.InsightName.PostDelayDeliveryActionableMessage},Object.defineProperty(d.prototype,"insightDomain",{get:function(){return u.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return s.default.isDelayDeliveryActionableMessageEnabled},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{postDelayDeliveryInsight:l.default.getState().postDelayDeliveryInsight()}},d.prototype.computeInsightInstances=function(e){return e.postDelayDeliveryInsight?[e.postDelayDeliveryInsight]:[]},Object.defineProperty(d.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.PostDelayDeliveryActionableMessageCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PostDelayDeliveryActionableMessageStore=t.PostDelayDeliveryActionableMessageStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=n(83),u=n(5),l=(r=s.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"postDelayDeliveryInsight",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],c.prototype,"postDelayDeliveryInsight",null),c=o.__decorate([u.doop],c))
function c(){return null!==r&&r.apply(this,arguments)||this}t.PostDelayDeliveryActionableMessageStoreState=l
var d,p=(d=s.DataStreamStoreBase,o.__extends(f,d),f.prototype.getStoreLoggingName=function(){return"PostDelayDeliveryActionableMessageStore"},f.prototype.getInitialState=function(){return new l},f.prototype.setStateForItemChangedEvent=function(e,t){return this.getInitialState()},Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),f.prototype.processPostDelayDeliveryFromActionableMessage=function(e,t){return e.postDelayDeliveryInsight(t.insight)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(a.default.GetPostDelayDeliveryFromActionableMessage,e.processPostDelayDeliveryFromActionableMessage),e}t.PostDelayDeliveryActionableMessageStore=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedTimeHeaderCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(308)),s=o.__importDefault(n(26)),u=o.__importDefault(n(64)),l=o.__importDefault(n(178)),c=o.__importDefault(n(8)),d=n(7),p=o.__importDefault(n(31)),f=(r=p.default,o.__extends(g,r),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[u.default,a.default,l.default]},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(e){return{bookedBlocks:a.default.getState().editedBlocks().filter(function(e){return e.isBooked}).length,isFocusOutcomeEnrolled:l.default.getState().isFocusOutcomeEnrolled()}},g.prototype.insightName=function(){return i.InsightName.ProtectedTimeBookingHeader},g.prototype.computeInsightInstances=function(e){return 0===e.bookedBlocks||e.isFocusOutcomeEnrolled?[]:[{identifier:{primaryId:"ProtectedTimeHeaderIdentifier"}}]},Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return d.Constants.oneMonth},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return c.default.isOutcomeEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"insightDomain",{get:function(){return s.default.Broadcast},enumerable:!1,configurable:!0}),g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.ProtectedTimeHeaderCompute=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingPreparationInfobarCompute=void 0
var r,o=n(0),i=o.__importDefault(n(8)),a=o.__importDefault(n(37)),s=o.__importDefault(n(307)),u=o.__importDefault(n(93)),l=o.__importDefault(n(26)),c=o.__importDefault(n(294)),d=n(7),p=n(13),f=o.__importDefault(n(533)),g=n(177),m=o.__importDefault(n(89)),h=n(177),y=(r=s.default,o.__extends(_,r),Object.defineProperty(_.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([a.default,c.default],this.getBaseStores())},enumerable:!1,configurable:!0}),_.prototype.insightName=function(){return p.InsightName.MeetingPreparationInfobar},_.prototype.computeNudgeInstances=function(e){if(!e.isComposing||!e.insightData)return[]
var t=this.updateMeetingInsight(e,this.getPreparationTimeInstance(e))
return[o.__assign(o.__assign({},t),{identifier:e.insightData.identifier,insightText:e.insightData.insightText,actionText:e.insightData.actionText,bookRehearsalTimeActions:e.insightData.bookRehearsalTimeActions,setMeetingInsightCustomProperties:i.default.areMeetingInfobarsEnabledForEditMode?function(){var e=a.default.asComposeAppointment()
m.default.setAppointmentComposeCustomProperty(e,h.IS_MEETING_PREPARATION_INFOBAR_SHOWN_DURING_COMPOSE_CUSTOM_PROP,!0,"MeetingPreparartionInfobarCompute_setMeetingInsightCustomProperties")}:void 0})]},_.prototype.calculateCurrentState=function(){return{isComposing:!!a.default.asComposeItem(),appointmentItem:a.default.asComposeAppointment(),insightData:this.getInsightDataFromStoreState(u.default.getState()),actionSlotDurationInMinutes:c.default.getState().actionSlotDurationInMinutes(),actedUponInsightId:c.default.getState().actedUponInsightId(),performedActionName:c.default.getState().performedActionName(),bookedMeetingId:c.default.getState().bookedMeetingId()}},_.prototype.getInsightDataFromStoreState=function(e){return e.meetingPreparationInfobarInsight()},_.prototype.shouldFreezeDetailPage=function(e,t){return!!e},Object.defineProperty(_.prototype,"insightDomain",{get:function(){return l.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isInsightComputeEnabled",{get:function(){return i.default.isMeetingPreparationInfobarEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"confirmationExpirationInMilliseconds",{get:function(){return d.Constants.oneDay},enumerable:!1,configurable:!0}),_.prototype.updateMeetingInsight=function(e,t){return t.identifier.primaryId===e.actedUponInsightId&&(t=f.default.updateInsightAfterPreparationTimeAction(t,e.performedActionName,e.actionSlotDurationInMinutes,e.bookedMeetingId)),t},_.prototype.getPreparationTimeInstance=function(e){var t,n,r=this.bookPreparationTimeAction(g.SHORT_PREPARATION_TIME_DURATION,e.insightData.bookPreparationTimeActions),o=this.bookPreparationTimeAction(g.LONG_PREPARATION_TIME_DURATION,e.insightData.bookPreparationTimeActions),i=Math.max(null!==(t=null==r?void 0:r.PreparationTimeDurationInMinutes)&&void 0!==t?t:0,null!==(n=null==o?void 0:o.PreparationTimeDurationInMinutes)&&void 0!==n?n:0),a=""
return e.insightData.bookPreparationTimeActions.length?a=e.insightData.bookPreparationTimeActions[0].PreparationTimeSubject:e.insightData.bookRehearsalTimeActions.length&&(a=e.insightData.bookRehearsalTimeActions[0].RehearsalTimeSubject),{identifier:e.insightData.identifier,meetingId:"",subject:a,startTime:r?new Date(r.PreparationEndTimeInUtc):null,preparationTimeDurationBooked:e.actionSlotDurationInMinutes,preparationTimeDurationAvailable:i,bookShortPreparationTimeAction:r,bookLongPreparationTimeAction:o,cancelBookedTimeAction:null,isMock:!1}},_.prototype.bookPreparationTimeAction=function(t,e){var n=e.filter(function(e){return e.PreparationTimeDurationInMinutes===t})
return 0<n.length?n[0]:null},_)
function _(){return null!==r&&r.apply(this,arguments)||this}t.MeetingPreparationInfobarCompute=y,t.default=new y},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(37)),u=o.__importDefault(n(31)),l=o.__importDefault(n(243)),c=o.__importDefault(n(297)),d=n(7),p=o.__importDefault(n(26)),f=n(983),g=(r=u.default,o.__extends(m,r),Object.defineProperty(m.prototype,"storesToObserve",{get:function(){return[c.default,s.default]},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areSentMailStatisticsEnabled},enumerable:!1,configurable:!0}),m.prototype.calculateState=function(e){return{currentItemInternetMsgId:s.default.getState().internetMessageId(),messageAnalytics:c.default.getState().messageAnalytics(),documentAnalytics:c.default.getState().documentAnalytics()}},m.prototype.computeInsightInstances=function(n){var r=this
if(!n.currentItemInternetMsgId)return[]
var e=n.messageAnalytics.filter(function(e){return r.shouldIncludeMessage(e)&&e.internetMsgId!==n.currentItemInternetMsgId})
return a.default.isExtendedSentMailStatsEnabled&&(e=this.moveItemsWithExtendedStatsToTop(e)),e.map(function(e){var t=l.default.areMessageReadsStable(e)
return{identifier:{primaryId:e.itemId.id,secondaryId:r.labelStatisticStability(t)},messageAnalytics:e,documentAnalytics:r.parseDocumentAnalytics(n.documentAnalytics,e.internetMsgId),areStatisticsStable:t,secondsUntilReadByMost:l.default.computeSecondsUntilReadByMost(e.analytics.mostReadByDateTime,e.dateTimeSent)}})},m.prototype.insightName=function(){return i.InsightName.SentMailStats},Object.defineProperty(m.prototype,"insightDomain",{get:function(){return p.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"dismissExpirationInMilliseconds",{get:function(){return d.Constants.oneMonth},enumerable:!1,configurable:!0}),m.prototype.parseDocumentAnalytics=function(e,t){var n,r=null!==(n=null==e?void 0:e.filter(function(e){return e.internetMessageId===t}))&&void 0!==n?n:[]
return 0<r.length?r[0]:null},m.prototype.shouldIncludeMessage=function(e){return Date.now()-e.dateTimeSent.getTime()>=m.MAX_DURATION_BEFORE_FORCED_INCLUSION||e.analytics.percentOpened>=f.SentMailStatsConstants.MAJORITY_OPENED_PERCENT},m.prototype.labelStatisticStability=function(e){return e?m.STABILIZED_STATISTICS_STATE:m.UPDATING_STATISTICS_STATE},m.prototype.moveItemsWithExtendedStatsToTop=function(e){var n=[],r=[]
return e.forEach(function(e){var t
return void 0!==(null===(t=e.analytics)||void 0===t?void 0:t.extendedStatistics)?n.push(e):r.push(e)}),n.concat(r)},m.MAX_DURATION_BEFORE_FORCED_INCLUSION=3*d.Constants.oneHourInMilliSeconds,m.UPDATING_STATISTICS_STATE="STILL_UPDATING",m.STABILIZED_STATISTICS_STATE="FINAL_STATISTICS",m)
function m(){return null!==r&&r.apply(this,arguments)||this}t.SentMailStatsCompute=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsConstants=void 0
var r=(o.MAJORITY_OPENED_PERCENT=50,o)
function o(){}t.SentMailStatsConstants=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsInContextCompute=void 0
var r,o=n(0),i=o.__importDefault(n(8)),a=o.__importDefault(n(37)),s=o.__importDefault(n(31)),u=o.__importDefault(n(243)),l=o.__importDefault(n(397)),c=o.__importDefault(n(26)),d=n(208),p=n(13),f=(r=s.default,o.__extends(g,r),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[l.default,a.default]},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return i.default.areSentMailStatisticsEnabled},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(e){var t=a.default.getState().isItemInSentItemsFolder()||a.default.getState().doesSenderApproximatelyMatchCurrentUser()
return{messageAnalytics:l.default.getState().analytics(),documentAnalytics:l.default.getState().documentAnalytics(),messageStatus:l.default.getState().messageStatus(),currentItemId:a.default.currentItemId(),currentItemInternetMsgId:a.default.getState().internetMessageId(),isInContextScenario:t,isMeetingRequestOrResponse:a.default.isMeetingRequestOrResponse()}},g.prototype.computeInsightInstances=function(e){if(!e.currentItemInternetMsgId||!e.isInContextScenario||e.messageStatus===d.InContextStatus.None)return[]
if(e.messageAnalytics&&e.messageAnalytics.itemId.id!==e.currentItemId)return[]
if(this.isShortCircuitStateChange(e.messageStatus))return[{identifier:{primaryId:p.InsightName.SentMailStatsInContext},messageStatus:e.messageStatus,messageAnalytics:null,documentAnalytics:null,areStatisticsStable:!1}]
var t=u.default.areMessageReadsStable(e.messageAnalytics)
return[{identifier:{primaryId:p.InsightName.SentMailStatsInContext.toString()},messageStatus:e.messageStatus,messageAnalytics:e.messageAnalytics,documentAnalytics:e.documentAnalytics,areStatisticsStable:t}]},g.prototype.insightName=function(){return p.InsightName.SentMailStatsInContext},Object.defineProperty(g.prototype,"insightDomain",{get:function(){return c.default.InContext},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),g.prototype.isShortCircuitStateChange=function(e){return e===d.InContextStatus.Expired||e===d.InContextStatus.InsufficientData||e===d.InContextStatus.ServerError||e===d.InContextStatus.Processing||e===d.InContextStatus.Loading},g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.SentMailStatsInContextCompute=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenMeetingActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(31)),s=o.__importDefault(n(986)),u=o.__importDefault(n(8)),l=o.__importDefault(n(26)),c=(r=a.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[s.default]},enumerable:!1,configurable:!0}),d.prototype.insightName=function(){return i.InsightName.ShortenMeetingActionableMessage},Object.defineProperty(d.prototype,"insightDomain",{get:function(){return l.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return u.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{shortenMeetingInsight:s.default.getState().shortenMeetingInsight()}},d.prototype.computeInsightInstances=function(e){return e.shortenMeetingInsight?[e.shortenMeetingInsight]:[]},Object.defineProperty(d.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.ShortenMeetingActionableMessageCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenMeetingActionableMessageStore=t.ShortenMeetingActionableMessageStoreState=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=n(83),u=n(5),l=(r=s.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"shortenMeetingInsight",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],c.prototype,"shortenMeetingInsight",null),c=o.__decorate([u.doop],c))
function c(){return null!==r&&r.apply(this,arguments)||this}t.ShortenMeetingActionableMessageStoreState=l
var d,p=(d=s.DataStreamStoreBase,o.__extends(f,d),f.prototype.getStoreLoggingName=function(){return"ShortenMeetingActionableMessageStore"},f.prototype.getInitialState=function(){return new l},f.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),f.prototype.processShortenMeetingFromActionableMessage=function(e,t){return e.shortenMeetingInsight(t.insight)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(a.default.GetShortenMeetingFromActionableMessage,e.processShortenMeetingFromActionableMessage),e}t.ShortenMeetingActionableMessageStore=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenMeetingCompute=void 0
var r,u=n(0),o=u.__importStar(n(13)),i=u.__importDefault(n(488)),a=u.__importDefault(n(389)),s=u.__importDefault(n(535)),l=u.__importStar(n(309)),c=u.__importDefault(n(988)),d=u.__importDefault(n(25)),p=u.__importDefault(n(37)),f=u.__importDefault(n(24)),g=u.__importDefault(n(8)),m=u.__importDefault(n(31)),h=u.__importDefault(n(6)),y=n(7),_=u.__importDefault(n(26)),S=u.__importDefault(n(57)),T=(r=m.default,u.__extends(I,r),Object.defineProperty(I.prototype,"storesToObserve",{get:function(){return[p.default]},enumerable:!1,configurable:!0}),I.prototype.insightName=function(){return o.InsightName.ShortenMeeting},Object.defineProperty(I.prototype,"insightDomain",{get:function(){return _.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"isInsightComputeEnabled",{get:function(){return g.default.isShortenMeetingInfobarEnabled},enumerable:!1,configurable:!0}),I.prototype.calculateState=function(e){return{isComposeAppointment:p.default.getState().isAppointmentOrMeeting()&&p.default.getState().isCompose(),meetingStartTime:p.default.getState().meetingStartTime(),meetingEndTime:p.default.getState().meetingEndTime(),requiredAttendees:p.default.getState().requiredAttendees(),optionalAttendees:p.default.getState().optionalAttendees(),recurrence:p.default.getState().recurrence(),isNewComposeMeeting:p.default.getState().isNewComposeMeeting()}},I.prototype.computeInsightInstances=function(e){if(!(e.isNewComposeMeeting&&e.isComposeAppointment&&(e.recurrence||e.meetingStartTime&&e.meetingEndTime)))return[]
var t=u.__spreadArrays(e.requiredAttendees||[],e.optionalAttendees||[]),n=this.getTotalUniqueMemberCount(t),r=this.getApplicableMeetingType(e,n)
if(r){var o=this.getMeetingLength(e),i=this.getTimeSavedInHours(e,o,1),a=this.getTimeSavedInHours(e,o,n-1)
if(i+a<1)return[]
var s=!0
return r===l.MeetingType.OneTimeGroup&&(s=this.allEmailAddressesResolved(t)),[{meetingStartTime:e.meetingStartTime,organizerTimeSaveInHours:i,attendeesTimeSaveInHours:a,meetingType:r,durationInHours:this.getMeetingLength(e),allEmailsResolved:s,identifier:{primaryId:"SHORTEN_MEETING_COMPUTE",secondaryId:S.default.sessionGuid},doesSupportNudgeFeedback:!0}]}return[]},I.prototype.getTimeSavedInHours=function(e,t,n){return t===y.Constants.oneHourInHours||t===y.Constants.threeQuarterHourInHours?e.recurrence?this.getNumOccurrences(e.recurrence)*n*l.ShortenMeetingConstants.TIME_SAVE_PER_MEETING_PER_PERSON_15_MINS:n*l.ShortenMeetingConstants.TIME_SAVE_PER_MEETING_PER_PERSON_15_MINS:t===y.Constants.halfHourInHours?e.recurrence?this.getNumOccurrences(e.recurrence)*n*l.ShortenMeetingConstants.TIME_SAVE_PER_MEETING_PER_PERSON_30_MINS:n*l.ShortenMeetingConstants.TIME_SAVE_PER_MEETING_PER_PERSON_30_MINS:0},I.prototype.getApplicableMeetingType=function(e,t){var n
if(t<2||this.isSameDayMeeting(e))return n
var r=[]
r.push(y.Constants.oneHourInHours),d.default.isInBackgroundMode||r.push(y.Constants.threeQuarterHourInHours)
var o=e.recurrence,i=this.getMeetingLength(e)
return o?0<=r.indexOf(i)&&(2===t?n=l.MeetingType.RecurringOneOnOne:2<t&&(n=l.MeetingType.RecurringGroup)):0<=r.indexOf(i)&&t>=l.ShortenMeetingConstants.MIN_PEOPLE_FOR_GROUP&&(n=l.MeetingType.OneTimeGroup),n},I.prototype.getMeetingLength=function(e){return e.recurrence?e.recurrence.seriesTime.getDuration()/y.Constants.oneHourInMinutes:(e.meetingEndTime.getTime()-e.meetingStartTime.getTime())/y.Constants.oneHourInMilliSeconds},I.prototype.isSameDayMeeting=function(e){var t=new Date,n=e.recurrence?new Date(e.recurrence.seriesTime.getStartDate()+e.recurrence.seriesTime.getStartTime()):e.meetingStartTime
return f.default.isSameDay(t,n)},I.prototype.getTotalUniqueMemberCount=function(e){var t=a.default(e,"emailAddress")
return h.default.sumElementsInArray(t,function(e){return 0<e.totalMemberCount?e.totalMemberCount:1})},I.prototype.allEmailAddressesResolved=function(e){return i.default(e,{totalMemberCount:0})<0},I.prototype.getNumOccurrences=function(e){var t,n,r,o=0,i=new Date(e.seriesTime.getStartDate()),a=f.default.addDays(i,27)
return e.seriesTime.getEndDate()&&(a=(t=new Date(e.seriesTime.getEndDate())).getTime()<a.getTime()?t:a),"daily"===e.recurrenceType?(n=e.recurrenceProperties,o=Math.ceil(f.default.getTotalDays(i,a)/n.interval)):"weekday"===e.recurrenceType?(r=[1,2,3,4,5],o=this.getTotalOccurrenceInTimeRange(i,a,r)):"weekly"===e.recurrenceType&&(r=(n=e.recurrenceProperties).days.map(function(e){return f.default.convertToDayOfWeek(e)}),o=this.getTotalOccurrenceInTimeRange(i,a,r,n.interval)),o},Object.defineProperty(I.prototype,"dismissExpirationInMilliseconds",{get:function(){return y.Constants.oneMonth},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"confirmationExpirationInMilliseconds",{get:function(){return y.Constants.fourteenDays},enumerable:!1,configurable:!0}),I.prototype.getTotalOccurrenceInTimeRange=function(e,t,n,r){void 0===r&&(r=1)
for(var o=f.default.getWeeksBetweenDates(e,t),i=0,a=0;a<o.length;a++)a%r==0&&(i+=s.default(n,o[a]).length)
return i},I)
function I(){return r.call(this,new c.default(o.InsightName.ShortenMeeting))||this}t.ShortenMeetingCompute=T,t.default=new T},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=o.__importDefault(n(394)),a=o.__importDefault(n(4)),s=o.__importDefault(n(57)),u=(r=i.default,o.__extends(l,r),l.prototype.shouldInstanceBeFilteredOut=function(e,t){var n=t.insightName,r=s.default.sessionGuid
return n?n===this.insightName&&r!==t.insightIdentifer.secondaryId:(a.default.logAssert("Missing insightName in actionLog item:["+JSON.stringify(t)+"].","InsightNamesAreEqualFilter","shouldInstanceBeFilteredOut"),!1)},l)
function l(e){return r.call(this,e)||this}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedFreeBlocksCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(91)),s=o.__importDefault(n(24)),u=o.__importDefault(n(153)),l=o.__importDefault(n(26)),c=o.__importDefault(n(31)),d=o.__importDefault(n(202)),p=o.__importDefault(n(201)),f=n(7),g=o.__importDefault(n(8)),m=(r=c.default,o.__extends(h,r),Object.defineProperty(h.prototype,"storesToObserve",{get:function(){return[a.default,u.default]},enumerable:!1,configurable:!0}),h.prototype.insightName=function(){return i.InsightName.SuggestedFreeBlocks},Object.defineProperty(h.prototype,"insightDomain",{get:function(){return l.default.Broadcast},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isInsightComputeEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),h.prototype.calculateState=function(e){return{hasLoadedCalendarItems:a.default.getState().hasLoadedCalendarItems(),workingHours:a.default.getState().workingHours(),freeBlocksWithinWorkingHours:a.default.getState().freeBlocksWithinWorkingHours(),hasLoadedFocusTimeSettings:u.default.getState().hasLoaded(),shouldEnableCalendarReminder:u.default.getState().shouldEnableCalendarReminder}},h.prototype.computeInsightInstances=function(e){var n=this
if(!e.hasLoadedCalendarItems||!e.workingHours)return[]
if(g.default.isFocusReminderSettingEnabled&&!e.hasLoadedFocusTimeSettings)return[]
var t=d.default.trimToMinuteMarker(e.freeBlocksWithinWorkingHours,f.Constants.halfHourInMinutes),t=d.default.filterByLength(t,f.Constants.halfHourInMilliSeconds)
t=d.default.segmentToMultipleBlocks(t,f.Constants.halfHourInMilliSeconds)
var r=new Date,o=p.default.buildWorkingHoursOverKWorkingDays(r,this.DAYS_TO_LOOK_AHEAD_FOR_FOCUS_TIME,e.workingHours),i={startDate:r,endDate:s.default.addHours(r,this.MIN_NUMBER_HOURS_FROM_NOW)}
return t=t.filter(function(t){return o.some(function(e){return d.default.isWithin(t,e)})&&!d.default.doesOverlap(t,i)}).sort(function(e,t){return n.freeBlocksCompareFunction(e,t)}),t=d.default.groupByDate(t).slice(0,this.MAX_SUGGESTED_BLOCKS_COUNT).map(function(e){return e.sortedTimeSlots[0]}),g.default.isFocusReminderSettingEnabled&&(t=d.default.addReminderSetting(t,e.shouldEnableCalendarReminder)),[{identifier:{primaryId:"SuggestedFreeBlocksInstance"},suggestedBlocks:t}]},h.prototype.freeBlocksCompareFunction=function(e,t){var n=e.startDate.getTime()-t.startDate.getTime()
if(s.default.isSameDay(e.startDate,t.startDate)){var r=this.isDuringLunchTime(e),o=this.isDuringLunchTime(t)
if(r&&o)return n
if(o)return-1
if(r)return 1}return n},h.prototype.isDuringLunchTime=function(e){var t=e.startDate.getHours()*f.Constants.oneHourInMinutes+e.startDate.getMinutes(),n=e.endDate.getHours()*f.Constants.oneHourInMinutes+e.endDate.getMinutes()
return t>=this.LUNCH_MINUTE_START&&t<this.LUNCH_MINUTE_END||n>this.LUNCH_MINUTE_START&&n<=this.LUNCH_MINUTE_END||t<=this.LUNCH_MINUTE_START&&n>=this.LUNCH_MINUTE_END},h)
function h(){var e=null!==r&&r.apply(this,arguments)||this
return e.DAYS_TO_LOOK_AHEAD_FOR_FOCUS_TIME=5,e.MAX_SUGGESTED_BLOCKS_COUNT=3,e.MIN_NUMBER_HOURS_FROM_NOW=2,e.LUNCH_MINUTE_START=11*f.Constants.oneHourInMinutes,e.LUNCH_MINUTE_END=14*f.Constants.oneHourInMinutes,e}t.SuggestedFreeBlocksCompute=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TasksCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(207)),l=o.__importStar(n(6)),c=n(7),d=o.__importDefault(n(26)),p=o.__importDefault(n(290)),f=o.__importDefault(n(120)),g=o.__importDefault(n(991)),m=o.__importDefault(n(64)),h=(r=s.default,o.__extends(y,r),Object.defineProperty(y.prototype,"storesToObserve",{get:function(){return[u.default,f.default,m.default]},enumerable:!1,configurable:!0}),y.prototype.insightName=function(){return i.InsightName.Tasks},Object.defineProperty(y.prototype,"insightDomain",{get:function(){return d.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isTaskInsightEnabled},enumerable:!1,configurable:!0}),y.prototype.calculateState=function(e){return{tasks:u.default.getState().taskInsights(),directReports:f.default.getState().directReports(),isManagerExperienceEnabled:m.default.isManagerExperienceEnabled()}},y.prototype.computeInsightInstances=function(e){var t=e.tasks.map(p.default.convertTaskInstanceToToDo)
return a.default.isManagerEffectivenessEnabled&&e.isManagerExperienceEnabled&&(t=g.default.augmentDirectReportTasks(t,e.directReports)),this.areTasksSortedAtServer()||(t=l.default.sortArrayOnKey(t,function(e){return e.sourceItem.dateTimeSent.getTime()},l.OrderBy.Descending)),this.getMappedTasks(t)},Object.defineProperty(y.prototype,"dismissExpirationInMilliseconds",{get:function(){return c.Constants.oneQuarterYear},enumerable:!1,configurable:!0}),y.prototype.areTasksSortedAtServer=function(){return a.default.isTaskInsightsWithRankingScoreEnabled},y.prototype.getMappedTasks=function(e){return e.map(function(e){return{identifier:{primaryId:e.entity.entityId},task:e}})},y)
function y(){var e=null!==r&&r.apply(this,arguments)||this
return e.MIN_CONFIDENCE_SCORE=.7,e}t.TasksCompute=h,t.default=new h},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=(o.augmentDirectReportTasks=function(e,t){return e.forEach(function(e){return e.isTargetPersonDirectReport=o.isTargetPersonDirectReport(e,t)}),e},o.isTargetPersonDirectReport=function(e,t){var n=e.targetPerson.smtpAddress.toLowerCase()
return t.map(function(e){return e.smtpAddress.toLowerCase()}).some(function(e){return n===e})},o)
function o(){}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DetectOOFComposingInfobarCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(37)),u=o.__importDefault(n(93)),l=o.__importDefault(n(26)),c=o.__importDefault(n(31)),d=o.__importDefault(n(179)),p=n(7),f=(r=c.default,o.__extends(g,r),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[s.default,u.default,d.default]},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(){return{timeAwayState:d.default.getState(),isComposeItem:!!s.default.asComposeItem(),insightData:u.default.getState().detectOOFComposingInfobarInsight()}},g.prototype.computeInsightInstances=function(e){return e.isComposeItem&&e.insightData&&e.timeAwayState.dataReady()&&!e.timeAwayState.dismissedAll()?[{identifier:{primaryId:"DetectOOFComposingInfobar"},insightText:e.insightData.insightText,actionText:e.insightData.actionText,startTime:e.insightData.startTime,endTime:e.insightData.endTime,doesSupportServerSideDislikeInsightAction:!0}]:[]},g.prototype.insightName=function(){return i.InsightName.DetectOOFComposingInfobar},Object.defineProperty(g.prototype,"insightDomain",{get:function(){return l.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isDetectOOFComposingInfobarEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"confirmationExpirationInMilliseconds",{get:function(){return p.Constants.oneDay},enumerable:!1,configurable:!0}),g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.DetectOOFComposingInfobarCompute=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEmailInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(37)),u=o.__importDefault(n(307)),l=o.__importDefault(n(93)),c=n(7),d=o.__importDefault(n(26)),p=(r=u.default,o.__extends(f,r),Object.defineProperty(f.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([s.default],this.getBaseStores())},enumerable:!1,configurable:!0}),f.prototype.calculateCurrentState=function(e){return{insightData:this.getInsightDataFromStoreState(l.default.getState())}},f.prototype.getInsightDataFromStoreState=function(e){return e.trackEmailInsight()},f.prototype.computeNudgeInstances=function(e){return this.isEmptyInsightFromState(e)?[]:[{insightId:e.insightData.insightId,suggestionAction:e.insightData.suggestionAction,identifier:e.insightData.identifier,isEligibleForExtendedStatistics:e.insightData.isEligibleForExtendedStatistics}]},f.prototype.insightName=function(){return i.InsightName.TrackEmail},Object.defineProperty(f.prototype,"insightDomain",{get:function(){return d.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isTrackEmailInfoBarEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"confirmationExpirationInMilliseconds",{get:function(){return c.Constants.fourteenDays},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"needTransitionLeavePage",{get:function(){return!0},enumerable:!1,configurable:!0}),f)
function f(){return null!==r&&r.apply(this,arguments)||this}t.TrackEmailInsightCompute=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PeopleCatchUpItemsCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),u=o.__importDefault(n(8)),a=o.__importDefault(n(37)),s=o.__importDefault(n(307)),l=o.__importDefault(n(93)),c=o.__importDefault(n(26)),d=o.__importDefault(n(207)),p=o.__importDefault(n(242)),f=o.__importDefault(n(290)),g=o.__importDefault(n(291)),m=o.__importDefault(n(204)),h=n(7),y=o.__importDefault(n(4)),_=o.__importDefault(n(6)),S=(r=s.default,o.__extends(T,r),Object.defineProperty(T.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([a.default,d.default,m.default,p.default],this.getBaseStores())},enumerable:!1,configurable:!0}),T.prototype.calculateCurrentState=function(e){return{tasks:d.default.getState().taskInsights(),followUpsFromTaskSuggestion:p.default.getState().taskInsights(),toRecipients:a.default.getState().toRecipientsInUserType(),insightData:this.getInsightDataFromStoreState(l.default.getState()),followUps:m.default.getState().entities(),completedFollowUps:m.default.getState().completedEntityIds()}},T.prototype.getInsightDataFromStoreState=function(e){return e.peopleCatchUpItemsInsight()},T.prototype.computeNudgeInstances=function(e){try{return this.computeInstances(e)}catch(e){y.default.logAssert("Unable to compute nudge instances. Error: ["+e.message+"]","PeopleCatchUpItemsCompute","computeNudgeInstances")}return[]},T.prototype.computeInstances=function(e){if(this.isEmptyInsightFromState(e)||1!==e.toRecipients.length||e.toRecipients.every(function(e){return e.emailAddress===_.default.userEmailLowerCase}))return[]
var t=e.insightData,n=t.followUps,n=u.default.isFollowUpsTaskSuggestionMigrationEnabled?f.default.filterTaskPresentInTaskStore(n,e.followUpsFromTaskSuggestion.map(g.default.convertTaskInstanceToFollowUp)):f.default.filterTaskPresentInTaskStore(n,e.followUps)
n=f.default.removeCompletedTasks(n,e.completedFollowUps)
var r=f.default.sortAndWrapTasksAsInstances(this.filterTasks(n,e),t),o=this.wrapInstancesAsInsights(r,this.getDataSources(this.storesToObserve)),i=t.commitments.concat(t.requests),i=f.default.filterTaskPresentInTaskStore(i,e.tasks.map(f.default.convertTaskInstanceToToDo)),a=f.default.sortAndWrapTasksAsInstances(this.filterTasks(i,e),t),s=this.wrapInstancesAsInsights(a,this.getDataSources(this.storesToObserve))
return 0===s.length&&0===o.length?[]:[{identifier:t.identifier,taskInsights:s,followUpInsights:o,targetPerson:t.targetPerson,doesSupportNudgeFeedback:t.doesSupportNudgeFeedback}]},T.prototype.filterTasks=function(e,t){var n=t.toRecipients[0].emailAddress.toLowerCase()
return e.filter(function(e){return e.targetPerson.smtpAddress.toLowerCase()===n})},T.prototype.insightName=function(){return i.InsightName.PeopleCatchUpItems},Object.defineProperty(T.prototype,"insightDomain",{get:function(){return c.default.Infobar},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"isInsightComputeEnabled",{get:function(){return u.default.isPeopleCatchUpItemsInfobarEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"confirmationExpirationInMilliseconds",{get:function(){return h.Constants.fourteenDays},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"needTransitionLeavePage",{get:function(){return!0},enumerable:!1,configurable:!0}),T)
function T(){return null!==r&&r.apply(this,arguments)||this}t.PeopleCatchUpItemsCompute=S,t.default=new S},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FollowUpRequestTasksCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),u=o.__importDefault(n(480)),l=o.__importDefault(n(8)),a=o.__importDefault(n(204)),s=o.__importDefault(n(31)),c=o.__importStar(n(6)),d=o.__importDefault(n(242)),p=n(7),f=n(66),g=o.__importDefault(n(26)),m=o.__importDefault(n(290)),h=o.__importDefault(n(291)),y=(r=s.default,o.__extends(_,r),Object.defineProperty(_.prototype,"storesToObserve",{get:function(){return[a.default,d.default]},enumerable:!1,configurable:!0}),_.prototype.insightName=function(){return i.InsightName.FollowUpRequestTasks},Object.defineProperty(_.prototype,"insightDomain",{get:function(){return g.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"isInsightComputeEnabled",{get:function(){return l.default.areFollowUpRequestTasksEnabled},enumerable:!1,configurable:!0}),_.prototype.calculateState=function(e){return{followUpsFromTaskSuggestion:d.default.getState().taskInsights(),followUpRequestTasks:a.default.getState().entities(),completedFollowUpRequestTaskIds:a.default.getState().completedEntityIds()}},_.prototype.computeInsightInstances=function(e){var t,o,i=this,a=[],s=e.completedFollowUpRequestTaskIds
return l.default.isFollowUpsTaskSuggestionMigrationEnabled?(t=e.followUpsFromTaskSuggestion.map(h.default.convertTaskInstanceToFollowUp),a=m.default.removeCompletedTasks(t,s)):(t=e.followUpRequestTasks,o={},t.forEach(function(e){var t=e.sourceItem.itemId.id,n=e.entity.description
o[t]=o[t]||{},o[t][n]=(o[t][n]||[]).concat(e)}),Object.keys(o).forEach(function(e){var r=o[e]
Object.keys(r).forEach(function(e){var t,n=r[e]
s.some(function(t){return n.some(function(e){return e.entity.entityId===t.entityId})})||(t=u.default(n,function(e){return i.isGreaterThanThreshold(e)}))&&(1<n.length&&(t.duplicateEntityIds=n.map(function(e){return e.entity.entityId}).filter(function(e){return e!==t.entity.entityId})),a.push(t))})})),c.default.sortArrayOnKey(a,function(e){return e.sourceItem.dateTimeSent.getTime()},c.OrderBy.Descending).map(function(e){return{identifier:{primaryId:e.entity.entityId},task:e}})},_.prototype.isGreaterThanThreshold=function(e){var t=e.followUpType===f.FollowUpType.ReplyFollowUp?this.REPLY_FOLLOWUP_MIN_CONFIDENCE_SCORE:this.ACTION_FOLLOWUP_MIN_CONFIDENCE_SCORE
return e.entity.confidenceScore>=t},Object.defineProperty(_.prototype,"dismissExpirationInMilliseconds",{get:function(){return p.Constants.fourteenDays},enumerable:!1,configurable:!0}),_)
function _(){var e=null!==r&&r.apply(this,arguments)||this
return e.ACTION_FOLLOWUP_MIN_CONFIDENCE_SCORE=.7,e.REPLY_FOLLOWUP_MIN_CONFIDENCE_SCORE=.9,e}t.FollowUpRequestTasksCompute=y,t.default=new y},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportUnreadMailCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(31)),s=o.__importDefault(n(298)),u=n(7),l=o.__importDefault(n(26)),c=o.__importDefault(n(8)),d=o.__importDefault(n(64)),p=o.__importDefault(n(120)),f=(r=a.default,o.__extends(g,r),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[s.default,d.default,p.default]},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return c.default.isManagerEffectivenessEnabled},enumerable:!1,configurable:!0}),g.prototype.insightName=function(){return i.InsightName.DirectReportUnreadMail},Object.defineProperty(g.prototype,"insightDomain",{get:function(){return l.default.Feed},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(e){return{unreadEmailItems:s.default.getState().unreadMail(),isManagerExperienceEnabled:d.default.isManagerExperienceEnabled(),directReports:p.default.getState().directReports()}},g.prototype.computeInsightInstances=function(e){return e.isManagerExperienceEnabled?e.unreadEmailItems.filter(function(t){return e.directReports.some(function(e){return e.smtpAddress.toLowerCase()===t.fromEmailAddress.toLowerCase()})}).map(function(e){return{identifier:{primaryId:e.itemId.id},unreadEmailItem:e}}):[]},Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return 15*u.Constants.oneDay},enumerable:!1,configurable:!0}),g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportUnreadMailCompute=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.CatchUpImportantMailCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(286)),u=o.__importDefault(n(118)),l=o.__importDefault(n(31)),c=o.__importStar(n(6)),d=o.__importDefault(n(998)),p=o.__importDefault(n(241)),f=n(7),g=o.__importDefault(n(26)),m=(r=l.default,o.__extends(h,r),Object.defineProperty(h.prototype,"storesToObserve",{get:function(){return[s.default,u.default,p.default]},enumerable:!1,configurable:!0}),h.prototype.insightName=function(){return i.InsightName.CatchUpImportantMail},Object.defineProperty(h.prototype,"insightDomain",{get:function(){return g.default.Feed},enumerable:!1,configurable:!0}),h.prototype.calculateState=function(e){return{unreadEmailItems:s.default.getState().unreadMail(),pinnedPeople:u.default.getState().sortedVIPs(),suggestedPeople:p.default.getState().relevantPeople(),irankerMailInstances:s.default.getState().irankerMailInstances()}},h.prototype.computeInsightInstances=function(e){var t=this
if(a.default.isIRankerInOneEngineEnabled&&e.irankerMailInstances)return c.default.dedupObjectArrayByKey(e.irankerMailInstances,function(e){return e.unreadEmailItem.conversationId},function(e){return e[0]})
if(0===e.unreadEmailItems.length)return[]
var n=e.unreadEmailItems.filter(function(e){return t.wasSentInComputeTimeRange(e.dateTimeSent)}),r=this.filterEmailItemsByPeople(n,e.pinnedPeople,e.suggestedPeople),o=c.default.sortArrayOnKey(r,function(e){return e.dateTimeSent.getTime()},c.OrderBy.Descending)
return c.default.dedupObjectArrayByKey(o,function(e){return e.conversationId},function(e){return e[0]}).map(function(e){return{identifier:{primaryId:e.conversationId,secondaryId:String(e.dateTimeSent.getTime())},unreadEmailItem:e}})},Object.defineProperty(h.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"dismissExpirationInMilliseconds",{get:function(){return 2*f.Constants.oneDay},enumerable:!1,configurable:!0}),h.prototype.filterEmailItemsByPeople=function(e,t,n){var r=t.map(function(e){return e.smtpAddress}),o=n.map(function(e){return e.smtpAddress})
return e.filter(function(e){return-1<r.indexOf(e.fromEmailAddress)||-1<o.indexOf(e.fromEmailAddress)})},h.prototype.wasSentInComputeTimeRange=function(e){var t=Date.now()
return e.getTime()<t-h.SEND_TIME_UPPER_BOUND&&e.getTime()>t-h.SEND_TIME_LOWER_BOUND},h.SEND_TIME_UPPER_BOUND=f.Constants.oneHourInMilliSeconds,h.SEND_TIME_LOWER_BOUND=7*f.Constants.oneDay,h)
function h(){return r.call(this,new d.default(i.InsightName.CatchUpImportantMail))||this}t.CatchUpImportantMailCompute=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r,o=n(0),i=o.__importDefault(n(394)),a=o.__importDefault(n(4)),s=(r=i.default,o.__extends(u,r),u.prototype.shouldInstanceBeFilteredOut=function(e,t){var n=t.insightIdentifer
return n?!n.primaryId&&!n.secondaryId||e.identifier.primaryId===n.primaryId&&e.identifier.secondaryId<=n.secondaryId:(a.default.logAssert("Missing insightIdentifier in actionLog item:["+JSON.stringify(t)+"].","IdentifiersAreEqualFilter","shouldInstanceBeFilteredOut"),!1)},u)
function u(e){return r.call(this,e)||this}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsInContextActionableMessageCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=n(208),s=o.__importDefault(n(31)),u=o.__importDefault(n(1e3)),l=o.__importDefault(n(397)),c=o.__importDefault(n(243)),d=o.__importDefault(n(26)),p=o.__importDefault(n(8)),f=(r=s.default,o.__extends(g,r),Object.defineProperty(g.prototype,"storesToObserve",{get:function(){return[u.default,l.default]},enumerable:!1,configurable:!0}),g.prototype.insightName=function(){return i.InsightName.SentMailStatsInContextActionableMessage},Object.defineProperty(g.prototype,"insightDomain",{get:function(){return d.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isInsightComputeEnabled",{get:function(){return p.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),g.prototype.calculateState=function(e){var t,n,r,o,i,a=u.default.getState().analyticsInstance()
return p.default.isExtendedSentMailStatsEnabled&&null!==(t=null==a?void 0:a.analytics)&&void 0!==t&&t.extendedStatistics&&(i=null===(o=null===(r=null===(n=l.default.getState().analytics())||void 0===n?void 0:n.analytics)||void 0===r?void 0:r.extendedStatistics)||void 0===o?void 0:o.extendedReadRateStatistics,a.analytics.extendedStatistics.extendedReadRateStatistics=i),{messageAnalyticsInstance:a,documentAnalytics:l.default.getState().documentAnalytics()}},g.prototype.computeInsightInstances=function(e){var t=e.messageAnalyticsInstance
if(!t)return[]
var n=c.default.areMessageReadsStable(t)
return[{identifier:e.messageAnalyticsInstance.identifier,doesSupportNudgeFeedback:e.messageAnalyticsInstance.doesSupportNudgeFeedback,doesSupportServerSideDislikeInsightAction:e.messageAnalyticsInstance.doesSupportServerSideDislikeInsightAction,messageStatus:a.InContextStatus.Ok,messageAnalytics:t,documentAnalytics:e.documentAnalytics,areStatisticsStable:n}]},Object.defineProperty(g.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),g)
function g(){return null!==r&&r.apply(this,arguments)||this}t.SentMailStatsInContextActionableMessageCompute=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsInContextActionableMessageStore=t.State=void 0
var r,o=n(0),i=o.__importStar(n(15)),a=o.__importDefault(n(3)),s=o.__importStar(n(83)),u=n(5),l=(r=s.DataStreamStoreStateBase,o.__extends(c,r),Object.defineProperty(c.prototype,"analyticsInstance",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),o.__decorate([u.doop],c.prototype,"analyticsInstance",null),c=o.__decorate([u.doop],c))
function c(){return r.call(this)||this}t.State=l
var d,p=(d=s.default,o.__extends(f,d),f.prototype.getStoreLoggingName=function(){return"SentMailStatsInContextActionableMessageStore"},f.prototype.getInitialState=function(){return new l},f.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(f.prototype,"wellKnownDataSourceType",{get:function(){return i.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),f.prototype.processSentMailStatsInContextFromActionableMessage=function(e,t){return e.analyticsInstance(t.messageAnalyticsInstance)},f)
function f(){var e=d.call(this)||this
return e.addActionCallback(a.default.GetToSentMailStatsInContextFromActionableMessage,e.processSentMailStatsInContextFromActionableMessage),e}t.SentMailStatsInContextActionableMessageStore=p,t.default=new p},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentsToCatchupInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(150)),s=o.__importDefault(n(8)),u=o.__importDefault(n(31)),l=o.__importDefault(n(300)),c=o.__importDefault(n(26)),d=o.__importDefault(n(120)),p=o.__importDefault(n(64)),f=o.__importDefault(n(2)),g=(r=u.default,o.__extends(m,r),Object.defineProperty(m.prototype,"storesToObserve",{get:function(){return[l.default,d.default]},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isInsightComputeEnabled",{get:function(){return s.default.isDocumentsToCatchupEnabled},enumerable:!1,configurable:!0}),m.prototype.calculateState=function(e){return{documentsToCatchupInsights:l.default.getState().documentsToCatchupInsights(),directReports:d.default.getState().directReports(),isManagerExperienceEnabled:p.default.isManagerExperienceEnabled()}},m.prototype.computeInsightInstances=function(t){var n=this,e=t.documentsToCatchupInsights
return(e=(e=e.filter(function(e){return!a.default(e.itemId)})).sort(function(e,t){return t.attachedDocuments[0].relevancyScore-e.attachedDocuments[0].relevancyScore!=0?t.attachedDocuments[0].relevancyScore-e.attachedDocuments[0].relevancyScore:t.attachedDocuments[0].lastSharedTime.getTime()-e.attachedDocuments[0].lastSharedTime.getTime()})).map(function(e){return n.computeIndividualDocumentsToCatchupInsight(t,e)})},m.prototype.computeIndividualDocumentsToCatchupInsight=function(e,t){return t.doesSupportNudgeFeedback=!1,t.subject||(t.subject=f.default.DOCUMENTS_TO_CATCHUP_DEFAULT_SUBJECT()),s.default.isManagerEffectivenessEnabled&&e.directReports&&e.isManagerExperienceEnabled&&(t.isSharedByDirectReport=e.directReports.some(function(e){return e.smtpAddress.toLowerCase()===t.sharedByUser.smtpAddress.toLowerCase()})),t},m.prototype.insightName=function(){return i.InsightName.DocumentsToCatchup},Object.defineProperty(m.prototype,"insightDomain",{get:function(){return c.default.Feed},enumerable:!1,configurable:!0}),m)
function m(){return null!==r&&r.apply(this,arguments)||this}t.DocumentsToCatchupInsightCompute=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusOutcomeCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(178)),l=o.__importDefault(n(26)),c=n(7),d=(r=s.default,o.__extends(p,r),p.prototype.insightName=function(){return i.InsightName.FocusOutcome},Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[u.default]},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{isFocusOutcomeEnrolled:u.default.getState().isFocusOutcomeEnrolled(),wasOutcomeAPISuccessful:u.default.getState().wasOutcomeAPISuccessful()}},Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isOutcomeEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"insightDomain",{get:function(){return l.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"dismissExpirationInMilliseconds",{get:function(){return c.Constants.oneMonth},enumerable:!1,configurable:!0}),p.prototype.computeInsightInstances=function(e){return!1===e.isFocusOutcomeEnrolled&&e.wasOutcomeAPISuccessful?[{identifier:{primaryId:"FocusOutcome"}}]:[]},p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.FocusOutcomeCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DaysToBookInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(398)),u=o.__importDefault(n(308)),l=o.__importDefault(n(396)),c=o.__importDefault(n(178)),d=o.__importDefault(n(26)),p=o.__importStar(n(6)),f=o.__importDefault(n(536)),g=o.__importDefault(n(153)),m=o.__importDefault(n(154)),h=o.__importDefault(n(369)),y=n(107),_=(r=l.default,o.__extends(S,r),Object.defineProperty(S.prototype,"storesToObserve",{get:function(){return o.__spreadArrays([s.default,u.default,c.default,f.default,g.default],this.getBaseStores())},enumerable:!1,configurable:!0}),S.prototype.computeInsightInstances=function(t){var n=this
if(this.suppressInsight(t))return[]
if(a.default.isFocusReminderSettingEnabled&&!t.hasLoadedFocusTimeSettings)return[]
var e=h.default(t.insights)
return a.default.isFocusReminderSettingEnabled&&e.forEach(function(e){e.freeBlocks.forEach(function(e){e.isReminderOn=t.shouldEnableCalendarReminder})}),e.map(function(e){return n.sortFreeBlocksByDate(e)})},S.prototype.insightName=function(){return i.InsightName.DaysToBook},Object.defineProperty(S.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isOutcomeEnabled},enumerable:!1,configurable:!0}),S.prototype.calculateCurrentState=function(e){var t=!!e&&e.isProtectedTimeBooked
return{insights:s.default.getState().focusInsights(),bookedFocusBlocks:u.default.getState().editedBlocks().filter(function(e){return e.isBooked}),isFocusOutcomeEnrolled:c.default.getState().isFocusOutcomeEnrolled(),isProtectedTimeBooked:t||f.default.getState().isBookingComplete(),hasLoadedFocusTimeSettings:g.default.getState().hasLoaded(),shouldEnableCalendarReminder:g.default.getState().shouldEnableCalendarReminder}},S.prototype.mergeNewStateWhenFrozen=function(e,t){var n=o.__assign({},t)
return n.bookedFocusBlocks=e.bookedFocusBlocks,this.isInFocusPlanEnrollmentConfirmation()&&(n.bookedFocusBlocks=[]),n},S.prototype.shouldFreezeDetailPage=function(e,t){return!0},Object.defineProperty(S.prototype,"insightDomain",{get:function(){return d.default.Feed},enumerable:!1,configurable:!0}),S.prototype.isInDetailPage=function(){return r.prototype.isInDetailPage.call(this)||this.isInFocusPlanEnrollmentConfirmation()},S.prototype.isInFocusPlanEnrollmentConfirmation=function(){return m.default.getState().activeRoute().routeName===y.Routes.FocusPlanEnrollmentConfirmation},S.prototype.sortFreeBlocksByDate=function(e){var t=p.default.sortArrayOnKey(e.freeBlocks,function(e){return e.startDate.getTime()},p.OrderBy.Ascending)
return o.__assign(o.__assign({},e),{freeBlocks:t})},S.prototype.suppressInsight=function(e){return!e.isFocusOutcomeEnrolled||0<e.bookedFocusBlocks.length||e.isProtectedTimeBooked},S)
function S(){return null!==r&&r.apply(this,arguments)||this}t.DaysToBookInsightCompute=_,t.default=new _},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportBookOneOnOneInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(31)),s=o.__importDefault(n(26)),u=o.__importDefault(n(8)),l=o.__importDefault(n(302)),c=o.__importDefault(n(537)),d=o.__importDefault(n(37)),p=o.__importDefault(n(64)),f=o.__importDefault(n(120)),g=o.__importDefault(n(91)),m=(r=a.default,o.__extends(h,r),Object.defineProperty(h.prototype,"storesToObserve",{get:function(){return[l.default,p.default,f.default,g.default,d.default]},enumerable:!1,configurable:!0}),h.prototype.insightName=function(){return i.InsightName.DirectReportBookOneOnOne},Object.defineProperty(h.prototype,"insightDomain",{get:function(){return s.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isInsightComputeEnabled",{get:function(){return u.default.isBookOneOnOneEnabled},enumerable:!1,configurable:!0}),h.prototype.calculateState=function(e){return{isReadingOrContextless:d.default.getState().isReading()||d.default.getState().isContextless(),bookOneOnOneInsights:l.default.getState().bookOneOnOneInsights(),actedOnInsightIds:l.default.getState().actedOnInsightIds(),isManagerExperienceEnabled:p.default.isManagerExperienceEnabled(),directReports:f.default.getState().directReports(),freeSlotsInWorkingHours:g.default.getState().freeBlocksWithinWorkingHours()}},h.prototype.computeInsightInstances=function(t){var n=this
return t.bookOneOnOneInsights&&t.isManagerExperienceEnabled&&t.isReadingOrContextless?t.bookOneOnOneInsights.filter(function(e){return n.validateBookOneOnOneActions(e)&&n.validateBookOneOnOneInsight(t.directReports,e)}).map(function(e){return n.buildBookOneOnOneInsight(e,t)}):[]},h.prototype.validateBookOneOnOneActions=function(e){return!(!e.bookOneOnOneActions||!e.bookOneOnOneActions.every(function(e){return!!e})||0===e.bookOneOnOneActions.length)},h.prototype.validateBookOneOnOneInsight=function(e,t){return e.some(function(e){return e.smtpAddress.toLowerCase()===t.smtpAddress.toLowerCase()})},h.prototype.buildBookOneOnOneInsight=function(t,e){var n=e.actedOnInsightIds.some(function(e){return e===t.identifier.primaryId})
return{identifier:t.identifier,directReport:{name:t.displayName,smtpAddress:t.smtpAddress},weeklySlots:c.default.getWeeklySlotsFromActionItems(t.bookOneOnOneActions,e.freeSlotsInWorkingHours),actedUpOn:n}},h)
function h(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportBookOneOnOneInsightCompute=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DirectReportConflictingOneOnOneInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(31)),s=o.__importDefault(n(26)),u=o.__importDefault(n(8)),l=o.__importDefault(n(301)),c=o.__importDefault(n(537)),d=o.__importDefault(n(64)),p=o.__importDefault(n(120)),f=o.__importDefault(n(91)),g=(r=a.default,o.__extends(m,r),Object.defineProperty(m.prototype,"storesToObserve",{get:function(){return[l.default,d.default,p.default,f.default]},enumerable:!1,configurable:!0}),m.prototype.insightName=function(){return i.InsightName.DirectReportConflictingOneOnOne},Object.defineProperty(m.prototype,"insightDomain",{get:function(){return s.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"isInsightComputeEnabled",{get:function(){return u.default.isManagerEffectivenessEnabled},enumerable:!1,configurable:!0}),m.prototype.calculateState=function(e){return{conflictingOneOnOneInsights:l.default.getState().conflictingOneOnOneInsights(),actedOnInsightIds:l.default.getState().actedOnInsightIds(),isManagerExperienceEnabled:d.default.isManagerExperienceEnabled(),directReports:p.default.getState().directReports(),freeSlotsInWorkingHours:f.default.getState().freeBlocksWithinWorkingHours()}},m.prototype.computeInsightInstances=function(t){var n=this
return t.conflictingOneOnOneInsights&&t.isManagerExperienceEnabled?t.conflictingOneOnOneInsights.filter(function(e){return n.validateConflictingOneOnOneActions(e)&&n.validateConflictingOneOnOneInsight(t.directReports,e)}).map(function(e){return n.buildConflictingOneOnOneInsight(e,t)}):[]},m.prototype.validateConflictingOneOnOneActions=function(e){return!(!e.conflictingActions||!e.conflictingActions.every(function(e){return!!e})||0===e.conflictingActions.length)},m.prototype.validateConflictingOneOnOneInsight=function(e,t){return e.some(function(e){return e.smtpAddress.toLowerCase()===t.smtpAddress.toLowerCase()})},m.prototype.buildConflictingOneOnOneInsight=function(t,e){var n=e.actedOnInsightIds.some(function(e){return e===t.identifier.primaryId})
return{identifier:t.identifier,directReport:{smtpAddress:t.smtpAddress,name:t.displayName},meetingId:t.meetingId,meetingTimeRange:{startDate:new Date(t.meetingStartTime),endDate:new Date(t.meetingEndTime)},weeklySlots:c.default.getWeeklySlotsFromActionItems(t.conflictingActions,e.freeSlotsInWorkingHours),actedUpOn:n}},m)
function m(){return null!==r&&r.apply(this,arguments)||this}t.DirectReportConflictingOneOnOneInsightCompute=g,t.default=new g},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LunchSettingsAdvertCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(538)),l=o.__importDefault(n(91)),c=o.__importDefault(n(26)),d=n(7),p=o.__importDefault(n(306)),f=o.__importDefault(n(24)),g=o.__importDefault(n(399)),m=(r=s.default,o.__extends(h,r),h.prototype.insightName=function(){return i.InsightName.LunchSettingsAdvert},Object.defineProperty(h.prototype,"storesToObserve",{get:function(){return[p.default,l.default,u.default]},enumerable:!1,configurable:!0}),h.prototype.calculateState=function(e){return{editedStartMinute:u.default.getState().lunchStartMinute(),editedEndMinute:u.default.getState().lunchEndMinute(),editedCheckboxState:u.default.getState().isCheckboxChecked(),workingHours:l.default.getState().workingHours(),storedCheckboxState:p.default.getState().shouldBookRecurringAppointment(),lastLunchModifiedTime:p.default.getState().lastModifiedTime(),recurringAppointmentIdentifier:p.default.getState().recurringAppointmentIdentifier(),isAwaitingServerResponse:u.default.getState().isAwaitingServerResponse()}},Object.defineProperty(h.prototype,"isInsightComputeEnabled",{get:function(){return a.default.areFeedInsightsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"insightDomain",{get:function(){return c.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"dismissExpirationInMilliseconds",{get:function(){return d.Constants.oneMonth},enumerable:!1,configurable:!0}),h.prototype.computeInsightInstances=function(e){var t,n,r,o,i,a,s=!!e.workingHours&&!!e.lastLunchModifiedTime,u=null===(t=e.storedCheckboxState)||void 0===t||t
return!s||this.didUserModifySettings(e.lastLunchModifiedTime)||g.default.hasNonStandardWorkingHours(f.default.getMinutesSinceStartOfDay(e.workingHours.workingHoursTimeBlock.startDate),f.default.getMinutesSinceStartOfDay(e.workingHours.workingHoursTimeBlock.endDate))?[]:[{identifier:{primaryId:"LunchSettingsAdvert"},isCheckboxChecked:null!==(n=e.editedCheckboxState)&&void 0!==n?n:u,recurringAppointmentIdentifier:e.recurringAppointmentIdentifier,startMinute:null!==(r=e.editedStartMinute)&&void 0!==r?r:p.default.getState().startMinute(),endMinute:null!==(o=e.editedEndMinute)&&void 0!==o?o:p.default.getState().endMinute(),workingDaysSundayStart:null===(i=e.workingHours)||void 0===i?void 0:i.workingDays.workingDaysSundayStart,workingHourTimeZone:null===(a=e.workingHours)||void 0===a?void 0:a.timeZoneInMinute,isAwaitingServerResponse:e.isAwaitingServerResponse}]},h.prototype.didUserModifySettings=function(e){return e.getTime()>this.DEFAULT_LAST_MODIFIED_TIME.getTime()},h)
function h(){var e=null!==r&&r.apply(this,arguments)||this
return e.DEFAULT_LAST_MODIFIED_TIME=new Date("0001-01-01"),e}t.LunchSettingsAdvertCompute=m,t.default=new m},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TimeAwayCompute=void 0
var r,i=n(0),a=i.__importStar(n(58)),s=i.__importDefault(n(8)),o=i.__importDefault(n(31)),u=i.__importDefault(n(26)),l=i.__importDefault(n(179)),c=i.__importDefault(n(539)),d=i.__importDefault(n(54)),p=i.__importDefault(n(37)),f=i.__importDefault(n(153)),g=i.__importDefault(n(540)),m=i.__importDefault(n(6)),h=n(7),y=n(13),_=(r=o.default,i.__extends(S,r),S.prototype.insightName=function(){return y.InsightName.TimeAway},Object.defineProperty(S.prototype,"storesToObserve",{get:function(){return[l.default,c.default,p.default,f.default]},enumerable:!1,configurable:!0}),S.prototype.calculateState=function(e){return{isReadingOrContextless:p.default.getState().isReading()||p.default.getState().isContextless(),timeAwayState:l.default.getState(),activeContacts:c.default.getState().activeNetworkContacts(),isGetActiveContactsSuccess:c.default.getState().isGetActiveContactsSuccess(),focusTimeSettingsHasLoaded:f.default.getState().hasLoaded(),shouldEnableCalendarReminder:f.default.getState().shouldEnableCalendarReminder}},Object.defineProperty(S.prototype,"isInsightComputeEnabled",{get:function(){return s.default.isTimeAwayPreparationEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"insightDomain",{get:function(){return u.default.Feed},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"dismissExpirationInMilliseconds",{get:function(){return h.Constants.oneYear},enumerable:!1,configurable:!0}),S.prototype.computeInsightInstances=function(e){var t=e.timeAwayState,n=[]
return this.isDataReady(e)&&!t.dismissedAll()&&(n.push(this.getScheduleTimeAwayInstance(t)),n.push(this.getSetAutoReplyInstance(t)),d.default.doesSupportNewMessageForm&&e.isReadingOrContextless&&n.push(this.getNotifyContactsInstance(t,e.activeContacts,e.isGetActiveContactsSuccess)),n.push(this.getResolveMeetingsInstance(t)),n.push(this.getScheduleFocusTimeInstance(t,e.shouldEnableCalendarReminder))),n},S.prototype.isDataReady=function(e){return s.default.isFocusReminderSettingEnabled?e.timeAwayState.dataReady()&&e.focusTimeSettingsHasLoaded:e.timeAwayState.dataReady()},S.prototype.getScheduleTimeAwayInstance=function(e){var t=e.timeAwayType(),n=e.id()
return e.shouldShowCustomFeedCard||e.isConfirmed()||(n=a.UNSCHEDULED_TIME_AWAY_ID,t!==a.TimeAwayType.NudgeDetected&&(t=a.TimeAwayType.Adhoc)),{identifier:{primaryId:n,secondaryId:a.TimeAwayPreparationTaskNames.ScheduleTimeAway},startTime:e.startTime(),endTime:e.endTime(),isConfirmed:e.isConfirmed(),timeAwayType:t,createdTime:e.createdTime(),singleTaskStatus:e.preparation().scheduleTimeAwayStatus,holidayName:e.holidayName(),bookTime:e.bookTime(),confirmTime:e.confirmTime(),timeAwayMessageSentTime:e.timeAwayMessageSentTime(),doesSupportServerSideDislikeInsightAction:!1,shouldShowCustomFeedCard:e.shouldShowCustomFeedCard,holidayCardLoadHistory:e.holidayCardLoadHistory(),expandStatus:!e.isConfirmed()||this.getExpandStatus(e,a.TimeAwayPreparationTaskNames.ScheduleTimeAway)}},S.prototype.getSetAutoReplyInstance=function(e){return i.__assign(i.__assign({},this.getOptionalTaskInstance(e,a.TimeAwayPreparationTaskNames.SetAutoReply,this.getSetAutoReplyStatus(e))),{autoReplySettings:e.automaticRepliesSetting()})},S.prototype.getNotifyContactsInstance=function(e,t,n){return i.__assign(i.__assign({},this.getOptionalTaskInstance(e,a.TimeAwayPreparationTaskNames.NotifyContacts,e.preparation().notifyContactsStatus)),{activeContacts:t.map(function(e){return{name:e.Contact.DisplayName,smtpAddress:e.Contact.PrimarySmtpAddress}}),isErrorState:!n})},S.prototype.getResolveMeetingsInstance=function(e){var t,n
return i.__assign(i.__assign({},this.getOptionalTaskInstance(e,a.TimeAwayPreparationTaskNames.ResolveMeetings,e.preparation().resolveMeetingsStatus)),{meetingsDuringTimeAway:e.isConfirmed?m.default.dedupObjectArrayByKey((null!==(t=e.meetingsDuringTimeAway1stBatch())&&void 0!==t?t:[]).concat(null!==(n=e.meetingsDuringTimeAway2ndBatch())&&void 0!==n?n:[]),function(e){return e.id},function(e){return e[0]}):[],deletedMeetingsCount:e.deletedMeetingsCount()})},S.prototype.getScheduleFocusTimeInstance=function(e,t){var n,r,o=i.__assign(i.__assign({},this.getOptionalTaskInstance(e,a.TimeAwayPreparationTaskNames.ScheduleCatchUpTime,e.preparation().scheduleCatchUpTimeStatus)),{protectedTimeBeforeTimeAway:null!==(n=e.protectedTimeBeforeTimeAway())&&void 0!==n?n:[],protectedTimeAfterTimeAway:null!==(r=e.protectedTimeAfterTimeAway())&&void 0!==r?r:[]})
return s.default.isFocusReminderSettingEnabled&&(o.protectedTimeBeforeTimeAway=this.updateProtectedTimeCalendarReminderProperties(o.protectedTimeBeforeTimeAway,t),o.protectedTimeAfterTimeAway=this.updateProtectedTimeCalendarReminderProperties(o.protectedTimeAfterTimeAway,t)),o},S.prototype.updateProtectedTimeCalendarReminderProperties=function(e,t){return e.map(function(e){return i.__assign(i.__assign({},e),{IsReminderOn:t})})},S.prototype.getOptionalTaskInstance=function(e,t,n){return{identifier:{primaryId:e.id(),secondaryId:t},startTime:e.startTime(),endTime:e.endTime(),singleTaskStatus:n,isConfirmed:e.isConfirmed(),doesSupportServerSideDislikeInsightAction:!1,expandStatus:this.getExpandStatus(e,t)}},S.prototype.getSetAutoReplyStatus=function(e){return this.isAutoReplyRangeAlignedWithSettings(e)&&e.preparation().setAutoReplyStatus===a.TimeAwayTaskStatus.NotCompleted?a.TimeAwayTaskStatus.Done:e.preparation().setAutoReplyStatus},S.prototype.isAutoReplyRangeAlignedWithSettings=function(e){return e.isConfirmed()&&g.default.checkIfTimeAwayAndAutoReplyRangeMatch(e.startTime(),e.endTime(),e.automaticRepliesSetting())},S.prototype.getExpandStatus=function(e,t){var n
return null!==(n=e.expandStatus().get(t))&&void 0!==n&&n},S)
function S(){return null!==r&&r.apply(this,arguments)||this}t.TimeAwayCompute=_,t.default=new _},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SmartRulesSuggestionInsightCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(8)),s=o.__importDefault(n(31)),u=o.__importDefault(n(26)),l=o.__importDefault(n(303)),c=o.__importDefault(n(304)),d=(r=s.default,o.__extends(p,r),Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[l.default,c.default]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return a.default.isSmartRulesSuggestionEnabled},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{smartRulesSuggestionInsights:l.default.getState().smartRulesSuggestionInsights(),mailFolders:c.default.getState().mailFolders()}},p.prototype.computeInsightInstances=function(t){return t.smartRulesSuggestionInsights.forEach(function(e){e.mailFolders=t.mailFolders}),t.smartRulesSuggestionInsights.filter(function(e){return!(0<e.messageRulePredicates.fromAddresses.length&&0<e.messageRulePredicates.sentToAddresses.length)})},p.prototype.insightName=function(){return i.InsightName.SmartRulesSuggestion},Object.defineProperty(p.prototype,"insightDomain",{get:function(){return u.default.Feed},enumerable:!1,configurable:!0}),p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.SmartRulesSuggestionInsightCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.TeamsGroupSuggestionCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(26)),s=o.__importDefault(n(31)),u=o.__importDefault(n(400)),l=o.__importDefault(n(8)),c=(r=s.default,o.__extends(d,r),Object.defineProperty(d.prototype,"storesToObserve",{get:function(){return[u.default]},enumerable:!1,configurable:!0}),d.prototype.calculateState=function(e){return{teamsGroupSuggestions:u.default.getState().teamsGroupSuggestionInsights()}},d.prototype.computeInsightInstances=function(e){return e.teamsGroupSuggestions},d.prototype.insightName=function(){return i.InsightName.TeamsGroupSuggestion},Object.defineProperty(d.prototype,"isInsightComputeEnabled",{get:function(){return l.default.isTeamsGroupSuggestionInsightEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"insightDomain",{get:function(){return a.default.Feed},enumerable:!1,configurable:!0}),d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.TeamsGroupSuggestionCompute=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedTasksActionableMessageCompute=void 0
var r,o=n(0),i=o.__importDefault(n(1011)),a=o.__importStar(n(13)),s=o.__importDefault(n(31)),u=o.__importDefault(n(8)),l=o.__importDefault(n(26)),c=o.__importDefault(n(530)),d=(r=s.default,o.__extends(p,r),Object.defineProperty(p.prototype,"storesToObserve",{get:function(){return[i.default]},enumerable:!1,configurable:!0}),p.prototype.calculateState=function(e){return{suggestedTasksInsight:i.default.getState().suggestedTasksInsight(),notTaskIds:i.default.getState().notTaskIds(),completedTaskIds:i.default.getState().completedTaskIds()}},p.prototype.computeInsightInstances=function(e){if(e.suggestedTasksInsight){var t=e.suggestedTasksInsight,n=this.filterActedUponTasks(e)
return 0===n.length?[]:(t.tasks=n,[t])}return[]},p.prototype.insightName=function(){return a.InsightName.SuggestedTasksActionableMessage},Object.defineProperty(p.prototype,"insightDomain",{get:function(){return l.default.ActionableMessage},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isInsightComputeEnabled",{get:function(){return u.default.areActionableMessagesEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"dismissExpirationInMilliseconds",{get:function(){return 0},enumerable:!1,configurable:!0}),p.prototype.filterActedUponTasks=function(e){var t=e.notTaskIds.concat(e.completedTaskIds),n=e.suggestedTasksInsight.tasks
return c.default(n,t,function(e,t){return e.todoEntityId===t})},p)
function p(){return null!==r&&r.apply(this,arguments)||this}t.SuggestedTasksActionableMessageCompute=d,t.default=new d},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedTasksActionableMessageStore=t.StoreState=void 0
var r,o,i=n(0),a=i.__importStar(n(15)),s=i.__importDefault(n(3)),u=n(5),l=n(114),c=(r=l.LoadableDataStreamStateBase,i.__extends(d,r),o=d,Object.defineProperty(d.prototype,"suggestedTasksInsight",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"notTaskIds",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"completedTaskIds",{get:function(){return u.doop()},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(e){return(new o).suggestedTasksInsight(e.suggestedTasksInsight).notTaskIds(e.notTaskIds).completedTaskIds(e.completedTaskIds)},i.__decorate([u.doop],d.prototype,"suggestedTasksInsight",null),i.__decorate([u.doop],d.prototype,"notTaskIds",null),i.__decorate([u.doop],d.prototype,"completedTaskIds",null),d=o=i.__decorate([u.doop],d))
function d(){var e=r.call(this)||this
return e.notTaskIds([]),e.completedTaskIds([]),e}t.StoreState=c
var p,f=(p=l.LoadableDataStreamStoreBase,i.__extends(g,p),g.prototype.getStoreLoggingName=function(){return"SuggestedTasksActionableMessageStore"},g.prototype.getInitialState=function(){return new c},g.prototype.setStateForItemChangedEvent=function(e,t){return e},Object.defineProperty(g.prototype,"wellKnownDataSourceType",{get:function(){return a.WellKnownDataSources.ActionableMessage},enumerable:!1,configurable:!0}),g.prototype.processActionableMessageInsight=function(e,t){return e.suggestedTasksInsight(t.insight)},g.prototype.processMarkAsDone=function(e,t){return e.completedTaskIds(this.upsertTaskId(e.completedTaskIds(),t.toDoEntityId))},g.prototype.processMarkAsNotATask=function(e,t){return e.notTaskIds(this.upsertTaskId(e.notTaskIds(),t.toDoEntityId))},g.prototype.upsertTaskId=function(e,t){return e.some(function(e){return e===t})?e:e.concat([t])},g.prototype.processPromoteTask=function(e,t){var n=e.suggestedTasksInsight()
if(n){var r=n.tasks.map(function(e){return e.todoEntityId===t.toDoEntityId&&(e.hasTaskBeenPromoted=!0,e.promotedTaskLink=t.promotedTaskLink),e})
return n.tasks=r,e.suggestedTasksInsight(n)}return e},g)
function g(){var e=p.call(this)||this
return e.addActionCallback(s.default.GetSuggestedTasksFromActionableMessage,e.processActionableMessageInsight),e.addActionCallback(s.default.MarkTaskAsDoneAction,e.processMarkAsDone),e.addActionCallback(s.default.MarkFollowUpAsDone,e.processMarkAsDone),e.addActionCallback(s.default.MarkAsNotATaskAction,e.processMarkAsNotATask),e.addActionCallback(s.default.MarkAsNotAFollowUp,e.processMarkAsNotATask),e.addActionCallback(s.default.PromoteTaskAction,e.processPromoteTask),e.addActionCallback(s.default.PromoteFollowUpAction,e.processPromoteTask),e}t.SuggestedTasksActionableMessageStore=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AutoDelayDeliveryAdvertisementCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(26)),s=o.__importDefault(n(541)),u=(r=s.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.AutoDelayDeliveryAdvertisement},Object.defineProperty(l.prototype,"insightDomain",{get:function(){return a.default.Broadcast},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.AutoDelayDeliveryAdvertisementCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.DelayDeliveryAdvertFeedCompute=void 0
var r,o=n(0),i=o.__importStar(n(13)),a=o.__importDefault(n(26)),s=o.__importDefault(n(541)),u=(r=s.default,o.__extends(l,r),l.prototype.insightName=function(){return i.InsightName.DelayDeliveryAdvertFeed},Object.defineProperty(l.prototype,"insightDomain",{get:function(){return a.default.Feed},enumerable:!1,configurable:!0}),l)
function l(){return null!==r&&r.apply(this,arguments)||this}t.DelayDeliveryAdvertFeedCompute=u,t.default=new u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.InfobarFactory=void 0
var s=n(0),r=s.__importDefault(n(134)),o=s.__importDefault(n(3)),i=s.__importDefault(n(235)),a=s.__importDefault(n(11)),u=s.__importDefault(n(543)),l=s.__importDefault(n(196)),c=s.__importDefault(n(548)),d=s.__importDefault(n(547)),p=s.__importDefault(n(55)),f=s.__importDefault(n(2)),g=s.__importStar(n(4)),m=n(364),h=n(276),y=s.__importDefault(n(62)),_=s.__importDefault(n(57)),S=s.__importDefault(n(6)),T=(I.prototype.updateInfobar=function(t){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return t?[2,this.renderInfobarWithRetry(t)]:[2,this.removeInfobarWithRetry()]})})},I.prototype.renderInfobarWithRetry=function(t,n){return void 0===n&&(n=0),s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return l.default.getState().currentInfobarIdentifier()?[2,this.replaceInfobar(t,n)]:[2,this.addInfobar(t,n)]})})},I.prototype.removeInfobarWithRetry=function(t){return void 0===t&&(t=0),s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){return l.default.getState().currentInfobarIdentifier()?[2,this.removeInfobar(t)]:[2,!1]})})},I.prototype.addInfobar=function(i,a){return s.__awaiter(this,void 0,void 0,function(){var n,r,o=this
return s.__generator(this,function(e){return(n=this.buildInfobarObject(i))?(r=this.buildApiCallLogCreator(m.InfobarActionType.Add,i.insightName),[2,new Promise(function(t){Office.context.mailbox.item.notificationMessages.addAsync(h.InfobarConstants.InfobarKey,n,function(e){e.status===Office.AsyncResultStatus.Failed?t(o.processRenderInfobarFailure(i,e.error,a,r)):(o.processRenderInfobarSuccess(i,r),o.logInfobarLoad(i),i.instanceData.setMeetingInsightCustomProperties&&i.instanceData.setMeetingInsightCustomProperties(),t(!0))})}).catch(this.processException.bind(this,r))]):[2,!1]})})},I.prototype.replaceInfobar=function(i,a){return s.__awaiter(this,void 0,void 0,function(){var n,r,o=this
return s.__generator(this,function(e){return(n=this.buildInfobarObject(i))?(r=this.buildApiCallLogCreator(m.InfobarActionType.Replace,i.insightName),[2,new Promise(function(t){Office.context.mailbox.item.notificationMessages.replaceAsync(h.InfobarConstants.InfobarKey,n,function(e){e.status===Office.AsyncResultStatus.Failed?t(o.processRenderInfobarFailure(i,e.error,a,r)):(o.processRenderInfobarSuccess(i,r),t(!0))})}).catch(this.processException.bind(this,r))]):[2,!1]})})},I.prototype.removeInfobar=function(o){return s.__awaiter(this,void 0,void 0,function(){var n,r=this
return s.__generator(this,function(e){return n=this.buildApiCallLogCreator(m.InfobarActionType.Remove),[2,new Promise(function(t){Office.context.mailbox.item.notificationMessages.removeAsync(h.InfobarConstants.InfobarKey,function(e){e.status===Office.AsyncResultStatus.Failed?t(r.processRemoveInfobarFailure(e.error,o,n)):(r.processRemoveInfobarSuccess(n),t(!0))})}).catch(this.processException.bind(this,n))]})})},I.prototype.processRenderInfobarSuccess=function(e,t){t.success()
var n=p.default.getInsightIdentifier(e)
r.default(l.default.getState().currentInfobarIdentifier(),n)||a.default.dispatch({actionType:o.default.UpdateInfobar,infobarIdentifier:n})},I.prototype.processRenderInfobarFailure=function(t,n,r,o){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return r<this.MAX_RETRY?(o.expectedFail("Failed to render an infobar with error: "+n.message+", retryCount = "+r+".",n.name),[4,u.default.updateInfobarIdentifier()]):[3,2]
case 1:return e.sent(),[2,this.renderInfobarWithRetry(t,r+1)]
case 2:return o.unexpectedFail("Failed to render an infobar with error: "+n.message+", Abandoning retry.",n.name),[2,!1]}})})},I.prototype.processRemoveInfobarSuccess=function(e){e.success(),a.default.dispatch({actionType:o.default.UpdateInfobar,infobarIdentifier:void 0})},I.prototype.processRemoveInfobarFailure=function(t,n,r){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return n<this.MAX_RETRY?(r.expectedFail("Failed to remove an infobar with error: "+t.message+", retryCount = "+n+".",t.name),[4,u.default.updateInfobarIdentifier()]):[3,2]
case 1:return e.sent(),[2,this.removeInfobarWithRetry(n+1)]
case 2:return r.unexpectedFail("Failed to remove an infobar with error: "+t.message+", Abandoning retry.",t.name),[2,!1]}})})},I.prototype.processException=function(e,t){return t&&"Sys.ArgumentOutOfRangeException"===t.name&&(t.additionalDetails="LCID is "+S.default.LCID,t.description=void 0,t.stack=void 0),e.unexpectedFail(""+JSON.stringify(t)),!1},I.prototype.buildApiCallLogCreator=function(e,t){return new i.default(this.LOG_FEATURE_NAME,g.LogEventType.Set,e,g.LogRequestType.IndirectAction,t)},I.prototype.buildInfobarObject=function(e){var t=d.default.mapToInfobarProperties(e),n=c.default.getCommandIdByCurrentItem()
if(t&&n){var r={userFlights:y.default.getUserFlightsMap(),infobarIdentifier:p.default.getInsightIdentifier(e),contextStores:this.getContextStoresFromInsight(e),sessionGuid:_.default.sessionGuid,sessionStartTime:_.default.sessionStartTime}
return{type:h.InfobarConstants.InfobarType,icon:h.InfobarConstants.InfobarIcon,message:p.default.addPaddingInsightMessage(t.message),actions:[{actionType:Office.MailboxEnums.ActionType.ShowTaskPane,commandId:n,actionText:t.doNotWrapActionText?t.actionText:this.wrapActionTextWithFeedback(t.actionText,e.insightName),contextData:JSON.stringify(r)}]}}},I.prototype.getContextStoresFromInsight=function(e){var t={}
return e.computedFrom.forEach(function(e){t[e.storeName]=d.default.mapStoreNameToDataStreamState(e.storeName)}),t},I.prototype.logInfobarLoad=function(e){function t(){return s.__assign({insightType:e.insightName},d.default.mapToLoggingProperties(e))}var n=this
g.default.logLoad(p.default.getInsightIdentifierAsString(e.instanceData.identifier),{getFeatureNameForLogging:function(){return n.LOG_FEATURE_NAME},getRegionNameForLogging:function(){return"InfobarFactory"},getClickEventLoggingProperties:t,getLoadEventLoggingProperties:t})},I.prototype.wrapActionTextWithFeedback=function(e,t){var n=f.default.INFOBAR_ACTION_TEXT_WITH_FEEDBACK(e)
return n.length>this.ACTION_TEXT_MAX_LENGTH?(g.default.logWarning("ActionText of "+t+" is over limit 30 chars, do not append Feedback","InfobarFactory","wrapActionTextWithFeedback"),e):n},I)
function I(){this.LOG_FEATURE_NAME="Infobar",this.MAX_RETRY=3,this.ACTION_TEXT_MAX_LENGTH=30}t.InfobarFactory=T,t.default=new T},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionableMessageActionCreator=void 0
var r=n(0),a=r.__importDefault(n(3)),o=r.__importDefault(n(54)),s=r.__importDefault(n(11)),i=n(155),u=r.__importDefault(n(544)),l=n(108),c=r.__importDefault(n(4)),d=r.__importDefault(n(27)),p=r.__importDefault(n(57)),f=r.__importDefault(n(6)),g=n(1018),m=r.__importDefault(n(1034)),h=(y.prototype.processActionableMessageContext=function(e){var t=this.parseActionableMessageContext(e)
switch(t.selectedAction){case l.ActionableMessageAction.Feedback:var n=t
n&&n.insightIdentifier&&(o=n.insightIdentifier,p.default.externalInsightIdentifier=o,this.logClickAndRouteToSetting(o,n))
break
case l.ActionableMessageAction.DigestFeedback:t&&t.digestFeedback&&this.logClickAndRouteToFeedback(t.digestFeedback)
break
default:var r=t
if(r&&r.insightIdentifier)try{var o=r.insightIdentifier
this.extractAndDispatchAsInsight(r)
var i=m.default.actionableMessageToExternalContextLoggingProperties(o.insightName,r)
u.default.logExternalContextClickEvent("ActionableMessage",o.insightName,r.messageType,i),d.default.goToDetailsContainer(o)}catch(e){c.default.logAssert("Unable to parse actionable message context. Error: ["+e.message+"]","ActionableMessageActionCreator","processActionableMessageContext")}}s.default.dispatch({actionType:a.default.HasLoadedFromExternalContext})},y.prototype.parseActionableMessageContext=function(e){var t=e
o.default.isOutlookWebApp&&"object"==typeof e&&(t=JSON.stringify(e))
var n=JSON.parse(t,f.default.dateReviver)
return i.ActionableMessageConverterBase.convertToActionableMessageContext(n)},y.prototype.extractAndDispatchAsInsight=function(e){new g.ActionableMessageConverter(e.insightIdentifier.insightName).convertAndDispatchInsight(e)},y.prototype.logClickAndRouteToSetting=function(e,t){var n=m.default.actionableMessageToExternalContextLoggingProperties(e.insightName,t)
u.default.logFeedbackClickEvent(e.insightName,"ActionableMessageNudgeFeedback","ActionableMessageActionCreator",t.messageType,n),d.default.goToNudgeFeedbackContainer(e),s.default.dispatch({actionType:a.default.HasLoadedFromSettingsContext})},y.prototype.logClickAndRouteToFeedback=function(e){u.default.logDigestFeedbackClickEvent(e,"ActionableMessageDigestFeedback","ActionableMessageActionCreator"),d.default.goToFeedbackContainer(e),s.default.dispatch({actionType:a.default.HasLoadedFromExternalContext})},y)
function y(){}t.ActionableMessageActionCreator=h,t.default=new h},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionableMessageConverter_V2=void 0
var r=n(0).__importDefault(n(4)),o=n(108),i=n(1017),a=n(13),s=n(119),u=(l.convertToActionableMessageContext=function(e){var t
return e.Type===i.INSIGHT_CONTEXT_TYPE_NAME_V2?{context:t=e,selectedAction:l.getSelectedAction(t),insightIdentifier:{insightName:l.getActionableMessageInsightType(t),identifier:s.ExternalContextUtils_V2.getInsightIdentifier(t.Insight)},version:o.ContextVersion.V2,messageType:t.FromAdaptiveCard?o.ExplicitMessageType.AdaptiveCard:o.ExplicitMessageType.MessageCard}:e.Type===i.DIGEST_FEEDBACK_CONTEXT_TYPE_NAME_V2?{context:t=e,selectedAction:l.getSelectedAction(t),digestFeedback:s.ExternalContextUtils_V2.getDigestFeedback(t.DigestFeedback),version:o.ContextVersion.V2}:void 0},l.getActionableMessageInsightType=function(e){switch(e.Insight.Name){case"FocusBlocksBookAheadInsight":return a.InsightName.BookFocusTimeActionableMessage
case"ReduceMeetingLoadsInsight":return a.InsightName.MeetingOverloadActionableMessage
case"ShortenMeetingInsight":return a.InsightName.ShortenMeetingActionableMessage
case"FocusBlockConflictInsight":return a.InsightName.FocusTimeConflictActionableMessage
case"ImportantPeopleEmailFollowUpInsight":return a.InsightName.SuggestedTasksActionableMessage
case"AfterHoursAttendeeMeetingSuggestionInsight":return a.InsightName.AfterHoursMeetingAttendeeActionableMessage
case"SentMailInsight":return a.InsightName.SentMailStatsInContextActionableMessage
case"PostDelayDeliveryInsight":return a.InsightName.PostDelayDeliveryActionableMessage
default:throw r.default.logWarning("Insight type is not supported: "+e.Insight.Name,"getActionableMessageInsightType","ActionableMessage_V2"),new Error("Couldn't map actionable message to insight: "+e.Insight.Name)}},l.getSelectedAction=function(e){return e.ActionName===i.FEEDBACK_ACTION_NAME_V2?o.ActionableMessageAction.Feedback:e.ActionName===i.DIGEST_FEEDBACK_ACTION_NAME_V2?o.ActionableMessageAction.DigestFeedback:o.ActionableMessageAction.Insight},l)
function l(){}t.ActionableMessageConverter_V2=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MARK_TODO_AS_DONE_V2=t.DIGEST_FEEDBACK_CONTEXT_TYPE_NAME_V2=t.INSIGHT_CONTEXT_TYPE_NAME_V2=t.DIGEST_FEEDBACK_ACTION_NAME_V2=t.FEEDBACK_ACTION_NAME_V2=void 0,t.FEEDBACK_ACTION_NAME_V2="Feedback",t.DIGEST_FEEDBACK_ACTION_NAME_V2="DigestFeedback",t.INSIGHT_CONTEXT_TYPE_NAME_V2="Microsoft.O365Insights.Sdk.Insights.V1",t.DIGEST_FEEDBACK_CONTEXT_TYPE_NAME_V2="Microsoft.O365Insights.Sdk.DigestFeedback",t.MARK_TODO_AS_DONE_V2="MarkAsDone"},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ActionableMessageConverter=void 0
var r=n(0),o=r.__importDefault(n(1019)),i=r.__importDefault(n(1021)),a=r.__importDefault(n(1023)),s=r.__importDefault(n(1025)),u=r.__importDefault(n(1027)),l=r.__importDefault(n(1029)),c=r.__importDefault(n(1030)),d=r.__importDefault(n(1032)),p=n(13),f=(Object.defineProperty(g.prototype,"ActionableMessageConverter",{get:function(){switch(this.insightName){case p.InsightName.BookFocusTimeActionableMessage:return i.default
case p.InsightName.FocusTimeConflictActionableMessage:return a.default
case p.InsightName.MeetingOverloadActionableMessage:return s.default
case p.InsightName.AfterHoursMeetingAttendeeActionableMessage:return o.default
case p.InsightName.SuggestedTasksActionableMessage:return d.default
case p.InsightName.ShortenMeetingActionableMessage:return u.default
case p.InsightName.SentMailStatsInContextActionableMessage:return l.default
case p.InsightName.PostDelayDeliveryActionableMessage:return c.default
default:throw new Error("No Actionable message converter exists for "+this.insightName)}},enumerable:!1,configurable:!0}),g.prototype.convertAndDispatchInsight=function(e){return this.ActionableMessageConverter.convertAndDispatchInsight(e)},g)
function g(e){this.insightName=e}t.ActionableMessageConverter=f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AfterHoursMeetingAttendeeActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1020)),a=n(108),s=n(155),u=n(3),l=(r=s.ActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return u.Action.GetAfterHoursMeetingAttendeeActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid AfterHoursMeetingAttendee insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.AfterHoursMeetingAttendeeActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.AfterHoursMeetingAttendeeActionableMessageConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importDefault(n(75)),a=(s.prototype.convertToRuntimeInsight=function(e){var t=this
o.default.throwIfUndefinedOrNull("actionableMessageContext",e),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight",e.Insight),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight Inference",e.Insight.Inference),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight Inference Subject",e.Insight.Inference.Subject),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight Inference Observation",e.Insight.Inference.Observations)
var n=i.default.convertObservation(e.Insight.Inference.Observations,"AfterHoursAttendeeMeetingSuggestionFreeTimeBlocks")
return o.default.throwIfNullOrEmptyArray("suggestedMeetingTimes",n),{suggestedMeetingTimes:n.map(function(e){return t.convertToRuntimeSuggestedMeetingDate(e)})}},s.prototype.convertToRuntimeSuggestedMeetingDate=function(e){return o.default.throwIfUndefinedOrInvalidDate("StartDateTime",e.StartDateTime),o.default.throwIfUndefinedOrInvalidDate("EndDateTime",e.EndDateTime),{startDate:e.StartDateTime,endDate:e.EndDateTime}},s)
function s(){}t.AfterHoursMeetingAttendeeActionableMessageConverter_V2=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BookFocusTimeActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1022)),a=n(108),s=n(3),u=n(545),l=(r=u.FocusTimeActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return s.Action.GetFocusTimeFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid FocusTime insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.BookFocusTimeActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.BookFocusTimeActionableMessageConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importDefault(n(4)),a=r.__importDefault(n(75)),s=r.__importDefault(n(513)),u=n(29),l=(c.prototype.convertToRuntimeInsight=function(e){var t=e.Insight.Inference.Observations
return{meetingTimeRange:{startDate:this.convertVersionedDateToDate(a.default.convertObservation(t,"MeetingStartTime")),endDate:this.convertVersionedDateToDate(a.default.convertObservation(t,"MeetingEndTime"))},freeBlocks:s.default.extractFreeBlockSuggestionFromContext(e),focusTimeType:this.convertInsightIdToEnum(t)}},c.prototype.convertVersionedDateToDate=function(e){return o.default.throwIfUndefinedOrInvalidDate("versionedDate",e),e},c.prototype.convertInsightIdToEnum=function(e){var t=e.filter(function(e){return"BookAheadScenario"===e.Name})[0].Value
switch(o.default.throwIfUndefinedOrEmptyString("insightId",t),t){case"BusyMeetingDay":return u.BookFocusTimeActionableMessageTypes.BusyDay
case"BusyNextWeek":return u.BookFocusTimeActionableMessageTypes.NextWeekBusy
case"BusyCurrentWeek":return u.BookFocusTimeActionableMessageTypes.ThisWeekBusy
default:return void i.default.logAssert("Undefined focus time actionable message type: "+t,"FocusTimeActionableMessageConverter","convertInsightIdToEnum")}},c)
function c(){}t.BookFocusTimeActionableMessageConverter_V2=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeConflictActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1024)),a=n(3),s=n(108),u=n(545),l=(r=u.FocusTimeActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return a.Action.GetFocusTimeConflictFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case s.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid FocusTime conflict insight version: ["+s.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.FocusTimeConflictActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.FocusTimeConflictActionableMessageConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importStar(n(52)),a=n(29),s=(u.prototype.convertToRuntimeInsight=function(e){var t=i.default.convertSuggestedActions(e.Insight.Suggestion.SuggestedActions,i.MOVE_MEETING_ACTION_NAME),n=i.default.convertSuggestedActions(e.Insight.Suggestion.SuggestedActions,i.MOVE_FOCUS_BLOCK_ACTION_NAME),r=e.Insight.Inference.Observations.filter(function(e){return"ConflictingFocusBlocks"===e.Name})[0].Value,o=this.convertToCalendarItem(r)
return{meetingFreeBlocks:this.getFreeBlocks(t),freeBlocks:this.getFreeBlocks(n),focusTimeConflictType:this.convertActionNameToConflictType(e.ActionName),conflictingEvents:o}},u.prototype.convertToCalendarItem=function(e){return e.map(function(e){return o.default.throwIfUndefinedOrInvalidDate("startTime",e.StartTime),o.default.throwIfUndefinedOrInvalidDate("endTime",e.EndTime),o.default.throwIfUndefinedOrEmptyString("event identifier",e.EventId),{startDate:e.StartTime,endDate:e.EndTime,subject:e.Subject,identifier:{id:e.EventId}}})},u.prototype.getFreeBlocks=function(e){var t=this
return e.map(function(e){return t.validateDateObject({StartTime:e.StartTime,EndTime:e.EndTime})})},u.prototype.validateDateObject=function(e){return o.default.throwIfUndefinedOrInvalidDate("startDate",e.StartTime),o.default.throwIfUndefinedOrInvalidDate("endDate",e.EndTime),{startDate:e.StartTime,endDate:e.EndTime}},u.prototype.convertActionNameToConflictType=function(e){switch(e){case i.MOVE_FOCUS_BLOCK_ACTION_NAME:return a.FocusConflict.MoveFocusBlock
case i.MOVE_MEETING_ACTION_NAME:return a.FocusConflict.MoveMeeting
default:throw new Error("Unexpected action name: "+e)}},u)
function u(){}t.FocusTimeConflictActionableMessageConverter_V2=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingOverloadActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1026)),a=n(108),s=n(155),u=n(3),l=(r=s.ActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return u.Action.GetMeetingOverloadFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid MeetingOverload insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.MeetingOverloadActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingOverloadActionableMessageConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importStar(n(52)),a=(s.prototype.convertToRuntimeInsight=function(e){var t=i.default.convertSuggestedActions(e.Insight.Suggestion.SuggestedActions,i.DELEGATE_ATTENDEES_ACTION_NAME)
return{delegateAttendees:this.convertToMeetingDelegates(t)}},s.prototype.convertToMeetingDelegates=function(e){return e.map(function(e){return o.default.throwIfUndefinedOrEmptyString("emailAddress",e.DelegateAttendeesSuggestions.EmailAddress),o.default.throwIfUndefinedOrNull("isInvitedInOriginalMeeting",e.DelegateAttendeesSuggestions.IsInvitedInOriginalMeeting),{name:e.DelegateAttendeesSuggestions.Name,smtpAddress:e.DelegateAttendeesSuggestions.EmailAddress,meetingResponse:null==e.DelegateAttendeesSuggestions.MeetingResponse?"None":e.DelegateAttendeesSuggestions.MeetingResponse,isInvitedInMeeting:e.DelegateAttendeesSuggestions.IsInvitedInOriginalMeeting}})},s)
function s(){}t.MeetingOverloadActionableMessageConverter_V2=a,t.default=new a},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenMeetingActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1028)),a=n(108),s=n(155),u=n(3),l=(r=s.ActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return u.Action.GetShortenMeetingFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid ShortenMeeting insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.ShortenMeetingActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.ShortenMeetingActionableMessageConverter_V2=void 0
var r=n(0).__importStar(n(52)),o=(i.prototype.convertToRuntimeInsight=function(e){return{bodyText:r.default.convertSuggestedActions(e.Insight.Suggestion.SuggestedActions,r.SHORTEN_MEETING_REPLY_ACTION_NAME)[0].EmailTextSuggestion}},i)
function i(){}t.ShortenMeetingActionableMessageConverter_V2=o,t.default=new o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SentMailStatsInContextActionableMessageConverter=void 0
var r,o=n(0),i=n(3),a=n(155),s=n(108),u=o.__importDefault(n(546)),l=o.__importDefault(n(524)),c=(r=a.ActionableMessageConverterBase,o.__extends(d,r),Object.defineProperty(d.prototype,"dispatchActionName",{get:function(){return i.Action.GetToSentMailStatsInContextFromActionableMessage},enumerable:!1,configurable:!0}),d.prototype.parseAsInsightInstance=function(e,t){switch(e){case s.ContextVersion.V2:return u.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid sent mail insight version: ["+s.ContextVersion[e]+"]")}},d.prototype.dispatchConvertedInsight=function(e){l.default.sentMailStatsFromActionableMessage(e)},d)
function d(){return null!==r&&r.apply(this,arguments)||this}t.SentMailStatsInContextActionableMessageConverter=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PostDelayDeliveryActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1031)),a=n(108),s=n(155),u=n(3),l=(r=s.ActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return u.Action.GetPostDelayDeliveryFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid PostDelayDelivery insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.PostDelayDeliveryActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.PostDelayDeliveryActionableMessageConverter_V2=void 0
var r=n(0),o=r.__importDefault(n(39)),i=r.__importStar(n(52)),a=n(402),s=(u.prototype.convertToRuntimeInsight=function(e){return o.default.throwIfUndefinedOrNull("actionableMessageContext",e),o.default.throwIfUndefinedOrNull("actionableMessageContext ActionName",e.ActionName),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight",e.Insight),o.default.throwIfUndefinedOrNull("actionableMessageContext Insight Suggestion",e.Insight.Suggestion),{actionName:this.getSelectedScenario(e.ActionName),actionPayload:i.default.convertSuggestedAction(e.Insight.Suggestion.SuggestedActions,e.ActionName)}},u.prototype.getSelectedScenario=function(e){switch(e){case i.CANCEL_DELAY_DELIVERY_AND_DELETE_ACTION:return a.CancelDelayDeliveryActionName.CancelAndDelete
case i.CANCEL_DELAY_DELIVERY_AND_SEND_ACTION:return a.CancelDelayDeliveryActionName.CancelAndSend
default:throw new Error("Unexpected action name: "+e)}},u)
function u(){}t.PostDelayDeliveryActionableMessageConverter_V2=s,t.default=new s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedTasksActionableMessageConverter=void 0
var r,o=n(0),i=o.__importDefault(n(1033)),a=n(108),s=n(155),u=n(3),l=(r=s.ActionableMessageConverterBase,o.__extends(c,r),Object.defineProperty(c.prototype,"dispatchActionName",{get:function(){return u.Action.GetSuggestedTasksFromActionableMessage},enumerable:!1,configurable:!0}),c.prototype.parseAsInsightInstance=function(e,t){switch(e){case a.ContextVersion.V2:return i.default.convertToRuntimeInsight(t)
default:throw new Error("Invalid SuggestedTasks insight version: ["+a.ContextVersion[e]+"]")}},c)
function c(){return null!==r&&r.apply(this,arguments)||this}t.SuggestedTasksActionableMessageConverter=l,t.default=new l},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestedTasksActionableMessageConverter_V2=void 0
var r=n(0),o=n(66),i=r.__importDefault(n(39)),a=r.__importDefault(n(75)),s=n(518),u=n(52),l=r.__importDefault(n(35)),c=(d.prototype.convertToRuntimeInsight=function(e){i.default.throwIfUndefinedOrNull("actionableMessageContext",e),i.default.throwIfUndefinedOrNull("actionableMessageContext Insight",e.Insight),i.default.throwIfUndefinedOrNull("actionableMessageContext Insight Inference",e.Insight.Inference),i.default.throwIfUndefinedOrNull("actionableMessageContext Insight Inference Subject",e.Insight.Inference.Subject),i.default.throwIfNullOrEmptyArray("actionableMessageContext Insight Inference Observation",e.Insight.Inference.Observations)
var t=a.default.convertObservation(e.Insight.Inference.Observations,"ToDoObservation")
return{targetPerson:this.extractTargetPerson(t),tasks:this.extractTasks(t)}},d.prototype.extractTargetPerson=function(e){return i.default.throwIfUndefinedOrNull("todoObservation ImportantPerson",e.ImportantPerson),i.default.throwIfUndefinedOrNull("todoObservation ImportantPerson DisplayName",e.ImportantPerson.DisplayName),i.default.throwIfUndefinedOrEmptyString("todoObservation PrimarySmtp",e.ImportantPerson.PrimarySmtpAddress),{name:e.ImportantPerson.DisplayName,smtpAddress:e.ImportantPerson.PrimarySmtpAddress.toLowerCase()}},d.prototype.extractTasks=function(e){var t=this
return i.default.throwIfNullOrEmptyArray("todoObservation tasks",e.ToDos),e.ToDos.map(function(e){return t.validateTask(e)}),e.ToDos.map(function(e){return t.convertToRuntimeTask(e)})},d.prototype.validateTask=function(e){i.default.throwIfUndefinedOrEmptyString("TaskId",e.TaskId),i.default.throwIfUndefinedOrNull("NumberOfRecipientsOnToLine",e.NumberOfRecipientsOnToLine),i.default.throwIfUndefinedOrNull("SourceMailSubject",e.SourceMailSubject),i.default.throwIfUndefinedOrEmptyString("SourceMailId",e.SourceMailId),i.default.throwIfUndefinedOrNull("ToDoEntityId",e.ToDoEntityId),i.default.throwIfUndefinedOrNull("Confidence",e.Confidence),i.default.throwIfUndefinedOrEmptyString("Description",e.Description),i.default.throwIfUndefinedOrEmptyString("ActionType",e.ActionType),i.default.throwIfUndefinedOrInvalidDate("SourceReceivedDateTime",new Date(e.SourceReceivedDateTime)),i.default.throwIfNullOrEmptyArray("Requester",e.Requesters)},d.prototype.convertToRuntimeTask=function(e){var t=this.getTaskType(e.ActionType)
return t===o.TaskType.Commitment||t===o.TaskType.Request?this.convertToTodoSuggestion(e,t):this.convertToFollowUpSuggestion(e,t)},d.prototype.convertToTodoSuggestion=function(e,t){return{taskId:e.TaskId,numberOfRecipientsOnToLine:e.NumberOfRecipientsOnToLine,sourceMailSubject:e.SourceMailSubject,sourceMailId:l.default.convertToEwsId(e.SourceMailId),todoEntityId:e.ToDoEntityId,confidence:e.Confidence,description:e.Description,taskType:t,sourceReceivedDateTime:new Date(e.SourceReceivedDateTime),targetPerson:{mailAddress:e.Requesters[0].MailAddress,displayName:e.Requesters[0].DisplayName},markAsDone:{Name:u.MARK_TASK_AS_DONE_ACTION,TaskSuggestionId:e.TaskId,Text:null},markAsNotATask:{Name:u.MARK_AS_NOT_A_TASK_ACTION,TaskSuggestionId:e.TaskId,Text:null},promoteTask:{Name:u.PROMOTE_TASK_ACTION,TaskSuggestionId:e.TaskId,Text:null},hasTaskBeenPromoted:!1,promotedTaskLink:null}},d.prototype.convertToFollowUpSuggestion=function(e,t){var n=this.convertToTodoSuggestion(e,t)
return n.sourceConversationId=e.SourceConversationId,n},d.prototype.getTaskType=function(e){switch(e){case s.TODO_COMMITMENT:return o.TaskType.Commitment
case s.TODO_REQUEST:return o.TaskType.Request
case s.FOLLOW_UP_ACTION_REQUEST:return o.TaskType.FollowUpActionRequest
case s.FOLLOW_UP_REPLY_REQUEST:return o.TaskType.FollowUpReplyRequest
default:throw Error("Invalid task actionType: "+e)}},d)
function d(){}t.SuggestedTasksActionableMessageConverter_V2=c,t.default=new c},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),u=n(13),l=n(108),c=r.__importDefault(n(546)),d=n(208),p=r.__importDefault(n(8)),o=(i.actionableMessageToExternalContextLoggingProperties=function(e,t){var n
switch(e){case u.InsightName.SentMailStatsInContextActionableMessage:var r,o,i=t.context,a=!1,s=d.StatisticsBreakdownTypes.EXTENDED_SENT_MAIL_STATISTICS_BREAKDOWN
return!p.default.isExtendedSentMailStatsEnabled||(null==t?void 0:t.version)!==l.ContextVersion.V2||0<(null==(o=null===(n=null==(r=c.default.convertToRuntimeInsight(i))?void 0:r.StatisticBreakdowns)||void 0===n?void 0:n.filter(function(e){return e["@odata.type"].toUpperCase()===s.toUpperCase()}))?void 0:o.length)&&(a=!0),a?{hasExtendedStatistics:a}:{}
default:return{}}},i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o=n(0).__importDefault(n(44)),r=(i.getMessageAndActionText=function(e,t,n){var r="PEOPLE_CATCH_UP_TODO_AND_FOLLOW_UP_INFOBAR"
return 0===e?r="PEOPLE_CATCH_UP_TODO_INFOBAR":0===t&&(r="PEOPLE_CATCH_UP_FOLLOW_UP_INFOBAR"),[o.default.getLocalizationString(r).replace("{0}",n),o.default.getLocalizationString("PEOPLE_CATCH_UP_ACTION")]},i)
function i(){}t.default=r},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=n(309),a=r.__importDefault(n(4)),s=r.__importDefault(n(2)),u=(l.getInfobarMessage=function(e){if(e.durationInHours===o.Constants.oneHourInHours)return this.getSuggestion(e,"")},l.getSuggestion=function(e,t){switch(e.meetingType){case i.MeetingType.RecurringGroup:return s.default.SHORTEN_MEETING_RECURRING_GROUP(this.getOverRoundHoursString(e.organizerTimeSaveInHours),t)
case i.MeetingType.RecurringOneOnOne:return s.default.SHORTEN_MEETING_RECURRING_ONEONONE(this.getOverRoundHoursString(e.organizerTimeSaveInHours),t)
case i.MeetingType.OneTimeGroup:return s.default.SHORTEN_MEETING_ONETIME_GROUP(t)
default:return void a.default.logAssert("Undefined meetingType enum value","MeetingType","getShortenMeetingSuggestion")}},l.getOverRoundHoursString=function(e){var t=Math.floor(e)
return e<o.Constants.oneHourInHours?this.getMinutesString(e*o.Constants.oneHourInMinutes):e!==t?s.default.OVER_HOURS_COUNT(this.getHoursString(t)):this.getHoursString(t)},l.getHoursString=function(e){return s.default.HOURS_COUNT(e,e)},l.getMinutesString=function(e){return s.default.MINUTES_COUNT(e)},l)
function l(){}t.default=u},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var r=n(0),o=n(7),i=r.__importDefault(n(4)),a=r.__importDefault(n(25)),s=(u.getSupportedLanguage=function(e){var t=u.languageMap[e]
if(t)return t
var n=e.split("-")[0],r=u.languageMap[n]
return r||(a.default.isInBackgroundMode||i.default.logWarning("Unsupported LCID "+e+". Mapping to default language.","LocalizerMap","getSupportedLanguage"),o.Constants.defaultLocation)},u.languageMap={"ar-sa":"ar-sa","be-by":"ru-ru","ca-es":"ca-es","cs-cz":"cs-cz","da-dk":"da-dk","de-de":"de-de","el-gr":"el-gr","es-es":"es-es","et-ee":"et-ee","eu-es":"eu-es","fi-fi":"fi-fi","fr-fr":"fr-fr","gl-es":"gl-es","he-il":"he-il","hi-in":"hi-in","hr-hr":"hr-hr","hu-hu":"hu-hu","id-id":"id-id","it-ch":"it-it","it-it":"it-it","ja-jp":"ja-jp","kk-kz":"kk-kz","ko-kr":"ko-kr","ky-kg":"ru-ru","lb-lu":"de-de","lv-lv":"lv-lv","nb-no":"nb-no","nl-nl":"nl-nl","pl-pl":"pl-pl","pt-br":"pt-br","pt-pt":"pt-pt","qut-gt":"es-es","quz-pe":"es-es","ro-ro":"ro-ro","ru-ru":"ru-ru","sk-sk":"sk-sk","sl-si":"sl-si","sr-cyrl":"sr-cyrl-cs","sr-cyrl-rs":"sr-cyrl-cs","sr-latn":"sr-latn-cs","sv-se":"sv-se","tg-cyrl-tj":"ru-ru","th-th":"th-th","tk-tm":"ru-ru","tr-tr":"tr-tr","tt-ru":"ru-ru","ug-cn":"zh-cn","uk-ua":"uk-ua","vi-vn":"vi-vn","wo-sn":"fr-fr","zh-cn":"zh-cn","zh-hans":"zh-cn","zh-hant":"zh-tw","zh-hk":"zh-tw","zh-mo":"zh-tw","zh-sg":"zh-cn","zh-tw":"zh-tw",ar:"ar-sa",be:"ru-ru",bg:"bg-bg",ca:"ca-es",cs:"cs-cz",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es",et:"et-ee",fi:"fi-fi",fr:"fr-fr",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",it:"it-it",ja:"ja-jp",ko:"ko-kr",lb:"de-de",lt:"lt-lt",lv:"lv-lv",ms:"ms-my",nb:"nb-no",nl:"nl-nl",pl:"pl-pl",pt:"pt-br",qut:"es-es",quz:"es-es",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-cs",sv:"sv-se",th:"th-th",tk:"ru-ru",tr:"tr-tr",tt:"ru-ru",ug:"zh-cn",uk:"uk-ua",vi:"vi-vn",wo:"zh-cn",zh:"en-us"},u)
function u(){}t.default=s},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var u=n(0),l=u.__importDefault(n(235)),r=u.__importDefault(n(25)),c=u.__importDefault(n(11)),d=u.__importDefault(n(6)),p=u.__importStar(n(4)),f=u.__importDefault(n(116)),g=n(7),m=u.__importDefault(n(175)),o=(Object.defineProperty(i,"rootPath",{get:function(){return r.default.isInAutoRunJSMode?"":"../.."},enumerable:!1,configurable:!0}),i.requestResjsonLocStrings=function(s,o){return u.__awaiter(this,void 0,void 0,function(){var i,t,n,a,r=this
return u.__generator(this,function(e){switch(e.label){case 0:return i=s.lcId,[4,f.default.tryLoadFromPersistedStorage(s.localStorageKey)]
case 1:return(t=e.sent().result)&&(p.default.logInformation(i,"App","GetLocalizationStringFromCache"),c.default.dispatch({actionType:s.actionToDispatch,nameValueMappings:t})),n={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8"},cache:"no-cache"},a=new l.default("App",p.LogEventType.Get,o,p.LogRequestType.Interval),d.default.fetchWithTimeout(s.remoteUrl,n,this.TIMEOUT_IN_MILLISECONDS).then(function(o){return u.__awaiter(r,void 0,void 0,function(){var t,n,r
return u.__generator(this,function(e){switch(e.label){case 0:return o.ok?(r=(n=JSON).parse,[4,o.text()]):(i===g.Constants.defaultLocation?(a.unexpectedFail("Failed to load localization string "+i+" with Error: "+o.status),m.default.updateDebugMessage("Failed to load default locStrings")):a.expectedFail("Failed to load localization string "+i+" with Error: "+o.status),[2])
case 1:switch(t=r.apply(n,[e.sent()]),a.success(),i){case"ar-sa":case"he-il":t.DIR_ATTRIBUTE="rtl"
break
default:t.DIR_ATTRIBUTE="ltr"}return f.default.trySaveToPersistedStorage(s.localStorageKey,t,30*g.Constants.oneMinuteInSeconds),c.default.dispatch({actionType:s.actionToDispatch,nameValueMappings:t}),[2]}})})}).catch(function(e){a.unexpectedFail("Connection error in loading localization strings. ["+e+"]"),m.default.updateDebugMessage("Failed to connect locStrings")}),[2]}})})},i.TIMEOUT_IN_MILLISECONDS=6e3,i)
function i(){}t.default=o},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.LoadStoreFromCacheActionCreator=void 0
var a=n(0),s=a.__importDefault(n(3)),u=a.__importDefault(n(25)),l=a.__importDefault(n(11)),r=a.__importDefault(n(64)),o=a.__importDefault(n(91)),i=a.__importDefault(n(245)),c=a.__importDefault(n(551)),d=a.__importDefault(n(286)),p=a.__importDefault(n(398)),f=a.__importDefault(n(120)),g=a.__importDefault(n(298)),m=a.__importDefault(n(300)),h=a.__importDefault(n(153)),y=a.__importDefault(n(552)),_=a.__importDefault(n(204)),S=a.__importDefault(n(242)),T=a.__importDefault(n(118)),I=a.__importDefault(n(306)),b=a.__importDefault(n(304)),E=a.__importDefault(n(302)),v=a.__importDefault(n(301)),A=a.__importDefault(n(293)),D=a.__importDefault(n(295)),O=a.__importDefault(n(539)),C=a.__importDefault(n(178)),R=a.__importDefault(n(241)),M=a.__importDefault(n(297)),P=a.__importDefault(n(303)),N=a.__importDefault(n(207)),k=a.__importDefault(n(400)),w=a.__importDefault(n(179)),F=a.__importDefault(n(299)),L=a.__importDefault(n(287)),U=a.__importDefault(n(4)),x=(B.prototype.triggerLoad=function(){return a.__awaiter(this,void 0,void 0,function(){var t,n,r,o,i=this
return a.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),t=this.CACHED_STORES.filter(function(e){return e.shouldLoadFromCache()}).map(function(e){return i.loadCachedStore(e)}),[4,Promise.all(t)]
case 1:return n=e.sent(),0<(r=n.filter(function(e){return e.failedToLoad}).map(function(e){return e.storeName})).length&&U.default.logWarning("Failed cnt: "+r.length+". Stores: ["+(r.length===this.CACHED_STORES.length?"All":r)+"]",this.LOG_FEATURE_NAME,"triggerLoad"),[3,3]
case 2:return o=e.sent(),U.default.logAssert("Caught error: "+JSON.stringify(o),this.LOG_FEATURE_NAME,"triggerLoad"),[3,3]
case 3:return[2]}})})},B.prototype.loadCachedStore=function(i){return a.__awaiter(this,void 0,void 0,function(){var t,n,r,o
return a.__generator(this,function(e){switch(e.label){case 0:t=i.getStoreLoggingName(),n=!1,e.label=1
case 1:return e.trys.push([1,3,,4]),[4,i.loadFromCache()]
case 2:return(r=e.sent())&&l.default.dispatch({actionType:s.default.UpdateLoadedCache,storeName:t,cachedResult:r}),[3,4]
case 3:return o=e.sent(),n=!0,u.default.isLocalDebugging&&U.default.logAssert("Failed to load cache for "+t+": "+o,this.LOG_FEATURE_NAME,"loadCachedStore"),[3,4]
case 4:return[2,{storeName:t,failedToLoad:n}]}})})},B)
function B(){this.CACHED_STORES=[r.default,o.default,T.default,f.default,L.default,C.default,w.default,_.default,N.default,S.default,y.default,R.default,i.default,I.default,d.default,E.default,v.default,g.default,m.default,b.default,A.default,D.default,M.default,P.default,F.default,p.default,k.default,O.default,c.default,h.default],this.LOG_FEATURE_NAME="LoadStoreFromCacheActionCreator"}t.LoadStoreFromCacheActionCreator=x,t.default=new x},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0}),t.UserFlightsActionCreator=void 0
var o=n(0),r=o.__importDefault(n(35)),i=o.__importDefault(n(1041)),a=o.__importDefault(n(11)),s=n(4),u=n(34),l=o.__importDefault(n(3)),c=o.__importStar(n(116)),d=n(7),p=o.__importDefault(n(175)),f=(g.prototype.getUserFlights=function(r){return o.__awaiter(this,void 0,void 0,function(){var t,n
return o.__generator(this,function(e){switch(e.label){case 0:return[4,this.requestUserFlights()]
case 1:return(t=e.sent()).status===Office.AsyncResultStatus.Succeeded?(n=t.result.Flights,r||a.default.dispatch({actionType:l.default.GetUserFlightsFromControlTower,userFlights:n}),c.default.trySaveToPersistedStorage(c.PersistedStorageKeys.UserFlights_V1,n,d.Constants.oneDayInSeconds)):r||(a.default.dispatch({actionType:l.default.FailedAjaxConnection}),p.default.updateDebugMessage("Failed to load flights.")),[2]}})})},g.prototype.requestUserFlights=function(){var e=new i.default("UserFlights","GetUserFlightsFromControlTower",s.LogRequestType.Init)
return r.default.executeWESRequest(e,u.RequestPriority.High)},g)
function g(){}t.UserFlightsActionCreator=f,t.default=new f},function(e,t,n){"use strict"
Object.defineProperty(t,"__esModule",{value:!0})
var o,r=n(0),i=n(5),a=n(16),s=n(38),u=(o=s.WESRequestBase,r.__extends(l,o),Object.defineProperty(l.prototype,"urlPath",{get:function(){return"Me/Flights"},enumerable:!1,configurable:!0}),l=r.__decorate([i.doop],l))
function l(e,t,n,r){return o.call(this,a.HTTPRequestMethod.GET,e,t,n,r)||this}t.default=u},function(e,t){e.exports="../../tempimages/6b70662b0e44e423e59af78d6815e3d1.gif"},function(e,t){e.exports="../../tempimages/0f3f53010fa877c46409265cc6d6ecac.gif"}]])
